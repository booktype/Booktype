/*
 Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Copyright 2011, Tim Down
 Licensed under the MIT license.
 Version: 1.2.1
 Build date: 8 October 2011
 MIT License {@link http://creativecommons.org/licenses/MIT/}
 @return {String} outerHtml

 jquery.layout 1.3.0 - Release Candidate 30.7
 $Date: 2012-10-13 08:00:00 (Sat, 13 Oct 2012) $
 $Rev: 303007 $

 Copyright (c) 2012 
   Fabrizio Balliano (http://www.fabrizioballiano.net)
   Kevin Dalman (http://allpro.net)

 Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.

 Changelog: http://layout.jquery-dev.net/changelog.cfm#1.3.0.rc30.7

 Docs: http://layout.jquery-dev.net/documentation.html
 Tips: http://layout.jquery-dev.net/tips.html
 Help: http://groups.google.com/group/jquery-ui-layout
 RequireJS i18n 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details
*/
(function(){function Da(l,f){var a,g;g=l||{};this.jQuery=f||{};this.config={};this.config.elements=g.elements?g.elements:[];this.config.attributes=g.attributes?g.attributes:{};this.config.attributes[Da.ALL]=this.config.attributes[Da.ALL]?this.config.attributes[Da.ALL]:[];this.config.allow_comments=g.allow_comments?g.allow_comments:!1;this.allowed_elements={};this.config.protocols=g.protocols?g.protocols:{};this.config.add_attributes=g.add_attributes?g.add_attributes:{};this.dom=g.dom?g.dom:document;
for(a=0;a<this.config.elements.length;a++)this.allowed_elements[this.config.elements[a]]=!0;this.config.remove_element_contents={};this.config.remove_all_contents=!1;if(g.remove_contents)if(g.remove_contents instanceof Array)for(a=0;a<g.remove_contents.length;a++)this.config.remove_element_contents[g.remove_contents[a]]=!0;else this.config.remove_all_contents=!0;this.transformers=g.transformers?g.transformers:[];this.filters=g.filters?g.filters:[]}var ja;ja||(ja={});(function(){function l(a){return 10>
a?"0"+a:a}function f(a){c.lastIndex=0;return c.test(a)?'"'+a.replace(c,function(a){var b=k[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function a(c,d){var k,g,s,o,q=b,r,u=d[c];u&&("object"===typeof u&&"function"===typeof u.toJSON)&&(u=u.toJSON(c));"function"===typeof j&&(u=j.call(d,c,u));switch(typeof u){case "string":return f(u);case "number":return isFinite(u)?""+u:"null";case "boolean":case "null":return""+u;case "object":if(!u)return"null";
b+=e;r=[];if("[object Array]"===Object.prototype.toString.apply(u)){o=u.length;for(k=0;k<o;k+=1)r[k]=a(k,u)||"null";s=0===r.length?"[]":b?"[\n"+b+r.join(",\n"+b)+"\n"+q+"]":"["+r.join(",")+"]";b=q;return s}if(j&&"object"===typeof j){o=j.length;for(k=0;k<o;k+=1)"string"===typeof j[k]&&(g=j[k],(s=a(g,u))&&r.push(f(g)+(b?": ":":")+s))}else for(g in u)Object.prototype.hasOwnProperty.call(u,g)&&(s=a(g,u))&&r.push(f(g)+(b?": ":":")+s);s=0===r.length?"{}":b?"{\n"+b+r.join(",\n"+b)+"\n"+q+"}":"{"+r.join(",")+
"}";b=q;return s}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,e,k={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;"function"!==typeof ja.stringify&&(ja.stringify=function(c,d,k){var g;e=b="";if(typeof k==="number")for(g=0;g<k;g=g+1)e=e+" ";else typeof k==="string"&&(e=k);if((j=d)&&typeof d!=="function"&&(typeof d!=="object"||typeof d.length!=="number"))throw Error("JSON.stringify");return a("",{"":c})});
"function"!==typeof ja.parse&&(ja.parse=function(a,d){function b(a,c){var m,j,e=a[c];if(e&&typeof e==="object")for(m in e)if(Object.prototype.hasOwnProperty.call(e,m)){j=b(e,m);j!==void 0?e[m]=j:delete e[m]}return d.call(a,c,e)}var c,a=""+a;g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=eval("("+a+")");return typeof d==="function"?b({"":c},""):c}throw new SyntaxError("JSON.parse");})})();define("util/json2",[],function(){return ja});(function(){var l=function(){function f(a,b){var c=typeof a[b];return c==d||!!(c==m&&a[b])||"unknown"==c}function a(a,d){return!!(typeof a[d]==m&&a[d])}function g(a,d){return typeof a[d]!=p}function c(a){return function(d,b){for(var c=b.length;c--;)if(!a(d,b[c]))return!1;return!0}}function b(a){return a&&r(a,
q)&&x(a,o)}function e(a){window.alert("Rangy not supported in your browser. Reason: "+a);t.initialized=!0;t.supported=!1}function k(){if(!t.initialized){var d,c=!1,m=!1;f(document,"createRange")&&(d=document.createRange(),r(d,s)&&x(d,n)&&(c=!0),d.detach());if((d=a(document,"body")?document.body:document.getElementsByTagName("body")[0])&&f(d,"createTextRange"))d=d.createTextRange(),b(d)&&(m=!0);!c&&!m&&e("Neither Range nor TextRange are implemented");t.initialized=!0;t.features={implementsDomRange:c,
implementsTextRange:m};c=B.concat(l);m=0;for(d=c.length;m<d;++m)try{c[m](t)}catch(j){a(window,"console")&&f(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",j)}}}function j(a){this.name=a;this.supported=this.initialized=!1}var m="object",d="function",p="undefined",n="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),s="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
o="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),q="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),r=c(f),u=c(a),x=c(g),t={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:f,isHostObject:a,isHostProperty:g,areHostMethods:r,areHostObjects:u,areHostProperties:x,isTextRange:b},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!0}};
t.fail=e;t.warn=function(a){a="Rangy warning: "+a;t.config.alertOnWarn?window.alert(a):typeof window.console!=p&&typeof window.console.log!=p&&window.console.log(a)};({}).hasOwnProperty?t.util.extend=function(a,d){for(var b in d)d.hasOwnProperty(b)&&(a[b]=d[b])}:e("hasOwnProperty not supported");var l=[],B=[];t.init=k;t.addInitListener=function(a){t.initialized?a(t):l.push(a)};var C=[];t.addCreateMissingNativeApiListener=function(a){C.push(a)};t.createMissingNativeApi=function(a){a=a||window;k();
for(var d=0,b=C.length;d<b;++d)C[d](a)};j.prototype.fail=function(a){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);};j.prototype.warn=function(a){t.warn("Module "+this.name+": "+a)};j.prototype.createError=function(a){return Error("Error in Rangy "+this.name+" module: "+a)};t.createModule=function(a,d){var b=new j(a);t.modules[a]=b;B.push(function(a){d(a,b);b.initialized=!0;b.supported=!0})};t.requireModules=function(a){for(var d=0,b=a.length,c,m;d<
b;++d){m=a[d];c=t.modules[m];if(!c||!(c instanceof j))throw Error("Module '"+m+"' not found");if(!c.supported)throw Error("Module '"+m+"' not supported");}};var z=!1,u=function(){z||(z=!0,t.initialized||k())};if(typeof window==p)e("No window found");else if(typeof document==p)e("No document found");else return f(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",u,!1),f(window,"addEventListener")?window.addEventListener("load",u,!1):f(window,"attachEvent")?window.attachEvent("onload",
u):e("Window does not have required addEventListener or attachEvent method"),t}();l.createModule("DomUtil",function(f,a){function g(a){for(var d=0;a=a.previousSibling;)d++;return d}function c(a,d){var b=[],c;for(c=a;c;c=c.parentNode)b.push(c);for(c=d;c;c=c.parentNode)if(u(b,c))return c;return null}function b(a,d,b){for(b=b?a:a.parentNode;b;){a=b.parentNode;if(a===d)return b;b=a}return null}function e(a){a=a.nodeType;return 3==a||4==a||8==a}function k(a,d){var b=d.nextSibling,c=d.parentNode;b?c.insertBefore(a,
b):c.appendChild(a);return a}function j(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=o)return a.ownerDocument;if(typeof a.document!=o)return a.document;if(a.parentNode)return j(a.parentNode);throw Error("getDocument: no document found for node");}function m(a){if(a)return a.previousSibling?a.previousSibling.nextSibling:a.nextSibling?a.nextSibling.previousSibling:a.parentNode?a.parentNode.firstChild:a}function d(a){return!a?"[No node]":e(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?
' id="'+a.id+'"':"")+">["+a.childNodes.length+"]":a.nodeName}function p(a){this._next=this.root=a}function n(a,d){this.node=a;this.offset=d}function s(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var o="undefined",q=f.util;q.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||a.fail("document missing a Node creation method");q.isHostMethod(document,"getElementsByTagName")||a.fail("document missing getElementsByTagName method");
var r=document.createElement("div");q.areHostMethods(r,["insertBefore","appendChild","cloneNode"])||a.fail("Incomplete Element implementation");q.isHostProperty(r,"innerHTML")||a.fail("Element is missing innerHTML property");r=document.createTextNode("test");q.areHostMethods(r,["splitText","deleteData","insertData","appendData","cloneNode"])||a.fail("Incomplete Text Node implementation");var u=function(a,d){for(var b=a.length;b--;)if(a[b]===d)return!0;return!1};p.prototype={_current:null,hasNext:function(){return!!this._next},
next:function(){var a=this._current=this._next,d;if(this._current){d=a.firstChild;if(!d)for(d=null;a!==this.root&&!(d=a.nextSibling);)a=a.parentNode;this._next=d}return this._current},detach:function(){this._current=this._next=this.root=null}};n.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+d(this.node)+":"+this.offset+")]"}};s.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,
NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};s.prototype.toString=function(){return this.message};f.dom={arrayContains:u,isHtmlNamespace:function(a){var d;return typeof a.namespaceURI==o||null===(d=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==d},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:g,getNodeLength:function(a){var d;return e(a)?a.length:(d=a.childNodes)?d.length:0},getCommonAncestor:c,isAncestorOf:function(a,d,b){for(d=b?d:d.parentNode;d;){if(d===
a)return!0;d=d.parentNode}return!1},getClosestAncestorIn:b,isCharacterDataNode:e,insertAfter:k,splitDataNode:function(a,d){var b=a.cloneNode(!1);b.deleteData(0,d);a.deleteData(d,a.length-d);k(b,a);return b},getDocument:j,getWindow:function(a){a=j(a);if(typeof a.defaultView!=o)return a.defaultView;if(typeof a.parentWindow!=o)return a.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(a){if(typeof a.contentWindow!=o)return a.contentWindow;if(typeof a.contentDocument!=
o)return a.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(a){if(typeof a.contentDocument!=o)return a.contentDocument;if(typeof a.contentWindow!=o)return a.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(a){return q.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]},getRootContainer:function(a){for(var d;d=a.parentNode;)a=d;return a},
comparePoints:function(a,d,j,e){var a=m(a),j=m(j),k;if(a==j)return d===e?0:d<e?-1:1;if(k=b(j,a,!0))return d<=g(k)?-1:1;if(k=b(a,j,!0))return g(k)<e?-1:1;d=c(a,j);a=a===d?d:b(a,d,!0);j=j===d?d:b(j,d,!0);if(a===j)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(d=d.firstChild;d;){if(d===a)return-1;if(d===j)return 1;d=d.nextSibling}throw Error("Should not be here!");},inspectNode:d,fragmentFromNodeChildren:function(a){for(var d=j(a).createDocumentFragment(),b;b=a.firstChild;)d.appendChild(b);
return d},createIterator:function(a){return new p(a)},DomPosition:n};f.DOMException=s});l.createModule("DomRange",function(f){function a(a,d){return 3!=a.nodeType&&(G.isAncestorOf(a,d.startContainer,!0)||G.isAncestorOf(a,d.endContainer,!0))}function g(a){return G.getDocument(a.startContainer)}function c(a,d,b){if(d=a._listeners[d])for(var c=0,m=d.length;c<m;++c)d[c].call(a,{target:a,args:b})}function b(a){return new Q(a.parentNode,G.getNodeIndex(a))}function e(a){return new Q(a.parentNode,G.getNodeIndex(a)+
1)}function k(a,d,b){var c=11==a.nodeType?a.firstChild:a;G.isCharacterDataNode(d)?b==d.length?G.insertAfter(a,d):d.parentNode.insertBefore(a,0==b?d:G.splitDataNode(d,b)):b>=d.childNodes.length?d.appendChild(a):d.insertBefore(a,d.childNodes[b]);return c}function j(a){for(var d,b,c=g(a.range).createDocumentFragment();b=a.next();){d=a.isPartiallySelectedSubtree();b=b.cloneNode(!d);d&&(d=a.getSubtreeIterator(),b.appendChild(j(d)),d.detach(!0));if(10==b.nodeType)throw new H("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}
function m(a,d,b){for(var c,j,b=b||{stop:!1};c=a.next();)if(a.isPartiallySelectedSubtree())if(!1===d(c)){b.stop=!0;break}else{if(c=a.getSubtreeIterator(),m(c,d,b),c.detach(!0),b.stop)break}else for(c=G.createIterator(c);j=c.next();)if(!1===d(j)){b.stop=!0;return}}function d(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),d(b),b.detach(!0)):a.remove()}function p(a){for(var d,b=g(a.range).createDocumentFragment(),c;d=a.next();){a.isPartiallySelectedSubtree()?(d=d.cloneNode(!1),
c=a.getSubtreeIterator(),d.appendChild(p(c)),c.detach(!0)):a.remove();if(10==d.nodeType)throw new H("HIERARCHY_REQUEST_ERR");b.appendChild(d)}return b}function n(a,d,b){var c=!(!d||!d.length),j,e=!!b;c&&(j=RegExp("^("+d.join("|")+")$"));var k=[];m(new o(a,!1),function(a){(!c||j.test(a.nodeType))&&(!e||b(a))&&k.push(a)});return k}function s(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+G.inspectNode(a.startContainer)+":"+a.startOffset+", "+G.inspectNode(a.endContainer)+":"+a.endOffset+
")]"}function o(a,d){this.range=a;this.clonePartiallySelectedTextNodes=d;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var b=a.commonAncestorContainer;this.sc===this.ec&&G.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===b&&!G.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:G.getClosestAncestorIn(this.sc,b,!0),this._last=this.ec===b&&!G.isCharacterDataNode(this.ec)?
this.ec.childNodes[this.eo-1]:G.getClosestAncestorIn(this.ec,b,!0))}}function q(a){this.code=this[a];this.codeName=a;this.message="RangeException: "+this.codeName}function r(a,d,b){this.nodes=n(a,d,b);this._next=this.nodes[0];this._position=0}function u(a){return function(d,b){for(var c,m=b?d:d.parentNode;m;){c=m.nodeType;if(G.arrayContains(a,c))return m;m=m.parentNode}return null}}function x(a,d){if(P(a,d))throw new q("INVALID_NODE_TYPE_ERR");}function t(a){if(!a.startContainer)throw new H("INVALID_STATE_ERR");
}function l(a,d){if(!G.arrayContains(d,a.nodeType))throw new q("INVALID_NODE_TYPE_ERR");}function B(a,d){if(0>d||d>(G.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new H("INDEX_SIZE_ERR");}function C(a,d){if(L(a,!0)!==L(d,!0))throw new H("WRONG_DOCUMENT_ERR");}function z(a){if(I(a,!0))throw new H("NO_MODIFICATION_ALLOWED_ERR");}function A(a,d){if(!a)throw new H(d);}function E(a){t(a);if(!G.arrayContains($,a.startContainer.nodeType)&&!L(a.startContainer,!0)||!G.arrayContains($,a.endContainer.nodeType)&&
!L(a.endContainer,!0)||!(a.startOffset<=(G.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length))||!(a.endOffset<=(G.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function K(){}function U(a){a.START_TO_START=ta;a.START_TO_END=Ea;a.END_TO_END=ka;a.END_TO_START=Aa;a.NODE_BEFORE=Fa;a.NODE_AFTER=ea;a.NODE_BEFORE_AND_AFTER=
ma;a.NODE_INSIDE=Ha}function y(a){U(a);U(a.prototype)}function S(a,d){return function(){E(this);var b=this.startContainer,c=this.startOffset,j=this.commonAncestorContainer,k=new o(this,!0);b!==j&&(b=G.getClosestAncestorIn(b,j,!0),c=e(b),b=c.node,c=c.offset);m(k,z);k.reset();j=a(k);k.detach();d(this,b,c,b,c);return j}}function D(c,m,j){function k(a,d){return function(c){t(this);l(c,O);l(ha(c),$);c=(a?b:e)(c);(d?g:n)(this,c.node,c.offset)}}function g(a,d,b){var c=a.endContainer,j=a.endOffset;if(d!==
a.startContainer||b!==this.startOffset){if(ha(d)!=ha(c)||1==G.comparePoints(d,b,c,j))c=d,j=b;m(a,d,b,c,j)}}function n(a,d,b){var c=a.startContainer,j=a.startOffset;if(d!==a.endContainer||b!==this.endOffset){if(ha(d)!=ha(c)||-1==G.comparePoints(d,b,c,j))c=d,j=b;m(a,c,j,d,b)}}function r(a,d,b){(d!==a.startContainer||b!==this.startOffset||d!==a.endContainer||b!==this.endOffset)&&m(a,d,b,d,b)}c.prototype=new K;f.util.extend(c.prototype,{setStart:function(a,d){t(this);x(a,!0);B(a,d);g(this,a,d)},setEnd:function(a,
d){t(this);x(a,!0);B(a,d);n(this,a,d)},setStartBefore:k(!0,!0),setStartAfter:k(!1,!0),setEndBefore:k(!0,!1),setEndAfter:k(!1,!1),collapse:function(a){E(this);a?m(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):m(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){t(this);x(a,!0);m(this,a,0,a,G.getNodeLength(a))},selectNode:function(a){t(this);x(a,!1);l(a,O);var d=b(a),a=e(a);m(this,d.node,d.offset,a.node,a.offset)},
extractContents:S(p,m),deleteContents:S(d,m),canSurroundContents:function(){E(this);z(this.startContainer);z(this.endContainer);var d=new o(this,!0),b=d._first&&a(d._first,this)||d._last&&a(d._last,this);d.detach();return!b},detach:function(){j(this)},splitBoundaries:function(){E(this);var a=this.startContainer,d=this.startOffset,b=this.endContainer,c=this.endOffset,j=a===b;G.isCharacterDataNode(b)&&(0<c&&c<b.length)&&G.splitDataNode(b,c);G.isCharacterDataNode(a)&&(0<d&&d<a.length)&&(a=G.splitDataNode(a,
d),j?(c-=d,b=a):b==a.parentNode&&c>=G.getNodeIndex(a)&&c++,d=0);m(this,a,d,b,c)},normalizeBoundaries:function(){E(this);var a=this.startContainer,d=this.startOffset,b=this.endContainer,c=this.endOffset,j=function(a){var d=a.nextSibling;d&&d.nodeType==a.nodeType&&(b=a,c=a.length,a.appendData(d.data),d.parentNode.removeChild(d))},e=function(m){var j=m.previousSibling;if(j&&j.nodeType==m.nodeType){a=m;var e=m.length;d=j.length;m.insertData(0,j.data);j.parentNode.removeChild(j);a==b?(c+=d,b=a):b==m.parentNode&&
(j=G.getNodeIndex(m),c==j?(b=m,c=e):c>j&&c--)}},k=!0;G.isCharacterDataNode(b)?b.length==c&&j(b):(0<c&&(k=b.childNodes[c-1])&&G.isCharacterDataNode(k)&&j(k),k=!this.collapsed);k?G.isCharacterDataNode(a)?0==d&&e(a):d<a.childNodes.length&&(j=a.childNodes[d])&&G.isCharacterDataNode(j)&&e(j):(a=b,d=c);m(this,a,d,b,c)},collapseToPoint:function(a,d){t(this);x(a,!0);B(a,d);r(this,a,d)}});y(c)}function Y(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=
a.collapsed?a.startContainer:G.getCommonAncestor(a.startContainer,a.endContainer)}function X(a,d,b,m,j){var e=a.startContainer!==d||a.startOffset!==b,k=a.endContainer!==m||a.endOffset!==j;a.startContainer=d;a.startOffset=b;a.endContainer=m;a.endOffset=j;Y(a);c(a,"boundarychange",{startMoved:e,endMoved:k})}function V(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};Y(this)}f.requireModules(["DomUtil"]);var G=f.dom,Q=G.DomPosition,
H=f.DOMException;o.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,G.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));
return a},remove:function(){var a=this._current,d,b;G.isCharacterDataNode(a)&&(a===this.sc||a===this.ec)?(d=a===this.sc?this.so:0,b=a===this.ec?this.eo:a.length,d!=b&&a.deleteData(d,b-d)):a.parentNode&&a.parentNode.removeChild(a)},isPartiallySelectedSubtree:function(){return a(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new V(g(this.range));var d=this._current,b=d,c=0,m=d,j=G.getNodeLength(d);G.isAncestorOf(d,
this.sc,!0)&&(b=this.sc,c=this.so);G.isAncestorOf(d,this.ec,!0)&&(m=this.ec,j=this.eo);X(a,b,c,m,j)}return new o(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};q.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};q.prototype.toString=function(){return this.message};r.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=
this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var O=[1,3,4,5,7,8,10],$=[2,9,11],W=[1,3,4,5,7,8,10,11],fa=[1,3,4,5,7,8],ha=G.getRootContainer,L=u([9,11]),I=u([5,6,10,12]),P=u([6,10,12]),F=document.createElement("style"),Ka=!1;try{F.innerHTML="<b>x</b>",Ka=3==F.firstChild.nodeType}catch(Ba){}f.features.htmlParsingConforms=Ka;var ca="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),
ta=0,Ea=1,ka=2,Aa=3,Fa=0,ea=1,ma=2,Ha=3;K.prototype={attachListener:function(a,d){this._listeners[a].push(d)},compareBoundaryPoints:function(a,d){E(this);C(this.startContainer,d.startContainer);var b=a==Aa||a==ta?"start":"end",c=a==Ea||a==ta?"start":"end";return G.comparePoints(this[b+"Container"],this[b+"Offset"],d[c+"Container"],d[c+"Offset"])},insertNode:function(a){E(this);l(a,W);z(this.startContainer);if(G.isAncestorOf(a,this.startContainer,!0))throw new H("HIERARCHY_REQUEST_ERR");this.setStartBefore(k(a,
this.startContainer,this.startOffset))},cloneContents:function(){E(this);var a,d;if(this.collapsed)return g(this).createDocumentFragment();if(this.startContainer===this.endContainer&&G.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),d=g(this).createDocumentFragment(),d.appendChild(a),d;d=new o(this,!0);a=j(d);d.detach();return a},canSurroundContents:function(){E(this);z(this.startContainer);z(this.endContainer);
var d=new o(this,!0),b=d._first&&a(d._first,this)||d._last&&a(d._last,this);d.detach();return!b},surroundContents:function(a){l(a,fa);if(!this.canSurroundContents())throw new q("BAD_BOUNDARYPOINTS_ERR");var d=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);k(a,this.startContainer,this.startOffset);a.appendChild(d);this.selectNode(a)},cloneRange:function(){E(this);for(var a=new V(g(this)),d=ca.length,b;d--;)b=ca[d],a[b]=this[b];return a},toString:function(){E(this);
var a=this.startContainer;if(a===this.endContainer&&G.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var d=[],a=new o(this,!0);m(a,function(a){(3==a.nodeType||4==a.nodeType)&&d.push(a.data)});a.detach();return d.join("")},compareNode:function(a){E(this);var d=a.parentNode,b=G.getNodeIndex(a);if(!d)throw new H("NOT_FOUND_ERR");a=this.comparePoint(d,b);d=this.comparePoint(d,b+1);return 0>a?0<d?ma:Fa:0<d?ea:Ha},comparePoint:function(a,d){E(this);
A(a,"HIERARCHY_REQUEST_ERR");C(a,this.startContainer);return 0>G.comparePoints(a,d,this.startContainer,this.startOffset)?-1:0<G.comparePoints(a,d,this.endContainer,this.endOffset)?1:0},createContextualFragment:Ka?function(a){var d=this.startContainer,b=G.getDocument(d);if(!d)throw new H("INVALID_STATE_ERR");var c=null;1==d.nodeType?c=d:G.isCharacterDataNode(d)&&(c=G.parentElement(d));c=null===c||"HTML"==c.nodeName&&G.isHtmlNamespace(G.getDocument(c).documentElement)&&G.isHtmlNamespace(c)?b.createElement("body"):
c.cloneNode(!1);c.innerHTML=a;return G.fragmentFromNodeChildren(c)}:function(a){t(this);var d=g(this).createElement("body");d.innerHTML=a;return G.fragmentFromNodeChildren(d)},toHtml:function(){E(this);var a=g(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,d){E(this);A(a,"NOT_FOUND_ERR");if(G.getDocument(a)!==g(this))return!1;var b=a.parentNode,c=G.getNodeIndex(a);A(b,"NOT_FOUND_ERR");var m=G.comparePoints(b,c,this.endContainer,this.endOffset),
b=G.comparePoints(b,c+1,this.startContainer,this.startOffset);return d?0>=m&&0<=b:0>m&&0<b},isPointInRange:function(a,d){E(this);A(a,"HIERARCHY_REQUEST_ERR");C(a,this.startContainer);return 0<=G.comparePoints(a,d,this.startContainer,this.startOffset)&&0>=G.comparePoints(a,d,this.endContainer,this.endOffset)},intersectsRange:function(a,d){E(this);if(g(a)!=g(this))throw new H("WRONG_DOCUMENT_ERR");var b=G.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),c=G.comparePoints(this.endContainer,
this.endOffset,a.startContainer,a.startOffset);return d?0>=b&&0<=c:0>b&&0<c},intersection:function(a){if(this.intersectsRange(a)){var d=G.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),b=G.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),c=this.cloneRange();-1==d&&c.setStart(a.startContainer,a.startOffset);1==b&&c.setEnd(a.endContainer,a.endOffset);return c}return null},union:function(a){if(this.intersectsRange(a,!0)){var d=this.cloneRange();
-1==G.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&d.setStart(a.startContainer,a.startOffset);1==G.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&d.setEnd(a.endContainer,a.endOffset);return d}throw new q("Ranges do not intersect");},containsNode:function(a,d){return d?this.intersectsNode(a,!1):this.compareNode(a)==Ha},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,G.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},
containsNodeText:function(a){var d=this.cloneRange();d.selectNode(a);var b=d.getNodes([3]);return 0<b.length?(d.setStart(b[0],0),a=b.pop(),d.setEnd(a,a.length),a=this.containsRange(d),d.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,d){E(this);return new r(this,a,d)},getNodes:function(a,d){E(this);return n(this,a,d)},getDocument:function(){return g(this)},collapseBefore:function(a){t(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){t(this);this.setStartAfter(a);
this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return V.rangesEqual(this,a)},inspect:function(){return s(this)}};D(V,X,function(a){t(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=null;a.collapsed=a.commonAncestorContainer=null;c(a,"detach",null);a._listeners=null});f.rangePrototype=K.prototype;V.rangeProperties=ca;V.RangeIterator=o;V.copyComparisonConstants=y;V.createPrototypeRange=D;V.inspect=s;V.getRangeDocument=g;V.rangesEqual=function(a,d){return a.startContainer===
d.startContainer&&a.startOffset===d.startOffset&&a.endContainer===d.endContainer&&a.endOffset===d.endOffset};f.DomRange=V;f.RangeException=q});l.createModule("WrappedRange",function(f){function a(a,d,c,j){var k=a.duplicate();k.collapse(c);var g=k.parentElement();b.isAncestorOf(d,g,!0)||(g=d);if(!g.canHaveHTML)return new e(g.parentNode,b.getNodeIndex(g));d=b.getDocument(g).createElement("span");d.parentNode&&d.parentNode.removeChild(d);var f,r=c?"StartToStart":"StartToEnd";do g.insertBefore(d,d.previousSibling),
k.moveToElementText(d);while(0<(f=k.compareEndPoints(r,a))&&d.previousSibling);r=d.nextSibling;if(-1==f&&r&&b.isCharacterDataNode(r)){k.setEndPoint(c?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(r.data)){k=k.duplicate();g=k.text.replace(/\r\n/g,"\r").length;for(g=k.moveStart("character",g);-1==k.compareEndPoints("StartToEnd",k);)g++,k.moveStart("character",1)}else if(g=k.text.replace(/\u00a0/g," "),c=r.data.replace(/\u00a0/g," "),0!==c.indexOf(g)){for(;0<g.length&&0!==c.indexOf(g);)g=g.substr(1);g=
g.length}else g=k.text.length;r=new e(r,g)}else r=(j||!c)&&d.previousSibling,r=(k=(j||c)&&d.nextSibling)&&b.isCharacterDataNode(k)?new e(k,0):r&&b.isCharacterDataNode(r)?new e(r,r.length):new e(g,b.getNodeIndex(d));d.parentNode.removeChild(d);return r}function g(a,d){var c,j,e=a.offset,k=b.getDocument(a.node),g=k.body.createTextRange(),f=b.isCharacterDataNode(a.node);f?(c=a.node,j=c.parentNode):(c=a.node.childNodes,c=e<c.length?c[e]:null,j=a.node);k=k.createElement("span");k.innerHTML="&#feff;";c?
j.insertBefore(k,c):j.appendChild(k);try{g.moveToElementText(k),g.collapse(!d)}catch(u){}j.removeChild(k);if(f)g[d?"moveStart":"moveEnd"]("character",e);return g}f.requireModules(["DomUtil","DomRange"]);var c,b=f.dom,e=b.DomPosition,k=f.DomRange;if(f.features.implementsDomRange&&(!f.features.implementsTextRange||!f.config.preferTextRange))(function(){function a(d){for(var b=j.length,c;b--;)c=j[b],d[c]=d.nativeRange[c]}var d,j=k.rangeProperties,e;c=function(d){if(!d)throw Error("Range must be specified");
this.nativeRange=d;a(this)};k.createPrototypeRange(c,function(a,d,b,c,j){var m=a.endContainer!==c||a.endOffset!=j;if(a.startContainer!==d||a.startOffset!=b||m)a.setEnd(c,j),a.setStart(d,b)},function(a){a.nativeRange.detach();a.detached=!0;for(var d=j.length,b;d--;)b=j[d],a[b]=null});d=c.prototype;d.selectNode=function(d){this.nativeRange.selectNode(d);a(this)};d.deleteContents=function(){this.nativeRange.deleteContents();a(this)};d.extractContents=function(){var d=this.nativeRange.extractContents();
a(this);return d};d.cloneContents=function(){return this.nativeRange.cloneContents()};d.surroundContents=function(d){this.nativeRange.surroundContents(d);a(this)};d.collapse=function(d){this.nativeRange.collapse(d);a(this)};d.cloneRange=function(){return new c(this.nativeRange.cloneRange())};d.refresh=function(){a(this)};d.toString=function(){return this.nativeRange.toString()};var g=document.createTextNode("test");b.getBody(document).appendChild(g);var o=document.createRange();o.setStart(g,0);o.setEnd(g,
0);try{o.setStart(g,1),d.setStart=function(d,b){this.nativeRange.setStart(d,b);a(this)},d.setEnd=function(d,b){this.nativeRange.setEnd(d,b);a(this)},e=function(d){return function(b){this.nativeRange[d](b);a(this)}}}catch(q){d.setStart=function(d,b){try{this.nativeRange.setStart(d,b)}catch(c){this.nativeRange.setEnd(d,b),this.nativeRange.setStart(d,b)}a(this)},d.setEnd=function(d,b){try{this.nativeRange.setEnd(d,b)}catch(c){this.nativeRange.setStart(d,b),this.nativeRange.setEnd(d,b)}a(this)},e=function(d,
b){return function(c){try{this.nativeRange[d](c)}catch(j){this.nativeRange[b](c),this.nativeRange[d](c)}a(this)}}}d.setStartBefore=e("setStartBefore","setEndBefore");d.setStartAfter=e("setStartAfter","setEndAfter");d.setEndBefore=e("setEndBefore","setStartBefore");d.setEndAfter=e("setEndAfter","setStartAfter");o.selectNodeContents(g);d.selectNodeContents=o.startContainer==g&&o.endContainer==g&&0==o.startOffset&&o.endOffset==g.length?function(d){this.nativeRange.selectNodeContents(d);a(this)}:function(a){this.setStart(a,
0);this.setEnd(a,k.getEndOffset(a))};o.selectNodeContents(g);o.setEnd(g,3);e=document.createRange();e.selectNodeContents(g);e.setEnd(g,4);e.setStart(g,2);d.compareBoundaryPoints=-1==o.compareBoundaryPoints(o.START_TO_END,e)&1==o.compareBoundaryPoints(o.END_TO_START,e)?function(a,d){d=d.nativeRange||d;a==d.START_TO_END?a=d.END_TO_START:a==d.END_TO_START&&(a=d.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,d)}:function(a,d){return this.nativeRange.compareBoundaryPoints(a,d.nativeRange||
d)};f.util.isHostMethod(o,"createContextualFragment")&&(d.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});b.getBody(document).removeChild(g);o.detach();e.detach()})(),f.createNativeRange=function(a){a=a||document;return a.createRange()};else if(f.features.implementsTextRange){c=function(a){this.textRange=a;this.refresh()};c.prototype=new k(document);c.prototype.refresh=function(){var c,d,j=this.textRange;c=j.parentElement();var e=j.duplicate();e.collapse(!0);
d=e.parentElement();e=j.duplicate();e.collapse(!1);j=e.parentElement();d=d==j?d:b.getCommonAncestor(d,j);d=d==c?d:b.getCommonAncestor(c,d);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?d=c=a(this.textRange,d,!0,!0):(c=a(this.textRange,d,!0,!1),d=a(this.textRange,d,!1,!1));this.setStart(c.node,c.offset);this.setEnd(d.node,d.offset)};k.copyComparisonConstants(c);var j=function(){return this}();"undefined"==typeof j.Range&&(j.Range=c);f.createNativeRange=function(a){a=a||document;return a.body.createTextRange()}}f.features.implementsTextRange&&
(c.rangeToTextRange=function(a){if(a.collapsed)return g(new e(a.startContainer,a.startOffset),!0);var d=g(new e(a.startContainer,a.startOffset),!0),c=g(new e(a.endContainer,a.endOffset),!1),a=b.getDocument(a.startContainer).body.createTextRange();a.setEndPoint("StartToStart",d);a.setEndPoint("EndToEnd",c);return a});c.prototype.getName=function(){return"WrappedRange"};f.WrappedRange=c;f.createRange=function(a){a=a||document;return new c(f.createNativeRange(a))};f.createRangyRange=function(a){a=a||
document;return new k(a)};f.createIframeRange=function(a){return f.createRange(b.getIframeDocument(a))};f.createIframeRangyRange=function(a){return f.createRangyRange(b.getIframeDocument(a))};f.addCreateMissingNativeApiListener(function(a){a=a.document;if(typeof a.createRange=="undefined")a.createRange=function(){return f.createRange(this)};a=a=null})});l.createModule("WrappedSelection",function(f,a){function g(a){return(a||window).getSelection()}function c(a){return(a||window).document.selection}
function b(a,d,b){var c=b?"end":"start",b=b?"start":"end";a.anchorNode=d[c+"Container"];a.anchorOffset=d[c+"Offset"];a.focusNode=d[b+"Container"];a.focusOffset=d[b+"Offset"]}function e(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function k(a){var d;a instanceof x?(d=a._selectionNativeRange,d||(d=f.createNativeRange(r.getDocument(a.startContainer)),d.setEnd(a.endContainer,a.endOffset),d.setStart(a.startContainer,a.startOffset),
a._selectionNativeRange=d,a.attachListener("detach",function(){this._selectionNativeRange=null}))):a instanceof t?d=a.nativeRange:f.features.implementsDomRange&&a instanceof r.getWindow(a.startContainer).Range&&(d=a);return d}function j(a){var d=a.getNodes(),b;a:if(!d.length||1!=d[0].nodeType)b=!1;else{b=1;for(var c=d.length;b<c;++b)if(!r.isAncestorOf(d[0],d[b])){b=!1;break a}b=!0}if(!b)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return d[0]}
function m(a,d){var c=new t(d);a._ranges=[c];b(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function d(a){a._ranges.length=0;if("None"==a.docSelection.type)e(a);else{var d=a.docSelection.createRange();if(d&&"undefined"!=typeof d.text)m(a,d);else{a.rangeCount=d.length;for(var c,j=r.getDocument(d.item(0)),k=0;k<a.rangeCount;++k)c=f.createRange(j),c.selectNode(d.item(k)),a._ranges.push(c);a.isCollapsed=1==a.rangeCount&&a._ranges[0].collapsed;b(a,a._ranges[a.rangeCount-1],!1)}}}function p(a,b){for(var c=
a.docSelection.createRange(),m=j(b),e=r.getDocument(c.item(0)),e=r.getBody(e).createControlRange(),k=0,g=c.length;k<g;++k)e.add(c.item(k));try{e.add(m)}catch(f){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}e.select();d(a)}function n(a,d,b){this.nativeSelection=a;this.docSelection=d;this._ranges=[];this.win=b;this.refresh()}function s(a,b){for(var c=r.getDocument(b[0].startContainer),c=r.getBody(c).createControlRange(),
e=0,m;e<rangeCount;++e){m=j(b[e]);try{c.add(m)}catch(k){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");}}c.select();d(a)}function o(a,d){if(a.anchorNode&&r.getDocument(a.anchorNode)!==r.getDocument(d))throw new l("WRONG_DOCUMENT_ERR");}function q(a){var d=[],b=new B(a.anchorNode,a.anchorOffset),c=new B(a.focusNode,a.focusOffset),j="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var e=
0,m=a.rangeCount;e<m;++e)d[e]=x.inspect(a.getRangeAt(e));return"["+j+"(Ranges: "+d.join(", ")+")(anchor: "+b.inspect()+", focus: "+c.inspect()+"]"}f.requireModules(["DomUtil","DomRange","WrappedRange"]);f.config.checkSelectionRanges=!0;var r=f.dom,u=f.util,x=f.DomRange,t=f.WrappedRange,l=f.DOMException,B=r.DomPosition,C,z,A=f.util.isHostMethod(window,"getSelection"),E=f.util.isHostObject(document,"selection"),K=E&&(!A||f.config.preferTextRange);K?(C=c,f.isSelectionValid=function(a){var a=(a||window).document,
d=a.selection;return"None"!=d.type||r.getDocument(d.createRange().parentElement())==a}):A?(C=g,f.isSelectionValid=function(){return!0}):a.fail("Neither document.selection or window.getSelection() detected.");f.getNativeSelection=C;var A=C(),U=f.createNativeRange(document),y=r.getBody(document),S=u.areHostObjects(A,u.areHostProperties(A,["anchorOffset","focusOffset"]));f.features.selectionHasAnchorAndFocus=S;var D=u.isHostMethod(A,"extend");f.features.selectionHasExtend=D;var Y="number"==typeof A.rangeCount;
f.features.selectionHasRangeCount=Y;var X=!1,V=!0;u.areHostMethods(A,["addRange","getRangeAt","removeAllRanges"])&&("number"==typeof A.rangeCount&&f.features.implementsDomRange)&&function(){var a=document.createElement("iframe");y.appendChild(a);var d=r.getIframeDocument(a);d.open();d.write("<html><head></head><body>12</body></html>");d.close();var b=r.getIframeWindow(a).getSelection(),c=d.documentElement.lastChild.firstChild,d=d.createRange();d.setStart(c,1);d.collapse(true);b.addRange(d);V=b.rangeCount==
1;b.removeAllRanges();var j=d.cloneRange();d.setStart(c,0);j.setEnd(c,2);b.addRange(d);b.addRange(j);X=b.rangeCount==2;d.detach();j.detach();y.removeChild(a)}();f.features.selectionSupportsMultipleRanges=X;f.features.collapsedNonEditableSelectionsSupported=V;var G=!1,Q;y&&u.isHostMethod(y,"createControlRange")&&(Q=y.createControlRange(),u.areHostProperties(Q,["item","add"])&&(G=!0));f.features.implementsControlRange=G;z=S?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:
function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:false};var H;u.isHostMethod(A,"getRangeAt")?H=function(a,d){try{return a.getRangeAt(d)}catch(b){return null}}:S&&(H=function(a){var d=r.getDocument(a.anchorNode),d=f.createRange(d);d.setStart(a.anchorNode,a.anchorOffset);d.setEnd(a.focusNode,a.focusOffset);if(d.collapsed!==this.isCollapsed){d.setStart(a.focusNode,a.focusOffset);d.setEnd(a.anchorNode,a.anchorOffset)}return d});f.getSelection=function(a){var a=a||window,d=a._rangySelection,
b=C(a),j=E?c(a):null;if(d){d.nativeSelection=b;d.docSelection=j;d.refresh(a)}else{d=new n(b,j,a);a._rangySelection=d}return d};f.getIframeSelection=function(a){return f.getSelection(r.getIframeWindow(a))};Q=n.prototype;if(!K&&S&&u.areHostMethods(A,["removeAllRanges","addRange"])){Q.removeAllRanges=function(){this.nativeSelection.removeAllRanges();e(this)};var O=function(a,d){var b=x.getRangeDocument(d),b=f.createRange(b);b.collapseToPoint(d.endContainer,d.endOffset);a.nativeSelection.addRange(k(b));
a.nativeSelection.extend(d.startContainer,d.startOffset);a.refresh()};Q.addRange=Y?function(a,d){if(G&&E&&this.docSelection.type=="Control")p(this,a);else if(d&&D)O(this,a);else{var c;if(X)c=this.rangeCount;else{this.removeAllRanges();c=0}this.nativeSelection.addRange(k(a));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==c+1){if(f.config.checkSelectionRanges)(c=H(this.nativeSelection,this.rangeCount-1))&&!x.rangesEqual(c,a)&&(a=new t(c));this._ranges[this.rangeCount-1]=a;b(this,
a,fa(this.nativeSelection));this.isCollapsed=z(this)}else this.refresh()}}:function(a,d){if(d&&D)O(this,a);else{this.nativeSelection.addRange(k(a));this.refresh()}};Q.setRanges=function(a){if(G&&a.length>1)s(this,a);else{this.removeAllRanges();for(var d=0,b=a.length;d<b;++d)this.addRange(a[d])}}}else if(u.isHostMethod(A,"empty")&&u.isHostMethod(U,"select")&&G&&K)Q.removeAllRanges=function(){try{var a=jQuery.browser.msie&&jQuery.browser.version<8&&typeof document.documentMode==="undefined";a||this.docSelection.empty();
this.docSelection.type!="None"&&a&&this.docSelection.empty()}catch(d){}e(this)},Q.addRange=function(a){if(this.docSelection.type=="Control")p(this,a);else try{t.rangeToTextRange(a).select();this._ranges[0]=a;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;b(this,a,false)}catch(d){}},Q.setRanges=function(a){this.removeAllRanges();var d=a.length;d>1?s(this,a):d&&this.addRange(a[0])};else return a.fail("No means of selecting a Range or TextRange was found"),!1;Q.getRangeAt=function(a){if(a<
0||a>=this.rangeCount)throw new l("INDEX_SIZE_ERR");return this._ranges[a]};var $;if(K)$=function(a){var b;if(f.isSelectionValid(a.win))b=a.docSelection.createRange();else{b=r.getBody(a.win.document).createTextRange();b.collapse(true)}a.docSelection.type=="Control"?d(a):b&&typeof b.text!="undefined"?m(a,b):e(a)};else if(u.isHostMethod(A,"getRangeAt")&&"number"==typeof A.rangeCount)$=function(a){if(G&&E&&a.docSelection.type=="Control")d(a);else{a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount;
if(a.rangeCount){for(var c=0,j=a.rangeCount;c<j;++c)a._ranges[c]=new f.WrappedRange(a.nativeSelection.getRangeAt(c));b(a,a._ranges[a.rangeCount-1],fa(a.nativeSelection));a.isCollapsed=z(a)}else e(a)}};else if(S&&"boolean"==typeof A.isCollapsed&&"boolean"==typeof U.collapsed&&f.features.implementsDomRange)$=function(a){var d;d=a.nativeSelection;if(d.anchorNode){d=H(d,0);a._ranges=[d];a.rangeCount=1;d=a.nativeSelection;a.anchorNode=d.anchorNode;a.anchorOffset=d.anchorOffset;a.focusNode=d.focusNode;
a.focusOffset=d.focusOffset;a.isCollapsed=z(a)}else e(a)};else return a.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;Q.refresh=function(a){var d=a?this._ranges.slice(0):null;$(this);if(a){a=d.length;if(a!=this._ranges.length)return false;for(;a--;)if(!x.rangesEqual(d[a],this._ranges[a]))return false;return true}};var W=function(a,d){var b=a.getAllRanges(),c=false;a.removeAllRanges();for(var j=0,m=b.length;j<m;++j)c||d!==b[j]?a.addRange(b[j]):c=true;a.rangeCount||
e(a)};Q.removeRange=G?function(a){if(this.docSelection.type=="Control"){for(var b=this.docSelection.createRange(),a=j(a),c=r.getDocument(b.item(0)),c=r.getBody(c).createControlRange(),e,m=false,k=0,g=b.length;k<g;++k){e=b.item(k);e!==a||m?c.add(b.item(k)):m=true}c.select();d(this)}else W(this,a)}:function(a){W(this,a)};var fa;!K&&S&&f.features.implementsDomRange?(fa=function(a){var d=false;a.anchorNode&&(d=r.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)==1);return d},Q.isBackwards=
function(){return fa(this)}):fa=Q.isBackwards=function(){return false};Q.toString=function(){for(var a=[],d=0,b=this.rangeCount;d<b;++d)a[d]=""+this._ranges[d];return a.join("")};Q.collapse=function(a,d){o(this,a);var b=f.createRange(r.getDocument(a));b.collapseToPoint(a,d);this.removeAllRanges();this.addRange(b);this.isCollapsed=true};Q.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new l("INVALID_STATE_ERR");};Q.collapseToEnd=
function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new l("INVALID_STATE_ERR");};Q.selectAllChildren=function(a){o(this,a);var d=f.createRange(r.getDocument(a));d.selectNodeContents(a);this.removeAllRanges();this.addRange(d)};Q.deleteFromDocument=function(){if(G&&E&&this.docSelection.type=="Control"){for(var a=this.docSelection.createRange(),d;a.length;){d=a.item(0);a.remove(d);d.parentNode.removeChild(d)}this.refresh()}else if(this.rangeCount){a=
this.getAllRanges();this.removeAllRanges();d=0;for(var b=a.length;d<b;++d)a[d].deleteContents();this.addRange(a[b-1])}};Q.getAllRanges=function(){return this._ranges.slice(0)};Q.setSingleRange=function(a){this.setRanges([a])};Q.containsNode=function(a,d){for(var b=0,c=this._ranges.length;b<c;++b)if(this._ranges[b].containsNode(a,d))return true;return false};Q.toHtml=function(){var a="";if(this.rangeCount){for(var a=x.getRangeDocument(this._ranges[0]).createElement("div"),d=0,b=this._ranges.length;d<
b;++d)a.appendChild(this._ranges[d].cloneContents());a=a.innerHTML}return a};Q.getName=function(){return"WrappedSelection"};Q.inspect=function(){return q(this)};Q.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};n.inspect=q;f.Selection=n;f.selectionPrototype=Q;f.addCreateMissingNativeApiListener(function(a){if(typeof a.getSelection=="undefined")a.getSelection=function(){return f.getSelection(this)};a=null})});window.rangy=l})();define("vendor/rangy-core",function(){});
define("aloha/rangy-core",["jquery","vendor/rangy-core"],function(){return window.rangy});define("util/class",[],function(){var l=!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function a(){!l&&this._constructor&&this._constructor.apply(this,arguments)}var g=this.prototype;l=!0;var c=new this;l=!1;for(var b=0;b<arguments.length;b++){var e=arguments[b],k;for(k in e)c[k]="function"==typeof e[k]&&"function"==typeof g[k]&&f.test(e[k])?function(a,b){return function(){var d=
this._super;this._super=g[a];var c=b.apply(this,arguments);this._super=d;return c}}(k,e[k]):e[k]}a.prototype=c;a.constructor=a;a.extend=arguments.callee;return a};return this.Class});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/lang",[],function(){});(function(l){var f=l.GENTICS;f.Utils.applyProperties=function(a,g){for(var c in g)g.hasOwnProperty(c)&&(a[c]=g[c])};f.Utils.uniqeString4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};
f.Utils.guid=function(){var a=f.Utils.uniqeString4;return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}})(window);define("aloha/ecma5shims",[],function(){function l(a){var b=null;if(a){do b=a;while(null!=(a=a.parentNode))}return b}function f(a,b){return(a.contains(b)&&16)+(b.contains(a)&&8)+(0<=a.sourceIndex&&0<=b.sourceIndex?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1)}function a(a){return null!=a.sourceIndex?a:a.parentNode.insertBefore(document.createComment(""),a)}var g,
c={bind:function(a){var b=this.obj||this,c=Function.prototype.bind,m=Array.prototype.slice.call(arguments,1);return c?c.apply(b,arguments):function(){return b.apply(a,0===arguments.length?m:m.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var a=this.obj||this,b=String.prototype.trim;return b?b.call(a):a.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(a,b){var c=this.obj||this,m=Array.prototype.indexOf;if(m)return m.call(c,a,b);void 0===b&&(b=0);0>b&&(b+=c.length);0>b&&(b=
0);for(m=c.length;b<m;b++)if(void 0!==c[b]&&c[b]===a)return b;return-1},forEach:function(a,b){var c=this.obj||this,m=Array.prototype.forEach;if(m)return m.call(c,a,b);var d,m=0;for(d=c.length;m<d;m++)void 0!==c[m]&&a.call(b,c[m],m,c)},map:function(a,b,c){var m=this.obj||this,d=Array.prototype.map,f="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,n=[];if(d)n=d.call(m,a,b);else{var d=[],s,n=0;for(s=m.length;n<s;n++)void 0!==m[n]&&(d[n]=a.call(b,m[n],n,m));n=d}return f?
g(n):n},filter:function(a,b,c){var m=this.obj||this,d=Array.prototype.filter,f="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,n=[];if(d)n=d.call(m,a,b);else{var d=[],s,o,n=0;for(o=m.length;n<o;n++)void 0!==m[n]&&a.call(b,s=m[n],n,m)&&d.push(s);n=d}return f?g(n):n},every:function(a,b){var c=this.obj||this,m=Array.prototype.every;if(m)return m.call(c,a,b);var d,m=0;for(d=c.length;m<d;m++)if(void 0!==c[m]&&!a.call(b,c[m],m,c))return!1;return!0},some:function(a,
b){var c=this.obj||this,m=Array.prototype.some;if(m)return m.call(c,a,b);var d,m=0;for(d=c.length;m<d;m++)if(void 0!==c[m]&&a.call(b,c[m],m,c))return!0;return!1},hasAttribute:function(a){var b=this.obj||this;return b.hasAttribute?b.hasAttribute(a):!!b.getAttribute(a)}};g=function(a){var b=function(){};b.prototype=c;b=new b;b.obj=a;return b};for(var b in c)c.hasOwnProperty(b)&&(g[b]=c[b]);g.Node="undefined"!=typeof window.Node?window.Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,
ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32};g.compareDocumentPosition=function(b,c){if(document.documentElement.compareDocumentPosition)return b.compareDocumentPosition(c);if(!document.documentElement.contains)throw"neither compareDocumentPosition nor contains is supported by this browser.";
if(b==c)return 0;if(l(b)!=l(c))return 1;if(null!=b.sourceIndex&&null!=c.sourceIndex)return f(b,c);if(b==document)return 20;if(c==document)return 10;var j=a(b),m=a(c),d=f(j,m);b!=j&&j.parentNode.removeChild(j);c!=m&&m.parentNode.removeChild(m);return d};g.getComputedStyle=function(a,b){return window.getComputedStyle?window.getComputedStyle(a,b):a.currentStyle?a.currentStyle:null};return g});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/dom",["jquery",
"util/class","aloha/ecma5shims"],function(l,f,a){var g;function c(a){if(1===a.nodeType){for(var d=0,a=a.firstChild;a;)d+=1,a=a.nextSibling;return d}return 3===a.nodeType?a.length:0}function b(a){return"aloha-editing-p"===a.className&&1===c(a)&&"BR"===a.children[0].nodeName&&"aloha-end-br"===a.children[0].className}function e(a,b){if(!a)return null;if(b(a))return a;var c=a.firstChild||a.nextSibling||a.parentNode&&!d.Utils.Dom.isEditingHost(a.parentNode)&&a.parentNode.nextSibling;return c?e(c,b):null}
function k(a){if(!a)return!0;if("BR"===a.nodeName)return!1;if(a.nodeType===g)return-1===a.data.search(/\S/)||1===a.data.length&&8192<=a.data.charCodeAt(0)?!0:!1;var d=c(a);if(0===d)return!0;var a=a.childNodes,b;for(b=0;b<d;b++)if(!k(a[b]))return!1;return!0}function j(a){return!k(a)}function m(a,d){a.nodeType!==g&&(k(a)||b(a))?l(a).replaceWith(d):l(a).after(d)}var d=window.GENTICS;g=3;var p={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0},f=f.extend({wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,
mergeableTags:"b code del em i ins strong sub sup #text".split(" "),nonWordBoundaryTags:"a b code del em i ins span strong sub sup #text".split(" "),nonEmptyTags:["br"],tags:{flow:"a abbr address area article aside audio b bdi bdo blockquote br button canvas cite code command datalist del details dfn div dl em embed fieldset figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr i iframe img input ins kbd keygen label map mark math menu meter nav noscript object ol output p pre progress q ruby s samp script section select small span strong style sub sup svg table textarea time u ul var video wbr #text".split(" "),
phrasing:"a abbr area audio b bdi bdo br button canvas cite code command datalist del dfn em embed i iframe img input ins kbd keygen label map mark math meter noscript object output progress q ruby samp script select small span strong sub sup svg textarea time u var video wbr #text".split(" ")},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",
canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:"h1 h2 h3 h4 h5 h6".split(" "),
hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",
script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:"caption colgroup thead tbody tfoot tr".split(" "),tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:"p h1 h2 h3 h4 h5 h6 blockquote div pre".split(" "),
listElements:["li","ol","ul"],split:function(a,d,b){var c=l(a.startContainer),j=a.startOffset,m,e,k,g,f,p,z,A,E;b&&(c=l(a.endContainer),j=a.endOffset);1>d.length&&(d=l(document.body));b=!a.isCollapsed()&&!b;e=c.parents().get();e.unshift(c.get(0));l.each(e,function(a,b){if(d.filter(function(){return this==b}).length){a>0&&(m=e.slice(0,a));return false}});if(!m)return!0;m=m.reverse();c=0;for(p=m.length;c<p;++c)if(z=m[c],c===p-1)3===z.nodeType?(f=document.createTextNode(z.data.substring(j,z.data.length)),
z.data=z.data.substring(0,j),this.isEmpty(f)&&0===l("br",k).length&&(f=l("<br/>").addClass("aloha-end-br"))):(A=l(z),f=A.contents(),A=A.clone(!1).empty(),f=A.append(f.slice(j,f.length)).get(0),l(f).addClass("aloha-editing-p"),1===f.childNodes.length&&"br"===f.childNodes.item(0).nodeName.toLowerCase()&&l(f.childNodes.item(0)).addClass("aloha-end-br")),b&&a.endContainer===z&&(a.endContainer=f,a.endOffset-=j,a.clearCaches()),g?g.prepend(f):l(z).after(f);else{A=l(z).clone(!1).empty();k?g.prepend(A):k=
A;for(g=A;;){E=m[c+1].nextSibling;if(!E)break;g.append(E)}if(b&&a.endContainer===z){a.endContainer=A.get(0);z=m[c+1];for(A=0;;){z=z.previousSibling;if(!z)break;A++}a.endOffset-=A;a.clearCaches()}}l(m[0]).after(k);return l([m[0],k?k.get(0):f])},allowsNesting:function(a,d){if(!a||!a.nodeName||!d||!d.nodeName)return!1;var b=a.nodeName.toLowerCase(),c=d.nodeName.toLowerCase();return!this.children[b]?!1:this.children[b]==c||l.isArray(this.children[b])&&0<=l.inArray(c,this.children[b])||l.isArray(this.tags[this.children[b]])&&
0<=l.inArray(c,this.tags[this.children[b]])?!0:!1},addMarkup:function(a,d,b){var c=a.startContainer,j=a.startOffset;1===c.nodeType&&(c.childNodes[j]&&3===c.childNodes[j].nodeType)&&a.correctRange();3===a.startContainer.nodeType&&(0<a.startOffset&&a.startOffset<a.startContainer.data.length)&&this.split(a,l(a.startContainer).parent(),!1);3===a.endContainer.nodeType&&(0<a.endOffset&&a.endOffset<a.endContainer.data.length)&&this.split(a,l(a.endContainer).parent(),!0);this.recursiveAddMarkup(a.getRangeTree(),
d,a,b);this.doCleanup({merge:!0,removeempty:!0},a)},recursiveAddMarkup:function(a,b,c,j){var m,e,c=0;for(e=a.length;c<e;++c)if("full"==a[c].type&&this.allowsNesting(b.get(0),a[c].domobj)){if((j||a[c].domobj.nodeName!=b.get(0).nodeName)&&(3!==a[c].domobj.nodeType||0!==l.trim(a[c].domobj.data).length))l(a[c].domobj).wrap(b),!j&&3!==a[c].domobj.nodeType&&(m=new d.Utils.RangeObject,m.startContainer=m.endContainer=a[c].domobj.parentNode,m.startOffset=0,m.endOffset=m.endContainer.childNodes.length,this.removeMarkup(m,
b,l(a[c].domobj.parentNode)))}else(j||a[c].domobj&&a[c].domobj.nodeName!==b.get(0).nodeName)&&(a[c].children&&0<a[c].children.length)&&this.recursiveAddMarkup(a[c].children,b)},findHighestElement:function(a,d,b){for(var d=d.toLowerCase(),c,j=a,a=b?function(){return b.filter(function(){return j==this}).length}:function(){return!1};!a()&&j;)j.nodeName.toLowerCase()===d&&(c=j),j=j.parentNode;return c},removeMarkup:function(a,d,b){var c=d.get(0).nodeName,j=this.findHighestElement(a.startContainer,c,b),
m=this.findHighestElement(a.endContainer,c,b),e=!1;j&&0<a.startOffset&&(this.split(a,l(j).parent(),!1),e=!0);if(m&&(3===a.endContainer.nodeType&&a.endOffset<a.endContainer.data.length&&(this.split(a,l(m).parent(),!0),e=!0),1===a.endContainer.nodeType&&a.endOffset<a.endContainer.childNodes.length))this.split(a,l(m).parent(),!0),e=!0;e&&a.correctRange();if(b=(b=this.findHighestElement(a.getCommonAncestorContainer(),c,b))?b.parentNode:a.getCommonAncestorContainer())c=a.getRangeTree(b),this.recursiveRemoveMarkup(c,
d),this.doCleanup({merge:!0,removeempty:!0},a,b)},recursiveRemoveMarkup:function(a,d){var b,c,j;b=0;for(c=a.length;b<c;++b)"full"==a[b].type&&a[b].domobj.nodeName==d.get(0).nodeName&&(j=l(a[b].domobj).contents(),0<j.length?j.first().unwrap():l(a[b].domobj).remove()),a[b].children&&this.recursiveRemoveMarkup(a[b].children,d)},doCleanup:function(a,b,c){var j=this,m,e,k,g,f;"undefined"===typeof a&&(a={});"undefined"===typeof a.merge&&(a.merge=!1);"undefined"===typeof a.removeempty&&(a.removeempty=!1);
"undefined"===typeof c&&b&&(c=b.getCommonAncestorContainer());e=m=!1;k=l(c);g=b.startOffset;f=b.endOffset;k.contents().each(function(){var c,p;try{p=this.nodeType;c=j.getIndexInParent(this)}catch(o){return}switch(p){case 1:if(m&&m.nodeName==this.nodeName){if(b.startContainer===k&&g>c){b.startOffset=b.startOffset-1;e=true}if(b.endContainer===k&&f>c){b.endOffset=b.endOffset-1;e=true}l(m).append(l(this).contents());e=e|j.doCleanup(a,b,m);l(this).remove()}else{e=e|j.doCleanup(a,b,this);p=false;if(a.removeempty){d.Utils.Dom.isBlockLevelElement(this)&&
this.childNodes.length===0&&(p=true);l.inArray(this.nodeName.toLowerCase(),j.mergeableTags)>=0&&(l(this).text().length===0&&this.childNodes.length===0)&&(p=true)}if(p){if(b.startContainer===this.parentNode&&g>c){b.startOffset=b.startOffset-1;e=true}if(b.endContainer===this.parentNode&&f>c){b.endOffset=b.endOffset-1;e=true}l(this).remove()}else m=(a.mergeable?a.mergeable(this):l.inArray(this.nodeName.toLowerCase(),j.mergeableTags)>=0)?this:false}break;case 3:if(m&&m.nodeType===3&&a.merge){if(b.startContainer===
this){b.startContainer=m;b.startOffset=b.startOffset+m.nodeValue.length;e=true}else if(b.startContainer===m.parentNode&&b.startOffset===j.getIndexInParent(m)+1){b.startContainer=m;b.startOffset=m.nodeValue.length;e=true}if(b.endContainer===this){b.endContainer=m;b.endOffset=b.endOffset+m.nodeValue.length;e=true}else if(b.endContainer===m.parentNode&&b.endOffset===j.getIndexInParent(m)+1){b.endContainer=m;b.endOffset=m.nodeValue.length;e=true}m.data=m.data+this.data}else if(!(this.nodeValue===""&&
a.removeempty)){m=this;break}if(b.startContainer===this.parentNode&&b.startOffset>c){b.startOffset=b.startOffset-1;e=true}if(b.endContainer===this.parentNode&&b.endOffset>c){b.endOffset=b.endOffset-1;e=true}l(this).remove();if(m&&3===m.nodeType&&(!m.nextSibling||m.nextSibling.nodeType!==3))for(c=m.data.length-1;c>=0&&m.data.length>1;c--)if(m.data.charAt(c)==="​"){m.deleteData(c,1);if(b.startContainer===m&&b.startOffset>c){b.startOffset--;e=true}if(b.endContainer===m&&b.endOffset>c){b.endOffset--;
e=true}}}});e&&b.clearCaches();return e},getIndexInParent:function(a){if(!a)return!1;for(var d=0,a=a.previousSibling;a;)d++,a=a.previousSibling;return d},isBlockLevelElement:function(a){return!a?!1:1===a.nodeType&&0<=l.inArray(a.nodeName.toLowerCase(),this.blockLevelElements)?!0:!1},isLineBreakElement:function(a){return!a?!1:1===a.nodeType&&"br"==a.nodeName.toLowerCase()},isListElement:function(a){return!a?!1:1===a.nodeType&&0<=l.inArray(a.nodeName.toLowerCase(),this.listElements)},isSplitObject:function(a){return 1===
a.nodeType&&p.hasOwnProperty(a.nodeName)},searchAdjacentTextNode:function(a,d,b,c){if(!a||1!==a.nodeType||0>d||d>a.childNodes.length)return!1;"undefined"===typeof c&&(c={blocklevel:!0,list:!0,linebreak:!0});"undefined"===typeof c.blocklevel&&(c.blocklevel=!0);"undefined"===typeof c.list&&(c.list=!0);"undefined"===typeof c.linebreak&&(c.linebreak=!0);"undefined"===typeof b&&(b=!0);var j,m=a;b&&0<d&&(j=a.childNodes[d-1]);for(!b&&d<a.childNodes.length&&(j=a.childNodes[d]);m;)if(j){if(3===j.nodeType&&
0<l.trim(j.data).length)return j;if(c.blocklevel&&this.isBlockLevelElement(j)||c.linebreak&&this.isLineBreakElement(j)||c.list&&this.isListElement(j))return!1;3===j.nodeType?j=b?j.previousSibling:j.nextSibling:(m=j,j=b?j.lastChild:j.firstChild)}else{if(c.blocklevel&&this.isBlockLevelElement(m)||c.list&&this.isListElement(m))return!1;j=b?m.previousSibling:m.nextSibling;m=m.parentNode}},insertIntoDOM:function(a,d,c,g,f){var p=d.getContainerParents(c,g),x=this,t;c||(c=l(document.body));0===p.length?
t=c.get(0):l.each(p,function(d,b){if(x.allowsNesting(b,a.get(0)))return t=b,!1});"undefined"===typeof t&&0<c.length&&(t=c.get(0));if(!this.allowsNesting(t,a.get(0))&&!f)return!1;if("undefined"!==typeof t){c=this.split(d,l(t),g);if(!0===c){c=d.startContainer;f=d.startOffset;g&&(c=d.endContainer,f=d.endOffset);if(0===f)return d=l(c).contents(),0<d.length?d.eq(0).before(a):l(c).append(a),!0;l(c).contents().eq(f-1).after(a);return!0}if(c){d=c[1];m(c[0],a);if(k(d)||b(d))e(d.nextSibling||d.parentNode&&
d.parentNode.nextSibling,j)&&l(d).remove();return!0}}return!1},removeFromDOM:function(a,d,b){if(b){var b=this.getIndexInParent(a),c=l(a).contents().length,j=a.parentNode;d.startContainer==j&&d.startOffset>b?d.startOffset+=c-1:d.startContainer==a&&(d.startContainer=j,d.startOffset=b+d.startOffset);d.endContainer==j&&d.endOffset>b?d.endOffset+=c-1:d.endContainer==a&&(d.endContainer=j,d.endOffset=b+d.endOffset);l(a).contents().unwrap();this.doCleanup({merge:!0},d,j)}},removeRange:function(a){if(!a||
a.isCollapsed())return!1;3==a.startContainer.nodeType&&(0<a.startOffset&&a.startOffset<a.startContainer.data.length)&&this.split(a,l(a.startContainer).parent(),!1);3==a.endContainer.nodeType&&(0<a.endOffset&&a.endOffset<a.endContainer.data.length)&&this.split(a,l(a.endContainer).parent(),!0);var d=a.getRangeTree();a.endContainer=a.startContainer;a.endOffset=a.startOffset;this.recursiveRemoveRange(d,a);this.doCleanup({merge:!0},a);a.clearCaches()},recursiveRemoveRange:function(a,d){var b;for(b=0;b<
a.length;++b)"full"==a[b].type?(0<l(d.startContainer).parents().andSelf().filter(a[b].domobj).length&&(d.startContainer=d.endContainer=a[b].domobj.parentNode,d.startOffset=d.endOffset=this.getIndexInParent(a[b].domobj)),l(a[b].domobj).remove()):"partial"==a[b].type&&a[b].children&&this.recursiveRemoveRange(a[b].children,d)},extendToWord:function(a,d){var b=this.searchWordBoundary(a.startContainer,a.startOffset,!0),c=this.searchWordBoundary(a.endContainer,a.endOffset,!1);if(d||!(a.startContainer==
b.container&&a.startOffset==b.offset||a.endContainer==c.container&&a.endOffset==c.offset))a.startContainer=b.container,a.startOffset=b.offset,a.endContainer=c.container,a.endOffset=c.offset,a.correctRange(),a.clearCaches()},isWordBoundaryElement:function(a){return!a||!a.nodeName?!1:-1==l.inArray(a.nodeName.toLowerCase(),this.nonWordBoundaryTags)},searchWordBoundary:function(a,d,b){"undefined"===typeof b&&(b=!0);for(var c=!1,j,m;!c;)if(3===a.nodeType)if(b){for(m=j=a.data.substring(0,d).search(this.nonWordRegex);-1!=
m;)j=m,m=a.data.substring(j+1,d).search(this.nonWordRegex),-1!=m&&(m=m+j+1);-1!=j?(d=j+1,c=!0):(d=this.getIndexInParent(a),a=a.parentNode)}else j=a.data.substring(d).search(this.nonWordRegex),-1!=j?(d+=j,c=!0):(d=this.getIndexInParent(a)+1,a=a.parentNode);else 1===a.nodeType&&(b?0<d?this.isWordBoundaryElement(a.childNodes[d-1])?c=!0:(a=a.childNodes[d-1],d=3===a.nodeType?a.data.length:a.childNodes.length):this.isWordBoundaryElement(a)?c=!0:(d=this.getIndexInParent(a),a=a.parentNode):d<a.childNodes.length?
this.isWordBoundaryElement(a.childNodes[d])?c=!0:(a=a.childNodes[d],d=0):this.isWordBoundaryElement(a)?c=!0:(d=this.getIndexInParent(a)+1,a=a.parentNode));if(3!==a.nodeType&&(c=this.searchAdjacentTextNode(a,d,!b)))a=c,d=b?0:a.data.length;return{container:a,offset:d}},isEmpty:function(a){if(!a)return!0;if(-1!=l.inArray(a.nodeName.toLowerCase(),this.nonEmptyTags))return!1;if(3===a.nodeType)return-1==a.data.search(/\S/)||1===a.data.length&&8192<=a.data.charCodeAt(0)?!0:!1;var d,b;d=0;for(b=a.childNodes.length;d<
b;++d)if(!this.isEmpty(a.childNodes[d]))return!1;return!0},setCursorAfter:function(a){var b=new d.Utils.RangeObject;this.getIndexInParent(a);var c;3==a.nodeType?(c=a,a=c.nodeValue.length):a.nextSibling&&3==a.nextSibling.nodeType?(c=a.nextSibling,a=0):(c=a.parentNode,a=this.getIndexInParent(a)+1);b.startContainer=b.endContainer=c;b.startOffset=b.endOffset=a;b.select();return b},selectDomNode:function(a){var b=new d.Utils.RangeObject;b.startContainer=b.endContainer=a.parentNode;b.startOffset=this.getIndexInParent(a);
b.endOffset=b.startOffset+1;b.select()},setCursorInto:function(a){var b=new d.Utils.RangeObject;b.startContainer=b.endContainer=a;b.startOffset=b.endOffset=0;b.select()},isEditingHost:function(a){return a&&1==a.nodeType&&("true"==a.contentEditable||a.parentNode&&9==a.parentNode.nodeType&&"on"==a.parentNode.designMode)},isEditable:function(a){return a&&!this.isEditingHost(a)&&(1!=a.nodeType||"false"!=a.contentEditable)&&(this.isEditingHost(a.parentNode)||this.isEditable(a.parentNode))},getEditingHostOf:function(a){if(this.isEditingHost(a))return a;
if(this.isEditable(a)){for(a=a.parentNode;!this.isEditingHost(a);)a=a.parentNode;return a}return null},inSameEditingHost:function(a,d){return this.getEditingHostOf(a)&&this.getEditingHostOf(a)==this.getEditingHostOf(d)},isBlockNode:function(d){return d&&(d.nodeType==a.Node.ELEMENT_NODE&&-1==a(["inline","inline-block","inline-table","none"]).indexOf(a.getComputedStyle(d).display)||d.nodeType==a.Node.DOCUMENT_NODE||d.nodeType==a.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(d,b){if(!d||
d.nodeType==a.Node.TEXT_NODE&&this.isEmpty(d)||d.nodeType==a.Node.ELEMENT_NODE&&0==d.offsetHeight&&-1===l.inArray(d.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(d.nodeType==a.Node.TEXT_NODE||d.nodeType==a.Node.ELEMENT_NODE&&0==d.childNodes.length||!l(d).contentEditable())return b?d:null;var c;for(c=0;c<d.childNodes.length;++c){var j=this.getFirstVisibleChild(d.childNodes[c],!0);if(null!=j)return j}return null},getLastVisibleChild:function(d,b){if(!d||d.nodeType==a.Node.TEXT_NODE&&this.isEmpty(d)||
d.nodeType==a.Node.ELEMENT_NODE&&0==d.offsetHeight&&-1===l.inArray(d.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(d.nodeType==a.Node.TEXT_NODE||d.nodeType==a.Node.ELEMENT_NODE&&0==d.childNodes.length||!l(d).contentEditable())return b?d:null;var c;for(c=d.childNodes.length-1;0<=c;--c){var j=this.getLastVisibleChild(d.childNodes[c],!0);if(null!=j)return j}return null}});d.Utils.Dom=new f;return d.Utils.Dom});define("aloha/pluginmanager",["jquery","util/class"],function(l,f){function a(a,
b){if(0===a.length)b&&b();else{var e=a.length,k=function(){0===--e&&b&&b()},j,m;for(j=0;j<a.length;j++)(m=a[j],m.settings=m.settings||{},"undefined"===typeof m.settings.enabled&&(m.settings.enabled=!0),m.settings.enabled&&m.checkDependencies())?(m=m.init())&&"function"===typeof m.done?m.done(k):k():k()}}var g=window.Aloha;return new (f.extend({plugins:{},init:function(c,b){var e=this.plugins,k=g&&g.settings&&g.settings.plugins,j;for(j in k)k.hasOwnProperty(j)&&e[j]&&(e[j].settings=k[j]||{});var m;
if(e&&0===b.length)for(m in b=[],e)e.hasOwnProperty(m)&&b.push(m);k=b;j=[];var d;for(d=0;d<k.length;d++)(m=e[k[d]])&&j.push(m);a(j,c)},register:function(a){if(!a.name)throw Error("Plugin does not have an name.");if(this.plugins[a.name])throw Error('Already registered the plugin "'+a.name+'"!');this.plugins[a.name]=a},makeClean:function(a){for(var b in this.plugins)this.plugins.hasOwnProperty(b)&&(g.Log.isDebugEnabled()&&g.Log.debug(this,"Passing contents of HTML Element with id { "+a.attr("id")+" } for cleaning to plugin { "+
b+" }"),this.plugins[b].makeClean(a))},toString:function(){return"pluginmanager"}}))});define("aloha/core",["jquery","aloha/pluginmanager"],function(l,f){function a(){var a=l.browser,b=a.version;return!(a.webkit&&!a.chrome&&532.5>parseFloat(b)||a.mozilla&&1.9>parseFloat(b)||a.msie&&7>b||a.opera&&11>b)}function g(){l("html").mousedown(function(a){var b;if(b=c.activeEditable)if(b=!c.eventHandled)a=l(a.target),b=!(a.is(".aloha-dialog")||a.closest(".aloha").length);b&&c.deactivateEditable()}).mouseup(function(){c.eventHandled=
!1})}var c=window.Aloha,b=[{fn:null,event:null,deferred:null},{fn:function(b,k){if(a())l.browser.webkit?l("html").addClass("aloha-webkit"):l.browser.opera?l("html").addClass("aloha-opera"):l.browser.msie?l("html").addClass("aloha-ie"+parseInt(l.browser.version,10)):l.browser.mozilla&&l("html").addClass("aloha-mozilla"),-1!==navigator.appVersion.indexOf("Win")?c.OSName="Win":-1!==navigator.appVersion.indexOf("Mac")?c.OSName="Mac":-1!==navigator.appVersion.indexOf("X11")?c.OSName="Unix":-1!==navigator.appVersion.indexOf("Linux")&&
(c.OSName="Linux"),g(),c.settings.base=c.getAlohaUrl(),c.Log.init(),c.settings.errorhandling&&(window.onerror=function(a,b,j){c.Log.error(c,"Error message: "+a+"\nURL: "+b+"\nLine Number: "+j);return true}),b(),k();else{var j=window.console;if(j){var m=j.error?"error":j.log?"log":null;if(m)j[m]("This browser is not supported")}}},event:null,deferred:null},{fn:function(a,b){c.RepositoryManager.init();a();b()},event:null,deferred:null},{fn:function(a,b){if(0===c.loadedPlugins.length){var j=f.plugins,
m;for(m in j)j.hasOwnProperty(m)&&c.loadedPlugins.push(m)}var d=!1;f.init(function(){d||(a(),d=!0);b()},c.loadedPlugins);d||(a(),d=!0)},event:"aloha-plugins-loaded",deferred:null},{fn:function(a,b){var j;for(j=0;j<c.editables.length;j++)c.editables[j].ready||c.editables[j].init();a();b()},event:null,deferred:null},{fn:null,event:"aloha-ready",deferred:null}];l.extend(!0,c,{version:"0.24.0-dev-SNAPSHOT",editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",loadedPlugins:[],_pluginBaseUrlByName:{},
init:function(){c.initialize(b)},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(a){var b=false;l.each(this.loadedPlugins,function(c,m){if(a===m.toString()){b=true;return false}});return b},activateEditable:function(a){var b=c.editables,j;for(j=0;j<b.length;j++)b[j]!==a&&b[j].isActive&&b[j].blur();c.activeEditable=a},getActiveEditable:function(){return c.activeEditable},deactivateEditable:function(){if(c.activeEditable){c.activeEditable.blur();c.activeEditable=null}},
getEditableById:function(a){var b=l("#"+a);b.length&&"textarea"===b[0].nodeName.toLowerCase()&&(a=a+"-aloha");for(b=0;b<c.editables.length;b++)if(c.editables[b].getId()===a)return c.editables[b];return null},isEditable:function(a){var b,j;b=0;for(j=c.editables.length;b<j;b++)if(c.editables[b].originalObj.get(0)===a)return true;return false},getEditableHost:function(){var a=function(a){var b;for(b=0;b<c.editables.length;b++)if(c.editables[b].originalObj[0]===a)return c.editables[b];return null};return function(b){if(!b||
0===b.length)return null;var c=a(b[0]);c||b.parents().each(function(b,d){if(c=a(d))return false});return c}}(),log:function(a,b,j){typeof c.Log!=="undefined"&&c.Log.log(a,b,j)},registerEditable:function(a){c.editables.push(a)},unregisterEditable:function(a){a=l.inArray(a,c.editables);a!==-1&&c.editables.splice(a,1)},isModified:function(){var a;for(a=0;a<c.editables.length;a++)if(c.editables[a].isModified&&c.editables[a].isModified())return true;return false},getAlohaUrl:function(){return c.settings.baseUrl||
""},getPluginUrl:function(a){if(!a)return null;(a=c.settings._pluginBaseUrlByName[a])&&(a.match("^(/|http[s]?:).*")||(a=c.getAlohaUrl()+"/"+a));return a},disableObjectResizing:function(){try{var a;try{a=document.queryCommandSupported("enableObjectResizing")}catch(b){a=false;c.Log.log("enableObjectResizing is not supported.")}if(a){document.execCommand("enableObjectResizing",false,false);c.Log.log("enableObjectResizing disabled.")}}catch(j){c.Log.error(j,"Could not disable enableObjectResizing")}},
toString:function(){return"Aloha"}});return c});define("aloha/console",["aloha/core","util/class","jquery"],function(l,f){var a=f.extend({init:function(){if("undefined"===typeof l.settings.logLevels||!l.settings.logLevels)l.settings.logLevels={error:!0,warn:!0};if("undefined"===typeof l.settings.logHistory||!l.settings.logHistory)l.settings.logHistory={};l.settings.logHistory.maxEntries||(l.settings.logHistory.maxEntries=100);l.settings.logHistory.highWaterMark||(l.settings.logHistory.highWaterMark=
90);l.settings.logHistory.levels||(l.settings.logHistory.levels={error:!0,warn:!0});this.flushLogHistory();l.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,log:function(a,c,b){"undefined"===typeof c&&(b=a);"string"!==typeof c&&(c&&c.toString)&&(c=c.toString());"undefined"===typeof b&&(b=c,c=void 0);if("undefined"===typeof a||!a)a="log";a=a.toLowerCase();if("undefined"!==typeof l.settings.logLevels&&l.settings.logLevels[a]){c=c||"Unkown Aloha Component";this.addToLogHistory({level:a,
component:c,message:b,date:new Date});var e=window.console;switch(a){case "error":window.console&&e.error&&(!c&&!b?e.error("Error occured without message and component"):e.error(c+": "+b));break;case "warn":window.console&&e.warn&&e.warn(c+": "+b);break;case "info":window.console&&e.info&&e.info(c+": "+b);break;case "debug":window.console&&e.log&&e.log(c+" ["+a+"]: "+b);break;default:window.console&&e.log&&e.log(c+" ["+a+"]: "+b)}}},error:function(a,c){this.log("error",a,c)},warn:function(a,c){this.log("warn",
a,c)},info:function(a,c){this.log("info",a,c)},debug:function(a,c){this.log("debug",a,c)},deprecated:function(a,c){this.log("warn",a,c);if(l.settings.logLevels.deprecated)throw Error(c);},isLogLevelEnabled:function(a){return l.settings&&l.settings.logLevels&&l.settings.logLevels[a]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},
addToLogHistory:function(a){l.settings.logHistory||this.init();if(!(0>=l.settings.logHistory.maxEntries)&&l.settings.logHistory.levels[a.level]){this.logHistory.push(a);!this.highWaterMarkReached&&this.logHistory.length>=l.settings.logHistory.maxEntries*l.settings.logHistory.highWaterMark/100&&(l.trigger("aloha-log-full"),this.highWaterMarkReached=!0);for(;this.logHistory.length>l.settings.logHistory.maxEntries;)this.logHistory.shift()}},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=
[];this.highWaterMarkReached=!1}}),a=new a;return l.Log=l.Console=a});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/range",["jquery","util/dom","util/class","aloha/console","aloha/rangy-core"],function(l,f,a,g,c){function b(a,b){var d=[],c;for(c=1===a.nodeType?a:a.parentNode;c&&!(c===b||9===c.nodeType);)1===c.nodeType&&d.push(c),c=c.parentNode;return d}var e=window.GENTICS,k=window.Aloha;e.Utils.RangeObject=a.extend({_constructor:function(a){if("object"===
typeof a){if("undefined"!==typeof a.startContainer&&(this.startContainer=a.startContainer),"undefined"!==typeof a.startOffset&&(this.startOffset=a.startOffset),"undefined"!==typeof a.endContainer&&(this.endContainer=a.endContainer),"undefined"!==typeof a.endOffset)this.endOffset=a.endOffset}else!0===a&&this.initializeFromUserSelection()},startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0,deleteContents:function(){f.removeRange(this)},log:function(a){g.deprecated("Utils.RangeObject",
'log() is deprecated. use console.log() from module "aloha/console" instead: '+a)},isCollapsed:function(){return!this.endContainer||this.startContainer===this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){if(this.commonAncestorContainer)return this.commonAncestorContainer;this.updateCommonAncestorContainer();return this.commonAncestorContainer},getContainerParents:function(a,c){var d=c?this.endContainer:this.startContainer;return!d?!1:l(b(d,a?a[0]:null))},
getStartContainerParents:function(a){return this.getContainerParents(a,!1)},getEndContainerParents:function(a){return this.getContainerParents(a,!0)},updateCommonAncestorContainer:function(a){if(a)this.commonAncestorContainer=a;else{var b=this.getStartContainerParents(),d=this.getEndContainerParents(),c;if(!(0<b.length&&0<d.length))return g.warn("aloha/range","could not find commonAncestorContainer"),!1;for(c=0;c<b.length;c++)if(-1!=d.index(b[c])){this.commonAncestorContainer=b[c];break}}g.debug(a?
"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully");return!0},getCollapsedIERange:function(a,b){var d=document.body.createTextRange(),c,e,k;k=this.searchElementToLeft(a,b);k.element?(c=document.body.createTextRange(),c.moveToElementText(k.element),d.setEndPoint("StartToEnd",c),0!==k.characters?d.moveStart("character",k.characters):(d.moveStart("character",1),d.moveStart("character",-1))):(this.searchElementToRight(a,b),e=3==a.nodeType?a.parentNode:
a,c=document.body.createTextRange(),c.moveToElementText(e),d.setEndPoint("StartToStart",c),0!==k.characters&&d.moveStart("character",k.characters));d.collapse();return d},select:function(){var a;if("undefined"===typeof this.startContainer||"undefined"===typeof this.endContainer)return g.warn("can not select an empty range"),!1;a=c.createRange();a.setStart(this.startContainer,this.startOffset);a.setEnd(this.endContainer,this.endOffset);c.getSelection().setSingleRange(a)},searchElementToLeft:function(a,
b){var d,c=0;3===a.nodeType?(c=b,d=a.previousSibling):0<b&&(d=a.childNodes[b-1]);for(;d&&3===d.nodeType;)c+=d.data.length,d=d.previousSibling;return{element:d,characters:c}},searchElementToRight:function(a,b){var d,c=0;3===a.nodeType?(c=a.data.length-b,d=a.nextSibling):b<a.childNodes.length&&(d=a.childNodes[b]);for(;d&&3===d.nodeType;)c+=d.data.length,d=d.nextSibling;return{element:d,characters:c}},update:function(a){g.debug("now updating rangeObject");this.initializeFromUserSelection(a);this.updateCommonAncestorContainer()},
initializeFromUserSelection:function(){var a=c.getSelection();if(!a||!a.rangeCount)return!1;a=a.getRangeAt(0);if(!a)return!1;this.startContainer=a.startContainer;this.endContainer=a.endContainer;this.startOffset=a.startOffset;this.endOffset=a.endOffset;this.correctRange()},correctRange:function(){var a,b;this.clearCaches();if(this.isCollapsed()){if(1===this.startContainer.nodeType){if(0<this.startOffset&&3===this.startContainer.childNodes[this.startOffset-1].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset-
1];this.startOffset=this.startContainer.data.length;this.endContainer=this.startContainer;this.endOffset=this.startOffset;return}if(0<this.startOffset&&1===this.startContainer.childNodes[this.startOffset-1].nodeType){if(a=e.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0)){this.startContainer=this.endContainer=a;this.startOffset=this.endOffset=a.data.length;return}if(a=e.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1)){this.startContainer=this.endContainer=
a;this.startOffset=this.endOffset=0;return}}if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset];this.startOffset=0;this.endContainer=this.startContainer;this.endOffset=0;return}}if(3===this.startContainer.nodeType&&0===this.startOffset&&(a=e.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,e.Utils.Dom.getIndexInParent(this.startContainer),!0))&&
0<l(a).closest(k.activeEditable.obj).length)this.startContainer=this.endContainer=a,this.startOffset=this.endOffset=a.data.length}else{if(1===this.startContainer.nodeType)if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&1===this.startContainer.childNodes[this.startOffset].nodeType){a=
!1;for(b=this.startContainer.childNodes[this.startOffset];!1===a&&b.childNodes&&0<b.childNodes.length;)b=b.childNodes[0],3===b.nodeType&&(a=b);!1!==a&&(this.startContainer=a,this.startOffset=0)}if(3===this.startContainer.nodeType&&this.startOffset===this.startContainer.data.length&&(a=e.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,e.Utils.Dom.getIndexInParent(this.startContainer)+1,!1)))this.startContainer=a,this.startOffset=0;if(3===this.endContainer.nodeType&&0===this.endOffset)if(this.endContainer.previousSibling&&
3===this.endContainer.previousSibling.nodeType)this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&1===this.endContainer.previousSibling.nodeType&&this.endContainer.parentNode){a=this.endContainer.parentNode;for(b=0;b<a.childNodes.length;++b)if(a.childNodes[b]==this.endContainer){this.endOffset=b;break}this.endContainer=a}1==this.endContainer.nodeType&&0===this.endOffset&&this.endContainer.previousSibling&&(3===
this.endContainer.previousSibling.nodeType?(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length):1===this.endContainer.previousSibling.nodeType&&(this.endContainer.previousSibling.childNodes&&0<this.endContainer.previousSibling.childNodes.length)&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.childNodes.length));if(1==this.endContainer.nodeType)if(0<this.endOffset&&3===this.endContainer.childNodes[this.endOffset-
1].nodeType)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;else if(0<this.endOffset&&1===this.endContainer.childNodes[this.endOffset-1].nodeType){a=!1;for(b=this.endContainer.childNodes[this.endOffset-1];!1===a&&b.childNodes&&0<b.childNodes.length;)b=b.childNodes[b.childNodes.length-1],3===b.nodeType&&(a=b);!1!==a&&(this.endContainer=a,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=
void 0},getRangeTree:function(a){"undefined"===typeof a&&(a=this.getCommonAncestorContainer());this.inselection=!1;return this.recursiveGetRangeTree(a)},recursiveGetRangeTree:function(a){var b=0,d=this,c=[];l(a).contents().each(function(k){var g="none",f=!1,q=!1,r=!1,u=!1,x=!1,t=!1;d.isCollapsed()&&(a===d.startContainer&&d.startOffset===k)&&(c[b]=new e.Utils.RangeTree,c[b].type="collapsed",c[b].domobj=void 0,d.inselection=!1,r=!0,b++);if(!d.inselection&&!r)switch(this.nodeType){case 3:this===d.startContainer&&
(d.inselection=!0,g=0<d.startOffset?"partial":"full",f=d.startOffset,q=this.length);break;case 1:if(this===d.startContainer&&0===d.startOffset&&(d.inselection=!0,g="full"),a===d.startContainer&&d.startOffset===k)d.inselection=!0,g="full"}if(d.inselection&&!r){"none"==g&&(g="full");switch(this.nodeType){case 3:this===d.endContainer&&(d.inselection=!1,d.endOffset<this.length&&(g="partial"),!1===f&&(f=0),q=d.endOffset);break;case 1:this===d.endContainer&&0===d.endOffset&&(d.inselection=!1)}a===d.endContainer&&
d.endOffset<=k&&(d.inselection=!1,g="none")}c[b]=new e.Utils.RangeTree;c[b].domobj=this;c[b].type=g;"partial"==g&&(c[b].startOffset=f,c[b].endOffset=q);c[b].children=d.recursiveGetRangeTree(this);if(0<c[b].children.length){for(k=0;k<c[b].children.length;++k)switch(c[b].children[k].type){case "none":u=!0;break;case "full":t=!0;break;case "partial":x=!0}x||t&&u?c[b].type="partial":t&&(!x&&!u)&&(c[b].type="full")}b++});this.isCollapsed()&&(a===this.startContainer&&this.startOffset==a.childNodes.length)&&
(c[b]=new e.Utils.RangeTree,c[b].type="collapsed",c[b].domobj=void 0);return c},findMarkup:function(a,c,d){var d=d?this.endContainer:this.startContainer,e,c=c?c[0]:null;if(d){c=b(d,c);d=0;for(e=c.length;d<e;d++)if(a.apply(c[d]))return c[d];return!1}},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(a){if(!a)return"";var b=this,d="";l.each(a,function(){"full"==this.type?d+=l(this.domobj).text():"partial"==this.type&&3===this.domobj.nodeType?
d+=l(this.domobj).text().substring(this.startOffset,this.endOffset):"partial"==this.type&&(1===this.domobj.nodeType&&this.children)&&(d+=b.recursiveGetText(this.children))});return d}});e.Utils.RangeTree=a.extend({domobj:{},type:null,children:[]});return e.Utils.RangeObject});define("util/functions",[],function(){return{identity:function(l){return l},noop:function(){},returnTrue:function(){return!0},returnFalse:function(){return!1},complement:function(l){return function(){return!l.apply(this,arguments)}},
bind:function(l,f){var a=Array.prototype.slice.call(arguments,2);return function(){return l.apply(f,a.concat(Array.prototype.slice.call(arguments,0)))}}}});define("util/arrays",["util/functions"],function(l){function f(a,b){var c,d,e=[];c=0;for(d=a.length;c<d;c++)e.push(b(a[c]));return e}function a(a,b){return a.map(b)}function g(a,b){var c,d,e,g=[];c=0;for(d=a.length;c<d;c++)e=a[c],b(e)&&g.push(e);return g}function c(a,b){var c,d;c=0;for(d=a.length;c<d;c++)if(b===a[c])return c;return-1}function b(a,
b){return-1!==c(a,b)}function e(a,b){var c,d;c=0;for(d=a.length;c<d;c++)if(b(a[c]))return!0;return!1}return{filter:g,indexOf:c,reduce:function(a,b,c){var d,e;d=0;for(e=a.length;d<e;d++)b=c(b,a[d]);return b},forEach:function(a,b){var c,d;c=0;for(d=a.length;c<d;c++)b(a[c],c,a)},some:e,every:function(a,b){return!e(a,l.complement(b))},map:Array.prototype.map?a:f,contains:b,equal:function(a,b,c){var d,e=a.length;if(e!==b.length)return!1;if(c)for(d=0;d<e;d++){if(!c(a[d],b[d]))return!1}else for(d=0;d<e;d++)if(a[d]!==
b[d])return!1;return!0},applyNotNull:function(a,b){return null==a?null:b(a)},sortUnique:function(a,b){var c;if(b){a.sort(b);for(c=1;c<a.length;c++)0===b(a[c],a[c-1])&&a.splice(c--,1)}else{a.sort();for(c=1;c<a.length;c++)a[c]==a[c-1]&&a.splice(c--,1)}return a},intersect:function(a,c){return g(a,function(a){return b(c,a)})},second:function(a){return a[1]},last:function(a){return a.length?a[a.length-1]:null}}});define("util/strings",["jquery"],function(){var l=/\s+/;return{words:function(f){f=f.split(l);
f.length&&""===f[0]&&f.shift();f.length&&""===f[f.length-1]&&f.pop();return f},dashesToCamelCase:function(f){return f.replace(/[\-]([a-z])/gi,function(a,g){return g.toUpperCase()})},camelCaseToDashes:function(f){return f.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})},splitIncl:function(f,a){for(var g=[],c=0,b;null!=(b=a.exec(f));)c<b.index&&(g.push(f.substring(c,b.index)),c=b.index),c+=b[0].length,g.push(b[0]);c<f.length&&g.push(f.substring(c,f.length));return g},empty:function(f){return""===
f||null==f}}});define("PubSub",[],function(){var l={},f={},a=0;return{sub:function(g,c){if("function"!==typeof c)return-1;var b=l[g];b||(b=l[g]=[]);b.push(++a);f[a]={channel:g,callback:c};return a},unsub:function(a){if(-1===a||!f[a])return!1;var c=f[a]&&l[f[a].channel];delete f[a];for(var b=c.length;b;)if(c[--b]===a)return c.splice(b,1),!0;return!1},pub:function(a,c){var b=a.split("."),e,k=b.length,j="",m=0;for(e=0;e<k;++e){var j=j+((0===e?"":".")+b[e]),d;var p=j;d=c;if(l[p]){d?"object"!==typeof d&&
(d={data:d}):d={};d.channel=p;for(var p=l[p].slice(),n=void 0,n=0;n<p.length;++n)f[p[n]].callback(d);d=n}else d=0;m+=d}return m}}});define("util/maps",[],function(){return{isEmpty:function(l){for(var f in l)if(l.hasOwnProperty(f))return!1;return!0},fillTuples:function(l,f){for(var a=f.length,g;a--;)g=f[a],l[g[0]]=g[1];return l},fillKeys:function(l,f,a){for(var g=f.length;g--;)l[f[g]]=a;return l},keys:function(l){var f=[],a;for(a in l)l.hasOwnProperty(a)&&f.push(a);return f},forEach:function(l,f){for(var a in l)l.hasOwnProperty(a)&&
f(l[a],a,l)},merge:function(){var l={},f;for(f=0;f<arguments.length;f++){var a=arguments[f],g;for(g in a)a.hasOwnProperty(g)&&(l[g]=a[g])}return l}}});define("util/browser",["jquery"],function(l){var f=document.createElement("div");return{ie7:l.browser.msie&&8>parseInt(l.browser.version,10),ie:l.browser.msie,hasRemoveProperty:!!f.style.removeProperty}});define("util/dom2","aloha/core jquery util/functions util/maps util/arrays util/strings util/browser util/dom util/range".split(" "),function(l,f,
a,g,c,b,e,k,j){function m(a,d,b){for(;d;){var c=d.nextSibling;a.insertBefore(d,b);d=c}}function d(a){var d=a.outerHTML;if(typeof d!=="undefined")return d;try{return Ea?Ea.serializeToString(a):a.xml}catch(b){return a.xml}}function p(a){for(var b=[],a=d(a.cloneNode(false)),c;null!=(c=ta.exec(a));)b.push(c[1]);return b}function n(a){var d=[],b=p(a),c,j;c=0;for(j=b.length;c<j;c++){var m=b[c],e=f.attr(a,m),e=null==e?"":e.toString();d.push([m,e])}return d}function s(a,d){var c={},j,m,e,k,g,f,p;f=0;for(g=
a.length;f<g;f++){e=a[f];if(e.className){m=b.words(e.className);for(p=0;p<m.length;p++){k=m[p];if(d[k])(j=c[k])?j.push(e):c[k]=[e]}}}return c}function o(a){for(var d=0;a.previousSibling;){d++;a=a.previousSibling}return d}function q(a){if(1===a.nodeType){a=a.lastChild;return!a?0:o(a)+1}return 3===a.nodeType?a.length:0}function r(a,d){return 1===a.nodeType&&d>=q(a)||3===a.nodeType&&d===a.length&&!a.nextSibling}function u(a,d){1===a.nodeType&&d<q(a)?a=a.childNodes[d]:3===a.nodeType&&d===a.length&&(a=
a.nextSibling||a.parentNode);return a}function x(a){var d=a.parentNode;m(d,a.firstChild,a);d.removeChild(a)}function t(a,d,b){b?d.appendChild(a):d.parentNode.insertBefore(a,d)}function v(a,d){this.node=a;this.atEnd=d}function B(a,d){return new v(a,d)}function C(a,d){return B(u(a,d),r(a,d))}function z(a,d){for(var b=[],c=a.parentNode;c&&!d(c);){b.push(c);c=c.parentNode}return b}function A(a,d){var b=z(a,d),c=b.length?b[b.length-1]:a;c.parentNode&&b.push(c.parentNode);return b}function E(a,d){if(d(a))return[];
var b=z(a,d);b.unshift(a);return b}function K(a,d){if(d(a))return[a];var b=A(a,d);b.unshift(a);return b}function U(a,d){return 1===a.nodeType?a.contains?a!==d&&(1===d.nodeType?a.contains(d):d.parentNode&&(a===d.parentNode||a.contains(d.parentNode))):!!(a.compareDocumentPosition(d)&16):false}function y(a,d){var b=a.parentNode,c=a.nodeValue;if(0===d||d>=c.length)return a;var j=document.createTextNode(c.substring(0,d)),c=document.createTextNode(c.substring(d,c.length));b.insertBefore(j,a);b.insertBefore(c,
a);b.removeChild(a);return j}function S(a,d,b,c){if(3===b.nodeType&&b.parentNode)if(c){if(c===b.length){c=o(b)+1;b=b.parentNode}}else{c=o(b);b=b.parentNode}a.call(d,b,c)}function D(a,d,b){S(a.setStart,a,d,b)}function Y(a,d,b){S(a.setEnd,a,d,b)}function X(a,d,b,c){for(;a&&!b(a,c);){var j=a.nextSibling;d(a,c);a=j}}function V(d,b,c){X(d,b,a.returnFalse,c)}function G(a,d,b){1===a.nodeType&&V(a.firstChild,function(a){G(a,d,b)});d(a,b)}function Q(a){if(a){this.startContainer=a.startContainer;this.startOffset=
a.startOffset;this.endContainer=a.endContainer;this.endOffset=a.endOffset;this.commonAncestorContainer=a.commonAncestorContainer;this.collapsed=a.collapsed}}function H(a,d){d.atEnd?a.setStart(d.node,q(d.node)):a.setStart(d.node.parentNode,o(d.node))}function O(a,d){d.atEnd?a.setEnd(d.node,q(d.node)):a.setEnd(d.node.parentNode,o(d.node))}function $(a,d){a.setStart(d.startContainer,d.startOffset);a.setEnd(d.endContainer,d.endOffset)}function W(a,d,b,c,j,m,e){if(a===j)if(d<=m||!m)a=e;else{a=e.nextSibling;
d=d-m}else if(a===e.parentNode){j=o(e);d>j&&(d=d+1)}c(b,a,d)}function fa(a,d,b,c,j,m,e,k,g,f,p){if(a===j){a=e;d=d+(p?k:0)}else if(a===e)d=d+(p?0:m);else if(a===g)if(d===f){a=e;d=p?k:0}else if(!p&&d===f+1){a=e;d=m}else d>f&&(d=d-1);c(b,a,d)}function ha(a,d,b,c,j,m,e){if(a===j||U(j,a)){a=m;d=e}else a===m&&d>e&&(d=d-1);c(b,a,d)}function L(a,d,b){if(3===a.nodeType){var c=b.startContainer,j=b.startOffset,m=b.endContainer,e=b.endOffset,k=y(a,d);if(k){W(c,j,b,D,a,d,k);W(m,e,b,Y,a,d,k)}}}function I(a,d,b,
c){if(!d||3!==d.nodeType)return a;var j=b.startContainer,m=b.startOffset,e=b.endContainer,k=b.endOffset,g=a.parentNode,f=o(a),p=a.length,n=d.length;d.insertData(c?n:0,a.data);g.removeChild(a);fa(j,m,b,D,a,p,d,n,g,f,c);fa(e,k,b,Y,a,p,d,n,g,f,c);return d}function P(a,d){var b,c=[],j;for(j=0;j<d.length;j++){b=d[j];c.push(b);c.push(b.startContainer);c.push(b.startOffset);c.push(b.endContainer);c.push(b.endOffset)}b=a.parentNode;var m=o(a);b.removeChild(a);for(j=0;j<c.length;j=j+5){ha(c[j+1],c[j+2],c[j],
D,a,b,m);ha(c[j+3],c[j+4],c[j],Y,a,b,m)}}function F(a,d,b,c,j,m,e,k){var g=C(d,b);if(k&&(3===d.nodeType&&b>0&&b<d.length)&&(k?g.next():g.prev())){if(!e(g))return;k?g.prev():g.next()}d=C(c,j);for(b=false;!g.equals(d)&&e(g)&&(k?g.prev():g.next());)b=true;b&&m(a,g)}function Ka(d,b,c){b=b||a.returnFalse;c=c||a.returnFalse;if(!d.collapsed){var j=d.startContainer,m=d.startOffset,e=d.endContainer,k=d.endOffset;F(d,j,m,e,k,H,b,false);F(d,e,k,j,m,O,c,true)}}function Ba(a,d){return U(d,a.node)||d===a.parent()}
function ca(a,d,b,c){if(Ba(a,b))return true;for(;!a.equals(d)&&(c?a.prev():a.next());)if(b===a.parent())return true;return false}var ta=/\s([^\/<>\s=]+)(?:=(?:"[^"]*"|'[^']*'|[^>\/\s]+))?/g,Ea=window.XMLSerializer&&new window.XMLSerializer;v.prototype.next=function(){var a=this.node,d;if(this.atEnd||1!==a.nodeType){if(d=a.nextSibling)this.atEnd=false;else{d=a.parentNode;if(!d)return false;this.atEnd=true}this.node=d}else(d=a.firstChild)?this.node=d:this.atEnd=true;return true};v.prototype.prev=function(){var a=
this.node,d;if(this.atEnd)if(d=a.lastChild){this.node=d;if(1!==d.nodeType)this.atEnd=false}else this.atEnd=false;else{if(d=a.previousSibling){if(1===d.nodeType)this.atEnd=true}else{d=a.parentNode;if(!d)return false}this.node=d}return true};v.prototype.skipPrev=function(){var a=this.prevSibling();if(a){this.node=a;this.atEnd=false;return true}return this.prev()};v.prototype.skipNext=function(){if(this.atEnd)return this.next();this.atEnd=true;return this.next()};v.prototype.nextWhile=function(a){for(;a(this);)if(!this.next())return false;
return true};v.prototype.prevWhile=function(a){for(;a(this);)if(!this.prev())return false;return true};v.prototype.parent=function(){return this.atEnd?this.node:this.node.parentNode};v.prototype.prevSibling=function(){return this.atEnd?this.node.lastChild:this.node.previousSibling};v.prototype.nextSibling=function(){return this.atEnd?null:this.node.nextSibling};v.prototype.equals=function(a){return a.node===this.node&&a.atEnd===this.atEnd};v.prototype.setFrom=function(a){this.node=a.node;this.atEnd=
a.atEnd};v.prototype.clone=function(){return B(this.node,this.atEnd)};v.prototype.insert=function(a){return t(a,this.node,this.atEnd)};Q.prototype.update=function(){if(this.startContainer&&this.endContainer){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset;var d=E(this.startContainer,a.returnFalse),b=E(this.endContainer,a.returnFalse);this.commonAncestorContainer=c.intersect(d,b)[0]}};Q.prototype.setStart=function(a,d){this.startContainer=a;this.startOffset=
d;this.update()};Q.prototype.setEnd=function(a,d){this.endContainer=a;this.endOffset=d;this.update()};return{removeStyle:function(a,d){var c=f(a);if(e.hasRemoveProperty){a.style.removeProperty(d);b.empty(c.attr("style"))&&c.removeAttr("style")}else{var j=c.attr("style");if(null!=j){if(/[^\w\-]/.test(d))throw"unrecognized style name "+d;j=j.replace(RegExp("(:?^|;)\\s*"+d+"\\s*:.*?(?=;|$)","i"),"");b.empty(j)?c.removeAttr("style"):c.attr("style",j)}}},moveNextAll:m,attrNames:p,attrs:n,indexByClass:function(a,
d){var b;b=e.ie7?a.getElementsByTagName("*"):f(a).find("."+g.keys(d).join(",."));return s(b,d)},indexByName:function(a,d){var b,c={},j;b=0;for(j=d.length;b<j;b++){var m=d[b];c[m]=f.makeArray(a.getElementsByTagName(m))}return c},indexByClassHaveList:s,outerHtml:d,removeShallow:x,removeShallowPreservingBoundaries:function(a,d){var b;for(b=0;b<d.length;b++){var c=d[b];c.node===a&&(c.node.firstChild?c.next():c.skipNext())}x(a)},removePreservingRange:function(a,d){P(a,[d])},removePreservingRanges:P,wrap:function(a,
d){a.parentNode.replaceChild(d,a);d.appendChild(a)},insert:t,replaceShallow:function(a,d){m(d,a.firstChild,null);t(d,a);a.parentNode.removeChild(a)},cursor:B,cursorFromBoundaryPoint:C,trimBoundaries:function(d,b,c,j){c=c||a.returnFalse;j=j||a.returnFalse;d.nextWhile(function(a){return!a.equals(b)&&(!a.atEnd?j(a.node):!c(a.parent()))});b.prevWhile(function(a){var b=a.prevSibling();return!d.equals(a)&&(b?j(b):!c(a.parent()))})},expandBoundaries:function(d,b,c,j){c=c||a.returnFalse;j=j||a.returnFalse;
d.prevWhile(function(a){var d=a.prevSibling();return d?j(d):!c(a.parent())});b.nextWhile(function(a){return!a.atEnd?j(a.node):!c(a.parent())})},nodeAtOffset:u,isAtEnd:r,parentsUntil:z,parentsUntilIncl:A,childAndParentsUntil:E,childAndParentsUntilIncl:K,childAndParentsUntilNode:function(a,d){return E(a,function(a){return a===d})},childAndParentsUntilInclNode:function(a,d){return K(a,function(a){return a===d})},isTextNode:function(a){return 3===a.nodeType},nodeIndex:o,splitTextNode:y,splitTextContainers:function(a){L(a.startContainer,
a.startOffset,a);L(a.endContainer,a.endOffset,a)},joinTextNodeAdjustRange:function(a,d){if(3===a.nodeType){a=I(a,a.previousSibling,d,true);I(a,a.nextSibling,d,false)}},nextWhile:function(a,d,b){for(;a&&d(a,b);)a=a.nextSibling;return a},contains:U,walk:V,walkRec:G,walkUntil:X,walkUntilNode:function(a,d,b,c){X(a,d,function(a){return a===b},c)},stableRange:function(a){return new Q(a)},trimRange:Ka,trimRangeClosingOpening:function(d,b,c){b=b||a.returnFalse;c=c||a.returnFalse;Ka(d,function(a){return a.atEnd||
b(a.node)},function(a){return!a.prevSibling()||c(a.prevSibling())})},setRangeFromRef:$,setRangeStartFromCursor:H,setRangeEndFromCursor:O,setRangeFromBoundaries:function(a,d,b){H(a,d);O(a,b)},splitTextNodeAdjustRange:L,insertSelectText:function(a,d){if(a.length){var b=u(d.startContainer,d.startOffset),c=r(d.startContainer,d.startOffset);if(!c&&3===b.nodeType){c=3===d.startContainer.nodeType?d.startOffset:0;b.insertData(c,a);d.setStart(b,c);d.setEnd(b,c+a.length)}else{var j;if((j=c?b.lastChild:b.previousSibling)&&
3===j.nodeType){j.insertData(j.length,a);d.setStart(j,j.length-a.length)}else{j=document.createTextNode(a);t(j,b,c);d.setStart(j,0)}d.setEnd(j,j.length)}}},areRangesEq:function(a,d){return a.startContainer===d.startContainer&&a.startOffset===d.startOffset&&a.endContainer===d.endContainer&&a.endOffset===d.endOffset},collapseToEnd:function(a){a.setStart(a.endContainer,a.endOffset)},extendToWord:function(a){var d=new j(a);k.extendToWord(d);$(a,d)},rangeFromRangeObject:function(a){var d=l.createRange();
d.setStart(a.startContainer,a.startOffset);d.setEnd(a.endContainer,a.endOffset);return d},cloneShallow:function(a){return a.cloneNode(false)},setStyle:function(a,d,b){f(a).css(d,b)},getStyle:function(a,d){d=b.dashesToCamelCase(d);return a.nodeType===1?a.style[d]:null},getComputedStyle:function(a,d){var c=a.ownerDocument;if(c&&c.defaultView&&c.defaultView.getComputedStyle)if(c=c.defaultView.getComputedStyle(a,null))return c[d]||c.getPropertyValue(d);if(a.currentStyle){d=b.dashesToCamelCase(d);return a.currentStyle[d]}return null},
hasAttrs:function(a){return!c.every(c.map(n(a),c.second),b.empty)},ensureRangeContainedByElem:function(a,d){var b=C(a.startContainer,a.startOffset),c=C(a.endContainer,a.endOffset),j=!Ba(b,d),m=!Ba(c,d),e=ca(b,c,d,false),k=ca(c,b,d,true);if(!e||!k)return false;j&&H(a,b);m&&O(a,c);return true},isBoundaryPointContainedByElem:function(a,d,b){return Ba(C(a,d),b)},nodeLength:q}});define("util/html",["jquery","util/dom2","util/dom","util/maps","util/arrays"],function(l,f,a,g,c){function b(a){return a&&(1==
a.nodeType&&!x[f.getComputedStyle(a,"display")]||9==a.nodeType||11==a.nodeType)}function e(a){return t[a.nodeName]}function k(a){return C.test(a)||E.test(a)}function j(a){return 3===a.nodeType&&k(a.data)}function m(a){return y[a.nodeName]}function d(a){return 3===a.nodeType&&!a.length}function p(a){return"pre"===a||"pre-wrap"===a||"-moz-pre-wrap"===a}function n(a){if(3!==a.nodeType)return!1;if(!a.length)return!0;if(u.test(a.nodeValue))return!1;var d=f.getComputedStyle(a.parentNode,"white-space");
return p(d)||"pre-line"===d&&/[\r\n]/.test(a.data)?!1:!0}function s(a){return n(a.node)||1===a.node.nodeType&&!b(a.node)&&!("IMG"===a.node.nodeName||"BR"===a.node.nodeName)}function o(a){var d=a.clone();d.nextWhile(s);if(!("BR"===d.node.nodeName||b(d.node)))return!1;a.setFrom(d);return!0}function q(a){var d=a.clone();d.prev();d.prevWhile(s);if(!("BR"===d.node.nodeName||b(d.node)))return!1;var c="BR"===d.node.nodeName;d.next();if(c&&(c=a.clone(),o(c)&&c.atEnd)){d.skipPrev();d.prevWhile(s);if(!("BR"===
d.node.nodeName||b(d.node)))return!1;d.next()}a.setFrom(d);return!0}function r(a){return!n(a)?!1:o(f.cursor(a,!1))||q(f.cursor(a,!1))}var u=/[^\r\n\t\f \u200B]/,x={inline:!0,"inline-block":!0,"inline-table":!0,none:!0},t={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,OL:!0,UL:!0,PRE:!0,ADDRESS:!0,BLOCKQUOTE:!0,DL:!0,DIV:!0,fieldset:!0,FORM:!0,HR:!0,NOSCRIPT:!0,TABLE:!0},v="address article aside audio blockquote canvas dd div dl fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr noscript ol output p pre section table tfoot ul video".split(" "),
B=["\\u200B","\\u200C","\\u200D","\\uFEFF"],C=RegExp("[\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u0085\\u00A0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000]+"),z=RegExp("^[\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u0085\\u00A0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000]+"),A=RegExp("[\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u0085\\u00A0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000]+$"),
E=RegExp("["+B.join("")+"]+"),K=RegExp("^["+B.join("")+"]+"),U=RegExp("["+B.join("")+"]+$"),y={};g.fillKeys(y,v,!0);g.fillKeys(y,c.map(v,function(a){return a.toUpperCase()}),!0);var S={"background-color":!0,underline:!0};return{isControlCharacter:function(a){return/[\x00-\x1f\x7f-\x9f]/.test(a)},isStyleInherited:function(a){return!S[a]},BLOCKLEVEL_ELEMENTS:v,isBlockType:e,isInlineType:function(a){return!e(a)},hasBlockStyle:b,hasInlineStyle:function(a){return!b(a)},isBlock:m,isUnrenderedWhitespace:r,
isWhiteSpacePreserveStyle:p,skipUnrenderedToStartOfLine:q,skipUnrenderedToEndOfLine:o,normalizeBoundary:function(a){if(q(a))return!0;if(!o(a))return!1;if("BR"===a.node.nodeName){a.skipNext();var d=a.clone();o(d)&&d.atEnd&&a.setFrom(d)}return!0},isIgnorableWhitespace:d,isEmpty:function(a){for(a=a.firstChild;a&&(r(a)||!(1===a.nodeType||3===a.nodeType));)a=a.nextSibling;return!0},isProppedBlock:function(a){if(!y[a.nodeName])return!1;var b=!1,a=a.children,c=a.length,j;for(j=0;j<c;j++)if(!b&&"br"===a[j].nodeName.toLowerCase())b=
!0;else if(!d(a[j]))return!1;return b},isEditingHost:function(a){return 1===a.nodeType&&"true"===a.contentEditable},findNodeLeft:function(a,d){for(;a&&!d(a);)a=a.nextSibling;return a},findNodeRight:function(a,d){for(;a&&!d(a);)a=a.previousSibling;return a},allowNestedParagraph:function(d){return d.obj[0]&&a.allowsNesting(d.obj[0],l("<p>")[0])?!0:!1},trimWhitespaceCharacters:function(a){return a.replace(z,"").replace(A,"").replace(K,"").replace(U,"")},isWSPorZWSPNode:j,isWSPorZWSPText:k,isUnrenderedNode:function(a){return 3===
a.nodeType&&0===a.data.length||a===a.parentNode.lastChild&&m(a.parentNode)&&"BR"===a.nodeName?!0:j(a)}}});define("aloha/engine","aloha/core aloha/ecma5shims util/maps util/dom2 util/html jquery".split(" "),function(l,f,a,g,c,b){function e(a,d){return a.hasAttribute?a.hasAttribute(d):typeof a.attributes[d]!="undefined"}function k(a){return a===null||!a||a===Bb}function j(a,d){typeof d=="string"&&(d=[d]);typeof d=="object"&&(d=f(d).map(function(a){return a.toUpperCase()}));return a&&a.nodeType==1&&
k(a.namespaceURI)&&(typeof d=="undefined"||f(d).indexOf(a.tagName)!=-1)}function m(a){return a&&a.nodeType==1&&k(a.namespaceURI)}function d(a,d){return a&&a.nodeType==1&&k(a.namespaceURI)&&d.toUpperCase()===a.nodeName}function p(a,d){var b;if(b=a)if(b=a.nodeType==1)if(b=k(a.namespaceURI))a:{b=a.nodeName;var c,j;b=b.toUpperCase();c=0;for(j=d.length;c<j;c++)if(d[c].toUpperCase()===b){b=true;break a}b=false}return b}function n(a){var d,b=0;if(!a||!a.style)return 0;if(typeof a.style.length!=="undefined")return a.style.length;
for(d in a.style)a.style[d]&&(a.style[d]!==0&&a.style[d]!=="false")&&b++;return b}function s(a){if(!a)return null;var d=[],b;for(b=a.length>>>0;b--;)d[b]=a[b];return d}function o(a){for(;a&&!a.nextSibling;)a=a.parentNode;return!a?null:a.nextSibling}function q(a){return a.hasChildNodes()?a.firstChild:o(a)}function r(a){if(a.previousSibling){for(a=a.previousSibling;a.hasChildNodes();)a=a.lastChild;return a}return a.parentNode&&a.parentNode.nodeType==f.Node.ELEMENT_NODE?a.parentNode:null}function u(a,
d){return a&&d&&Boolean(f.compareDocumentPosition(a,d)&f.Node.DOCUMENT_POSITION_CONTAINED_BY)}function x(a,d){return d&&a&&Boolean(f.compareDocumentPosition(d,a)&f.Node.DOCUMENT_POSITION_CONTAINED_BY)}function t(a,d){return Boolean(f.compareDocumentPosition(a,d)&f.Node.DOCUMENT_POSITION_FOLLOWING)}function v(a){for(var d=[];a.parentNode;){d.unshift(a.parentNode);a=a.parentNode}return d}function B(a){for(var d=[],b=o(a);null!=(a=q(a))&&a!=b;)d.push(a);return d}function C(a){return{"xx-small":1,small:2,
medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[a]}function z(a){return a.dir=="ltr"?"ltr":a.dir=="rtl"?"rtl":!m(a.parentNode)?"ltr":z(a.parentNode)}function A(a){for(var d=0;a.previousSibling;){d++;a=a.previousSibling}return d}function E(a){switch(a.nodeType){case f.Node.PROCESSING_INSTRUCTION_NODE:case f.Node.DOCUMENT_TYPE_NODE:return 0;case f.Node.TEXT_NODE:case f.Node.COMMENT_NODE:return a.length;default:return!a.lastChild?0:A(a.lastChild)+1}}function K(a,d,b,c){if(a==b){if(d==c)return"equal";
if(d<c)return"before";if(d>c)return"after"}var j=f.compareDocumentPosition(b,a);if(j&f.Node.DOCUMENT_POSITION_FOLLOWING){c=K(b,c,a,d);if(c=="before")return"after";if(c=="after")return"before"}if(j&f.Node.DOCUMENT_POSITION_CONTAINS){for(;b.parentNode!=a;)b=b.parentNode;if(A(b)<d)return"after"}return"before"}function U(a){for(;a.parentNode!=null;)a=a.parentNode;return a}function y(a,d){return K(a,0,d.startContainer,d.startOffset)!=="after"||K(a,E(a),d.endContainer,d.endOffset)!=="before"?false:U(a)==
U(d.startContainer)}function S(a,d){typeof d=="undefined"&&(d=function(){return true});for(var b=a.startContainer,b=b.hasChildNodes()&&a.startOffset<b.childNodes.length?b.childNodes[a.startOffset]:a.startOffset==E(b)?o(b):q(b),c=a.endContainer,c=c.hasChildNodes()&&a.endOffset<c.childNodes.length?c.childNodes[a.endOffset]:o(c),j=[];t(b,c);)if(y(b,a)&&d(b)){j.push(b);b=o(b)}else b=q(b);return j}function D(a,d){typeof d=="undefined"&&(d=function(){return true});for(var b=a.startContainer,b=b.hasChildNodes()&&
a.startOffset<b.childNodes.length?b.childNodes[a.startOffset]:a.startOffset==E(b)?o(b):q(b),c=a.endContainer,c=c.hasChildNodes()&&a.endOffset<c.childNodes.length?c.childNodes[a.endOffset]:o(c),j=[];t(b,c);){y(b,a)&&d(b)&&j.push(b);b=q(b)}return j}function Y(a){if(a.toLowerCase()=="currentcolor")return null;var d=document.createElement("span");document.body.appendChild(d);d.style.color="black";var b=document.createElement("span");d.appendChild(b);b.style.color=a;a=f.getComputedStyle(b).color;if(a==
"rgb(0, 0, 0)"){d.color="white";a=f.getComputedStyle(b).color;if(a!="rgb(0, 0, 0)")return null}document.body.removeChild(d);return/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(a)?a.replace("rgba","rgb").replace(", 1)",")"):a=="transparent"?"rgba(0, 0, 0, 0)":a}function X(a){a=a.toLowerCase();if(f(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk",
"crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo",
"ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue",
"mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke",
"yellow","yellowgreen"]).indexOf(a)!=-1)return a;var a=Y(a),d=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(a);return d?"#"+parseInt(d[1],10).toString(16).replace(/^.$/,"0$&")+parseInt(d[2],10).toString(16).replace(/^.$/,"0$&")+parseInt(d[3],10).toString(16).replace(/^.$/,"0$&"):/^#[abcdef0123456789]+$/i.exec(a)?a:null}function V(a){a=f(a).trim();if(/^[\-+]?[0-9]+(\.[0-9]+)?([eE][\-+]?[0-9]+)?$/.test(a)){var d;if(a[0]=="+"){a=a.slice(1);d="relative-plus"}else if(a[0]=="-"){a=a.slice(1);d="relative-minus"}else d=
"absolute";a=parseInt(a,10);d=="relative-plus"&&(a=a+3);d=="relative-minus"&&(a=3-a);a<1&&(a=1);a>7&&(a=7);a={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[a]}return a}function G(a){a=V(a);if(b.inArray(a,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])==-1&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(a))return null;var d=document.createElement("font");document.body.appendChild(d);a=="xxx-large"?d.size=7:d.style.fontSize=a;a=
parseInt(f.getComputedStyle(d).fontSize,10);document.body.removeChild(d);for(var c=1;c<7;){d=document.createElement("font");d.size=c;document.body.appendChild(d);var j=parseInt(f.getComputedStyle(d).fontSize,10);d.size=1+c;var m=parseInt(f.getComputedStyle(d).fontSize,10);document.body.removeChild(d);if(a<(m+j)/2)return""+c;c++}return"7"}function Q(a,d,b,c){var j;if(kb==0&&typeof b!="undefined")Ja=b;else if(kb==0){Ja=null;Ja=b}kb++;try{j=c()}catch(m){kb--;throw m;}kb--;return j}function H(a,d){a=
a.toLowerCase();return Q(a,"action",d,function(a){return function(){return b.inArray(a,["copy","cut","paste","selectall","stylewithcss","usecss"])!=-1||d!==null}}(a))}function O(a){var d=new window.GENTICS.Utils.RangeObject;d.startContainer=a.startContainer;d.startOffset=a.startOffset;d.endContainer=a.endContainer;d.endOffset=a.endOffset;d.select()}function $(a,d,b,c){var j=a.toLowerCase(),m=d,e=b;if(arguments.length==1||arguments.length>=4&&typeof m=="undefined")m=false;if(arguments.length<=2||arguments.length>=
4&&typeof e=="undefined")e="";return Q(j,"action",c,function(a,d,b){return function(){if(!H(a))return false;M[a].action(b,c);O(c);return true}}(j,m,e))}function W(a,d){a=a.toLowerCase();return Q(a,"state",d,function(a){return function(){return!H(a,d)?false:typeof $a(a,d)!="undefined"?$a(a,d):M[a].state(d)}}(a))}function fa(a,d){a=a.toLowerCase();return Q(a,"value",d,function(){return!M.hasOwnProperty(a)||!M[a].hasOwnProperty("value")?"":a=="fontsize"&&Oa("fontsize",d)!==void 0?G(Oa("fontsize",d)):
typeof Oa(a,d)!="undefined"?Oa(a,d):M[a].value(d)})}function ha(a){return a&&a.nodeType==1&&k(a.namespaceURI)&&aa[a.nodeName]}function L(a){return a&&(a.nodeType==f.Node.ELEMENT_NODE&&!Cb[f.getComputedStyle(a).display]||a.nodeType==f.Node.DOCUMENT_NODE||a.nodeType==f.Node.DOCUMENT_FRAGMENT_NODE)}function I(a){return a&&!L(a)}function P(a){return a&&a.nodeType==f.Node.ELEMENT_NODE&&(a.contentEditable=="true"||a.parentNode&&a.parentNode.nodeType==f.Node.DOCUMENT_NODE&&a.parentNode.designMode=="on")}
function F(a){return a&&!P(a)&&(a.nodeType!=f.Node.ELEMENT_NODE||a.contentEditable!="false"||b(a).hasClass("aloha-table-wrapper"))&&(P(a.parentNode)||F(a.parentNode))}function Ka(a){var d;for(d=0;d<a.childNodes.length;d++)if(F(a.childNodes[d])||Ka(a.childNodes[d]))return true;return false}function Ba(a){if(P(a))return a;if(F(a)){for(a=a.parentNode;!P(a);)a=a.parentNode;return a}return null}function ca(a,d){return Ba(a)&&Ba(a)==Ba(d)}function ta(a){if(!d(a,"br"))return false;for(var c=a.parentNode;f.getComputedStyle(c).display==
"inline";)c=c.parentNode;var j=c.style.height,m=c.style.maxHeight,e=c.style.minHeight;c.style.height="auto";c.style.maxHeight="none";if(!(b.browser.msie&&b.browser.version<8))c.style.minHeight="0";var k=document.createTextNode("​"),g=c.offsetHeight;if(g==0)throw"isCollapsedLineBreak: original height is zero, bug?";a.parentNode.insertBefore(k,a.nextSibling);a=c.offsetHeight;k.parentNode.removeChild(k);c.style.height=j;c.style.maxHeight=m;if(!(b.browser.msie&&b.browser.version<8))c.style.minHeight=
e;return g<a-5}function Ea(a){if(!d(a,"br")||d(a.parentNode,"li")&&a.parentNode.childNodes.length==1)return false;for(var c=a.parentNode;f.getComputedStyle(c).display=="inline";)c=c.parentNode;var j=c.style.height,m=c.style.maxHeight,e=c.style.minHeight,k=c.contentEditable;c.style.height="auto";c.style.maxHeight="none";c.style.minHeight="0";if(b.browser.msie&&b.browser.version<=7)c.contentEditable="false";var g=c.offsetHeight;if(g==0)throw"isExtraneousLineBreak: original height is zero, bug?";var p=
a.style.display;a.style.display="none";var n=c.offsetHeight;c.style.height=j;c.style.maxHeight=m;c.style.minHeight=e;if(b.browser.msie&&b.browser.version<=7)c.contentEditable=k;a.style.display=p;return g==n}function ka(a){return a&&a.nodeType==f.Node.TEXT_NODE&&(a.data==""||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==f.Node.ELEMENT_NODE&&b.inArray(f.getComputedStyle(a.parentNode).whiteSpace,["normal","nowrap"])!=-1||/^[\t\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==
f.Node.ELEMENT_NODE&&f.getComputedStyle(a.parentNode).whiteSpace=="pre-line"||/^[\t\n\r ]+$/.test(a.data)&&a.parentNode&&a.parentNode.nodeType==f.Node.DOCUMENT_FRAGMENT_NODE)}function Aa(a){if(!ka(a))return false;if(a.data=="")return true;var b=a.parentNode;if(!b||f(v(a)).some(function(a){return a.nodeType==f.Node.ELEMENT_NODE&&f.getComputedStyle(a).display=="none"}))return true;for(;!L(b)&&b.parentNode;)b=b.parentNode;for(var c=a;c!=b;){c=r(c);if(L(c)||d(c,"br"))return true;if(c.nodeType==f.Node.TEXT_NODE&&
!ka(c)||d(c,"img"))break}c=a;for(a=o(b);c!=a;){c=q(c);if(L(c)||d(c,"br"))return true;if(c&&c.nodeType==f.Node.TEXT_NODE&&!ka(c)||d(c,"img"))break}return false}function Fa(a){var b;if(1===a.nodeType&&"none"===f.getComputedStyle(a).display)return false;if(L(a)||a.nodeType==f.Node.TEXT_NODE&&!Aa(a)||d(a,"img")||d(a,"br")&&!Ea(a))return true;for(b=0;b<a.childNodes.length;b++)if(Fa(a.childNodes[b]))return true;return false}function ea(a){if(!a)return false;var d=v(a),b,c;c=0;for(b=d.length;c<b;c++){var j=
d[c];if(1===j.nodeType&&"none"===f.getComputedStyle(j).display)return false}return Fa(a)}function ma(a){return a&&!ea(a)}function Ha(a){var d;if(ta(a)&&!Ea(a))return true;if(!I(a)||a.nodeType!=f.Node.ELEMENT_NODE)return false;var b=false;for(d=0;d<a.childNodes.length;d++){if(!ma(a.childNodes[d])&&!Ha(a.childNodes[d]))return false;Ha(a.childNodes[d])&&(b=true)}return b}function Ab(a){var d;if(a&&a.nodeType!==f.Node.TEXT_NODE)d=false;else{d=0;for(var a=a.data,b=a.length;d<b&&a.charAt(d)==="​";)d++;
d=d===b}return!d}function Ya(a){var d;if(d=a){if(!(d=!a.hasChildNodes())){if(c.isBlock(a))d=(d=c.findNodeRight(a.lastChild,ea))&&"br"===d.nodeName.toLowerCase()&&!c.findNodeRight(d.previousSibling,ea);else d=false;d=d||!c.findNodeRight(a.lastChild,Ab)}d=d&&P(a.parentNode)&&!a.previousSibling&&!a.nextSibling}return d}function Wa(a){var d=a.parentNode,b=A(a);d.removeChild(a);return{node:d,offset:b}}function J(){var a;if(Ja)a=Ja;else if(l.getSelection().rangeCount)a=l.getSelection().getRangeAt(0);else return null;
if(b.inArray(a.startContainer.nodeType,[f.Node.TEXT_NODE,f.Node.ELEMENT_NODE])==-1||b.inArray(a.endContainer.nodeType,[f.Node.TEXT_NODE,f.Node.ELEMENT_NODE])==-1||!a.startContainer.ownerDocument||!a.endContainer.ownerDocument||!x(a.startContainer,a.startContainer.ownerDocument)||!x(a.endContainer,a.endContainer.ownerDocument))throw"Invalid active range; test bug?";return a}function qa(a,d,b,c){if(b==-1)b=d.childNodes.length;var j=a.parentNode,m=A(a),e,k=[c];for(e=0;e<l.getSelection().rangeCount;e++)k.push(l.getSelection().getRangeAt(e));
var g=[];f(k).forEach(function(a){g.push([a.startContainer,a.startOffset]);g.push([a.endContainer,a.endOffset])});f(g).forEach(function(a){a[0]==d&&a[1]>b&&a[1]++;if(a[0]==j&&(a[1]==m||a[1]==m+1)){a[0]=d;a[1]=a[1]+(b-m)}a[0]==j&&a[1]>m+1&&a[1]--});d.childNodes.length==b?d.appendChild(a):d.insertBefore(a,d.childNodes[b]);var p=null;if(1===g[0][0].nodeType&&1===g[1][0].nodeType&&g[0][1]>g[0][0].childNodes.length&&g[1][1]>g[1][0].childNodes.length){c.setStart(a,0);c.setEnd(a,0)}else{c.setStart(g[0][0],
g[0][1]);c.setEnd(g[1][0],g[1][1]);l.getSelection().removeAllRanges();for(e=1;e<k.length;e++){p=l.createRange();p.setStart(g[2*e][0],g[2*e][1]);p.setEnd(g[2*e+1][0],g[2*e+1][1]);l.getSelection().addRange(p)}}}function Sa(a,d){b.browser.msie&&(b.browser.version>=7&&typeof a.attributes[b.expando]!=="undefined")&&b(a).removeAttr(b.expando);var c=a.attributes,j;for(j=0;j<c.length;j++){var m=c[j];if(typeof m.specified==="undefined"||m.specified)typeof d.setAttributeNS==="function"?d.setAttributeNS(m.namespaceURI,
m.name,m.value):d.setAttribute(m.name,m.value)}}function za(a,b,c){if(d(a,b)||!a.parentNode)return a;b=a.ownerDocument.createElement(b);a.parentNode.insertBefore(b,a);for(Sa(a,b);a.childNodes.length;)qa(a.firstChild,b,b.childNodes.length,c);a.parentNode.removeChild(a);if(c.startContainer===a)c.startContainer=b;if(c.endContainer===a)c.endContainer=b;return b}function ib(a,d){var b=a.previousSibling;if(b){for(;b.hasChildNodes();)b=b.lastChild;for(;ma(b)&&!Ea(b)&&b!=a.parentNode;)b=r(b);F(b)&&Ea(b)&&
g.removePreservingRange(b,d)}}function Ma(a,d){for(var b=a;b.hasChildNodes();)b=b.lastChild;for(;ma(b)&&!Ea(b)&&b!=a;)b=r(b);F(b)&&Ea(b)&&g.removePreservingRange(b,d)}function jb(a,d){ib(a,d);Ma(a,d)}function wa(a,b,c,j){var m;typeof b=="undefined"&&(b=function(){return false});typeof c=="undefined"&&(c=function(){return null});if(!a.length||!F(a[0]))return null;I(a[a.length-1])&&(!d(a[a.length-1],"br")&&d(a[a.length-1].nextSibling,"br"))&&a.push(a[a.length-1].nextSibling);c=F(a[0].previousSibling)&&
b(a[0].previousSibling)?a[0].previousSibling:F(a[a.length-1].nextSibling)&&b(a[a.length-1].nextSibling)?a[a.length-1].nextSibling:c();if(!c)return null;if(!c.parentNode){a[0].parentNode.insertBefore(c,a[0]);m=j.startContainer;var e=j.startOffset,k=j.endContainer,g=j.endOffset;m==c.parentNode&&e>=A(c)&&j.setStart(m,e+1);k==c.parentNode&&g>=A(c)&&g+1<=k.childNodes.length&&j.setEnd(k,g+1);if(Ja&&Ja!==j){m=Ja.startContainer;e=Ja.startOffset;k=Ja.endContainer;g=Ja.endOffset;m==c.parentNode&&e>=A(c)&&Ja.setStart(m,
e+1);k==c.parentNode&&g>=A(c)&&Ja.setEnd(k,g+1)}}e=a[0].parentNode;if(t(c,a[0])){!I(c)&&(I(c.lastChild)&&I(a[0])&&!d(c.lastChild,"BR"))&&c.appendChild(c.ownerDocument.createElement("br"));for(m=0;m<a.length;m++)qa(a[m],c,-1,j)}else{!I(c)&&(I(c.firstChild)&&I(a[a.length-1])&&!d(a[a.length-1],"BR"))&&c.insertBefore(c.ownerDocument.createElement("br"),c.firstChild);for(m=a.length-1;m>=0;m--)qa(a[m],c,0,j)}F(e)&&!e.hasChildNodes()&&e.parentNode.removeChild(e);if(F(c.nextSibling)&&b(c.nextSibling)){for(!I(c)&&
(I(c.lastChild)&&I(c.nextSibling.firstChild)&&!d(c.lastChild,"BR"))&&c.appendChild(c.ownerDocument.createElement("br"));c.nextSibling.hasChildNodes();)qa(c.nextSibling.firstChild,c,-1,j);c.parentNode.removeChild(c.nextSibling)}jb(c,j);return c}function na(a,c){if((Db[c]||p(c,["colgroup","table","tbody","tfoot","thead","tr"]))&&typeof a=="object"&&a.nodeType==f.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(a.data)||(Eb[c]||p(c,["script","style","plaintext","xmp"]))&&(typeof a!="object"||a.nodeType!=f.Node.TEXT_NODE)||
typeof a=="object"&&(a.nodeType==f.Node.DOCUMENT_NODE||a.nodeType==f.Node.DOCUMENT_FRAGMENT_NODE||a.nodeType==f.Node.DOCUMENT_TYPE_NODE))return false;m(a)&&(a=a.tagName.toLowerCase());if(typeof a!="string")return true;if(m(c)){for(var j=c;j;){if(a=="a"&&d(j,"a")||aa[a.toUpperCase()]&&j&&j.nodeType==1&&k(j.namespaceURI)&&Fb[j.nodeName]||/^h[1-6]$/.test(a)&&m(j)&&/^H[1-6]$/.test(j.tagName))return false;j=j.parentNode}c=c.tagName.toLowerCase()}if(typeof c=="object"&&(c.nodeType==f.Node.ELEMENT_NODE||
c.nodeType==f.Node.DOCUMENT_FRAGMENT_NODE))return true;if(typeof c!="string")return false;switch(c){case "colgroup":return a=="col";case "table":return b.inArray(a,["caption","col","colgroup","tbody","td","tfoot","th","thead","tr"])!=-1;case "tbody":case "thead":case "tfoot":return b.inArray(a,["td","th","tr"])!=-1;case "tr":return b.inArray(a,["td","th"])!=-1;case "dl":return b.inArray(a,["dt","dd"])!=-1;case "dir":case "ol":case "ul":return b.inArray(a,["dir","li","ol","ul"])!=-1;case "hgroup":return/^h[1-6]$/.test(a)}if(b.inArray(a,
["body","caption","col","colgroup","frame","frameset","head","html","tbody","td","tfoot","th","thead","tr"])!=-1||b.inArray(a,["dd","dt"])!=-1&&c!="dl"||a=="li"&&c!="ol"&&c!="ul")return false;return(j=Gb[c.toUpperCase()])&&j[a.toUpperCase()]?false:true}function Za(a,d){return d.collapsed?false:y(a,d)||a==d.startContainer&&a.nodeType==f.Node.TEXT_NODE&&E(a)!=d.startOffset||a==d.endContainer&&a.nodeType==f.Node.TEXT_NODE&&d.endOffset!=0||a.hasChildNodes()&&f(a.childNodes).every(function(a){return Za(a,
d)})&&(!x(d.startContainer,a)||d.startContainer.nodeType!=f.Node.TEXT_NODE||d.startOffset==0)&&(!x(d.endContainer,a)||d.endContainer.nodeType!=f.Node.TEXT_NODE||d.endOffset==E(d.endContainer))?true:false}function ra(a,d){typeof d=="undefined"&&(d=function(){return true});for(var b=a.startContainer;Za(b.parentNode,a);)b=b.parentNode;for(var c=o(a.endContainer),j=[];t(b,c);){Za(b,a)&&d(b)&&j.push(b);b=q(b)}return j}function Xa(a){if(!m(a))return false;if(b.inArray(a.tagName,["B","EM","I","S","SPAN",
"STRIKE","STRONG","SUB","SUP","U"])!=-1&&(a.attributes.length==0||a.attributes.length==1&&e(a,"style")))return true;if(a.tagName=="FONT"||a.tagName=="A"){var d=a.attributes.length;e(a,"style")&&d--;if(a.tagName=="FONT"){e(a,"color")&&d--;e(a,"face")&&d--;e(a,"size")&&d--}a.tagName=="A"&&e(a,"href")&&d--;if(d==0)return true}return false}function Na(a){return!m(a)||b.inArray(a.tagName,["A","B","EM","FONT","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"])==-1?false:a.attributes.length==0?true:a.attributes.length>
1?false:e(a,"style")&&n(a)==0||a.tagName=="A"&&e(a,"href")||a.tagName=="FONT"&&(e(a,"color")||e(a,"face")||e(a,"size"))||(a.tagName=="B"||a.tagName=="STRONG")&&e(a,"style")&&n(a)==1&&a.style.fontWeight!=""||(a.tagName=="I"||a.tagName=="EM")&&e(a,"style")&&n(a)==1&&a.style.fontStyle!=""||(a.tagName=="A"||a.tagName=="FONT"||a.tagName=="SPAN")&&e(a,"style")&&n(a)==1&&a.style.textDecoration==""||b.inArray(a.tagName,["A","FONT","S","SPAN","STRIKE","U"])!=-1&&e(a,"style")&&n(a)==1&&(a.style.textDecoration==
"line-through"||a.style.textDecoration=="underline"||a.style.textDecoration=="overline"||a.style.textDecoration=="none")?true:false}function Ga(a,d,b){return d===null&&b===null||typeof d=="string"&&typeof b=="string"&&d==b&&!M[a].hasOwnProperty("equivalentValues")||typeof d=="string"&&typeof b=="string"&&M[a].hasOwnProperty("equivalentValues")&&M[a].equivalentValues(d,b)?true:false}function ua(a,d,b){if(Ga(a,d,b))return true;if(a!="fontsize"||typeof d!="string"||typeof b!="string")return false;var c=
ua;if(c.sizeMap===void 0){c.sizeMap={};var j=document.createElement("font");document.body.appendChild(j);f(["xx-small","small","medium","large","x-large","xx-large","xxx-large"]).forEach(function(a){j.size=C(a);c.sizeMap[a]=f.getComputedStyle(j).fontSize});document.body.removeChild(j)}return d===c.sizeMap[b]||b===c.sizeMap[d]}function da(a,b){if(a.nodeType!=f.Node.ELEMENT_NODE&&(!a.parentNode||a.parentNode.nodeType!=f.Node.ELEMENT_NODE))return null;if(a.nodeType!=f.Node.ELEMENT_NODE)return da(a.parentNode,
b);if(b=="createlink"||b=="unlink"){for(;a&&(!m(a)||a.tagName!="A"||!e(a,"href"));)a=a.parentNode;return!a?null:a.getAttribute("href")}if(b=="backcolor"||b=="hilitecolor"){for(;(f.getComputedStyle(a).backgroundColor=="rgba(0, 0, 0, 0)"||f.getComputedStyle(a).backgroundColor===""||f.getComputedStyle(a).backgroundColor=="transparent")&&a.parentNode&&a.parentNode.nodeType==f.Node.ELEMENT_NODE;)a=a.parentNode;return f.getComputedStyle(a).backgroundColor=="rgba(0, 0, 0, 0)"||f.getComputedStyle(a).backgroundColor===
""||f.getComputedStyle(a).backgroundColor=="transparent"?"rgb(255, 255, 255)":f.getComputedStyle(a).backgroundColor}if(b=="subscript"||b=="superscript"){for(var c=false,j=false;I(a);){f.getComputedStyle(a);d(a,"sub")?c=true:d(a,"sup")&&(j=true);a=a.parentNode}return c&&j?"mixed":c?"subscript":j?"superscript":null}if(b=="strikethrough"){do{if(f.getComputedStyle(a).textDecoration.indexOf("line-through")!=-1)return"line-through";a=a.parentNode}while(a&&a.nodeType==f.Node.ELEMENT_NODE);return null}if(b==
"underline"){do{if(f.getComputedStyle(a).textDecoration.indexOf("underline")!=-1)return"underline";a=a.parentNode}while(a&&a.nodeType==f.Node.ELEMENT_NODE);return null}if(!M[b].hasOwnProperty("relevantCssProperty"))throw"Bug: no relevantCssProperty for "+b+" in getEffectiveCommandValue";return f.getComputedStyle(a)[M[b].relevantCssProperty].toString()}function la(a,b){if((b=="backcolor"||b=="hilitecolor")&&f.getComputedStyle(a).display!="inline")return null;if(b=="createlink"||b=="unlink")return m(a)&&
a.tagName=="A"&&e(a,"href")?a.getAttribute("href"):null;if(b=="subscript"||b=="superscript")return d(a,"sup")?"superscript":d(a,"sub")?"subscript":null;if(b=="strikethrough"&&a.style.textDecoration!="")return a.style.textDecoration.indexOf("line-through")!=-1?"line-through":null;if(b=="strikethrough"&&p(a,["S","STRIKE"]))return"line-through";if(b=="underline"&&a.style.textDecoration!="")return a.style.textDecoration.indexOf("underline")!=-1?"underline":null;if(b=="underline"&&d(a,"U"))return"underline";
var c=M[b].relevantCssProperty;if(c===null)return null;if(a.style[c]!="")return a.style[c];if(k(a.namespaceURI)&&a.tagName=="FONT"){if(c=="color"&&e(a,"color"))return a.color;if(c=="fontFamily"&&e(a,"face"))return a.face;if(c=="fontSize"&&e(a,"size")){c=parseInt(a.size,10);c<1&&(c=1);c>7&&(c=7);return{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[c]}}return c=="fontWeight"&&(a.tagName=="B"||a.tagName=="STRONG")?"bold":c=="fontStyle"&&(a.tagName=="I"||a.tagName==
"EM")?"italic":null}function Ra(a,d,b,c){for(var j=a;Xa(j)&&j.childNodes.length==1&&Xa(j.firstChild)&&(!Na(j)||!Ga(d,la(j,d),b));)j=j.firstChild;if(!(j==a||!Na(j)||!Ga(d,la(j,d),b)||!ua(d,da(j,d),b))){for(;j.hasChildNodes();)qa(j.firstChild,j.parentNode,A(j),c);a.parentNode.insertBefore(j,a.nextSibling);qa(a,j,-1,c)}}function va(a){var d=[],a=b.makeArray(a),c,j,m,e,k,g;for(c=0;c<a.length;c++){m=a[c];for(j=0;j<ub.length;j++){e=ub[j];k=m;if(k.nodeType!=1)k=k.parentNode;for(g=null;k&&k.nodeType==1&&
(g=la(k,e))===null;)k=k.parentNode;d.push([m,e,g])}}return d}function ab(a,b,c){if(!F(a)||la(a,b)===null)return[];if(Na(a)){var b=Array.prototype.slice.call(s(a.childNodes)),j;for(j=0;j<b.length;j++)qa(b[j],a.parentNode,A(a),c);a.parentNode.removeChild(a);return b}if(b=="strikethrough"&&a.style.textDecoration.indexOf("line-through")!=-1){a.style.textDecoration=a.style.textDecoration=="line-through"?"":a.style.textDecoration.replace("line-through","");a.getAttribute("style")==""&&a.removeAttribute("style")}if(b==
"underline"&&a.style.textDecoration.indexOf("underline")!=-1){a.style.textDecoration=a.style.textDecoration=="underline"?"":a.style.textDecoration.replace("underline","");a.getAttribute("style")==""&&a.removeAttribute("style")}if(M[b].relevantCssProperty!==null){a.style[M[b].relevantCssProperty]="";a.getAttribute("style")==""&&a.removeAttribute("style")}if(k(a.namespaceURI)&&a.tagName=="FONT"){b=="forecolor"&&a.removeAttribute("color");b=="fontname"&&a.removeAttribute("face");b=="fontsize"&&a.removeAttribute("size")}d(a,
"A")&&(b=="createlink"||b=="unlink")&&a.removeAttribute("href");return la(a,b)===null?[]:[za(a,"span",c)]}function Pa(a,c,j,m){var e=[],k,g;if(a.parentNode&&j!==null){if(na(a,"span")){Ra(a.previousSibling,c,j,m);Ra(a.nextSibling,c,j,m);wa([a],function(a){return Na(a)&&Ga(c,la(a,c),j)&&ua(c,da(a,c),j)},function(){return null},m)}if(!ua(c,da(a,c),j))if(na(a,"span")){if(!ua(c,da(a,c),j)){e=null;if(!lb){if(c=="bold"&&(j=="bold"||j=="700"))e=a.ownerDocument.createElement("b");c=="italic"&&j=="italic"&&
(e=a.ownerDocument.createElement("i"));c=="strikethrough"&&j=="line-through"&&(e=a.ownerDocument.createElement("s"));c=="underline"&&j=="underline"&&(e=a.ownerDocument.createElement("u"));if(c=="forecolor"&&X(j)){e=a.ownerDocument.createElement("span");b(e).css("color",X(j))}if(c=="fontname"){e=a.ownerDocument.createElement("font");e.face=j}}if(c=="createlink"||c=="unlink"){e=a.ownerDocument.createElement("a");e.setAttribute("href",j);for(k=a.parentNode;k;){d(k,"A")&&(k=za(k,"span",m));k=k.parentNode}}if(c==
"fontsize"&&b.inArray(j,["xx-small","small","medium","large","x-large","xx-large","xxx-large"])!=-1&&(!lb||j=="xxx-large")){e=a.ownerDocument.createElement("font");e.size=C(j)}if((c=="subscript"||c=="superscript")&&j=="subscript")e=a.ownerDocument.createElement("sub");if((c=="subscript"||c=="superscript")&&j=="superscript")e=a.ownerDocument.createElement("sup");e||(e=a.ownerDocument.createElement("span"));a.parentNode.insertBefore(e,a);k=M[c].relevantCssProperty;k!==null&&!ua(c,da(e,c),j)&&(e.style[k]=
j);if(c=="strikethrough"&&j=="line-through"&&da(e,"strikethrough")!="line-through")e.style.textDecoration="line-through";if(c=="underline"&&j=="underline"&&da(e,"underline")!="underline")e.style.textDecoration="underline";qa(a,e,e.childNodes.length,m);if(a.nodeType==f.Node.ELEMENT_NODE&&!Ga(c,da(a,c),j)){qa(a,e.parentNode,A(e),m);e.parentNode.removeChild(e);e=[];for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==f.Node.ELEMENT_NODE){g=la(a.childNodes[k],c);if(g!==null&&!Ga(c,j,g))continue}e.push(a.childNodes[k])}for(k=
0;k<e.length;k++)Pa(e[k],c,j,m)}}}else{for(k=0;k<a.childNodes.length;k++){if(a.childNodes[k].nodeType==f.Node.ELEMENT_NODE){g=la(a.childNodes[k],c);if(g!==null&&!Ga(c,j,g))continue}e.push(a.childNodes[k])}for(k=0;k<e.length;k++)Pa(e[k],c,j,m)}}}function ja(a,d,b,c){if(a.parentNode&&a.parentNode.nodeType==f.Node.ELEMENT_NODE&&!ua(d,da(a,d),b)){for(var j=a.parentNode,e=[];F(j)&&j.nodeType==f.Node.ELEMENT_NODE&&!ua(d,da(j,d),b);){e.push(j);j=j.parentNode}if(e.length){var m=la(e[e.length-1],d);if(!(m===
null&&m!=b)&&(b===null||ua(d,da(e[e.length-1].parentNode,d),b)))for(;e.length;){j=e.pop();la(j,d)!==null&&(m=la(j,d));b=Array.prototype.slice.call(s(j.childNodes));la(j,d)!==null&&ab(j,d,c);for(j=0;j<b.length;j++){var k=b[j];k!=a&&!(k.nodeType==f.Node.ELEMENT_NODE&&la(k,d)!==null&&!Ga(d,m,la(k,d)))&&k!=e[e.length-1]&&Pa(k,d,m,c)}}}}}function La(a,d){f(a).forEach(function(a){var b=a[0],c=a[1],a=a[2],j=b;if(!j||j.nodeType!=f.Node.ELEMENT_NODE)j=j.parentNode;for(;j&&j.nodeType==f.Node.ELEMENT_NODE&&
la(j,c)===null;)j=j.parentNode;a===null&&j&&j.nodeType==f.Node.ELEMENT_NODE?ja(b,c,null,d):(j&&j.nodeType==f.Node.ELEMENT_NODE&&!Ga(c,la(j,c),a)||(!j||j.nodeType!=f.Node.ELEMENT_NODE)&&a!==null)&&Pa(b,c,a,d)})}function oa(a,d,b){b=b||J();if(f(ra(b)).filter(function(a){return a.nodeType==f.Node.TEXT_NODE},true).some(F)){if(F(b.startContainer)&&b.startContainer.nodeType==f.Node.TEXT_NODE&&b.startOffset!=0&&b.startOffset!=E(b.startContainer)){var c=b.startContainer.splitText(b.startOffset),j=l.createRange();
if(b.startContainer==b.endContainer){var e=b.endOffset-b.startOffset;j.setEnd(c,e);b.setEnd(c,e)}j.setStart(c,0);l.getSelection().removeAllRanges();l.getSelection().addRange(j);b.setStart(c,0)}if(F(b.endContainer)&&b.endContainer.nodeType==f.Node.TEXT_NODE&&b.endOffset!=0&&b.endOffset!=E(b.endContainer)){c=b;j=[c.startContainer,c.startOffset];e=[c.endContainer,c.endOffset];c.endContainer.splitText(c.endOffset);c.setStart(j[0],j[1]);c.setEnd(e[0],e[1]);l.getSelection().removeAllRanges();l.getSelection().addRange(c)}f(ra(J(),
function(a){return F(a)&&a.nodeType==f.Node.ELEMENT_NODE})).forEach(function(d){ab(d,a,b)});f(ra(b,F)).forEach(function(c){ja(c,a,d,b);Pa(c,a,d,b)})}else{M[a].hasOwnProperty("inlineCommandActivatedValues")&&ob(a,f(M[a].inlineCommandActivatedValues).indexOf(d)!=-1,b);a=="subscript"&&pb("superscript",b);a=="superscript"&&pb("subscript",b);d===null?vb(a,b):M[a].hasOwnProperty("value")&&sb(a,d,b)}}function T(a,d){var b;if(a.nodeType===f.Node.TEXT_NODE&&d<a.length)for(b=d;b<a.length;b++)if(a.data.charAt(b)!==
"\t"&&a.data.charAt(b)!=="\r"&&a.data.charAt(b)!=="\n"||a.data.charCodeAt(b)===160)return false;if(a.nextSibling&&a.nextSibling.className&&a.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return a.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&a.parentNode.nextSibling.className&&a.parentNode.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return a.parentNode.nextSibling;if(a.parentNode&&a.parentNode.nextSibling&&ka(a.parentNode.nextSibling)&&a.parentNode.nextSibling.nextSibling&&
a.parentNode.nextSibling.nextSibling.className&&a.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return a.parentNode.nextSibling.nextSibling}function R(a,d){var b;if(a.nodeType===f.Node.TEXT_NODE&&d>0)for(b=d-1;b>=0;b--)if(a.data.charAt(b)!=="\t"&&a.data.charAt(b)!=="\r"&&a.data.charAt(b)!=="\n"||a.data.charCodeAt(b)===160)return false;return a.previousSibling&&a.previousSibling.className&&a.previousSibling.className.indexOf("aloha-table-wrapper")>=0?a.previousSibling:
a.parentNode&&a.parentNode.previousSibling&&a.parentNode.previousSibling.className&&a.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")>=0?a.parentNode.previousSibling:a.parentNode&&a.parentNode.previousSibling&&ka(a.parentNode.previousSibling)&&a.parentNode.previousSibling.previousSibling&&a.parentNode.previousSibling.previousSibling.className&&a.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")>=0?a.parentNode.previousSibling.previousSibling:false}
function xa(a,b){return!a.parentNode&&b==0||0<=b-1&&b-1<a.childNodes.length&&ea(a.childNodes[b-1])&&(L(a.childNodes[b-1])||d(a.childNodes[b-1],"br"))}function ga(a,d){return!a.parentNode&&d==E(a)||d<a.childNodes.length&&ea(a.childNodes[d])&&L(a.childNodes[d])}function sa(a){for(var d=0;!xa(a,d)&&!ga(a,d);){if(0<=d-1&&d-1<a.childNodes.length&&ea(a.childNodes[d-1]))return false;if(d==0||!a.hasChildNodes()){d=A(a);a=a.parentNode}else{a=a.childNodes[d-1];d=E(a)}}return true}function Ia(a){for(var d=E(a);!xa(a,
d)&&!ga(a,d);){if(d<a.childNodes.length&&ea(a.childNodes[d]))return false;if(d==E(a)||!a.hasChildNodes()){d=1+A(a);a=a.parentNode}else{a=a.childNodes[d];d=0}}return true}function N(a,c){var j,e=a[0].parentNode;if(F(e)&&e.parentNode){b.inArray(e.firstChild,a)!=-1&&ib(e,c);j=b.inArray(e.firstChild,a)!=-1;var m=b.inArray(e.lastChild,a)!=-1,k=j&&sa(e),f=m&&Ia(e);if(!j&&m){for(j=a.length-1;j>=0;j--)qa(a[j],e.parentNode,1+A(e),c);f&&!Ia(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),
a[a.length-1].nextSibling);Ma(e,c)}else{if(!j){j=e.cloneNode(false);e.removeAttribute("id");for(e.parentNode.insertBefore(j,e);a[0].previousSibling;)qa(e.firstChild,j,j.childNodes.length,c)}for(j=0;j<a.length;j++)qa(a[j],e.parentNode,A(e),c);k&&!sa(a[0])&&a[0].parentNode.insertBefore(document.createElement("br"),a[0]);I(a[a.length-1])&&(!d(a[a.length-1],"br")&&d(e.firstChild,"br")&&!I(e))&&g.removePreservingRange(e.firstChild,c);if(e.hasChildNodes())ib(e,c);else{if(e.parentNode===c.startContainer&&
e.parentNode===c.endContainer&&c.startContainer===c.endContainer&&c.startOffset===c.endOffset&&e.parentNode.childNodes.length===c.startOffset){c.startOffset=e.parentNode.childNodes.length-1;c.endOffset=c.startOffset}g.removePreservingRange(e,c);f&&!Ia(a[a.length-1])&&a[a.length-1].parentNode.insertBefore(document.createElement("br"),a[a.length-1].nextSibling)}!a[a.length-1].nextSibling&&a[a.length-1].parentNode&&Ma(a[a.length-1].parentNode,c)}}}function ia(a){if(!m(a))return false;if(a.tagName=="BLOCKQUOTE")return true;
if(a.tagName!="DIV")return false;if(typeof a.style.length!=="undefined"){var d;for(d=0;d<a.style.length;d++)if(/^(-[a-z]+-)?margin/.test(a.style[d]))return true}else for(d in a.style)if(/^(-[a-z]+-)?margin/.test(d)&&a.style[d]&&a.style[d]!==0)return true;return false}function ba(a){if(!ia(a)||a.tagName!="BLOCKQUOTE"&&a.tagName!="DIV")return false;var d;for(d=0;d<a.attributes.length;d++)if(!k(a.attributes[d].namespaceURI)||b.inArray(a.attributes[d].name,["style","class","dir"])==-1)return false;if(typeof a.style.length!==
"undefined")for(d=0;d<a.style.length;d++){if(!/^(-[a-z]+-)?(margin|border|padding)/.test(a.style[d]))return false}else for(var c in a.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(c)&&a.style[c]&&a.style[c]!==0&&a.style[c]!=="false")return false;return true}function Z(a){return p(a,["address","div","h1","h2","h3","h4","h5","h6","listing","p","pre","xmp"])}function qb(a){return Z(a)||p(a,["li","dt","dd"])}function cb(){return document.createElement("br")}function Ta(a){a&&(P(a)||d(a.lastChild,
"br")||f(a.childNodes).some(ea)||(b.browser.msie?b.browser.msie&&(b.browser.version<=7&&p(a,["p","h1","h2","h3","h4","h5","h6","pre","blockquote"]))&&(a.firstChild||a.appendChild(document.createTextNode("​"))):a.appendChild(cb())))}function Qa(a,c){var e;if(F(a))if(f(v(a)).every(function(d){return!ca(a,d)||!na(a,d)})&&!j(a,db))if(p(a,["dd","dt"]))wa([a],function(a){return d(a,"dl")&&!a.attributes.length},function(){return document.createElement("dl")},c);else{if(ha(a)){a=za(a,db,c);Ta(a);Qa(a,c);
var m=B(a);for(e=0;e<m.length;e++)Qa(m[e],c)}}else{for(var m=va([a]),k;!na(a,a.parentNode);){for(e=a.parentNode.childNodes.length-1;e>=0;--e)if(a.parentNode.childNodes[e].nodeType==3&&a.parentNode.childNodes[e].data.length==0){a.parentNode.removeChild(a.parentNode.childNodes[e]);c.startContainer==a.parentNode&&c.startOffset>e&&c.startOffset--;c.endContainer==a.parentNode&&c.endOffset>e&&c.endOffset--}if(a.parentNode.childNodes.length==1){e=c.startOffset;k=c.endOffset;c.startContainer===a.parentNode&&
c.startOffset>A(a)&&(e=c.startOffset+(b(a).contents().length-1));c.endContainer===a.parentNode&&c.endOffset>A(a)&&(k=c.endOffset+(b(a).contents().length-1));b(a).contents().unwrap();c.startOffset=e;c.endOffset=k;break}else{e=a.parentNode;N([a],c);if(e===a.parentNode){e=c.startOffset;k=c.endOffset;c.startContainer===a.parentNode&&c.startOffset>A(a)&&(e=c.startOffset+(b(a).contents().length-1));c.endContainer===a.parentNode&&c.endOffset>A(a)&&(k=c.endOffset+(b(a).contents().length-1));b(a).contents().unwrap();
c.startOffset=e;c.endOffset=k;break}}}La(m,c)}}function eb(a,b){function c(a){return p(a,["OL","UL"])}if(d(a,"LI")&&F(a)&&F(a.parentNode))for(var j=null;f(a.childNodes).some(c);){var e=a.lastChild;if(p(e,["OL","UL"])||!j&&e.nodeType==f.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(e.data)){j=null;qa(e,a.parentNode,1+A(a),b)}else{if(!j){j=a.ownerDocument.createElement("li");a.parentNode.insertBefore(j,a.nextSibling)}qa(e,j,0,b)}}}function Hb(a,c){p(a,["OL","UL"])&&F(a)&&b(a).children("ol,ul").each(function(a,
b){d(b.previousSibling,"LI")&&qa(b,b.previousSibling,b.previousSibling.childNodes.length,c)})}function pa(a){var b=a.startContainer,c=a.startOffset,j=a.endContainer,a=a.endOffset,e=f(v(b).concat(b)).filter(function(a){return d(a,"li")}).slice(-1);if(e.length){c=A(e[0]);b=e[0].parentNode}if(!xa(b,c)){do if(c==0){c=A(b);b=b.parentNode}else c--;while(!xa(b,c)&&!ga(b,c))}for(;c==0&&b.parentNode;){c=A(b);b=b.parentNode}e=f(v(j).concat(j)).filter(function(a){return d(a,"li")}).slice(-1);if(e.length){a=
1+A(e[0]);j=e[0].parentNode}if(!ga(j,a)){do if(a==E(j)){a=1+A(j);j=j.parentNode}else a++;while(!xa(j,a)&&!ga(j,a))}for(;a==E(j)&&j.parentNode;){a=1+A(j);j=j.parentNode}e=l.createRange();e.setStart(b,c);e.setEnd(j,a);return e}function mb(){var a=pa(J()),b=S(a,function(a){return F(a)&&!ia(a)&&(p(a,["ol","ul"])||p(a.parentNode,["ol","ul"])||na(a,"li"))});if(!b.length)return"none";if(f(b).every(function(a){return d(a,"ol")||d(a.parentNode,"ol")||d(a.parentNode,"li")&&d(a.parentNode.parentNode,"ol")})&&
!f(b).some(function(a){return d(a,"ul")||a.querySelector&&a.querySelector("ul")}))return"ol";if(f(b).every(function(a){return d(a,"ul")||d(a.parentNode,"ul")||d(a.parentNode,"li")&&d(a.parentNode.parentNode,"ul")})&&!f(b).some(function(a){return d(a,"ol")||a.querySelector&&a.querySelector("ol")}))return"ul";a=f(b).some(function(a){return d(a,"ol")||d(a.parentNode,"ol")||a.querySelector&&a.querySelector("ol")||d(a.parentNode,"li")&&d(a.parentNode.parentNode,"ol")});b=f(b).some(function(a){return d(a,
"ul")||d(a.parentNode,"ul")||a.querySelector&&a.querySelector("ul")||d(a.parentNode,"li")&&d(a.parentNode.parentNode,"ul")});return a&&b?"mixed":a?"mixed ol":b?"mixed ul":"none"}function Ca(a){for(;a&&a.nodeType!=f.Node.ELEMENT_NODE||a.nodeType==f.Node.ELEMENT_NODE&&b.inArray(f.getComputedStyle(a).display,["inline","none"])!=-1;)a=a.parentNode;if(!a||a.nodeType!=f.Node.ELEMENT_NODE)return"left";var d=f.getComputedStyle(a).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return d==
"start"?z(a)=="ltr"?"left":"right":d=="end"?z(a)=="ltr"?"right":"left":b.inArray(d,["center","justify","left","right"])!=-1?d:"left"}function Ib(a){var d=[];Oa("createlink",a)!==void 0&&d.push(["createlink",Oa("createlink",a)]);f(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(b){$a(b,a)!==void 0&&d.push([b,$a(b,a)])});f(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(b){Oa(b,a)!==void 0&&d.push([b,Oa(b,a)])});return d}function Jb(a){var d=
[],b=f(ra(a)).filter(function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})[0];if(!b)return d;d.push(["createlink",M.createlink.value(a)]);f(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(a){f(M[a].inlineCommandActivatedValues).indexOf(da(b,a))!=-1?d.push([a,true]):d.push([a,false])});f(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(b){d.push([b,M[b].value(a)])});d.push(["fontsize",da(b,"fontsize")]);return d}function fb(a,d){function b(a){return F(a)&&
a.nodeType==f.Node.TEXT_NODE}var c,j,e,m=f(ra(d)).filter(function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})[0];if(m)for(c=0;c<a.length;c++){j=a[c][0];e=a[c][1];if(typeof e=="boolean"&&W(j,d)!=e)$(j,false,e,d);else if(typeof e=="string"&&j!="fontsize"&&!Ga(j,fa(j,d),e))$(j,false,e,d);else if(typeof e=="string"&&j=="fontsize"&&(Oa("fontsize",d)!==void 0&&Oa("fontsize",d)!==e||Oa("fontsize",d)===void 0&&!ua(j,da(m,"fontsize"),e)))$("fontsize",false,e,d);else continue;m=f(ra(d)).filter(b)[0]||m}else for(c=
0;c<a.length;c++){j=a[c][0];e=a[c][1];typeof e=="boolean"&&ob(j,e,d);typeof e=="string"&&sb(j,e,d)}}function Kb(a,d,b){if(a==0)return"";if(a==1&&!d&&!b)return" ";if(a==1)return" ";var c="",j;for(j=d?"  ":"  ";a>3;){c=c+j;a=a-2}return a==3?c+(!d&&!b?"   ":d&&!b?"   ":!d&&b?"   ":d&&b?"   ":"impossible"):c+(!d&&!b?"  ":d&&!b?"  ":!d&&b?"  ":d&&b?"  ":"impossible")}function Ua(a,d){if(F(a)||P(a)){for(var c=a,j=d;;)if(0<=j-1&&ca(c,c.childNodes[j-1])){c=c.childNodes[j-1];j=E(c)}else if(j==0&&!sa(c)&&ca(c,
c.parentNode)){j=A(c);c=c.parentNode}else if(c.nodeType==f.Node.TEXT_NODE&&b.inArray(f.getComputedStyle(c.parentNode).whiteSpace,["pre","pre-wrap"])==-1&&j!=0&&/[ \xa0]/.test(c.data[j-1]))j--;else break;for(var e=c,m=j,k=0,g=false;;)if(m<e.childNodes.length&&ca(e,e.childNodes[m])){e=e.childNodes[m];m=0}else if(m==E(e)&&!Ia(e)&&ca(e,e.parentNode)){m=1+A(e);e=e.parentNode}else if(e.nodeType==f.Node.TEXT_NODE&&b.inArray(f.getComputedStyle(e.parentNode).whiteSpace,["pre","pre-wrap"])==-1&&m!=E(e)&&/[ \xa0]/.test(e.data[m]))if(g&&
" "==e.data[m])e.deleteData(m,1);else{g=" "==e.data[m];m++;k++}else break;for(k=Kb(k,j==0&&sa(c),m==E(e)&&Ia(e));K(c,j,e,m)=="before";)if(j<c.childNodes.length){c=c.childNodes[j];j=0}else if(c.nodeType!=f.Node.TEXT_NODE||j==E(c)){j=1+A(c);c=c.parentNode}else{g=k[0];k=k.slice(1);if(g!=c.data[j]){c.insertData(j,g);c.deleteData(j+1,1)}j++}}}function ya(a,c,j,e,m,k){var n,q={},r;"array"!==b.type(k)&&(k=k?[k]:[]);if(arguments.length<3)n=a;else{n=l.createRange();n.setStart(a,c);n.setEnd(j,e)}k=k.concat([n]);
arguments.length==2&&(q=c||q);arguments.length==5&&(q=m||q);var o=null!=q.blockMerging?!!q.blockMerging:true,t=null!=q.stripWrappers?!!q.stripWrappers:true;if(n){var v=n.startContainer;r=n.startOffset;for(var B=n.endContainer,C=n.endOffset,z;v.hasChildNodes();)if(r==E(v)&&ca(v,v.parentNode)&&I(v)){r=1+A(v);v=v.parentNode}else{if(r==E(v))break;z=v.childNodes[r];if(L(z)||z.nodeType==f.Node.ELEMENT_NODE&&!z.hasChildNodes()||z.nodeType!=f.Node.ELEMENT_NODE&&z.nodeType!=f.Node.TEXT_NODE)break;v=z;r=0}for(;B.hasChildNodes();)if(C==
0&&ca(B,B.parentNode)&&I(B)){C=A(B);B=B.parentNode}else{if(C==0)break;z=B.childNodes[C-1];if(L(z)||z.nodeType==f.Node.ELEMENT_NODE&&!z.hasChildNodes()||z.nodeType!=f.Node.ELEMENT_NODE&&z.nodeType!=f.Node.TEXT_NODE)break;B=z;C=E(z)}if(K(B,C,v,r)!=="after"){n.setEnd(n.startContainer,n.startOffset);return n}if(v.nodeType==f.Node.TEXT_NODE&&r==0){r=A(v);v=v.parentNode}if(B.nodeType==f.Node.TEXT_NODE&&C==E(B)){C=1+A(B);B=B.parentNode}n.setStart(v,r);n.setEnd(B,C);for(var Z=n.startContainer;ca(Z,Z.parentNode)&&
I(Z);)Z=Z.parentNode;if(!L(Z)&&!P(Z)||!na("span",Z)||p(Z,["td","th"]))Z=null;for(var D=n.endContainer;ca(D,D.parentNode)&&I(D);)D=D.parentNode;if(!L(D)&&!P(D)||!na("span",D)||p(D,["td","th"]))D=null;q=Jb(n);if(v==B&&F(v)&&v.nodeType==f.Node.TEXT_NODE){z=v.parentNode;v.deleteData(r,C-r);r>0&&(v.data.substr(r-1,1)===" "&&r<v.data.length&&v.data.substr(r,1)===" ")&&v.replaceData(r-1,1," ");Ua(v,r);n.setStart(n.startContainer,n.startOffset);n.setEnd(n.startContainer,n.startOffset);fb(q,n);(F(z)||P(z))&&
!I(z)&&Ta(z);return n}F(v)&&v.nodeType==f.Node.TEXT_NODE&&v.deleteData(r,E(v)-r);var U=S(n,function(a){return F(a)&&!p(a,["thead","tbody","tfoot","tr","th","td"])});for(r=0;r<U.length;r++){var y=U[r];z=y.parentNode;g.removePreservingRanges(y,k);if(t||!u(z,v)&&z!=v)for(;F(z)&&I(z)&&E(z)==0;){y=z.parentNode;g.removePreservingRanges(z,k);z=y}(F(z)||P(z))&&!I(z)&&Ta(z)}F(B)&&B.nodeType==f.Node.TEXT_NODE&&B.deleteData(0,C);Ua(n.startContainer,n.startOffset);Ua(n.endContainer,n.endOffset);if(!o||!Z||!D||
!ca(Z,D)||Z==D){n.setEnd(n.startContainer,n.startOffset);D=Z||D;if(Ya(D)){D=Wa(D);n.setStart(D.node,D.offset);n.setEnd(D.node,D.offset)}fb(q,n);return n}Z.children.length==1&&Ha(Z.firstChild)&&g.removePreservingRanges(Z.firstChild,k);D.children.length==1&&Ha(D.firstChild)&&g.removePreservingRanges(D.firstChild,k);if(u(Z,D)){for(z=D;z.parentNode!=Z;)z=z.parentNode;n.setStart(Z,A(z));n.setEnd(Z,A(z));if(!D.hasChildNodes()){for(;F(D)&&D.parentNode.childNodes.length==1&&D.parentNode!=Z;){z=D;g.removePreservingRanges(D,
k);D=z}F(D)&&(!I(D)&&I(D.previousSibling)&&I(D.nextSibling))&&D.parentNode.insertBefore(document.createElement("br"),D.nextSibling);F(D)&&g.removePreservingRanges(D,k);fb(q,n);return n}if(!I(D.firstChild)){fb(q,n);return n}t=[];for(t.push(D.firstChild);!d(t[t.length-1],"br")&&I(t[t.length-1].nextSibling);)t.push(t[t.length-1].nextSibling);for(o=va(t);t[0].parentNode!=Z;)N(t,n);F(t[0].previousSibling)&&d(t[0].previousSibling,"br")&&g.removePreservingRanges(t[0].previousSibling,k)}else if(x(Z,D)){n.setStart(Z,
E(Z));n.setEnd(Z,E(Z));for(z=Z;z.parentNode!=D;)z=z.parentNode;I(z.nextSibling)&&d(Z.lastChild,"br")&&g.removePreservingRanges(Z.lastChild,k);D=[];z.nextSibling&&(!d(z.nextSibling,"br")&&!L(z.nextSibling))&&D.push(z.nextSibling);D.length&&(D[D.length-1].nextSibling&&!d(D[D.length-1].nextSibling,"br")&&!L(D[D.length-1].nextSibling))&&D.push(D[D.length-1].nextSibling);o=va(D);f(D).forEach(function(a){qa(a,Z,-1,n)});d(z.nextSibling,"br")&&g.removePreservingRanges(z.nextSibling,k)}else{n.setStart(Z,E(Z));
n.setEnd(Z,E(Z));I(D.firstChild)&&d(Z.lastChild,"br")&&g.removePreservingRanges(Z.lastChild,k);for(o=va([].slice.call(s(D.childNodes)));D.hasChildNodes();)qa(D.firstChild,Z,-1,n);for(;!D.hasChildNodes();){z=D.parentNode;g.removePreservingRanges(D,k);D=z}}La(o,n);if(Ya(Z)){D=Wa(Z);n.setStart(D.node,D.offset);n.setEnd(D.node,D.offset);Z=D.node}Ta(Z);fb(q,n);return n}}function nb(a,d){a.hasChildNodes()?N([].slice.call(s(a.childNodes)),d):a.parentNode&&a.parentNode.removeChild(a)}function Lb(a,d){a&&
b(a).find("ul,ol,li").each(function(){b(this).contents().each(function(){if(ka(this)){var a=A(this);if(d.startContainer===this.parentNode&&d.startOffset>a)d.startOffset--;else if(d.startContainer===this){d.startContainer=this.parentNode;d.startOffset=a}if(d.endContainer===this.parentNode&&d.endOffset>a)d.endOffset--;else if(d.endContainer===this){d.endContainer=this.parentNode;d.endOffset=a}b(this).remove()}})})}function tb(a,d){if(a.length){var b=a[0];if(p(b.parentNode,["OL","UL"])){var c=b.parentNode.tagName;
wa(a,function(a){return j(a,c)},function(){return b.ownerDocument.createElement(c)},d)}else{var e=wa(a,function(a){return ba(a)},function(){return b.ownerDocument.createElement("blockquote")},d);Qa(e,d)}}}function rb(a,b){if(F(a))if(ba(a))nb(a,b);else if(ia(a)){a.removeAttribute("class");a.removeAttribute("dir");a.style.margin="";a.style.padding="";a.style.border="";a.getAttribute("style")==""&&a.removeAttribute("style");za(a,"div",b)}else{for(var c=a.parentNode,j=[];F(c)&&c.nodeType==f.Node.ELEMENT_NODE&&
!ba(c)&&!p(c,["ol","ul"]);){j.push(c);c=c.parentNode}if(!F(c)||!ba(c)){c=a.parentNode;for(j=[];F(c)&&c.nodeType==f.Node.ELEMENT_NODE&&!ia(c)&&!p(c,["ol","ul"]);){j.push(c);c=c.parentNode}}if(p(a,["OL","UL"])&&(!F(c)||!ia(c))){a.removeAttribute("reversed");a.removeAttribute("start");a.removeAttribute("type");j=[].slice.call(s(a.childNodes));if(a.attributes.length&&!p(a.parentNode,["OL","UL"]))za(a,"div",b);else{var e=va([].slice.call(s(a.childNodes)));nb(a,b);La(e,b)}for(e=0;e<j.length;e++)Qa(j[e],
b)}else if(F(c)&&ia(c)){j.push(c);for(e=c;j.length;){var c=j.pop(),m=a.parentNode==c?a:j[j.length-1];I(m)&&(!d(m,"BR")&&d(m.nextSibling,"BR"))&&m.parentNode.removeChild(m.nextSibling);var k=[].slice.call(s(c.childNodes),0,A(m)),c=[].slice.call(s(c.childNodes),1+A(m));tb(k,b);tb(c,b)}rb(e,b)}}}function wb(a,b){function c(){return document.createElement("li")}function e(a){return p(a,["ol","ul"])}function m(a){return function(d){return j(d,a)}}function k(a){return function(){return document.createElement(a)}}
function g(a,d,b){return function(){if(!F(d[0].parentNode)||!ba(d[0].parentNode)||!F(d[0].parentNode.previousSibling)||!j(d[0].parentNode.previousSibling,a))return document.createElement(a);var c=d[0].parentNode.previousSibling;eb(c.lastChild,b);(!F(c.lastChild)||!j(c.lastChild,a))&&c.appendChild(document.createElement(a));return c.lastChild}}var n=mb()==a?"disable":"enable",a=a.toUpperCase(),q=a=="OL"?"UL":"OL",r=[];(function(){var a;for(a=b.endContainer;a!=b.commonAncestorContainer;a=a.parentNode)d(a,
"li")&&r.unshift(a);for(a=b.startContainer;a;a=a.parentNode)d(a,"li")&&r.unshift(a)})();f(r).forEach(function(a){eb(a,b)});var o=pa(b);n=="enable"&&f(D(o,function(a){return F(a)&&j(a,q)})).forEach(function(d){if(F(d.previousSibling)&&j(d.previousSibling,a)||F(d.nextSibling)&&j(d.nextSibling,a)){var d=[].slice.call(s(d.childNodes)),c=va(d);N(d,b);wa(d,function(d){return j(d,a)},function(){return null},b);La(c,b)}else za(d,a,b)});o=S(o,function(a){return F(a)&&!ia(a)&&(p(a,["OL","UL"])||p(a.parentNode,
["OL","UL"])||na(a,"li"))});n=="enable"&&(o=f(o).filter(function(a){return!p(a,["ol","ul"])||p(a.parentNode,["ol","ul"])}));var x;if(n=="disable")for(;o.length;){n=[];n.push(o.shift());if(j(n[0],a))rb(n[0],b);else{for(;o.length&&o[0]==n[n.length-1].nextSibling&&!j(o[0],a);)n.push(o.shift());x=va(n);N(n,b);var t;for(t=0;t<n.length;t++)Qa(n[t],b);La(x,b)}}else for(;o.length;){for(n=[];!n.length||o.length&&o[0]==n[n.length-1].nextSibling;)if(p(o[0],["p","div"])){n.push(za(o[0],"li",b));o.shift()}else if(p(o[0],
["li","ol","ul"]))n.push(o.shift());else{for(x=[];!x.length||o.length&&o[0]==x[x.length-1].nextSibling&&I(o[0])&&I(x[x.length-1])&&!d(x[x.length-1],"br");)x.push(o.shift());n.push(wa(x,void 0,c,b))}if(!j(n[0].parentNode,a)&&!f(n).every(e))if(j(n[0].parentNode,q)){x=va(n);N(n,b);wa(n,m(a),k(a),b);La(x,b)}else Qa(wa(n,m(a),g(a,n,b),b),b)}}function Da(a,b){function c(a){return function(b){return d(b,"div")&&f(b.attributes).every(function(d){return d.name=="align"&&d.value.toLowerCase()==a||d.name=="style"&&
n(b)==1&&b.style.textAlign==a})}}function j(a){return function(){var d=document.createElement("div");d.setAttribute("style","text-align: "+a);return d}}for(var m=pa(b),k=D(m,function(a){return a.nodeType==f.Node.ELEMENT_NODE&&F(a)&&(e(a,"align")||a.style.textAlign!=""||d(a,"center"))}),m=0;m<k.length;m++){var g=k[m];g.removeAttribute("align");g.style.textAlign="";g.getAttribute("style")==""&&g.removeAttribute("style");p(g,["div","span","center"])&&!g.attributes.length&&nb(g,b);d(g,"center")&&g.attributes.length&&
za(g,"div",b)}m=pa(Ja);k=[];for(k=S(m,function(d){return F(d)&&na(d,"div")&&Ca(d)!=a});k.length;){m=[];for(m.push(k.shift());k.length&&k[0]==m[m.length-1].nextSibling;)m.push(k.shift());wa(m,c(a),j(a),b)}}function xb(a,d){var b;if(a.collapsed){b=a.startOffset;if(d){if(a.startContainer&&a.startContainer.nodeType===f.Node.TEXT_NODE)for(;b<a.startContainer.data.length&&a.startContainer.data.charAt(b)==="​";)b++}else if(a.startContainer&&a.startContainer.nodeType===f.Node.TEXT_NODE)for(;b>0&&a.startContainer.data.charAt(b-
1)==="​";)b--;if(b!==a.startOffset){a.setStart(a.startContainer,b);a.setEnd(a.startContainer,b)}}}var Bb="http://www.w3.org/1999/xhtml",lb=false,Ja=null,M={},$a,ob,Va,pb,Oa,sb,vb,kb=0,aa={ADDRESS:true,ARTICLE:true,ASIDE:true,BLOCKQUOTE:true,CAPTION:true,CENTER:true,COL:true,COLGROUP:true,DD:true,DETAILS:true,DIR:true,DIV:true,DL:true,DT:true,FIELDSET:true,FIGCAPTION:true,FIGURE:true,FOOTER:true,FORM:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,HEADER:true,HGROUP:true,HR:true,LI:true,LISTING:true,
MENU:true,NAV:true,OL:true,P:true,PLAINTEXT:true,PRE:true,SECTION:true,SUMMARY:true,TABLE:true,TBODY:true,TD:true,TFOOT:true,TH:true,THEAD:true,TR:true,UL:true,XMP:true},Cb={inline:true,"inline-block":true,"inline-table":true,none:true};(function(){var d={},b={},c=null;Va=function(j){if(!c||c.startContainer!=j.startContainer||c.endContainer!=j.endContainer||c.startOffset!=j.startOffset||c.endOffset!=j.endOffset){c={startContainer:j.startContainer,endContainer:j.endContainer,startOffset:j.startOffset,
endOffset:j.endOffset};if(!a.isEmpty(d)||!a.isEmpty(b)){d={};b={};return true}}return false};$a=function(a,b){Va(b);return d[a]};ob=function(a,b,c){Va(c);d[a]=b};pb=function(a,b){Va(b);delete d[a]};Oa=function(a,d){Va(d);return b[a]};sb=function(a,d,c){Va(c);b[a]=d;if(a=="backcolor")b.hilitecolor=d;else if(a=="hilitecolor")b.backcolor=d};vb=function(a,d){Va(d);delete b[a];a=="backcolor"?delete b.hilitecolor:a=="hilitecolor"&&delete b.backcolor}})();var Fb={A:true,ABBR:true,B:true,BDI:true,BDO:true,
CITE:true,CODE:true,DFN:true,EM:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,I:true,KBD:true,MARK:true,P:true,PRE:true,Q:true,RP:true,RT:true,RUBY:true,S:true,SAMP:true,SMALL:true,SPAN:true,STRONG:true,SUB:true,SUP:true,U:true,VAR:true,ACRONYM:true,LISTING:true,STRIKE:true,XMP:true,BIG:true,BLINK:true,FONT:true,MARQUEE:true,NOBR:true,TT:true},Db={colgroup:true,table:true,tbody:true,tfoot:true,thead:true,tr:true},Eb={script:true,style:true,plaintext:true,xmp:true},gb=b.extend({H1:true,H2:true,
H3:true,H4:true,H5:true,H6:true},aa),yb={CAPTION:true,COL:true,COLGROUP:true,TBODY:true,TD:true,TFOOT:true,TH:true,THEAD:true,TR:true},zb={DD:true,DT:true},Gb={A:b.extend({A:true},aa),DD:zb,DT:zb,LI:{LI:true},NOBR:b.extend({NOBR:true},aa),H1:gb,H2:gb,H3:gb,H4:gb,H5:gb,H6:gb,TD:yb,TH:yb,ABBR:aa,B:aa,BDI:aa,BDO:aa,CITE:aa,CODE:aa,DFN:aa,EM:aa,I:aa,KBD:aa,MARK:aa,P:aa,PRE:aa,Q:aa,RP:aa,RT:aa,RUBY:aa,S:aa,SAMP:aa,SMALL:aa,SPAN:aa,STRONG:aa,SUB:aa,SUP:aa,U:aa,VAR:aa,ACRONYM:aa,LISTING:aa,STRIKE:aa,XMP:aa,
BIG:aa,BLINK:aa,FONT:aa,MARQUEE:aa,TT:aa},ub=["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"];M.backcolor={action:function(a,d){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||X(a)||a.toLowerCase()=="transparent")&&oa("backcolor",a,d)},standardInlineValueCommand:true,relevantCssProperty:"backgroundColor",equivalentValues:function(a,d){return Y(a)===Y(d)}};M.bold={action:function(a,d){W("bold",d)?oa("bold","normal",
d):oa("bold","bold",d)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(a,d){return a==d||a=="bold"&&d=="700"||a=="700"&&d=="bold"||a=="normal"&&d=="400"||a=="400"&&d=="normal"}};M.createlink={action:function(a,b){if(a!==""){f(ra(J())).forEach(function(b){f(v(b)).forEach(function(b){F(b)&&(d(b,"a")&&e(b,"href"))&&b.setAttribute("href",a)})});oa("createlink",a,b)}},standardInlineValueCommand:true};M.fontname={action:function(a,
d){oa("fontname",a,d)},standardInlineValueCommand:true,relevantCssProperty:"fontFamily"};M.fontsize={action:function(a,d){if(a!==""){a=V(a);(b.inArray(a,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])!=-1||/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(a))&&oa("fontsize",a,d)}},indeterm:function(){return f(ra(J(),function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})).map(function(a){return da(a,"fontsize")},true).filter(function(a,d,b){return f(b.slice(0,d)).indexOf(a)==
-1}).length>=2},value:function(a){var d=ra(a,function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})[0];if(d===void 0)d=a.startContainer;a=da(d,"fontsize");return G(a)},relevantCssProperty:"fontSize"};M.forecolor={action:function(a,d){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||X(a)||a.toLowerCase()=="transparent")&&oa("forecolor",a,d)},standardInlineValueCommand:true,relevantCssProperty:"color",equivalentValues:function(a,d){return Y(a)===Y(d)}};M.hilitecolor={action:function(a,
d){/^([0-9a-fA-F]{3}){1,2}$/.test(a)&&(a="#"+a);(/^(rgba?|hsla?)\(.*\)$/.test(a)||X(a)||a.toLowerCase()=="transparent")&&oa("hilitecolor",a,d)},indeterm:function(){return f(ra(J(),function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})).map(function(a){return da(a,"hilitecolor")},true).filter(function(a,d,b){return f(b.slice(0,d)).indexOf(a)==-1}).length>=2},standardInlineValueCommand:true,relevantCssProperty:"backgroundColor",equivalentValues:function(a,d){return Y(a)===Y(d)}};M.italic={action:function(a,
d){W("italic",d)?oa("italic","normal",d):oa("italic","italic",d)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"};M.removeformat={action:function(a,d){function b(a){return F(a)&&p(a,["abbr","acronym","b","bdi","bdo","big","blink","cite","code","dfn","em","font","i","ins","kbd","mark","nobr","q","s","samp","small","span","strike","strong","sub","sup","tt","u","var"])}var c,j;c=ra(J(),b);f(c).forEach(function(a){for(;a.hasChildNodes();)qa(a.firstChild,a.parentNode,
A(a),J());a.parentNode.removeChild(a)});if(F(J().startContainer)&&J().startContainer.nodeType==f.Node.TEXT_NODE&&J().startOffset!=0&&J().startOffset!=E(J().startContainer))if(J().startContainer==J().endContainer){c=J().endOffset-J().startOffset;j=J().startContainer.splitText(J().startOffset);J().setStart(j,0);J().setEnd(j,c)}else J().setStart(J().startContainer.splitText(J().startOffset),0);if(F(J().endContainer)&&J().endContainer.nodeType==f.Node.TEXT_NODE&&J().endOffset!=0&&J().endOffset!=E(J().endContainer)){j=
[J().startContainer,J().startOffset];c=[J().endContainer,J().endOffset];J().setEnd(document.documentElement,0);c[0].splitText(c[1]);J().setStart(j[0],j[1]);J().setEnd(c[0],c[1])}f(ra(J(),F)).forEach(function(a){for(;b(a.parentNode)&&ca(a.parentNode,a);)N([a],J())});f(["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"]).forEach(function(a){oa(a,null,d)})}};M.strikethrough={action:function(a,d){W("strikethrough",d)?oa("strikethrough",null,d):oa("strikethrough",
"line-through",d)},inlineCommandActivatedValues:["line-through"]};M.subscript={action:function(a,d){var b=W("subscript",d);oa("subscript",null,d);b||oa("subscript","subscript",d)},indeterm:function(){var a=ra(J(),function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE});return f(a).some(function(a){return da(a,"subscript")=="subscript"})&&f(a).some(function(a){return da(a,"subscript")!="subscript"})||f(a).some(function(a){return da(a,"subscript")=="mixed"})},inlineCommandActivatedValues:["subscript"]};
M.superscript={action:function(a,d){var b=W("superscript",d);oa("superscript",null,d);b||oa("superscript","superscript",d)},indeterm:function(){var a=ra(J(),function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE});return f(a).some(function(a){return da(a,"superscript")=="superscript"})&&f(a).some(function(a){return da(a,"superscript")!="superscript"})||f(a).some(function(a){return da(a,"superscript")=="mixed"})},inlineCommandActivatedValues:["superscript"]};M.underline={action:function(a,d){W("underline",
d)?oa("underline",null,d):oa("underline","underline",d)},inlineCommandActivatedValues:["underline"]};M.unlink={action:function(){var a=J(),b=[],c;for(c=a.startContainer;c;c=c.parentNode)d(c,"A")&&e(c,"href")&&b.unshift(c);for(c=a.startContainer;c!=o(a.endContainer);c=q(c))d(c,"A")&&(e(c,"href")&&(y(c,a)||u(c,a.endContainer)||c==a.endContainer))&&b.push(c);for(c=0;c<b.length;c++)ab(b[c],"unlink",a)},standardInlineValueCommand:true};var db="p";M["delete"]={action:function(a,c){var j;b.browser.msie&&
b.browser.version<=7&&xb(c,false);if(c.collapsed){Ua(c.startContainer,c.startOffset);for(var e=c.startContainer,m=c.startOffset,k=j=false;;){if(m>0){j=d(e.childNodes[m-1],"br")||false;k=d(e.childNodes[m-1],"hr")||false}if(m==0&&F(e.previousSibling)&&ma(e.previousSibling))e.parentNode.removeChild(e.previousSibling);else if(0<=m-1&&m-1<e.childNodes.length&&F(e.childNodes[m-1])&&(ma(e.childNodes[m-1])||j||k)){e.removeChild(e.childNodes[m-1]);m--;if(j||k){c.setStart(e,m);c.setEnd(e,m);return}}else if(m==
0&&I(e)||ma(e)){m=A(e);e=e.parentNode}else{if(0<=m-1&&m-1<e.childNodes.length&&F(e.childNodes[m-1])&&d(e.childNodes[m-1],"a")){nb(e.childNodes[m-1],c);return}if(0<=m-1&&m-1<e.childNodes.length&&!L(e.childNodes[m-1])&&!p(e.childNodes[m-1],["br","img"])){e=e.childNodes[m-1];m=E(e)}else break}}if(j=R(e,m))j.parentNode.removeChild(j);else if(e.nodeType==f.Node.TEXT_NODE&&m!=0){c.setStart(e,m-1);c.setEnd(e,m-1);ya(e,m-1,e,m,null,c)}else if(e.nodeType==f.Node.TEXT_NODE&&m==0&&b.browser.msie){m=1;c.setStart(e,
m);c.setEnd(e,m);c.startOffset=0;ya(c)}else if(!I(e))if(0<=m-1&&m-1<e.childNodes.length&&p(e.childNodes[m-1],["br","hr","img"])){c.setStart(e,m);c.setEnd(e,m);ya(c)}else if(p(e,["li","dt","dd"])&&e==e.parentNode.firstChild&&m==0){m=[];for(j=e.parentNode;j;j=j.parentNode)d(j,"li")&&m.unshift(j);for(j=0;j<m.length;j++)eb(m[j],c);j=va([e]);N([e],c);La(j,c);p(e,["dd","dt"])&&f(v(e)).every(function(a){return!ca(e,a)||!na(e,a)})&&(e=za(e,db,c));Qa(e,c);for(j=0;j<m.length;j++)Hb(m[j].parentNode,c)}else{j=
e;for(k=m;;)if(k==0){k=A(j);j=j.parentNode}else if(0<=k-1&&k-1<j.childNodes.length&&F(j.childNodes[k-1])&&ma(j.childNodes[k-1])){j.removeChild(j.childNodes[k-1]);k--}else break;if(m==0&&f(v(e).concat(e)).filter(function(a){return F(a)&&ca(a,e)&&ia(a)}).length){m=l.createRange();m.setStart(e,0);m.setEnd(e,0);m=pa(m);m=S(m,function(a){return F(a)&&!Ka(a)});for(j=0;j<m.length;j++)rb(m[j],c)}else if(!d(j.childNodes[k],"table"))if(0<=k-1&&k-1<j.childNodes.length&&d(j.childNodes[k-1],"table")){c.setStart(j,
k-1);c.setEnd(j,k)}else if(m==0&&(d(j.childNodes[k-1],"hr")||d(j.childNodes[k-1],"br")&&(d(j.childNodes[k-1].previousSibling,"br")||!I(j.childNodes[k-1].previousSibling)))){c.setStart(e,m);c.setEnd(e,m);ya(j,k-1,j,k,null,c)}else{if(p(j.childNodes[k],["li","dt","dd"])&&I(j.childNodes[k].firstChild)&&k!=0){var g=j.childNodes[k-1];I(g.lastChild)&&!d(g.lastChild,"br")&&g.appendChild(document.createElement("br"));I(g.lastChild)&&g.appendChild(document.createElement("br"))}if(p(j.childNodes[k],["li","dt",
"dd"])&&p(j.childNodes[k-1],["li","dt","dd"])){j=j.childNodes[k-1];k=E(j);e=j.nextSibling;m=0}else for(;0<=k-1&&k-1<j.childNodes.length;)if(F(j.childNodes[k-1])&&ma(j.childNodes[k-1])){j.removeChild(j.childNodes[k-1]);k--}else{j=j.childNodes[k-1];k=E(j)}g=l.createRange();g.setStart(j,k);g.setEnd(e,m);ya(g);if(!document.body&&!c.startContainer||!(document.body==c.startContainer||u(document.body,c.startContainer)))if(g.startContainer.hasChildNodes()||g.startContainer.nodeType==f.Node.TEXT_NODE||P(g.startContainer)){c.setStart(g.startContainer,
g.startOffset);c.setEnd(g.startContainer,g.startOffset)}else{c.setStart(g.startContainer.parentNode,A(g.startContainer));c.setEnd(g.startContainer.parentNode,A(g.startContainer))}}}}else ya(c)}};var hb=["address","dd","div","dt","h1","h2","h3","h4","h5","h6","p","pre"];M.formatblock={action:function(a){function c(a){return function(d){return F(d)&&ca(d,a)&&j(d,hb)&&!f(B(d)).some(ha)}}function e(a){return function(d){return j(d,a)&&!d.attributes.length}}function m(){return false}function k(a){return function(){return document.createElement(a)}}
var g;/^<.*>$/.test(a)&&(a=a.slice(1,-1));a=a.toLowerCase();if(!(f(hb).indexOf(a)==-1&&a!="blockquote")){var n=J(),q=pa(n),r=S(q,function(a){return F(a)&&(Z(a)||na(a,"p")||p(a,["dd","dt"]))&&!f(B(a)).some(ha)}),o=va(r);for(g=0;g<r.length;g++)for(var x=r[g];f(v(x)).some(c(x));)N([x],q);for(La(o,q);r.length;){if(qb(r[0])){g=[].slice.call(s(r[0].childNodes));o=va(g);nb(r[0],q);La(o,q);r.shift()}else{g=[];for(g.push(r.shift());r.length&&r[0]==g[g.length-1].nextSibling&&!qb(r[0])&&!d(g[g.length-1],"BR");)g.push(r.shift())}Qa(wa(g,
b.inArray(a,["div","p"])==-1?e(a):m,k(a),q),q)}n.setStart(q.startContainer,q.startOffset);n.setEnd(q.endContainer,q.endOffset)}},indeterm:function(){var a=pa(J()),a=D(a,function(a){return ea(a)&&F(a)&&!a.hasChildNodes()});if(!a.length)return false;var d=null,b;for(b=0;b<a.length;b++){for(var c=a[b];F(c.parentNode)&&ca(c,c.parentNode)&&!j(c,hb);)c=c.parentNode;var e="";if(F(c)&&j(c,hb)&&!f(B(c)).some(ha))e=c.tagName;if(d===null)d=e;else if(d!=e)return true}return false},value:function(){var a=pa(J()),
a=D(a,function(a){return ea(a)&&F(a)&&!a.hasChildNodes()});if(!a.length)return"";for(a=a[0];F(a.parentNode)&&ca(a,a.parentNode)&&!j(a,hb);)a=a.parentNode;return F(a)&&j(a,hb)&&!f(B(a)).some(ha)?a.tagName.toLowerCase():""}};M.forwarddelete={action:function(a,c){b.browser.msie&&b.browser.version<=7&&xb(c,true);if(c.collapsed){Ua(c.startContainer,c.startOffset);for(var j=c.startContainer,e=c.startOffset;;)if(e==E(j)&&F(j.nextSibling)&&ma(j.nextSibling))j.parentNode.removeChild(j.nextSibling);else if(e<
j.childNodes.length&&F(j.childNodes[e])&&ma(j.childNodes[e]))j.removeChild(j.childNodes[e]);else if(e<j.childNodes.length&&Ha(j.childNodes[e]))e++;else if(e==E(j)&&I(j)||ma(j)){e=1+A(j);j=j.parentNode}else if(e<j.childNodes.length&&!L(j.childNodes[e])&&!p(j.childNodes[e],["br","img"])){j=j.childNodes[e];e=0}else break;Ua(c.startContainer,c.startOffset);var m=T(j,e);if(m)m.parentNode.removeChild(m);else if(j.nodeType==f.Node.TEXT_NODE&&e!=E(j)){c.setStart(j,e);c.setEnd(j,e);for(m=e+1;m!=j.length&&
/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(j.data[m]);)m++;ya(j,e,j,m)}else if(!I(j))if(e<j.childNodes.length&&p(j.childNodes[e],["br","hr","img"])){c.setStart(j,e);c.setEnd(j,e);ya(j,e,j,e+1)}else{for(var k=j,m=e;;)if(m==E(k)){m=1+A(k);k=k.parentNode}else if(m<k.childNodes.length&&F(k.childNodes[m])&&ma(k.childNodes[m]))k.removeChild(k.childNodes[m]);else break;if(!d(k.childNodes[m-1],"table"))if(d(k.childNodes[m],"table")){c.setStart(k,m);c.setEnd(k,m+1)}else if(e==E(j)&&p(k.childNodes[m],
["br","hr"])){c.setStart(j,e);c.setEnd(j,e);ya(k,m,k,m+1)}else{for(;m<k.childNodes.length;)if(F(k.childNodes[m])&&ma(k.childNodes[m]))k.removeChild(k.childNodes[m]);else{k=k.childNodes[m];m=0}j=ya(j,e,k,m);c.setStart(j.startContainer,j.startOffset);c.setEnd(j.endContainer,j.endOffset)}}}else ya(c)}};M.indent={action:function(){var a=[],b;for(b=J().endContainer;b!=J().commonAncestorContainer;b=b.parentNode)d(b,"LI")&&a.unshift(b);for(b=J().startContainer;b!=J().commonAncestorContainer;b=b.parentNode)d(b,
"LI")&&a.unshift(b);for(b=J().commonAncestorContainer;b;b=b.parentNode)d(b,"LI")&&a.unshift(b);for(b=0;b<a.length;b++)eb(a[b],J());a=pa(J());b=[];b=S(a,function(a){return F(a)&&(na(a,"div")||na(a,"ol"))});for(b.length&&(d(b[0],"LI")&&p(b[0].parentNode,["OL","UL"])&&d(b[0].previousSibling,"LI"))&&eb(b[0].previousSibling,a);b.length;){var c=[];for(c.push(b.shift());b.length&&b[0]==c[c.length-1].nextSibling;)c.push(b.shift());tb(c,a)}}};M.inserthorizontalrule={action:function(a,d){for(;d.startOffset==
0&&d.startContainer.parentNode;)d.setStart(d.startContainer.parentNode,A(d.startContainer));for(;d.endOffset==E(d.endContainer)&&d.endContainer.parentNode;)d.setEnd(d.endContainer.parentNode,1+A(d.endContainer));ya(d,{blockMerging:false});if(F(J().startContainer)||P(J().startContainer)){if(J().startContainer.nodeType==f.Node.TEXT_NODE&&J().startOffset==0){J().setStart(J().startContainer.parentNode,A(J().startContainer));J().collapse(true)}if(J().startContainer.nodeType==f.Node.TEXT_NODE&&J().startOffset==
E(J().startContainer)){J().setStart(J().startContainer.parentNode,1+A(J().startContainer));J().collapse(true)}var b=document.createElement("hr");d.insertNode(b);Qa(b,d);d.setStart(b.parentNode,1+A(b));d.setEnd(b.parentNode,1+A(b));l.getSelection().removeAllRanges();l.getSelection().addRange(d)}}};M.inserthtml={action:function(a,d){ya(d);if(F(d.startContainer)||P(d.startContainer)){var b=d.createContextualFragment(a),c=b.lastChild;if(c){var j=B(b);L(d.startContainer)&&f(d.startContainer.childNodes).filter(function(a,
d){return F(a)&&Ha(a)&&A(a)>=d.startOffset},true).forEach(function(a){a.parentNode.removeChild(a)});d.insertNode(b);L(d.startContainer)&&Ta(d.startContainer);d.setStart(c.parentNode,1+A(c));d.setEnd(c.parentNode,1+A(c));for(b=0;b<j.length;b++)Qa(j[b],d);O(d)}}}};M.insertimage={action:function(a){if(a!==""){var b=J();ya(b,{stripWrappers:false});if(F(J().startContainer)||P(J().startContainer)){L(b.startContainer)&&(b.startContainer.childNodes.length==1&&d(b.startContainer.firstChild,"br")&&b.startOffset==
0)&&b.startContainer.removeChild(b.startContainer.firstChild);var c=document.createElement("img");c.setAttribute("src",a);b.insertNode(c);b.setStart(c.parentNode,1+A(c));b.setEnd(c.parentNode,1+A(c));l.getSelection().removeAllRanges();l.getSelection().addRange(b);c.removeAttribute("width");c.removeAttribute("height")}}}};M.insertlinebreak={action:function(a,d){ya(d,{stripWrappers:false});if(F(d.startContainer)||P(d.startContainer))if(d.startContainer.nodeType!=f.Node.ELEMENT_NODE||na("br",d.startContainer))if(d.startContainer.nodeType==
f.Node.ELEMENT_NODE||na("br",d.startContainer.parentNode)){var c,j;if(d.startContainer.nodeType==f.Node.TEXT_NODE&&d.startOffset==0){c=d.startContainer.parentNode;j=A(d.startContainer);l.getSelection().collapse(c,j);d.setStart(c,j);d.setEnd(c,j)}if(d.startContainer.nodeType==f.Node.TEXT_NODE&&d.startOffset==E(d.startContainer)){c=d.startContainer.parentNode;j=1+A(d.startContainer);l.getSelection().collapse(c,j);d.setStart(c,j);d.setEnd(c,j)}c=document.createElement("br");d.insertNode(c);l.getSelection().collapse(c.parentNode,
1+A(c));d.setStart(c.parentNode,1+A(c));d.setEnd(c.parentNode,1+A(c));if(ta(c)){d.insertNode(cb());l.getSelection().collapse(c.parentNode,1+A(c));d.setStart(c.parentNode,1+A(c));d.setEnd(c.parentNode,1+A(c))}b.browser.msie&&b.browser.version<8&&c.parentNode.removeAttribute("style")}}};M.insertorderedlist={action:function(a,d){wb("ol",d)},indeterm:function(){return/^mixed( ol)?$/.test(mb())},state:function(){return mb()=="ol"}};var Mb={LI:true,DT:true,DD:true};M.insertparagraph={action:function(a,
b){var c;ya(b);Lb(Ba(b.startContainer),b);if(F(b.startContainer)||P(b.startContainer)){var j=b.startContainer,e=b.startOffset;j.nodeType==f.Node.TEXT_NODE&&(e!=0&&e!=E(j))&&j.splitText(e);if(j.nodeType==f.Node.TEXT_NODE&&e==E(j)){e=1+A(j);j=j.parentNode}if(j.nodeType==f.Node.TEXT_NODE||j.nodeType==f.Node.COMMENT_NODE){e=A(j);j=j.parentNode}l.getSelection().collapse(j,e);b.setStart(j,e);b.setEnd(j,e);for(var m=j;!qb(m)&&F(m.parentNode)&&ca(j,m.parentNode);)m=m.parentNode;if(!F(m)||!ca(m,j)||!qb(m)){var k=
db;c=pa(b);c=S(c,function(a){return na(a,"p")}).slice(0,1);if(!c.length){if(!na(k,b.startContainer))return;m=document.createElement(k);b.insertNode(m);m.appendChild(cb());l.getSelection().collapse(m,0);b.setStart(m,0);b.setEnd(m,0);return}for(;c[c.length-1].nextSibling&&na(c[c.length-1].nextSibling,"p");)c.push(c[c.length-1].nextSibling);m=wa(c,function(){return false},function(){return document.createElement(k)},b)}if(m){var g;if(m.tagName=="ADDRESS"||m.tagName=="LISTING"||m.tagName=="PRE"){var n=
document.createElement("br");c=m.offsetHeight;b.insertNode(n);g=m.offsetHeight;l.getSelection().collapse(j,e+1);b.setStart(j,e+1);b.setEnd(j,e+1);if(c==g&&!x(q(n),m)){b.insertNode(cb());l.getSelection().collapse(j,e+1);b.setEnd(j,e+1)}}else if(Mb[m.tagName]&&(!m.hasChildNodes()||m.childNodes.length==1&&d(m.firstChild,"br"))){N([m],b);p(m,["dd","dt"])&&f(v(m)).every(function(a){return!ca(m,a)||!na(m,a)})&&(m=za(m,db,b));Qa(m,b);if(d(m,"li")&&d(m.nextSibling,"li")&&p(m.nextSibling.firstChild,["ol",
"ul"])){j=m.nextSibling;e=m.nextSibling.childNodes.length;for(c=0;c<e;c++)m.appendChild(j.childNodes[0]);j.parentNode.removeChild(j)}}else{e=l.createRange();e.setStart(b.startContainer,b.startOffset);for(e.setEnd(m,E(m));e.startOffset==0&&e.startContainer!=m;)e.setStart(e.startContainer.parentNode,A(e.startContainer));for(;e.startOffset==E(e.startContainer)&&e.startContainer!=m;)e.setStart(e.startContainer.parentNode,1+A(e.startContainer));j=S(e);j=!j.length||j.length==1&&d(j[0],"br");j=/^H[1-6]$/.test(m.tagName)&&
j?db:m.tagName=="DT"&&j?"dd":m.tagName=="DD"&&j?"dt":m.tagName.toLowerCase();j=document.createElement(j);Sa(m,j);j.removeAttribute("id");m.parentNode.insertBefore(j,m.nextSibling);g=D(e);e=e.extractContents();n=B(e);for(c=0;c<n.length;c++)n[c].nodeType==f.Node.ELEMENT_NODE&&f(g).indexOf(n[c])==-1&&n[c].removeAttribute("id");c=[];if(g=e.firstChild){do ka(g)||c.push(g);while(null!=(g=g.nextSibling))}if(d(j,"li")&&c.length&&p(c[0],["ul","ol"])){c=j.offsetHeight;n=cb();j.appendChild(n);g=j.offsetHeight;
c!==g&&j.removeChild(n)}j.appendChild(e);Ta(m);Ta(j);l.getSelection().collapse(j,0);b.setStart(j,0);b.setEnd(j,0)}}}}};M.inserttext={action:function(a,d){var c;ya(d,{stripWrappers:false});if(F(d.startContainer)||P(d.startContainer))if(a.length>1)for(c=0;c<a.length;c++)M.inserttext.action(a[c],d);else if(a!="")if(a=="\n")M.insertparagraph.action("",d);else{c=d.startContainer;var j=d.startOffset;if(0<=j-1&&j-1<c.childNodes.length&&c.childNodes[j-1].nodeType==f.Node.TEXT_NODE){c=c.childNodes[j-1];j=
E(c)}if(0<=j&&j<c.childNodes.length&&c.childNodes[j].nodeType==f.Node.TEXT_NODE){c=c.childNodes[j];j=0}var e=c.nodeType==f.Node.ELEMENT_NODE?c:c.parentNode;a==" "&&(e.nodeType==f.Node.ELEMENT_NODE&&b.inArray(f.getComputedStyle(e).whiteSpace,["pre","pre-wrap"])==-1)&&(a=" ");e=Ib(d);if(c.nodeType==f.Node.TEXT_NODE){c.insertData(j,a);l.getSelection().collapse(c,j);d.setStart(c,j);l.getSelection().extend(c,j+1);d.setEnd(c,j+1)}else{c.childNodes.length==1&&ta(c.firstChild)&&c.removeChild(c.firstChild);
c=document.createTextNode(a);d.insertNode(c);l.getSelection().collapse(c,0);d.setStart(c,0);l.getSelection().extend(c,1);d.setEnd(c,1)}fb(e,d);Ua(d.startContainer,d.startOffset);Ua(d.endContainer,d.endOffset);l.getSelection().collapseToEnd();d.collapse(false)}}};M.insertunorderedlist={action:function(a,d){wb("ul",d)},indeterm:function(){return/^mixed( ul)?$/.test(mb())},state:function(){return mb()=="ul"}};M.justifycenter={action:function(a,d){Da("center",d)},indeterm:function(){var a=D(pa(J()),function(a){return F(a)&&
ea(a)&&!a.hasChildNodes()});return f(a).some(function(a){return Ca(a)=="center"})&&f(a).some(function(a){return Ca(a)!="center"})},state:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&f(a).every(function(a){return Ca(a)=="center"})},value:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Ca(a[0]):"left"}};M.justifyfull={action:function(a,d){Da("justify",d)},indeterm:function(){var a=D(pa(J()),function(a){return F(a)&&
ea(a)&&!a.hasChildNodes()});return f(a).some(function(a){return Ca(a)=="justify"})&&f(a).some(function(a){return Ca(a)!="justify"})},state:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&f(a).every(function(a){return Ca(a)=="justify"})},value:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Ca(a[0]):"left"}};M.justifyleft={action:function(a,d){Da("left",d)},indeterm:function(){var a=D(pa(J()),function(a){return F(a)&&
ea(a)&&!a.hasChildNodes()});return f(a).some(function(a){return Ca(a)=="left"})&&f(a).some(function(a){return Ca(a)!="left"})},state:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&f(a).every(function(a){return Ca(a)=="left"})},value:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Ca(a[0]):"left"}};M.justifyright={action:function(a,d){Da("right",d)},indeterm:function(){var a=D(pa(J()),function(a){return F(a)&&
ea(a)&&!a.hasChildNodes()});return f(a).some(function(a){return Ca(a)=="right"})&&f(a).some(function(a){return Ca(a)!="right"})},state:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length&&f(a).every(function(a){return Ca(a)=="right"})},value:function(){var a=D(pa(J()),function(a){return F(a)&&ea(a)&&!a.hasChildNodes()});return a.length?Ca(a[0]):"left"}};M.outdent={action:function(){var a=[];(function(){var b;for(b=J().endContainer;b!=J().commonAncestorContainer;b=
b.parentNode)d(b,"li")&&a.unshift(b);for(b=J().startContainer;b;b=b.parentNode)d(b,"li")&&a.unshift(b)})();f(a).forEach(function(a){eb(a,J())});for(var b=pa(J()),c=S(b,function(a){return F(a)&&(!f(B(a)).some(F)||p(a,["ol","ul"])||d(a,"li")&&p(a.parentNode,["ol","ul"]))});c.length;){for(;c.length&&(p(c[0],["OL","UL"])||!p(c[0].parentNode,["OL","UL"]));)rb(c.shift(),b);if(!c.length)break;var j=[];for(j.push(c.shift());c.length&&c[0]==j[j.length-1].nextSibling&&!p(c[0],["OL","UL"]);)j.push(c.shift());
var e=va(j);N(j,b);f(j).forEach(Qa);La(e,b)}}};M.selectall={action:function(){var a=document.body;if(!a)a=document.documentElement;a?l.getSelection().selectAllChildren(a):l.getSelection().removeAllRanges()}};M.stylewithcss={action:function(a){lb=(""+a).toLowerCase()!="false"},state:function(){return lb}};M.usecss={action:function(a){lb=(""+a).toLowerCase()=="false"}};(function(){var a=[],d;for(d in M)M.hasOwnProperty(d)&&a.push(d);f(a).forEach(function(a){if(null==M[a].relevantCssProperty)M[a].relevantCssProperty=
null;if(null!=M[a].inlineCommandActivatedValues&&null==M[a].indeterm)M[a].indeterm=function(d){var d=f(ra(d,function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})).map(function(d){return da(d,a)}),b=f(d).filter(function(d){return f(M[a].inlineCommandActivatedValues).indexOf(d)!=-1});return b.length>=1&&d.length-b.length>=1};if(null!=M[a].inlineCommandActivatedValues)M[a].state=function(d){var b=ra(d,function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE});return b.length==0?f(M[a].inlineCommandActivatedValues).indexOf(da(d.startContainer,
a))!=-1:f(b).every(function(d){return f(M[a].inlineCommandActivatedValues).indexOf(da(d,a))!=-1})};if(null!=M[a].standardInlineValueCommand){M[a].indeterm=function(){var d=f(ra(J())).filter(function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE},true).map(function(d){return da(d,a)}),b;for(b=1;b<d.length;b++)if(d[b]!=d[b-1])return true;return false};M[a].value=function(d){var b=ra(d,function(a){return F(a)&&a.nodeType==f.Node.TEXT_NODE})[0];if(typeof b=="undefined")b=d.startContainer;return da(b,a)}}})})();
return{commands:M,execCommand:$,queryCommandIndeterm:function(a,d){a=a.toLowerCase();return Q(a,"indeterm",d,function(a){return function(){return!H(a,d)?false:M[a].indeterm(d)}}(a))},queryCommandState:W,queryCommandValue:fa,queryCommandEnabled:H,queryCommandSupported:function(a){a=a.toLowerCase();return M.hasOwnProperty(a)},copyAttributes:Sa,createEndBreak:cb,isEndBreak:function(a){return d(a,"br")&&a.parentNode.lastChild===a},ensureContainerEditable:Ta,isEditingHost:P,isEditable:F,getStateOverride:$a,
setStateOverride:ob,resetOverrides:Va,unsetStateOverride:pb,deleteContents:ya}});define("aloha/selection","aloha/core jquery util/class util/range util/arrays util/strings aloha/console PubSub aloha/engine aloha/ecma5shims aloha/rangy-core".split(" "),function(l,f,a,g,c,b,e,k,j,m){function d(a,d){var b=l.activeEditable?l.activeEditable.obj.parent()[0]:null,b=f(a).parentsUntil(b).get(),j;j=[];var e,m,k;1===a.nodeType&&a.nodeName!=="BODY"&&a.nodeName!=="HTML"?j.push(a.cloneNode(false).outerHTML):j.push("#"+
a.nodeType);k=0;for(m=b.length;k<m;k++){e=b[k];if(e.nodeName==="BODY"||e.nodeName==="HTML")break;j.push(e.cloneNode(false).outerHTML)}j=j.join("");return d&&a===d.node&&c.equal(d.parents,b)&&j===d.html?null:{node:a,parents:b,html:j}}function p(a){var d;if(f.browser.msie&&a.startContainer===a.endContainer&&a.startOffset===a.endOffset&&a.startContainer.nodeType==3&&a.startOffset==a.startContainer.data.length&&a.startContainer.nextSibling){d=a.startContainer.nextSibling;if("OL"===d.nodeName||"UL"===
d.nodeName)a.startContainer.data[a.startContainer.data.length-1]==" "?a.startOffset=a.endOffset=a.startOffset-1:a.startContainer.data=a.startContainer.data+" "}}var n=window.GENTICS,s=null,o=null,g=a.extend({_constructor:function(){this.rangeObject={};this.preventSelectionChangedFlag=false;this.tagHierarchy={textNode:{},abbr:{textNode:true},b:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,q:true,code:true,abbr:true,strong:true},
pre:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,q:true,code:true,abbr:true},blockquote:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true,cite:true,q:true,code:true,abbr:true,p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true},ins:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,u:true,p:true,h1:true,h2:true,h3:true,
h4:true,h5:true,h6:true},ul:{li:true},ol:{li:true},li:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,ul:true,ol:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,del:true,ins:true,u:true,a:true},td:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,ul:true,ol:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,del:true,ins:true,u:true,a:true,table:true},tr:{td:true,th:true},table:{tr:true,table:true},div:{textNode:true,b:true,i:true,
em:true,sup:true,sub:true,br:true,span:true,img:true,ul:true,ol:true,table:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,del:true,ins:true,u:true,p:true,div:true,pre:true,blockquote:true,a:true},h1:{textNode:true,b:true,i:true,em:true,sup:true,sub:true,br:true,span:true,img:true,a:true,del:true,ins:true,u:true}};this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,strong:this.tagHierarchy.b,
code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,li:this.tagHierarchy.li,td:this.tagHierarchy.td,div:this.tagHierarchy.div,h1:this.tagHierarchy.h1,
h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.table};this.replacingElements={h1:{p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,pre:true,blockquote:true}};this.replacingElements={h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,p:this.replacingElements.h1,
blockquote:this.replacingElements.h1};this.allowedToStealElements={h1:{textNode:true}};this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={};this.selection=void 0;this.children=[]},onChange:function(a,d,b){this.updateSelectionTimeout&&window.clearTimeout(this.updateSelectionTimeout);
var c=this;this.updateSelectionTimeout=window.setTimeout(function(){var j=new l.Selection.SelectionRange(true);if(!j.startContainer||"HTML"===j.startContainer.nodeName||"BODY"===j.startContainer.nodeName){if(!this.updateSelectionTimeout)c.onChange(a,d,10+(b||5)*2)}else l.Selection._updateSelection(d,j)},b||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=true},isSelectionChangedPrevented:function(){var a=this.preventSelectionChangedFlag;this.preventSelectionChangedFlag=false;
return a},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&f(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var a=f(l.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return a!=="undefined"&&a==="true"?true:false},updateSelection:function(a){return this._updateSelection(a,null)},_updateSelection:function(a,b){if(a&&a.originalEvent&&true===a.originalEvent.stopSelectionUpdate||typeof b===
"undefined")return false;this.rangeObject=b=b||new l.Selection.SelectionRange(true);b.update();if(b&&(b.startContainer&&b.endContainer)&&f(b.commonAncestorContainer).closest(".aloha-editable").length>0){var c=!(3===b.startContainer.nodeType&&!f(b.startContainer.parentNode).contentEditable()),j=!(3===b.endContainer.nodeType&&!f(b.endContainer.parentNode).contentEditable());if(!c||!j){l.getSelection().removeAllRanges();return true}}if(this.isSelectionChangedPrevented())return true;l.trigger("aloha-selection-changed-before",
[this.rangeObject,a]);l.trigger("aloha-selection-changed",[this.rangeObject,a]);var c=this.rangeObject,m=c.startContainer,j=c.endContainer;if(!m||!j)e.warn("aloha/selection","encountered range object without start or end container");else{m=d(m,s);j=d(j,o);if(m||j){s=m;o=j;k.pub("aloha.selection.context-change",{range:c,event:a})}}l.trigger("aloha-selection-changed-after",[this.rangeObject,a]);return true},getSelectionTree:function(a){if(!a)return this.rangeObject.getSelectionTree();if(!a.commonAncestorContainer){l.Log.error(this,
"the rangeObject is missing the commonAncestorContainer");return false}this.inselection=false;if(n.Utils.Dom.doCleanup({merge:true},a)){a.update();a.select()}return this.recursiveGetSelectionTree(a,a.commonAncestorContainer)},recursiveGetSelectionTree:function(a,d){var b=0,c=this,j=[];f(d).contents().each(function(e){var m="none",k=false,g=false,f=false,p=false,n=false,q=false;if(a.isCollapsed()&&d===a.startContainer&&a.startOffset==e){j[b]=new l.Selection.SelectionTree;j[b].selection="collapsed";
j[b].domobj=void 0;c.inselection=false;f=true;b++}if(!c.inselection&&!f){var o;try{o=this.nodeType}catch(s){return}switch(o){case 3:if(this===a.startContainer){c.inselection=true;m=a.startOffset>0?"partial":"full";k=a.startOffset;g=this.length}break;case 1:if(this===a.startContainer&&a.startOffset===0){c.inselection=true;m="full"}if(d===a.startContainer&&a.startOffset===e){c.inselection=true;m="full"}}}if(c.inselection&&!f){m=="none"&&(m="full");switch(this.nodeType){case 3:if(this===a.endContainer){c.inselection=
false;a.endOffset<this.length&&(m="partial");k===false&&(k=0);g=a.endOffset}break;case 1:if(this===a.endContainer&&a.endOffset===0)c.inselection=false}if(d===a.endContainer&&a.endOffset<=e){c.inselection=false;m="none"}}j[b]=new l.Selection.SelectionTree;j[b].domobj=this;j[b].selection=m;if(m=="partial"){j[b].startOffset=k;j[b].endOffset=g}j[b].children=c.recursiveGetSelectionTree(a,this);m=j[b].children.length;if(m>0){for(e=0;e<m;++e)switch(j[b].children[e].selection){case "none":p=true;break;case "full":q=
true;break;case "partial":n=true}if(n||q&&p)j[b].selection="partial";else if(q&&!n&&!p)j[b].selection="full"}b++});if(a.isCollapsed()&&d===a.startContainer&&a.startOffset==d.childNodes.length){j[b]=new l.Selection.SelectionTree;j[b].selection="collapsed";j[b].domobj=void 0}return j},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(a,d,b,c,j){var e=this,a=f(!d?a.startContainer:a.endContainer).parents(),m=false,k=-1;typeof c!=="undefined"&&typeof c!=="function"&&
l.Log.error(this,"parameter tagComparator is not a function");typeof c==="undefined"&&(c=function(a,d){return e.standardTextLevelSemanticsComparator(a,d)});a.length>0&&a.each(function(){if(this===j){l.Log.debug(e,"reached limit dom obj");return false}if(c(this,b)){m===false&&(m=[]);l.Log.debug(e,"reached object equal to markup");k++;m[k]=this;return true}});return m},standardSectionsAndGroupingContentComparator:function(a,d){if(a.nodeType!==1){l.Log.debug(this,"only element nodes (nodeType == 1) can be compared");
return false}if(!d[0].nodeName)return false;var b=l.Selection.replacingElements[a.nodeName.toLowerCase()];return b&&b[d[0].nodeName.toLowerCase()]},standardTagNameComparator:function(a,d){if(a.nodeType===1)return a.nodeName!=d[0].nodeName?false:true;l.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return false},standardTextLevelSemanticsComparator:function(a,d){if(a.nodeType===1)return a.nodeName!=d[0].nodeName||!this.standardAttributesComparator(a,d)?false:true;l.Log.debug(this,
"only element nodes (nodeType == 1) can be compared");return false},standardAttributesComparator:function(a,d){var j=b.words(a&&a.className||""),e=b.words(d.length&&d[0].className||"");c.sortUnique(j);c.sortUnique(e);return c.equal(j,e)},changeMarkup:function(a,d,b){var c=d[0].tagName.toLowerCase(),e,k,g=this.isRangeObjectWithinMarkup(a,false,d,b,e),p=this.isRangeObjectWithinMarkup(a,true,d,b,e),n,q,o,s;if(this.replacingElements[c]){k=a;a=new this.SelectionRange(a);c=l.activeEditable?l.activeEditable.obj.get(0):
f("body");a.update(c);d.isReplacingElement=true}else if(a.isCollapsed()){l.Log.debug(this,"early returning from applying markup because nothing is currently selected");return false}e=l.activeEditable?l.activeEditable.obj[0]:f("body");if(!d.isReplacingElement&&a.startOffset===0&&null!=(o=this.getTextNodeSibling(false,a.commonAncestorContainer.parentNode,a.startContainer)))s=this.isRangeObjectWithinMarkup({startContainer:o,startOffset:0},false,d,b,e);if(!d.isReplacingElement&&a.endOffset===a.endContainer.length&&
null!=(n=this.getTextNodeSibling(true,a.commonAncestorContainer.parentNode,a.endContainer)))q=this.isRangeObjectWithinMarkup({startContainer:n,startOffset:0},false,d,b,e);if(!d.isReplacingElement&&g&&!p){l.Log.info(this,"markup 2 non-markup");this.prepareForRemoval(a.getSelectionTree(),d,b);f(g).addClass("preparedForRemoval");this.insertCroppedMarkups(g,a,false,b)}else if(!d.isReplacingElement&&g&&p){l.Log.info(this,"markup 2 markup");this.prepareForRemoval(a.getSelectionTree(),d,b);this.splitRelevantMarkupObject(g,
p,a,b)}else if(!d.isReplacingElement&&(!g&&p||q||s)){l.Log.info(this,"non-markup 2 markup OR with next2markup");if(s&&q){g=new l.Selection.SelectionRange(a);g.startContainer=f(s[s.length-1]).textNodes()[0];g.startOffset=0;g.endContainer=f(q[q.length-1]).textNodes().last()[0];g.endOffset=g.endContainer.length;g.update();this.applyMarkup(g.getSelectionTree(),a,d,b);l.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")}else if(s&&!q&&!p){this.extendExistingMarkupWithSelection(s,
a,false,b);l.Log.info(this,"extending previous markup")}else if(s&&!q&&p){g=new l.Selection.SelectionRange(a);g.startContainer=f(s[s.length-1]).textNodes()[0];g.startOffset=0;g.endContainer=f(p[p.length-1]).textNodes().last()[0];g.endOffset=g.endContainer.length;g.update();this.applyMarkup(g.getSelectionTree(),a,d,b);l.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")}else if(!s&&q){this.extendExistingMarkupWithSelection(q,a,true,b);l.Log.info(this,
"extending following markup backwards")}else this.extendExistingMarkupWithSelection(p,a,true,b)}else if(d.isReplacingElement||!g&&!p&&!s&&!q){l.Log.info(this,"non-markup 2 non-markup");if(a.startContainer!==a.endContainer)p=false;else if(a.startContainer.nodeType!=1)p=false;else{p=a.startContainer.firstChild;p=!p||!p.nextSibling&&p.nodeName=="BR"}if(p){d=d.clone();b=a.startContainer!==a.endContainer?false:a.startContainer.nodeType!=1?false:j.isEndBreak(a.startContainer);b&&d[0].appendChild(j.createEndBreak());
l.activeEditable&&f.browser.mozilla&&l.activeEditable.obj.focus();if(j.isEditable(a.startContainer)){j.copyAttributes(a.startContainer,d[0]);f(a.startContainer).after(d[0]).remove()}else if(j.isEditingHost(a.startContainer)){f(a.startContainer).append(d[0]);j.ensureContainerEditable(d[0])}k.startContainer=d[0];k.endContainer=d[0];k.startOffset=0;k.endOffset=0;return}this.applyMarkup(a.getSelectionTree(),a,d,b,{setRangeObject2NewMarkup:true});k.startContainer=a.startContainer;k.endContainer=a.endContainer;
k.startOffset=a.startOffset;k.endOffset=a.endOffset}if(d.isReplacingElement){if(k&&k.startContainer.className&&k.startContainer.className.indexOf("preparedForRemoval")>-1){b=f(k.startContainer).parents(d[0].tagName).get(0);k.startContainer=b;a.startContainer=b}if(k&&k.endContainer.className&&k.endContainer.className.indexOf("preparedForRemoval")>-1){b=f(k.endContainer).parents(d[0].tagName).get(0);k.endContainer=b;a.endContainer=b}}f(".preparedForRemoval").zap();if(d.isReplacingElement){if(m.Node.ELEMENT_NODE===
k.startContainer.nodeType&&k.startContainer.childNodes&&k.startContainer.childNodes.length<k.startOffset){k.startOffset=k.startContainer.childNodes.length;a.startOffset=k.startContainer.childNodes.length}if(m.Node.ELEMENT_NODE===k.endContainer.nodeType&&k.endContainer.childNodes&&k.endContainer.childNodes.length<k.endOffset){k.endOffset=k.endContainer.childNodes.length;a.endOffset=k.endContainer.childNodes.length}a.endContainer=k.endContainer;a.endOffset=k.endOffset;a.startContainer=k.startContainer;
a.startOffset=k.startOffset;k.update();k.select()}else{a.update();a.select()}},areMarkupObjectsAsLongAsRangeObject:function(a,d,b){var c,j,e;if(b.startOffset!==0)return false;c=0;for(e=a.length;c<e;c++){j=f(a[c]);if(j.textNodes().first()[0]!==b.startContainer)return false}c=0;for(a=d.length;c<a;c++){j=f(d[c]);j=j.textNodes().last()[0];if(j!==b.endContainer||j.length!=b.endOffset)return false}return true},splitRelevantMarkupObject:function(a,d,b,c){f(a).addClass("preparedForRemoval");f(d).addClass("preparedForRemoval");
if(this.areMarkupObjectsAsLongAsRangeObject(a,d,b))return true;var j=this.intersectRelevantMarkupObjects(a,d);if(j){this.insertCroppedMarkups([j],b,false,c);this.insertCroppedMarkups([j],b,true,c)}else{this.insertCroppedMarkups(a,b,false,c);this.insertCroppedMarkups(d,b,true,c)}return true},intersectRelevantMarkupObjects:function(a,d){var b=false,c,j,e,m,k,g;if(!a||!d)return b;k=a.length;g=d.length;for(c=0;c<k;c++){j=a[c];for(e=0;e<g;e++){m=d[e];j===m&&(b=j)}}return b},extendExistingMarkupWithSelection:function(a,
d,b,c){var j,e,m,k,g,p,n;b||(j=true);b&&(e=true);b=[];m=0;for(k=a.length;m<k;m++){b[m]=new this.SelectionRange;g=a[m];if(e&&!j){b[m].startContainer=d.startContainer;b[m].startOffset=d.startOffset;p=f(g).textNodes(true);n=p.length-1;b[m].endContainer=p[n];b[m].endOffset=p[n].length;b[m].update();this.applyMarkup(b[m].getSelectionTree(),d,this.getClonedMarkup4Wrapping(g),c,{setRangeObject2NewMarkup:true})}if(!e&&j){p=f(g).textNodes(true);b[m].startContainer=p[0];b[m].startOffset=0;b[m].endContainer=
d.endContainer;b[m].endOffset=d.endOffset;b[m].update();this.applyMarkup(b[m].getSelectionTree(),d,this.getClonedMarkup4Wrapping(g),c,{setRangeObject2NewMarkup:true})}}return true},getClonedMarkup4Wrapping:function(a){a=f(a.outerHTML).removeClass("preparedForRemoval").empty();a.attr("class").length===0&&a.removeAttr("class");return a},insertCroppedMarkups:function(a,d,b,c){var j,e,m,k,g;b?e=true:j=true;b=[];for(k=0;k<a.length;k++){b[k]=new this.SelectionRange;g=a[k];if(j&&!e){m=f(g).textNodes(true);
b[k].startContainer=m[0];b[k].startOffset=0;if(b[k].startContainer===d.startContainer&&b[k].startOffset===d.startOffset)continue;if(d.startOffset===0){b[k].endContainer=this.getTextNodeSibling(false,g,d.startContainer);b[k].endOffset=b[k].endContainer.length}else{b[k].endContainer=d.startContainer;b[k].endOffset=d.startOffset}b[k].update();this.applyMarkup(b[k].getSelectionTree(),d,this.getClonedMarkup4Wrapping(g),c,{setRangeObject2NextSibling:true})}if(!j&&e){b[k].startContainer=d.endContainer;b[k].startOffset=
d.endOffset;m=f(g).textNodes(true);b[k].endContainer=m[m.length-1];b[k].endOffset=m[m.length-1].length;b[k].update();this.applyMarkup(b[k].getSelectionTree(),d,this.getClonedMarkup4Wrapping(g),c,{setRangeObject2PreviousSibling:true})}}return true},changeMarkupOnSelection:function(a){var d=this.getRangeObject();this.changeMarkup(d,a,this.getStandardTagComparator(a));n.Utils.Dom.doCleanup({merge:true},d);d.update();d.select();this.rangeObject=d},applyMarkup:function(a,d,b,c,j){var e,m,j=j||{};this.prepareForRemoval(a,
b,c);a=this.optimizeSelectionTree4Markup(a,b,c);for(e=0;e<a.length;e++){m=a[e];if(m.wrappable)this.wrapMarkupAroundSelectionTree(m.elements,d,b,c,j);else{l.Log.debug(this,"dive further into non-wrappable object");this.applyMarkup(m.element.children,d,b,c,j)}}},getMarkupType:function(a){var d=f(a)[0].nodeName.toLowerCase();a.outerHtml&&l.Log.debug(this,"Node name detected: "+d+" for: "+a.outerHtml());if(d=="#text")return"textNode";if(this.replacingElements[d])return"sectionOrGroupingContent";if(this.tagHierarchy[d])return"textLevelSemantics";
l.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+a.outerHtml())},getStandardTagComparator:function(a){var d=this;switch(this.getMarkupType(a)){case "textNode":a=function(){return false};break;case "sectionOrGroupingContent":a=function(a,b){return d.standardSectionsAndGroupingContentComparator(a,b)};break;default:a=function(a,b){return d.standardTextLevelSemanticsComparator(a,b)}}return a},prepareForRemoval:function(a,d,b){var c,j;typeof b!=="undefined"&&typeof b!=="function"&&
l.Log.error(this,"parameter tagComparator is not a function");typeof b==="undefined"&&(b=this.getStandardTagComparator(d));for(c=0;c<a.length;c++){j=a[c];if(j.domobj&&(j.selection=="full"||j.selection=="partial"&&d.isReplacingElement)&&j.domobj.nodeType===1&&b(j.domobj,d)){l.Log.debug(this,"Marking for removal: "+j.domobj.nodeName);f(j.domobj).addClass("preparedForRemoval")}j.selection!="none"&&j.children.length>0&&this.prepareForRemoval(j.children,d,b)}},wrapMarkupAroundSelectionTree:function(a,
d,b,c,j){var e=[],m=-1,k="",g="",p,n,q;l.Log.debug(this,"The formatting <"+b[0].tagName+"> will be wrapped around the selection");for(p=0;p<a.length;p++){n=a[p];if(n.domobj&&!this.canTag1WrapTag2(n.domobj.parentNode.tagName.toLowerCase(),b[0].tagName.toLowerCase()))l.Log.info(this,"Skipping the wrapping of <"+b[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+n.domobj.parentNode.tagName.toLowerCase()+">");else if(!n.domobj||!(n.domobj.nodeType===3&&f.trim(n.domobj.nodeValue).length===
0)){if(n.domobj&&n.selection=="partial"&&!b.isReplacingElement)if(n.startOffset!==void 0&&n.endOffset===void 0){m++;k=k+n.domobj.data.substr(0,n.startOffset);n.domobj.data=n.domobj.data.substr(n.startOffset,n.domobj.data.length-n.startOffset);e[m]=n.domobj}else if(n.endOffset!==void 0&&n.startOffset===void 0){m++;g=g+n.domobj.data.substr(n.endOffset,n.domobj.data.length-n.endOffset);n.domobj.data=n.domobj.data.substr(0,n.endOffset);e[m]=n.domobj}else if(n.endOffset!==void 0&&n.startOffset!==void 0){if(n.startOffset==
n.endOffset){l.Log.debug(this,"skipping empty selection");continue}m++;k=k+n.domobj.data.substr(0,n.startOffset);q=n.domobj.data.substr(n.startOffset,n.endOffset-n.startOffset);g=g+n.domobj.data.substr(n.endOffset,n.domobj.data.length-n.endOffset);n.domobj.data=q;e[m]=n.domobj}else{l.Log.debug(this,"diving into object");this.applyMarkup(n.children,d,b,c,j)}if(n.domobj&&(n.selection=="full"||n.selection=="partial"&&b.isReplacingElement)){m++;e[m]=n.domobj}}}if(e.length>0){e=f(e);f.each(e,function(a,
d){if(f.browser.msie&&d.nodeType==3&&!d.nextSibling&&!d.previousSibling&&d.parentNode&&d.parentNode.nodeName.toLowerCase()=="li")d.data=f.trim(d.data)});a=e.wrapAll(b).parent();a.before(k).after(g);if(j.setRangeObject2NewMarkup){k=e.textNodes();if(k.index(d.startContainer)!=-1)d.startOffset=0;if(k.index(d.endContainer)!=-1)d.endOffset=d.endContainer.length}if(j.setRangeObject2NextSibling){k=true;g=a.textNodes(true).last()[0];if(e.index(d.startContainer)!=-1){d.startContainer=this.getTextNodeSibling(k,
a.parent(),g);d.startOffset=0}if(e.index(d.endContainer)!=-1){d.endContainer=this.getTextNodeSibling(k,a.parent(),g);d.endOffset=d.endOffset-g.length}}if(j.setRangeObject2PreviousSibling){k=false;g=a.textNodes(true).first()[0];if(e.index(d.startContainer)!=-1){d.startContainer=this.getTextNodeSibling(k,a.parent(),g);d.startOffset=0}if(e.index(d.endContainer)!=-1){d.endContainer=this.getTextNodeSibling(k,a.parent(),g);d.endOffset=d.endContainer.length}}}},getTextNodeSibling:function(a,d,b){d=f(d).textNodes(true);
b=d.index(b);return b==-1?false:d[b+(!a?-1:1)]||false},optimizeSelectionTree4Markup:function(a,d,b){var c=[],j=0,e=0,m=this,k,g,p,n;typeof b==="undefined"&&(b=function(a,d){return m.standardTextLevelSemanticsComparator(d)});for(k=0;k<a.length;k++)if(a[k].domobj&&a[k].selection!="none")if(d.isReplacingElement&&b(d[0],f(a[k].domobj))){c[j]!==void 0&&j++;c[j]={};c[j].wrappable=true;c[j].elements=[];c[j].elements[e]=a[k];j++}else if(this.canMarkupBeApplied2ElementAsWhole([a[k]],d)){if(c[j]===void 0){c[j]=
{};c[j].wrappable=true;c[j].elements=[]}if(d.isReplacingElement){n=k;for(g=k-1;g>=0;g--)if(this.canMarkupBeApplied2ElementAsWhole([a[g]],d)&&this.isMarkupAllowedToStealSelectionTreeElement(a[g],d))n=g;else break;p=k;for(g=k+1;g<a.length;g++)if(this.canMarkupBeApplied2ElementAsWhole([a[g]],d)&&this.isMarkupAllowedToStealSelectionTreeElement(a[g],d))p=g;else break;e=0;for(g=n;g<=p;g++){c[j].elements[e]=a[g];c[j].elements[e].selection="full";e++}e=0}else{c[j].elements[e]=a[k];e++}}else{c[j]!==void 0&&
j++;c[j]={};c[j].wrappable=false;c[j].element=a[k];e=0;j++}return c},isMarkupAllowedToStealSelectionTreeElement:function(a,d){if(!a.domobj)return false;var b=a.domobj.nodeName.toLowerCase(),b=b=="#text"?"textNode":b,c=this.allowedToStealElements[d[0].nodeName.toLowerCase()];return c&&c[b]},canMarkupBeApplied2ElementAsWhole:function(a,d){var b,c,j;if(d.jquery)b=d[0].tagName;if(d.tagName)b=d.tagName;for(c=0;c<a.length;c++){j=a[c];if(j.domobj&&(j.selection!="none"||d.isReplacingElement))if(!this.canTag1WrapTag2(b,
j.domobj.nodeName)||j.children.length>0&&!this.canMarkupBeApplied2ElementAsWhole(j.children,d))return false}return true},canTag1WrapTag2:function(a,d){var a=a=="#text"?"textNode":a.toLowerCase(),d=d=="#text"?"textNode":d.toLowerCase(),b=this.tagHierarchy[a];return!b||!this.tagHierarchy[d]?true:b[d]},mayInsertTag:function(a){var d;if(typeof this.rangeObject.unmodifiableMarkupAtStart=="object"){for(d=0;d<this.rangeObject.unmodifiableMarkupAtStart.length;++d)if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[d].nodeName,
a))return false;return true}l.Log.warn(this,"Unable to determine whether tag "+a+" may be inserted");return true},toString:function(){return"Aloha.Selection"},SelectionRange:n.Utils.RangeObject.extend({_constructor:function(a){this._super(a);if(a){if(a.commonAncestorContainer)this.commonAncestorContainer=a.commonAncestorContainer;if(a.selectionTree)this.selectionTree=a.selectionTree;if(a.limitObject)this.limitObject=a.limitObject;if(a.markupEffectiveAtStart)this.markupEffectiveAtStart=a.markupEffectiveAtStart;
if(a.unmodifiableMarkupAtStart)this.unmodifiableMarkupAtStart=a.unmodifiableMarkupAtStart;if(a.splitObject)this.splitObject=a.splitObject}},commonAncestorContainer:void 0,selectionTree:void 0,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],limitObject:void 0,splitObject:void 0,select:function(){this._super();l.Selection.updateSelection()},update:function(a){this.updatelimitObject();this.updateMarkupEffectiveAtStart();this.updateCommonAncestorContainer(a);this.selectionTree=void 0},getSelectionTree:function(){if(!this.selectionTree)this.selectionTree=
l.Selection.getSelectionTree(this);return this.selectionTree},getSelectedSiblings:function(a){var d=this.getSelectionTree();return this.recursionGetSelectedSiblings(a,d)},recursionGetSelectedSiblings:function(a,d){var b=false,c=false,j;for(j=0;j<d.length;++j)if(d[j].domobj===a){c=true;b=[]}else if(!c&&d[j].children){b=this.recursionGetSelectedSiblings(a,d[j].children);if(b!==false)break}else if(c&&d[j].domobj&&d[j].selection!="collapsed"&&d[j].selection!="none")b.push(d[j].domobj);else if(c&&d[j].selection==
"none")break;return b},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[];this.unmodifiableMarkupAtStart=[];var a=this.getStartContainerParents(),d=false,b,c,j;for(c=0;c<a.length;c++){j=a[c];if(!d&&j!==this.limitObject){this.markupEffectiveAtStart[c]=j;if(!b&&n.Utils.Dom.isSplitObject(j)){b=true;this.splitObject=j}}else{d=true;this.unmodifiableMarkupAtStart.push(j)}}if(!b)this.splitObject=false},updatelimitObject:function(){if(l.editables&&l.editables.length>0){var a=this.getStartContainerParents(),
d=l.editables,b,c,j,e;for(b=0;b<a.length;b++){c=a[b];for(j=0;j<d.length;j++){e=d[j].obj[0];if(c===e){this.limitObject=c;return true}}}}this.limitObject=f("body");return true},toString:function(a){return!a?"Aloha.Selection.SelectionRange":"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}"}})}),q=a.extend({_constructor:function(a){this._nativeSelection=a;this.ranges=[];this.preventChange=
false},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:false,rangeCount:0,collapse:function(a,d){this._nativeSelection.collapse(a,d)},collapseToStart:function(){throw"NOT_IMPLEMENTED";},extend:function(){},modify:function(){},collapseToEnd:function(){this._nativeSelection.collapseToEnd()},selectAllChildren:function(){throw"NOT_IMPLEMENTED";},deleteFromDocument:function(){throw"NOT_IMPLEMENTED";},getRangeAt:function(a){a=this._nativeSelection.getRangeAt(a);p(a);return a},addRange:function(a){this._nativeSelection.addRange(a);
var d=this._nativeSelection._ranges;p(a);d[0]=a;l.Selection.updateSelection()},removeRange:function(){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(){},toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});l.getSelection=function(a){a=a!==document||a!==window?window:a;return new q(window.rangy.getSelection(a))};l.createRange=function(a){return window.rangy.createRange(a)};
a=new g;return l.Selection=a});define("aloha/block-jump",["aloha/core","jquery","aloha/console"],function(l,f,a){function g(a,b){a.deleteData(0,a.length);""!==b&&(a.nextSibling&&3===a.nextSibling.nodeType?a.nextSibling.insertData(0,b):a.previousSibling&&3===a.previousSibling.nodeType?a.previousSibling.insertData(a.previousSibling.length,b):a.insertData(0,b));setTimeout(function(){0===a.length&&f(a).remove()},0)}function c(){if(b){var c=b.nodeValue.replace(/\u200b/,"");c===b.nodeValue&&a.warn("Expected to remove the zero width text node fix, but couldn't find it");
g(b,c);b=null}}var b=null;return{removeZeroWidthTextNodeFix:c,insertZeroWidthTextNodeFix:function(a,k){c();b=document.createTextNode("​");k?f(a).after(b):f(a).before(b);l.bind("aloha-selection-changed",function(a){c();l.unbind(a)});return b}}});define("aloha/markup","aloha/core util/class util/html jquery aloha/ecma5shims aloha/console aloha/block-jump".split(" "),function(l,f,a,g,c,b,e){function k(a){return"false"===g(a).attr("contenteditable")}function j(a){return a&&3===a.nodeType}function m(a){return!a?
0:j(a)?a.length:a.childNodes.length}function d(a){return!a?null:a.nextSibling?j(a.nextSibling)&&!(0<a.nextSibling.data.replace(/\s+/g,"").length)||"BR"===a.nextSibling.nodeName&&a.nextSibling===a.parentNode.lastChild||""===a.nextSibling.innerHTML&&!k(a.nextSibling)?d(a.nextSibling):a.nextSibling:a.parentNode?d(a.parentNode):null}function p(a){return!a?null:a.previousSibling?j(a.previousSibling)&&!(0<a.previousSibling.data.replace(/\s+/g,"").length)?p(a.previousSibling):""===a.previousSibling.innerHTML&&
!k(a.previousSibling)?p(a.previouSibling):a.previousSibling:a.parentNode?p(a.parentNode):null}function n(a){var d;if(d=window.$_alohaPlaceholder){d=a.startContainer;var a=a.endContainer,b=window.$_alohaPlaceholder;d=!(b.is(d)||b.is(a)||(o?c.compareDocumentPosition(b[0],d)&16:0<g(b[0]).find(d).length)||(o?c.compareDocumentPosition(b[0],a)&16:0<g(b[0]).find(a).length))}if(d){0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove();window.$_alohaPlaceholder=
null}}var s=window.GENTICS,o=!!(g.browser.msie&&9>parseInt(g.browser.version,10));l.Markup=f.extend({keyHandlers:{},addKeyHandler:function(a,d){this.keyHandlers[a]||(this.keyHandlers[a]=[]);this.keyHandlers[a].push(d)},removeKeyHandler:function(a){this.keyHandlers[a]&&(this.keyHandlers[a]=null)},insertBreak:function(){var a=l.Selection.rangeObject,d,b,c;a.isCollapsed()||this.removeSelectedMarkup();c=g("<br/>");s.Utils.Dom.insertIntoDOM(c,a,l.activeEditable.obj);if(b=s.Utils.Dom.searchAdjacentTextNode(c.parent().get(0),
s.Utils.Dom.getIndexInParent(c.get(0))+1,false)){d=b.data.search(/\S/);if(d>0)b.data=b.data.substring(d)}a.startContainer=a.endContainer=c.get(0).parentNode;a.startOffset=a.endOffset=s.Utils.Dom.getIndexInParent(c.get(0))+1;a.correctRange();a.clearCaches();a.select()},preProcessKeyStrokes:function(d){if(d.type!=="keydown")return false;var b,c;if(this.keyHandlers[d.keyCode]){b=this.keyHandlers[d.keyCode];for(c=0;c<b.length;++c)if(!b[c](d))return false}if(d.keyCode===37||d.keyCode===39){if(l.getSelection().getRangeCount()){b=
l.getSelection().getRangeAt(0);if(this.processCursor(b,d.keyCode)){n(l.Selection.rangeObject);return true}}return false}if(d.keyCode===8){d.preventDefault();l.execCommand("delete",false);return false}if(d.keyCode===46){l.execCommand("forwarddelete",false);return false}if(d.keyCode===13){!d.shiftKey&&a.allowNestedParagraph(l.activeEditable)?l.execCommand("insertparagraph",false):l.execCommand("insertlinebreak",false);return false}return true},processCursor:function(a,b){if(!a.collapsed)return true;
e.removeZeroWidthTextNodeFix();var c=a.startContainer,f=l.getSelection();if(!c)return true;var t,v;if(g.browser.msie&&parseInt(g.browser.version,10)<=7&&j(c))if(b==37){for(v=a.startOffset;v>0&&c.data.charAt(v-1)==="​";)v--;if(v!=a.startOffset){a.setStart(a.startContainer,v);a.setEnd(a.startContainer,v);f=l.getSelection();f.removeAllRanges();f.addRange(a)}}else if(b==39){for(v=a.startOffset;v<c.data.length&&c.data.charAt(v)==="​";)v++;if(v!=a.startOffset){a.setStart(a.startContainer,v);a.setEnd(a.startContainer,
v);f.removeAllRanges();f.addRange(a)}}if(o&&!g(c).contentEditable()){v=g(c).parents("[contenteditable=false]");if(v.length>0)if(v.parent().hasClass("aloha-editable"))t=v[0];else return true}var B;if(!t){B=37===b||38===b;v=a.startOffset;if(j(c))if(B){if(1!==v&&!(0===v||v<=c.data.length-c.data.replace(/^\s+/,"").length))return true}else{t=c;f=m(t);if(f===v)t=true;else{var C=j(t);t=C&&t.data.replace(/\s+$/,"").length===v?true:1===f&&!C?"BR"===t.childNodes[0].nodeName:false}if(!t)return true}else c=c.childNodes[v===
m(c)?v-1:v];t=B?p(c):d(c)}if(k(t)){c=t;t=new s.Utils.RangeObject;v=B?p(c):d(c);if(!v||k(v)){v=g("<div>&nbsp;</div>");B?g(c).before(v):g(c).after(v);t.startContainer=t.endContainer=v[0];t.startOffset=t.endOffset=0;n(t);window.$_alohaPlaceholder=v}else{if(a.startContainer.nodeType===3&&a.startContainer===a.endContainer&&a.startContainer.nodeValue!==""&&(B?a.startOffset===1:a.endOffset+1===a.endContainer.length)||a.startContainer.nodeType===1&&(!a.startOffset||a.startContainer.childNodes[a.startOffset]&&
a.startContainer.childNodes[a.startOffset].nodeType===1)){v=e.insertZeroWidthTextNodeFix(c,B);t.startContainer=t.endContainer=v;t.startOffset=t.endOffset=B?1:0}else{t.startContainer=t.endContainer=v;t.startOffset=t.endOffset=B?m(v):0;B||e.insertZeroWidthTextNodeFix(c,true)}n(t)}t.select();l.trigger("aloha-block-selected",c);l.Selection.preventSelectionChanged();return false}return true},processShiftEnter:function(a){this.insertHTMLBreak(a.getSelectionTree(),a)},processEnter:function(a){a.splitObject?
this.splitRangeObject(a):this.insertHTMLBreak(a.getSelectionTree(),a)},insertHTMLCode:function(a){var d=l.Selection.rangeObject;this.insertHTMLBreak(d.getSelectionTree(),d,g(a))},insertHTMLBreak:function(a,d,b){var c,j,e,m,k,b=b||g("<br/>");c=0;for(j=a.length;c<j;++c){e=a[c];m=e.domobj?g(e.domobj):void 0;if(e.selection!=="none")if(e.selection=="collapsed"){if(c>0){e=g(a[c-1].domobj);e.after(b)}else{e=g(a[1].domobj);e.before(b)}d.startContainer=d.endContainer=b[0].parentNode;d.startOffset=d.endOffset=
s.Utils.Dom.getIndexInParent(b[0])+1;d.correctRange()}else if(e.domobj&&e.domobj.nodeType===3){e.domobj.nextSibling&&(e.domobj.nextSibling.nodeType==1&&l.Selection.replacingElements[e.domobj.nextSibling.nodeName.toLowerCase()])&&m.after("<br/>");if(this.needEndingBreak()){for(k=e.domobj;k;)if(k.nextSibling)k=false;else{k=k.parentNode;if(s.Utils.Dom.isBlockLevelElement(k)||s.Utils.Dom.isListElement(k))break;k===d.limitObject&&(k=false)}k&&g(k).append('<br class="aloha-cleanme" />')}m.between(b,e.startOffset);
m=0;for(e=b[0];e;){e=e.previousSibling;++m}d.startContainer=b[0].parentNode;d.endContainer=b[0].parentNode;d.startOffset=m;d.endOffset=m;d.correctRange()}else if(e.domobj&&e.domobj.nodeType===1){if(m.parent().find("br.aloha-ephemera").length===0){g(d.limitObject).find("br.aloha-ephemera").remove();g(d.commonAncestorContainer).append(this.getFillUpElement(d.splitObject))}m.after(b);d.startContainer=d.commonAncestorContainer;d.endContainer=d.startContainer;d.startOffset=c+2;d.endOffset=c+2;d.update()}}d.select()},
needEndingBreak:function(){return!g.browser.msie},getSelectedText:function(){var a=l.Selection.rangeObject;return a.isCollapsed()?false:this.getFromSelectionTree(a.getSelectionTree(),true)},getFromSelectionTree:function(a,d){var b="",c,j,e,m;c=0;for(j=a.length;c<j;c++){e=a[c];if(e.selection=="partial")if(e.domobj.nodeType===3)b=b+e.domobj.data.substring(e.startOffset,e.endOffset);else{if(e.domobj.nodeType===1&&e.children)if(d)b=b+this.getFromSelectionTree(e.children,d);else{m=g(e.domobj.outerHTML).empty();
m.html(this.getFromSelectionTree(e.children,d));b=b+m.outerHTML()}}else e.selection=="full"&&(e.domobj.nodeType===3?b=b+g(e.domobj).text():e.domobj.nodeType===1&&e.children&&(b=b+(d?g(e.domobj).text():g(e.domobj).outerHTML())))}return b},getSelectedMarkup:function(){var a=l.Selection.rangeObject;return a.isCollapsed()?null:this.getFromSelectionTree(a.getSelectionTree(),false)},removeSelectedMarkup:function(){var a=l.Selection.rangeObject,d;if(!a.isCollapsed()){d=new l.Selection.SelectionRange;this.removeFromSelectionTree(a.getSelectionTree(),
d);d.update();s.Utils.Dom.doCleanup({merge:true,removeempty:true},l.Selection.rangeObject);l.Selection.rangeObject=d;d.correctRange();d.update();d.select();l.Selection.updateSelection()}},removeFromSelectionTree:function(a,d){var b,c,j,e,m;j=0;for(m=a.length;j<m;j++){e=a[j];if(e.selection=="partial")if(e.domobj.nodeType===3){c="";e.startOffset>0&&(c=c+e.domobj.data.substring(0,e.startOffset));e.endOffset<e.domobj.data.length&&(c=c+e.domobj.data.substring(e.endOffset,e.domobj.data.length));e.domobj.data=
c;if(!d.startContainer){d.startContainer=d.endContainer=e.domobj;d.startOffset=d.endOffset=e.startOffset}}else{if(e.domobj.nodeType===1&&e.children){this.removeFromSelectionTree(e.children,d);if(b){if(b.nodeName==e.domobj.nodeName){g(b).append(g(e.domobj).contents());g(e.domobj).remove()}}else b=e.domobj}}else if(e.selection=="full"){if(!d.startContainer)if(c=s.Utils.Dom.searchAdjacentTextNode(e.domobj.parentNode,s.Utils.Dom.getIndexInParent(e.domobj)+1,false,{blocklevel:false})){d.startContainer=
d.endContainer=c;d.startOffset=d.endOffset=0}else{d.startContainer=d.endContainer=e.domobj.parentNode;d.startOffset=d.endOffset=s.Utils.Dom.getIndexInParent(e.domobj)+1}g(e.domobj).remove()}}},splitRangeObject:function(a){g(a.splitObject);var d,b;a.update(a.splitObject);d=a.getSelectionTree();b=this.getSplitFollowUpContainer(a);this.splitRangeObjectHelper(d,a,b);b.hasClass("preparedForRemoval")&&b.removeClass("preparedForRemoval");d=this.getInsertAfterObject(a,b);g(b).insertAfter(d);a.splitObject.nodeName.toLowerCase()===
"li"&&!l.Selection.standardTextLevelSemanticsComparator(a.splitObject,b)&&g(a.splitObject).remove();a.startContainer=null;d=b.contents();if(d.length>0&&d.get(0).nodeType==1&&d.get(0).nodeName.toLowerCase()==="br")a.startContainer=b.get(0);if(!a.startContainer)a.startContainer=b.textNodes(true,true).first().get(0);if(!a.startContainer)a.startContainer=b.textNodes(false).first().parent().get(0);if(a.startContainer){a.endContainer=a.startContainer;a.startOffset=0;a.endOffset=0}else{a.startContainer=
a.endContainer=b.parent().get(0);a.startOffset=a.endOffset=s.Utils.Dom.getIndexInParent(b.get(0))}a.update();a.select()},getInsertAfterObject:function(a,d){var b,c,j;for(c=0;c<a.markupEffectiveAtStart.length;c++){j=a.markupEffectiveAtStart[c];j===a.splitObject&&(b=true);if(b&&l.Selection.canTag1WrapTag2(g(j).parent()[0].nodeName,d[0].nodeName))return j}return false},getFillUpElement:function(){return g.browser.msie?false:g('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(a){var d=
0,b=[],c,j;for(c=0;c<a.length;++c){j=a[c];j.isElementContentWhitespace&&(b[b.length]=c)}for(c=0;c<b.length;++c){j=b[c];a.splice(j-d,1);++d}},splitRangeObjectHelper:function(a,d,b,c){b||l.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var j=this.getFillUpElement(d.splitObject),e=g(d.splitObject),m=false,k,f,p,n,o;if(a.length>0){p=b.contents();p.length!==a.length&&this.removeElementContentWhitespaceObj(p);f=0;for(o=a.length;f<o;++f){k=a[f];if(k.selection==="none"&&m===false||
k.domobj&&k.domobj.nodeType===3&&k===a[a.length-1]&&k.startOffset===k.domobj.data.length)if(b.textNodes().length>1||k.domobj.nodeType===1&&k.children.length===0)p.eq(f).remove();else if(s.Utils.Dom.isSplitObject(b[0]))j?b.html(j):b.empty();else{b.empty();b.addClass("preparedForRemoval")}else if(k.selection!=="none"){if(k.domobj&&k.domobj.nodeType===3&&k.startOffset!==void 0){m=k.domobj.data;if(k.startOffset>0)k.domobj.data=m.substr(0,k.startOffset);else if(a.length>1)g(k.domobj).remove();else{n=g(k.domobj).parent();
s.Utils.Dom.isSplitObject(n[0])?j?n.html(j):n.empty():n.remove()}if(m.length-k.startOffset>0)p[f].data=m.substr(k.startOffset,m.length);else if(p.length>1)p.eq(f).remove();else if(s.Utils.Dom.isBlockLevelElement(b[0]))j?b.html(j):b.empty();else{b.empty();b.addClass("preparedForRemoval")}}m=true;k.children.length>0&&this.splitRangeObjectHelper(k.children,d,p.eq(f),c)}else k.selection==="none"&&m===true&&g(k.domobj).remove()}}else l.Log.error(this,"can not split splitObject due to an empty selection tree");
e.find("br.aloha-ephemera:gt(0)").remove();b.find("br.aloha-ephemera:gt(0)").remove();e.find(".preparedForRemoval").remove();b.find(".preparedForRemoval").remove();e.contents().length===0&&(s.Utils.Dom.isSplitObject(e[0])&&j)&&e.html(j);b.contents().length===0&&(s.Utils.Dom.isSplitObject(b[0])&&j)&&b.html(j)},getSplitFollowUpContainer:function(a){var d;switch(a.splitObject.nodeName.toLowerCase()){case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":if((d=g(a.splitObject).textNodes(":not(.aloha-cleanme)").last()[0])&&
a.startContainer===d&&a.startOffset===d.length){d=g("<p></p>");a=g(a.splitObject.outerHTML).contents();d.append(a);return d}break;case "li":if(a.startContainer.nodeName.toLowerCase()==="br"&&g(a.startContainer).hasClass("aloha-ephemera")){d=g("<p></p>");a=g(a.splitObject.outerHTML).contents();d.append(a);return d}if(!a.splitObject.nextSibling&&g.trim(g(a.splitObject).text()).length===0)return d=g("<p></p>")}return g(a.splitObject.outerHTML)},transformDomObject:function(a,d,b){var c=g(a),d=g("<"+d+
">"),j,e=c[0].cloneNode(false).attributes;if(e)for(j=0;j<e.length;++j)(typeof e[j].specified==="undefined"||e[j].specified)&&d.attr(e[j].nodeName,e[j].nodeValue);if(c[0].style&&c[0].style.cssText)d[0].style.cssText=c[0].style.cssText;c.contents().appendTo(d);c.replaceWith(d);if(b){if(b.startContainer==a)b.startContainer=d.get(0);if(b.endContainer==a)b.endContainer=d.get(0)}return d},toString:function(){return"Aloha.Markup"}});l.Markup=new l.Markup;return l.Markup});define("aloha/observable",["jquery"],
function(l){return{_eventHandlers:null,bind:function(f,a,g){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[f]||(this._eventHandlers[f]=[]);this._eventHandlers[f].push({handler:a,scope:g||window})},unbind:function(f,a){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[f]&&(this._eventHandlers[f]=a?l.grep(this._eventHandlers[f],function(g){return g.handler===a?!1:!0}):[])},trigger:function(f){this._eventHandlers=this._eventHandlers||{};if(this._eventHandlers[f]){var a=
[];l.each(arguments,function(g,c){0<g&&a.push(c)});l.each(this._eventHandlers[f],function(g,c){c.handler.apply(c.scope,a)})}},unbindAll:function(){this._eventHandlers=null}}});define("aloha/registry",["jquery","aloha/observable","util/class"],function(l,f,a){return a.extend(f,{_entries:null,_ids:null,_constructor:function(){this._entries={};this._ids=[]},register:function(a,c){this._entries[a]=c;this._ids.push(a);this.trigger("register",c,a)},unregister:function(a){var c,b=this._entries[a];delete this._entries[a];
for(c in this._ids)if(this._ids.hasOwnProperty(c)&&this._ids[c]===a){this._ids.splice(c,1);break}this.trigger("unregister",b,a)},get:function(a){return this._entries[a]},has:function(a){return this._entries[a]?!0:!1},getEntries:function(){return l.extend({},this._entries)},getIds:function(){return l.extend([],this._ids)}})});define("aloha/contenthandlermanager",["aloha/core","aloha/registry","util/class"],function(l,f,a){return new (f.extend({createHandler:function(g){if("function"!==typeof g.handleContent)throw"ContentHandler has no function handleContent().";
return new (a.extend({handleContent:function(){}},g))},handleContent:function(a,c,b){var e=c?c.contenthandler:this.getIds();if(!e)return a;var k,j;for(k=0;k<e.length&&!((j=this.get(e[k]))&&(a=j.handleContent(a,c,b||l.activeEditable)),null===a);k++);return a}}))});define("util/trees",["jquery"],function(l){function f(a,d,b){var c=l.type(a),j,e,m;if("array"===c){c=b?a:[];m=j=0;for(e=a.length;m<e;m++)b=d(a[m]),b.length&&(c[j++]=b[0]);j!==c.length&&(c=c.slice(0,j))}else if("object"===c)for(j in c=b?a:
{},a)a.hasOwnProperty(j)&&(b=d(a[j]),b.length?c[j]=b[0]:delete c[j]);else c=a;return c}function a(a,d){return f(a,d,!0)}function g(a,d){var b,c,j;if(1===a.nodeType)for(c=a.firstChild;c;)b=d(c),j=c.nextSibling,b.length?b[0]!==c&&a.replaceChild(b[0],c):a.removeChild(c),c=j;return a}function c(a,d,b,c){return[b(d(c),a)]}function b(a,d,b,c){return[d(b(c,a))]}function e(a,d,b,c){return d(c)?[]:[b(c,a)]}function k(a,d,b,c){a=b(c,a);return d(a)?[]:[a]}function j(a,d,b,c){function j(c){return a(j,d,b,c)}
return j(c)[0]}function m(a){a=l.type(a);return"object"!==a&&"array"!==a}function d(d,b,c){function j(a){return m(a)?[b(a)]:[e(a,j)]}var e=c?a:f;return j(d)[0]}return{prewalk:function(d,b,e){return j(c,b,e?a:f,d)},postwalk:function(d,c,e){return j(b,c,e?a:f,d)},preprune:function(d,b,c){return j(e,b,c?a:f,d)},postprune:function(d,b,c){return j(k,b,c?a:f,d)},prewalkDom:function(a,d,b){return j(c,d,g,b?a:a.cloneNode(!0))},postwalkDom:function(a,d,c){return j(b,d,g,c?a:a.cloneNode(!0))},prepruneDom:function(a,
d,b){return j(e,d,g,b?a:a.cloneNode(!0))},postpruneDom:function(a,d,b){return j(k,d,g,b?a:a.cloneNode(!0))},isLeaf:m,leaves:d,clone:function(a){function d(a){return[f(a,d)]}return d(a)[0]},flatten:function(a){var b=[];d(a,function(a){b.push(a);return a},!0);return b},walk:f,walkInplace:a,walkDomInplace:g}});define("util/misc",[],function(){return{anyRx:function(l,f){var a,g;a=0;for(g=l.length;a<g;a++)if(l[a].test(f))return!0;return!1}}});define("aloha/ephemera","jquery aloha/core aloha/console util/strings util/trees util/arrays util/maps util/dom2 util/functions util/misc util/browser PubSub".split(" "),
function(l,f,a,g,c,b,e,k,j,m,d,p){function n(a){var a=l(a),b=a.attr("data-aloha-ephemera-attr"),c;d.ie7||a.removeAttr("data-aloha-ephemera-attr");if(typeof b==="string"){c=g.words(b);for(b=0;b<c.length;b++)a.removeAttr(c[b])}}function s(a,d,c,j){return(c=c[d])&&(true===c||-1!==b.indexOf(c,a.nodeName))?true:m.anyRx(j,d)}function o(a,d){var b=null,c=k.attrNames(a),j,e,m;e=0;for(m=c.length;e<m;e++){j=c[e];if(s(a,j,d.attrMap,d.attrRxs)){b=b||l(a);b.removeAttr(j)}}}function q(a,d){var c=a.className;if("string"===
typeof c&&-1!==c.indexOf(u)){c=g.words(c);if(-1!==b.indexOf(c,"aloha-cleanme")||-1!==b.indexOf(c,"aloha-ephemera")){l.removeData(a);return false}if(-1!==b.indexOf(c,"aloha-ephemera-wrapper")||-1!==b.indexOf(c,"aloha-ephemera-filler")){k.moveNextAll(a.parentNode,a.firstChild,a.nextSibling);l.removeData(a);return false}-1!==b.indexOf(c,"aloha-ephemera-attr")&&n(a);var j=b.filter(c,function(a){return!d.classMap[a]});if(j.length!==c.length)0===j.length?l(a).removeAttr("class"):a.className=j.join(" ")}o(a,
d);return true}var r={classMap:{"aloha-ephemera-wrapper":true,"aloha-ephemera-filler":true,"aloha-ephemera-attr":true,"aloha-ephemera":true,"aloha-anchor-first":true,"aloha-cleanme":true},attrMap:{hidefocus:true,hideFocus:true,tabindex:true,tabIndex:true,contenteditable:["TABLE"],contentEditable:["TABLE"]},attrRxs:[/^(?:nodeIndex|sizcache|sizset|jquery)[\w\d]*$/i],pruneFns:[]},u="aloha-";return{ephemera:function(a){if(a){r=a;p.pub("aloha.ephemera",{ephemera:r})}return r},classes:function(){var d=
Array.prototype.slice.call(arguments);e.fillKeys(r.classMap,d,true);var b=d,c,j;c=0;for(j=b.length;c<j;c++)if(-1===b[c].indexOf(u)){a.warn('Class "'+b[c]+'" was set to be ephemeral,which hurts peformance. Add the common substring "'+u+'" to the class to fix this problem.');u=""}p.pub("aloha.ephemera.classes",{ephemera:r,newClasses:d})},attributes:function(){var a=Array.prototype.slice.call(arguments);e.fillKeys(r.attrMap,a,true);p.pub("aloha.ephemera.attributes",{ephemera:r,newAttributes:a})},markElement:function(a){l(a).addClass("aloha-ephemera")},
markAttr:function(a,d){var a=l(a),c=a.attr("data-aloha-ephemera-attr");null==c||""===c?c=d:-1===b.indexOf(g.words(c),d)&&(c=c+(" "+d));a.attr("data-aloha-ephemera-attr",c);a.addClass("aloha-ephemera-attr")},markWrapper:function(a){l(a).addClass("aloha-ephemera-wrapper")},markFiller:function(a){l(a).addClass("aloha-ephemera-filler")},prune:function(a,d){function j(a){var e;a:{e=d;var m=j;if(1===a.nodeType){if(!q(a,e)){e=[];break a}a=c.walkDomInplace(a,m)}e=(a=b.reduce(e.pruneFns,a,b.applyNotNull))?
[a]:[]}return e}d=d||r;return j(a)[0]},isAttrEphemeral:s}});define("aloha/copypaste",["jquery","aloha/core"],function(l,f){function a(a){var c=f.createRange(),b=f.getSelection();c.setStart(a.startContainer,a.startOffset);c.setEnd(a.endContainer,a.endOffset);b.removeAllRanges();b.addRange(c)}return{getEditableAt:function(a){if(!a||!a.commonAncestorContainer)return null;a=l(a.commonAncestorContainer);return a.length?f.getEditableHost(a):null},getRange:function(){var a=f.getSelection();return a.getRangeCount()?
a.getRangeAt(0):null},selectAllOf:function(g){a({startContainer:g,endContainer:g,startOffset:0,endOffset:g.childNodes?g.childNodes.length:g.length});l(g).focus()},setSelectionAt:a}});define("aloha/command",["aloha/core","aloha/registry","aloha/engine","util/dom","aloha/contenthandlermanager"],function(l,f,a,g,c){var b={execCommand:function(b,k,j,m){var d={commandId:b,preventDefault:!1};l.trigger("aloha-command-will-execute",d);if(!0!==d.preventDefault){if(!m){if(!l.getSelection().getRangeCount())return;
m=l.getSelection().getRangeAt(0)}"inserthtml"===b.toLowerCase()&&(j=c.handleContent(j,{contenthandler:l.settings.contentHandler.insertHtml,command:"insertHtml",range:m}));a.execCommand(b,k,j,m);l.getSelection().getRangeCount()&&(m=l.getSelection().getRangeAt(0),k=m.commonAncestorContainer,k.parentNode&&(k=k.parentNode),j=new window.GENTICS.Utils.RangeObject,j.startContainer=m.startContainer,j.startOffset=m.startOffset,j.endContainer=m.endContainer,j.endOffset=m.endOffset,g.doCleanup({merge:!0,removeempty:!1},
j,k),j.select());l.trigger("aloha-command-executed",b)}},queryCommandEnabled:function(b,c){if(!c){if(!l.getSelection().getRangeCount())return;c=l.getSelection().getRangeAt(0)}return a.queryCommandEnabled(b,c)},queryCommandIndeterm:function(b,c){if(!c){if(!l.getSelection().getRangeCount())return;c=l.getSelection().getRangeAt(0)}return a.queryCommandIndeterm(b,c)},queryCommandState:function(b,c){if(!c){if(!l.getSelection().getRangeCount())return;c=l.getSelection().getRangeAt(0)}return a.queryCommandState(b,
c)},queryCommandSupported:function(b){return a.queryCommandSupported(b)},queryCommandValue:function(b,c){if(!c){if(!l.getSelection().getRangeCount())return;c=l.getSelection().getRangeAt(0)}return a.queryCommandValue(b,c)},querySupportedCommands:function(){var b=[],c;for(c in a.commands)a.commands.hasOwnProperty(c)&&b.push(c);return b},getStateOverride:a.getStateOverride,setStateOverride:a.setStateOverride,resetOverrides:a.resetOverrides,unsetStateOverride:a.unsetStateOverride},b=new (f.extend(b));
l.execCommand=b.execCommand;l.queryCommandEnabled=b.queryCommandEnabled;l.queryCommandIndeterm=b.queryCommandIndeterm;l.queryCommandState=b.queryCommandState;l.queryCommandSupported=b.queryCommandSupported;l.queryCommandValue=b.queryCommandValue;l.querySupportedCommands=b.querySupportedCommands;return b});define("aloha/state-override","aloha/core jquery aloha/command util/dom2 util/maps util/html util/functions util/range PubSub".split(" "),function(l,f,a,g,c,b,e,k,j){function m(){u=null;v=false;
x||(t=null)}function d(){x=null;u||(t=null)}function p(a){if(x){t=a;u=x;x=null;v=true}}function n(a,d,b,c,j){if(!r)return a;t&&!g.areRangesEq(t,c)&&d();t=c;a=a||{};a[b]=j;return a}function s(a,d,b){u=n(u,m,a,d,b)}function o(a,b,c){v?u[a]=c:x=n(x,d,a,b,c)}function q(a,d,b,c){r&&a(d,g.rangeFromRangeObject(b),function(a,d){var b=new k(d);c(a,b);g.setRangeFromRef(d,b)})}var r=l.settings.stateOverride!==false,u=null,x=null,t=null,v=false;l.bind("aloha-selection-changed",function(a,d,b){var c=b&&16===b.which&&
"keyup"===b.type;if(t&&!g.areRangesEq(t,d)&&!c){b&&13===b.which?p(d):m();j.pub("aloha.selection.context-change",{range:d,event:a})}});j.sub("aloha.selection.context-change",function(a){a.event&&(t&&13!==a.event.which)&&d()});return{enabled:function(a){null!=a&&(r=a);return r},keyPressHandler:function(a){if(u&&!a.altKey&&!a.ctrlKey&&!a.metaKey&&a.which&&13!==a.which){var d=String.fromCharCode(a.which);if(!b.isControlCharacter(d)){var j=l.getSelection();if(j.getRangeCount()){var k=j.getRangeAt(0);if(" "===
d){var f=g.nodeAtOffset(k.startContainer,k.startOffset),f=f.parentNode,f=g.getComputedStyle(f,"white-space");b.isWhiteSpacePreserveStyle(f)||(d=" ")}g.insertSelectText(d,k);c.forEach(u,function(a,d){a(d,k)});g.trimRangeClosingOpening(k,e.returnFalse,b.isUnrenderedWhitespace);g.trimRange(k,e.returnFalse,function(a){return(a=a.prevSibling())&&(3!==a.nodeType||b.isUnrenderedWhitespace(a))});g.collapseToEnd(k);j.removeAllRanges();j.addRange(k);a.preventDefault();m()}}}},keyDownHandler:function(a){if(x&&
13===a.which){a=l.getSelection();a.getRangeCount()&&p(a.getRangeAt(0))}},isSet:function(a){return u&&u.hasOwnProperty(a)},set:s,setWithRangeObject:function(a,d,b){if(r){q(s,a,d,b);d.select()}},setForLinebreak:o,setForLinebreakWithRangeObject:function(a,d,b){q(o,a,d,b)},clear:function(){m();d()}}});define("aloha/editable","aloha/core util/class jquery aloha/pluginmanager aloha/selection aloha/markup aloha/contenthandlermanager aloha/console aloha/block-jump aloha/ephemera util/dom2 util/html util/browser PubSub aloha/copypaste aloha/command aloha/engine aloha/state-override".split(" "),
function(l,f,a,g,c,b,e,k,j,m,d,p,n,s,o,q,r,u){function x(a){return e.handleContent(a.getContents(),{contenthandler:l.settings.contentHandler.smartContentChange},a)}function t(a){if(!a.altKey&&!a.ctrlKey&&!a.metaKey&&a.which){var d=l.getSelection();if(d.getRangeCount()){d=d.getRangeAt(0);if(!d.collapsed){a=String.fromCharCode(a.which);if(!p.isControlCharacter(a)){l.trigger("aloha-command-will-execute",{commandId:"delete"});r.deleteContents(d,{stripWrappers:false});l.trigger("aloha-command-executed",
"delete")}}}}}var v=window.unescape,B=window.GENTICS,C=false,z={};l.defaults.contentHandler={};l.defaults.contentHandler.initEditable=["blockelement","sanitize"];l.defaults.contentHandler.getContents=["blockelement","sanitize","basic"];if(typeof l.settings.contentHandler==="undefined")l.settings.contentHandler={};var A=function(d){return a(d).html()},E={65:"a"},K={"ctrl+a":function(){var a=o.getEditableAt(o.getRange());if(a){o.selectAllOf(a.obj[0]);return false}}};a(document).keydown(function(a){if(l.activeEditable){var d=
E[a.which];if(d){var b=a.altKey?"alt":a.ctrlKey?"ctrl":a.shiftKey?"shift":null,d=(b?b+"+":"")+d;if(K[d])return K[d](a)}}});(function(){function b(){if(l.activeEditable){var a=l.getSelection();if(a.getRangeCount()){a=a.getRangeAt(0);if(null==j||!d.areRangesEq(a,j)){j=a;var e=l.activeEditable.obj[0];if(d.contains(e,a.startContainer)||e===a.startContainer)c.onChange()}}else if(null!=j){j=null;c.onChange()}}}if(!n.ie){var j=null;a(document).bind("selectionchange",function(){setTimeout(b,0)})}})();l.Editable=
f.extend({_constructor:function(a){a.attr("id")||a.attr("id",B.Utils.guid());this.originalObj=this.obj=a;this.ready=false;this.sccDelimiters=[":",";",".","!","?",",",v("%u0009"),v("%u0020"),v("%u0008"),v("%u007F"),"Enter"];this.sccIdle=5E3;this.sccDelay=500;this.sccTimerDelay=this.sccTimerIdle=false;this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",
36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",145:"Scroll",16:"Shift",38:"Up",91:"Win",92:"Win"};this.placeholderClass="aloha-placeholder";l.registerEditable(this)},init:function(){var d=this;if((this.settings=l.settings)&&l.settings.smartContentChange){if(l.settings.smartContentChange.delimiters)this.sccDelimiters=l.settings.smartContentChange.delimiters;if(l.settings.smartContentChange.idle)this.sccIdle=l.settings.smartContentChange.idle;
if(l.settings.smartContentChange.delay)this.sccDelay=l.settings.smartContentChange.delay}if(this.check(this.obj)){if(typeof l.settings.contentHandler.getContents==="undefined")l.settings.contentHandler.getContents=l.defaults.contentHandler.getContents;if(typeof l.settings.contentHandler.initEditable==="undefined")l.settings.contentHandler.initEditable=l.defaults.contentHandler.initEditable;var j=d.obj.html(),j=e.handleContent(j,{contenthandler:l.settings.contentHandler.initEditable,command:"initEditable"},
d);d.obj.html(j);l.bind("aloha-plugins-loaded",function(){d.obj.addClass("aloha-editable").contentEditable(true);d.obj.mousedown(function(a){if(!l.eventHandled){l.eventHandled=true;return d.activate(a)}});d.obj.mouseup(function(){l.eventHandled=false});d.obj.focus(function(a){return d.activate(a)});d.obj.add(".aloha-block",d.obj).keydown(function(a){var c=b.preProcessKeyStrokes(a);d.keyCode=a.which;c||d.smartContentChange(a);return c}).keypress(t).keypress(u.keyPressHandler).keydown(u.keyDownHandler);
d.obj.keypress(function(a){l.activeEditable.smartContentChange(a)});d.obj.keyup(function(a){if(a.keyCode===27){l.deactivateEditable();return false}});d.obj.contentEditableSelectionChange(function(a){c.onChange(d.obj,a);return d.obj});d.setUnmodified();d.snapshotContent=d.getContents();a.browser.mozilla&&d.initEmptyEditable();d.initPlaceholder();d.ready=true;window.setTimeout(function(){l.disableObjectResizing()},20);l.trigger("aloha-editable-created",[d]);s.pub("aloha.editable.created",{data:d})})}else this.destroy()},
isActive:false,originalContent:null,range:void 0,check:function(){var d=this,b=this.obj,c=b.get(0).nodeName.toLowerCase(),j=["a","abbr","address","article","aside","b","bdo","blockquote","cite","code","command","del","details","dfn","div","dl","em","footer","h1","h2","h3","h4","h5","h6","header","i","ins","menu","nav","p","pre","q","ruby","section","small","span","strong","sub","sup","var"],e;for(e=0;e<j.length;++e)if(c===j[e])return true;switch(c){case "textarea":case "input":c=a('<div id="'+this.getId()+
'-aloha" class="aloha-'+c+'" />').insertAfter(b);c.height(b.height()).width(b.width()).html(b.val());b.hide();b.parents("form:first").submit(function(){b.val(d.getContents())});this.obj=c;return true}return false},initPlaceholder:function(){l.settings.placeholder&&this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var d=a.trim(this.getContents());return d.length===0||(d==="<br>"?true:false)},initEmptyEditable:function(){var d=this.obj;this.empty(this.getContents())&&a(d).prepend('<br class="aloha-cleanme" />')},
addPlaceholder:function(){var d=a("<div>"),b=a("<span>"),c,j=this.obj;c=B.Utils.Dom.allowsNesting(j[0],d[0])?d:b;if(a("."+this.placeholderClass,j).length===0){a.each(l.settings.placeholder,function(a,d){j.is(a)&&c.html(d)});if(!c.is(":empty")){c.addClass(this.placeholderClass).addClass("aloha-ephemera");a(j).append(c)}a("br",j).remove()}},removePlaceholder:function(d,b){var j=this.placeholderClass,e;a("."+this.placeholderClass,d).length!==0&&(b===true?window.setTimeout(function(){e=new c.SelectionRange;
e.startContainer=e.endContainer=d.get(0);e.startOffset=e.endOffset=0;a("."+j,d).remove();e.select()},100):a("."+j,d).remove())},destroy:function(){this===l.getActiveEditable()&&this.blur();switch(this.originalObj.get(0).nodeName.toLowerCase()){case "textarea":case "input":this.originalObj.val(this.getContents());this.obj.remove();this.originalObj.show()}this.ready=false;this.removePlaceholder(this.obj);this.obj.removeClass("aloha-editable").contentEditable(false).unbind("mousedown click dblclick focus keydown keypress keyup .contentEditableSelectionChange");
l.trigger("aloha-editable-destroyed",[this]);s.pub("aloha.editable.destroyed",{data:this});l.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||this.obj.contentEditable()==="false"},disable:function(){return this.isDisabled()||this.obj.contentEditable(false)},enable:function(){return this.isDisabled()&&
this.obj.contentEditable(true)},activate:function(a){var d=l.getActiveEditable();if(C)C=false;else if((!a||!(a.type==="focus"&&d!==null&&d.obj.parent().get(0)===a.currentTarget))&&!this.isActive&&!this.isDisabled()){this.obj.addClass("aloha-editable-active");l.activateEditable(this);C=true;this.removePlaceholder(this.obj,true);C=false;this.isActive=true;l.trigger("aloha-editable-activated",{oldActive:d,editable:this});s.pub("aloha.editable.activated",{data:{old:d,editable:this}})}},blur:function(){this.obj.blur();
this.isActive=false;this.initPlaceholder();this.obj.removeClass("aloha-editable-active");l.trigger("aloha-editable-deactivated",{editable:this});s.pub("aloha.editable.deactivated",{data:{editable:this}});l.activeEditable.smartContentChange({type:"blur"},null)},empty:function(d){return null===d||a.trim(d)===""||d==="<br/>"},getContents:function(d){var b=this.obj.html(),c=z[this.getId()];if(!c||b!==c.raw){j.removeZeroWidthTextNodeFix();var k=this.obj.clone(false);this.removePlaceholder(k);k=a(m.prune(k[0]));
g.makeClean(k);k=a("<div>"+e.handleContent(k.html(),{contenthandler:l.settings.contentHandler.getContents,command:"getContents"},this)+"</div>");c=z[this.getId()]={};c.raw=b;c.element=k}if(d)return c.element.clone().contents();if(null==c.serialized)c.serialized=A(c.element[0]);return c.serialized},setContents:function(a,d){var b=null;if(l.getActiveEditable()===this){l.deactivateEditable();b=this}this.obj.html(a);null!==b&&b.activate();this.smartContentChange({type:"set-contents"});return d?this.obj.contents():
A(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(d){function b(){null==m&&(m=c.getSnapshotContent());return m}var c=this,j=null,e;if(d&&(d.metaKey||d.crtlKey||d.altKey))return false;if(d&&d.originalEvent){e=/U\+(\w{4})/;e.exec(d.originalEvent.keyIdentifier);j=this.keyCodeMap[this.keyCode]||String.fromCharCode(d.which)||"unknown"}var m=null;if(a.inArray(j,this.sccDelimiters)>=0){clearTimeout(this.sccTimerIdle);clearTimeout(this.sccTimerDelay);this.sccTimerDelay=
window.setTimeout(function(){l.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:d.originalEvent.keyIdentifier,keyCode:d.keyCode,"char":j,triggerType:"keypress",getSnapshotContent:b});x(c);k.debug("Aloha.Editable","smartContentChanged: event type keypress triggered")},this.sccDelay)}else if(d&&d.type==="paste"){l.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:b});x(c)}else if(d&&d.type==="blur"){l.trigger("aloha-smart-content-changed",
{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:b});x(c)}else if(d&&d.type==="block-change"){l.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:null,keyCode:null,"char":null,triggerType:"block-change",getSnapshotContent:b});x(c)}else if(j!==null){clearTimeout(this.sccTimerDelay);clearTimeout(this.sccTimerIdle);this.sccTimerIdle=window.setTimeout(function(){l.trigger("aloha-smart-content-changed",{editable:c,keyIdentifier:null,keyCode:null,
"char":null,triggerType:"idle",getSnapshotContent:b});x(c)},this.sccIdle)}},getSnapshotContent:function(){var a=this.snapshotContent;this.snapshotContent=this.getContents();return a}});l.Editable.setContentSerializer=function(a){A=a};l.Editable.getContentSerializer=function(){return A}});define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(l,f,a,g,c){var b=a.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(a){"string"!==
typeof a?c.error("Cannot initialise unnamed plugin, skipping"):this.name=a},checkDependencies:function(){var a=this,b=!0;f.each(a.dependencies,function(j,m){if(!l.isPluginLoaded(m.toString()))return b=!1,c.error("plugin."+a.name,'Required plugin "'+m+'" not found.'),!1});return b},init:function(){},getEditableConfig:function(a){var b=null,c=!1,m=this;this.settings.editables&&f.each(this.settings.editables,function(d,g){var n;if(a.is(d))if(c=!0,g instanceof Array)b=[],b=f.merge(b,g);else if("object"===
typeof g)for(n in b={},b["aloha-editable-selector"]=d,g)g.hasOwnProperty(n)&&(g[n]instanceof Array?b[n]=g[n]:"object"===typeof g[n]?(b[n]={},b[n]=f.extend(!0,b[n],m.config[n],g[n])):b[n]=g[n]);else b=g});c||(b="undefined"===typeof this.settings.config||!this.settings.config?this.config:this.settings.config);return b},makeClean:function(){},getUID:function(){c.deprecated("plugin","getUID() is deprecated. Use plugin.name instead.");return this.name},toString:function(){return this.name},log:function(a,
b){c.deprecated("plugin","log() is deprecated. Use Aloha.console instead.");c.log(a,this,b)}});b.create=function(a,c){var j=new (b.extend(c))(a);j.settings=f.extendObjects(!0,j.defaults,l.settings[a]);g.register(j);return j};return b});define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],function(l,f,a,g){function c(a,b,c,d){if(!(b!==d.target&&(/textarea|input|select/i.test(d.target.nodeName)||"text"===d.target.type)))return a.apply(b,c)}function b(b){var j,e,d,g;
if("string"===typeof b.data){j=b.handler;e=b.data.toLowerCase().split(" ");d={};for(g=0;g<e.length;g++)d[e[g]]=!0;b.handler=function(b){if(this===b.target){var e="keypress"!==b.type&&a.hotkeys.specialKeys[b.which],m="";b.altKey&&"alt"!==e&&(m+="alt+");b.ctrlKey&&"ctrl"!==e&&(m+="ctrl+");b.metaKey&&(!b.ctrlKey&&"meta"!==e)&&(m+="meta+");b.shiftKey&&"shift"!==e&&(m+="shift+");if(e){if(d[m+e])return c(j,this,arguments,b)}else if(e=String.fromCharCode(b.which).toLowerCase(),d[m+e]||d[m+a.hotkeys.shiftNums[e]]||
"shift+"===m&&d[a.hotkeys.shiftNums[e]])return c(j,this,arguments,b)}}}}var e=window.XMLSerializer;a.fn.between=function(a,b){var c;3!==this[0].nodeType?(c=this.children().size(),b>c&&(b=c),0>=b?this.prepend(a):this.children().eq(b-1).after(a)):0>=b?this.before(a):(b>=this[0].length||(c=this[0].data,this[0].data=c.substring(0,b),this.after(c.substring(b,c.length))),this.after(a))};a.fn.contentEditable=function(b){var c=a(this),e="contenteditable";a.browser.msie&&7==parseInt(a.browser.version,10)&&
(e="contentEditable");if("undefined"===typeof b){if("undefined"===typeof c[0]){g.warn("The jquery object did not contain any valid elements.");return}return"undefined"===typeof c[0].isContentEditable?(g.warn("Could not determine whether the is editable or not. I assume it is."),!0):c[0].isContentEditable}""===b?c.removeAttr(e):c.attr(e,b&&"false"!==b?"true":"false");return c};a.fn.aloha=function(){var b=this;l.bind("aloha-plugins-loaded",function(){b.each(function(b,c){l.isEditable(c)||(new l.Editable(a(c))).init()})});
return b};a.fn.mahalo=function(){return this.each(function(){l.isEditable(this)&&l.getEditableById(a(this).attr("id")).destroy()})};a.fn.alohaText=function(){return this.each(function(){l.isEditable(this)&&l.getEditableById(a(this).attr("id")).getContents()})};a.fn.contentEditableSelectionChange=function(b){var c=this;this.keyup(function(a){f.getRangeObject();b(a)});this.dblclick(function(a){b(a)});this.bind("touchend.contentEditableSelectionChange",b);this.mousedown(function(){c.selectionStarted=
!0});a(document).mouseup(function(a){f.eventOriginalTarget=c;c.selectionStarted&&b(a);f.eventOriginalTarget=!1;c.selectionStarted=!1});return this};a.fn.outerHtml=a.fn.outerHtml||function(){var b=a(this).get(0);if("undefined"!=typeof b.outerHTML)return b.outerHTML;try{return(new e).serializeToString(b)}catch(c){try{return b.xml}catch(m){}}};a.fn.zap=function(){return this.each(function(){a(this.childNodes).insertBefore(this)}).remove()};a.fn.textNodes=function(b,c){var e=[],d=function(g){var f,s;
if(3===g.nodeType&&a.trim(g.data)&&!c||3===g.nodeType&&c||"BR"==g.nodeName&&!b)e.push(g);else{f=0;for(s=g.childNodes.length;f<s;++f)d(g.childNodes[f])}};d(this[0]);return a(e)};a.extendObjects=a.fn.extendObjects=function(b,c){var e,d,g,f,s;e=1;var o=b||{},q=arguments.length,r=!1,l;"boolean"===typeof o&&(r=o,o=c||{},e=2);"object"!==typeof o&&!a.isFunction(o)&&(o={});q===e&&(o=this,--e);for(l=e;l<q;l++)if(null!=(e=arguments[l]))for(d in e)e.hasOwnProperty(d)&&(g=o[d],f=e[d],o!==f&&(r&&f&&(a.isPlainObject(f)||
!0===(s=a.isArray(f)))?(s?(s=!1,g=g&&a.isArray(g)?g:[]):g=g&&a.isPlainObject(g)?g:{},o[d]=a.isArray(f)?f:a.extendObjects(r,g,f)):void 0!==f&&(o[d]=f)));return o};a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",
109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})});define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],
function(l,f,a,g){var c=+new Date;f.easing.easeOutExpo||f.extend(f.easing,{easeOutExpo:function(a,b,c,j,e){return b==e?c+j:j*(-Math.pow(2,-10*b/e)+1)+c},easeOutElastic:function(a,b,c,j,e){var a=Math,m=1.70158,k=0,g=j;if(!b)return c;if(1==(b/=e))return c+j;k||(k=0.3*e);g<a.abs(j)?(g=j,m=k/4):m=k/(2*a.PI)*a.asin(j/g);return g*a.pow(2,-10*b)*a.sin((b*e-m)*2*a.PI/k)+j+c}});var b=function(a){this.id=null;this.folds={};this.button=null;this.title=f('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>');
this.content=f('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>');this.effectiveElement=this.element=null;this.expanded=!1;this.isActive=!0;this.init(a)},e=function(a){var b=this;this.id="aloha-sidebar-"+ ++c;this.panels={};this.container=f('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>');
this.width=300;this.isCompletelyOpen=this.isOpen=this.opened=!1;this.settings={rotateIcons:!f.browser.msie,overlayPage:!0};f(function(){"undefined"!==typeof l.settings.sidebar&&l.settings.sidebar.disabled||b.init(a)})},k=null,j=null;f.extend(e.prototype,{init:function(a){var b=this,c;"object"===typeof a&&(c=a.panels,delete a.panels);f.extend(this,a);"object"===typeof c&&f.each(c,function(){b.addPanel(this,true)});a=this.container;"right"===this.position&&a.addClass("aloha-sidebar-right");a.hide().appendTo(f("body")).click(function(){b.barClicked.apply(b,
arguments)}).find(".aloha-sidebar-panels").width(this.width);a.width(this.width);this.width=a.width();this.updateHeight();this.initToggler();this.container.css("right"===this.position?"marginRight":"marginLeft",-this.width);this.opened&&this.open(0);this.toggleHandleIcon(this.isOpen);this.subscribeToEvents();f(window).resize(function(){b.updateHeight();b.correctHeight()});this.correctHeight()},show:function(){this.container.css("display","block");return this},hide:function(){this.container.css("display",
"none");return this},checkActivePanels:function(a){var b=[];if("undefined"!==typeof a&&"undefined"!==typeof a.markupEffectiveAtStart){var c=a.markupEffectiveAtStart.length,j;for(j=0;j<c;++j)b.push(f(a.markupEffectiveAtStart[j]))}var e=this;f.each(this.panels,function(){e.showActivePanel(this,b)});this.correctHeight()},subscribeToEvents:function(){var a=this;g.sub("aloha.selection.context-change",function(b){a.isOpen&&a.checkActivePanels(b.range);a.lastRange=b.range});l.bind("aloha-editable-deactivated",
function(){a.isOpen&&a.checkActivePanels();a.lastRange=null});this.container.mousedown(function(a){a.originalEvent.stopSelectionUpdate=!0;l.eventHandled=!0});this.container.mouseup(function(a){a.originalEvent.stopSelectionUpdate=!0;l.eventHandled=!1})},correctHeight:function(){if(this.isOpen)if(this.isCompletelyOpen){var a=f(window).height(),b=[],c=[],e;for(e in this.panels)this.panels.hasOwnProperty(e)&&this.panels[e].isActive&&(c.push(this.panels[e]),b.push(e));if(0!==c.length&&(b=b.sort().join(","),
!(j===b&&k===a))){k=a;j=b;for(var a=this.container.find(".aloha-sidebar-inner").height()-(c[0].title.outerHeight()+10)*c.length,m,g,r,l=0,x=Math,t;0<c.length&&0<a;){a+=l;l=0;r=[];for(t=c.length-1;0<=t;--t)b=c[t],m=b.content.find(".aloha-sidebar-panel-content-inner"),e=x.min(m.height("auto").height(),x.floor(a/(t+1))),m.height(e),a-=e,g=m.find(".aloha-sidebar-panel-content-inner-text"),g.height()>e?(r.push(b),l+=e,m.css({"overflow-x":"hidden","overflow-y":"scroll"})):m.css("overflow-y","hidden"),b.expanded&&
b.expand();c=r}}}else this.correctHeightWhenCompletelyOpen=!0},showActivePanel:function(a,b){b.push(null);a.content.parent("li");var c=a.activeOn,j=f(),e=0,m=b.length,k;for(k=0;k<m;++k)c(b[k])&&(++e,b[k]&&f.merge(j,b[k]));e?a.activate(j):a.deactivate()},initToggler:function(){var a=this,b=this.container,c=b.find(".aloha-sidebar-handle-icon"),j,e="right"===this.position;this.opened&&this.rotateHandleArrow(e?0:180,0);f(function(){"undefined"!==typeof l.settings.sidebar&&(l.settings.sidebar.handle&&
l.settings.sidebar.handle.top)&&(f(b.find(".aloha-sidebar-handle"))[0].style.top=l.settings.sidebar.handle.top)});b.find(".aloha-sidebar-handle").click(function(){j&&clearInterval(j);c.stop().css("marginLeft",4);a.isOpen?(f(this).removeClass("aloha-sidebar-toggled"),a.close(),a.isOpen=!1):(f(this).addClass("aloha-sidebar-toggled"),a.open(),a.isOpen=!0)}).hover(function(){var b=a.isOpen?-1:1;j&&clearInterval(j);c.stop();f(this).stop().animate(e?{marginLeft:"-="+5*b}:{marginRight:"-="+5*b},200);j=setInterval(function(){b*=
-1;c.animate(e?{left:"-="+4*b}:{right:"-="+4*b},300)},300)},function(){j&&clearInterval(j);c.stop().css(e?"left":"right",5);f(this).stop().animate(e?{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var a=this.container,b=a.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)");a.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass("aloha-sidebar-panel-top").removeClass("aloha-sidebar-panel-bottom");b.first().find(".aloha-sidebar-panel-title").addClass("aloha-sidebar-panel-top");
b.last().find(".aloha-sidebar-panel-content").addClass("aloha-sidebar-panel-bottom")},updateHeight:function(){var a=f(window).height();this.container.height(a).find(".aloha-sidebar-inner").height(a)},barClicked:function(a){this.handleBarclick(f(a.target))},handleBarclick:function(a){a.hasClass("aloha-sidebar-panel-title")?this.togglePanel(a):!a.hasClass("aloha-sidebar-panel-content")&&(!a.hasClass("aloha-sidebar-handle")&&!a.hasClass("aloha-sidebar-bar"))&&this.handleBarclick(a.parent())},getPanelById:function(a){return this.panels[a]},
getPanelByElement:function(a){return this.getPanelById(("LI"===a[0].tagName?a:a.parent("li"))[0].id)},togglePanel:function(a){this.getPanelByElement(a).toggle()},rotateHandleIcon:function(a,b){var c=this.container.find(".aloha-sidebar-handle-icon");c.animate({angle:a},{duration:"number"===typeof b||"string"===typeof b?b:500,easing:"easeOutExpo",step:function(a){c.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+
a+"deg)"})}})},toggleHandleIcon:function(a){a^="right"===this.position;if(this.settings.rotateIcons)this.rotateHandleIcon(a?180:0,0);else{var b=this.container.find(".aloha-sidebar-handle-icon");a?b.addClass("aloha-sidebar-handle-icon-left"):b.removeClass("aloha-sidebar-handle-icon-left")}},open:function(a){if(this.isOpen)return this;var b="right"===this.position,c=b?{marginRight:0}:{marginLeft:0},j=this;this.toggleHandleIcon(!0);this.container.animate(c,"number"===typeof a||"string"===typeof a?a:
500,"easeOutExpo");this.settings.overlayPage||f("body").animate(b?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},500,"easeOutExpo",function(){j.isCompletelyOpen=!0;j.correctHeightWhenCompletelyOpen&&j.correctHeight()});this.isOpen=!0;this.correctHeight();this.lastRange&&this.checkActivePanels(this.lastRange);f("body").trigger("aloha-sidebar-opened",this);return this},close:function(a){if(!this.isOpen)return this;var b="right"===this.position,c=b?{marginRight:-this.width}:{marginLeft:-this.width};
this.toggleHandleIcon(!1);this.container.animate(c,"number"===typeof a||"string"===typeof a?a:500,"easeOutExpo");this.settings.overlayPage||f("body").animate(b?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo");this.isCompletelyOpen=this.isOpen=!1;return this},activatePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.activate(b);this.roundCorners();return this},expandPanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.expand(b);return this},
collapsePanel:function(a,b){"string"===typeof a&&(a=this.getPanelById(a));a&&a.collapse(b);return this},addPanel:function(d){d instanceof b||(d.width||(d.width=this.width),d.sidebar=this,d=new b(d));this.panels[d.id]=d;this.container.find(".aloha-sidebar-panels").append(d.element);this.checkActivePanels(a.getRangeObject());return d}});f.extend(b.prototype,{init:function(a){this.setTitle(a.title).setContent(a.content);delete a.title;delete a.content;f.extend(this,a);this.id||(this.id="aloha-sidebar-"+
++c);this.element=f('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto");this.toggleTitleIcon(this.expanded);this.coerceActiveOn();this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return false}});"function"===typeof this.onInit&&this.onInit.apply(this)},toggleTitleIcon:function(a){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(a?90:0);else{var b=this.title.find(".aloha-sidebar-panel-title-arrow");
a?b.addClass("aloha-sidebar-panel-title-arrow-down"):b.removeClass("aloha-sidebar-panel-title-arrow-down")}},coerceActiveOn:function(){if("function"!==typeof this.activeOn){var a=this.activeOn;this.activeOn=function(){var b=typeof a;return"boolean"===b?function(){return a}:"undefined"===b?function(){return!0}:"string"===b?function(b){return b?b.is(a):!1}:function(){return!1}}()}},activate:function(a){this.isActive=!0;this.content.parent("li").show().removeClass("aloha-sidebar-deactivated");this.effectiveElement=
a;"function"===typeof this.onActivate&&this.onActivate.call(this,a)},deactivate:function(){this.isActive&&(this.isActive=!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null)},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(a){var b=this,c=this.content,j=c.height(),e=c.height("auto").height();c.height(j).stop().animate({height:e},500,"easeOutExpo",function(){"function"===typeof a&&a.call(b)});this.element.removeClass("collapsed");
this.toggleTitleIcon(!0);this.expanded=!0;return this},collapse:function(a,b){var c=this;this.element.addClass("collapsed");this.content.stop().animate({height:3},250,"easeOutExpo",function(){"function"===typeof b&&b.call(c)});this.toggleTitleIcon(!1);this.expanded=!1;return this},setTitle:function(a){this.title.find(".aloha-sidebar-panel-title-text").html(a);return this},setContent:function(a){if(!a||""===a)a="&nbsp;";this.content.find(".aloha-sidebar-panel-content-inner-text").html(a);return this},
rotateTitleIcon:function(a,b){var c=this.title.find(".aloha-sidebar-panel-title-arrow");c.animate({angle:a},{duration:"number"===typeof b?b:500,easing:"easeOutExpo",step:function(a){c.css({"-o-transform":"rotate("+a+"deg)","-webkit-transform":"rotate("+a+"deg)","-moz-transform":"rotate("+a+"deg)","-ms-transform":"rotate("+a+"deg)"})}})},renderEffectiveParents:function(a,b){for(var c=a.first(),j=[],e=[],m=this.activeOn,k,g;0<c.length&&!c.is(".aloha-editable");){if(m(c)){e.push("<span>"+c[0].tagName.toLowerCase()+
"</span>");k=e.length;for(g=[];k--;)g.push(e[k]);j.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+g.join("")+'</div><div class="aloha-sidebar-panel-parent-contentaloha-sidebar-opened">'+("function"===typeof b?b(c):"----")+"</div></div>")}c=c.parent()}this.setContent(j.join(""));f(".aloha-sidebar-panel-parent-path").click(function(){var a=f(this).parent().find(".aloha-sidebar-panel-parent-content");a.hasClass("aloha-sidebar-opened")?a.hide().removeClass("aloha-sidebar-opened"):
a.show().addClass("aloha-sidebar-opened")});this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});var m=new e({position:"left",width:250}),e=new e({position:"right",width:250});l.Sidebar={left:m,right:e};return l.Sidebar});window.GENTICS=window.GENTICS||{};window.GENTICS.Utils=window.GENTICS.Utils||{};define("util/position",["jquery"],function(l){var f=window.GENTICS;f.Utils.Position={};f.Utils.Position.w=l(window);f.Utils.Position.Scroll={top:0,left:0,isScrolling:!1};
f.Utils.Position.ScrollCorrection={top:100,left:50};f.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0};f.Utils.Position.mouseStopCallbacks=[];f.Utils.Position.mouseMoveCallbacks=[];f.Utils.Position.update=function(){var a=this.w.scrollTop(),g=this.w.scrollLeft();if(this.Scroll.isScrolling)this.Scroll.top==a&&this.Scroll.left==g&&(this.Scroll.isScrolling=!1);else if(this.Scroll.top!=a||this.Scroll.left!=g)this.Scroll.isScrolling=!0;this.Scroll.top=a;this.Scroll.left=g;
if(this.Mouse.x==this.Mouse.oldX&&this.Mouse.y==this.Mouse.oldY){if(this.Mouse.isMoving=!1,!this.Mouse.triggeredMouseStop){this.Mouse.triggeredMouseStop=!0;for(a=0;a<this.mouseStopCallbacks.length;a++)this.mouseStopCallbacks[a].call()}}else{this.Mouse.isMoving=!0;this.Mouse.triggeredMouseStop=!1;for(a=0;a<this.mouseMoveCallbacks.length;a++)this.mouseMoveCallbacks[a].call()}this.Mouse.oldX=this.Mouse.x;this.Mouse.oldY=this.Mouse.y};f.Utils.Position.addMouseStopCallback=function(a){this.mouseStopCallbacks.push(a);
return this.mouseStopCallbacks.length-1};f.Utils.Position.addMouseMoveCallback=function(a){this.mouseMoveCallbacks.push(a);return this.mouseMoveCallbacks.length-1};l(function(){window.setInterval(function(){f.Utils.Position.update()},500)});l("html").mousemove(function(a){f.Utils.Position.Mouse.x=a.pageX;f.Utils.Position.Mouse.y=a.pageY})});define("aloha/repositoryobjects",["aloha/core","util/class"],function(l,f){var a=window.GENTICS;l.RepositoryObject=function(){};l.RepositoryDocument=f.extend({_constructor:function(g){this.type=
"document";g.id&&(g.name&&g.repositoryId)&&(a.Utils.applyProperties(this,g),this.baseType="document")}});l.RepositoryFolder=f.extend({_constructor:function(g){this.type="folder";g.id&&(g.name&&g.repositoryId)&&(a.Utils.applyProperties(this,g),this.baseType="folder")}})});define("aloha/repositorymanager","jquery util/class util/arrays aloha/core aloha/console aloha/repositoryobjects".split(" "),function(l,f,a,g,c){function b(a,b){var c={items:a,results:a.length};if(b){c.numItems=b.numItems;c.hasMoreItems=
b.hasMoreItems;c.timeout=b.timeout}return c}function e(a,b){a(b)}var k=function(a){return typeof a.query==="function"},j=function(a){return typeof a.getChildren==="function"},m=function(a){return typeof a.getSelectedFolder==="function"},f=f.extend({repositories:[],settings:g.settings&&g.settings.repositories||{},initialized:false,init:function(){if(typeof this.settings.timeout==="undefined")this.settings.timeout=5E3;var a;for(a=0;a<this.repositories.length;a++)this.initRepository(this.repositories[a]);
this.initialized=true},register:function(a){if(this.getRepository(a.repositoryId))c.warn(this,'A repository with name "'+a.repositoryId+'" already registerd. Ignoring this.');else{this.repositories.push(a);this.initialized&&this.initRepository(a)}},initRepository:function(a){if(!a.settings)a.settings={};this.settings[a.repositoryId]&&l.extend(a.settings,this.settings[a.repositoryId]);a.init()},getRepository:function(a){var b;for(b=0;b<this.repositories.length;b++)if(this.repositories[b].repositoryId===
a)return this.repositories[b];return null},query:function(d,j){var m=this,g,f=[],q={numItems:0,hasMoreItems:false},r,u=d.timeout&&parseInt(d.timeout,10)||m.settings.timeout,x=window.setTimeout(function(){q=q||{};q.timeout=true;if(r>0){c.warn(m,r+" repositories did not return before the configured timeout of "+u+"ms.");r=0}clearTimeout(x);var a=b(f,q);j(a)},u),t=function(a,d){if(0!==r){if(a&&a.length){if(!a[0].repositoryId){var e=this.repositoryId,k;for(k=0;k<a.length;k++)a[k].repositoryId=e}l.merge(f,
a)}if(d&&q){q.numItems=l.isNumeric(d.numItems)&&l.isNumeric(q.numItems)?q.numItems+d.numItems:void 0;q.hasMoreItems=typeof d.hasMoreItems==="boolean"&&typeof q.hasMoreItems==="boolean"?q.hasMoreItems||d.hasMoreItems:void 0;if(d.timeout)q.timeout=true}else q=void 0;c.debug(m,"The repository "+this.repositoryId+"returned with "+a.length+" results.");if(0===--r){clearTimeout(x);e=b(f,q);j(e)}}};g=d.repositoryId?[m.getRepository(d.repositoryId)]:m.repositories;var v=a.filter(g,k);if(0===v.length){clearTimeout(x);
e(j,b(f,q))}else{var B=function(a){return function(){t.apply(a,arguments)}};r=v.length;for(g=0;g<v.length;g++)v[g].query(d,B(v[g]))}},getChildren:function(b,e){var m=this,k,f=[],q=0,r=b.timeout&&parseInt(b.timeout,10)||m.settings.timeout,u=window.setTimeout(function(){if(q>0){c.warn(m,q+" repositories did not respond before the configured timeout of "+r+"ms.");q=0}clearTimeout(u);e(f)},r),x=function(a){if(0!==q){a&&l.merge(f,a);if(0===--q){clearTimeout(u);e(f)}}},t=b.repositoryId?[m.getRepository(b.repositoryId)]:
m.repositories;b.repositoryFilter&&b.repositoryFilter.length&&(t=a.filter(t,function(a){return-1<l.inArray(a.repositoryId,b.repositoryFilter)}));if("aloha"===b.inFolderId){for(k=0;k<t.length;k++)f.push(new g.RepositoryFolder({id:t[k].repositoryId,name:t[k].repositoryName,repositoryId:t[k].repositoryId,type:"repository",hasMoreItems:true}));clearTimeout(u);e(f)}else{t=a.filter(t,j);if(0===t.length){clearTimeout(u);e(f)}else{q=t.length;for(k=0;k<t.length;k++)t[k].getChildren(b,x)}}},makeClean:function(a){var b=
this,j={},e=0,m=b.repositories.length;a.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){for(;e<m;){j.makeClean(a);e=e+1}c.debug(b,"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+j.repositoryId+" }");j.makeClean(this)})},markObject:function(a,b){if(a)if(b){var j=this.getRepository(b.repositoryId);if(j){l(a).attr({"data-gentics-aloha-repository":b.repositoryId,"data-gentics-aloha-object-id":b.id});j.markObject(a,b)}else c.error(this,
'Trying to apply a repository "'+b.name+'" to an object, but item has no repositoryId.')}else l(a).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")},getObject:function(a,b){var c=l(a),j=c.attr("data-gentics-aloha-object-id"),c=c.attr("data-gentics-aloha-repository"),e=this.getRepository(c);if(e&&j){if(!this.itemCache)this.itemCache=[];var m=this.itemCache[c];m||(m=this.itemCache[c]=[]);m[j]?b([m[j]]):e.getObjectById(j,function(a){m[j]=a[0];b(a)})}},folderOpened:function(a){var b=
this.getRepository(a.repositoryId);typeof b.folderOpened==="function"&&b.folderOpened(a)},folderClosed:function(a){var b=this.getRepository(a.repositoryId);typeof b.folderClosed==="function"&&b.folderClosed(a)},folderSelected:function(a){var b=this.getRepository(a.repositoryId);typeof b.folderSelected==="function"&&b.folderSelected(a)},getSelectedFolder:function(){var b=a.filter(this.repositories,m),c,j;for(c=0;c<b.length;c++)if(j=b[c].getSelectedFolder())return j;return null},toString:function(){return"repositorymanager"}});
g.RepositoryManager=new f;return g.RepositoryManager});define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],function(l,f,a){f=f.extend({_constructor:function(g,c){this.repositoryId=g;this.settings={};this.repositoryName=c||g;a.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(){},markObject:function(){},setTemplate:function(a){this.template=a?a:null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},
getObjectById:function(){return!0}});return l.AbstractRepository=f});(function(l){function f(){var a,b,d=Aloha.settings.plugins&&Aloha.settings.plugins.load,c=Aloha.settings.baseUrl,e,k=/\/aloha.js(\?\S*)?$/,g=/\/[^\/]*\.js$/,f;if(!d||!c){a=document.getElementsByTagName("script");for(f=0;f<a.length;f++){b=a[f];e=b.getAttribute("data-aloha-plugins");if(null!=e){d||(d=e);c||(c=b.src.replace(g,""));break}!c&&k.test(b.src)&&(c=b.src.replace(k,""))}}"string"===typeof d&&""!==d&&(d=d.replace(/\s+/g,"").split(","));
return{baseUrl:c,plugins:d||[]}}function a(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++)if("true"===a[b].getAttribute("data-aloha-defer-init"))return!0;return!1}function g(a){var b={},d=[],c={},e={},k,g,f=Aloha.settings.basePath||"",r=Aloha.settings.bundles||{},l;for(l=0;l<a.length;l++){k=a[l].split("/");g=k[0];k=k[1];g=r[g]?f+r[g]:f+"../plugins/"+g;var x=b,t=g,v=k,B=["nls","css","vendor","res"],C=void 0,z=void 0;x[v]=t+"/"+v+"/lib";for(z=0;z<B.length;z++)C=B[z],x[v+"/"+
C]=t+"/"+v+"/"+C;c[k]=g+"/"+k;d.push(k+"/"+k+"-plugin");e[k]={jquery:"aloha/jquery"}}return{paths:b,entryPoints:d,baseUrlByName:c,names:[],map:e}}function c(){var a={},b=Array.prototype.slice.call(arguments),d,c,e;for(c=0;c<b.length;c++)for(d in e=b[c],e)e.hasOwnProperty(d)&&(a[d]=b[c][d]);return a}function b(a,b){define(a,function(){return b})}function e(){Aloha.features={};Aloha.defaults={};Aloha.settings=Aloha.settings||{};Aloha.initialize=k.start;var a=f(),e=g(a.plugins);Aloha.settings.baseUrl=
a.baseUrl;Aloha.settings.loadedPlugins=e.names;Aloha.settings._pluginBaseUrlByName=e.baseUrlByName;a=c({aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},e.map);a={context:"aloha",
config:{i18n:{locale:Aloha.settings.locale||"en"}},baseUrl:Aloha.settings.baseUrl,map:a};(l.__DEPS__||(l.__DEPS__={})).lang=a.locale;var d=c(a,Aloha.settings.requireConfig);d.paths=c({jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9.0.custom-aloha"},{PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout-1.3.0-rc30.7",
"jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},e.paths,d.paths);a=Aloha.settings.predefinedModules||{};Aloha.settings.jQuery&&(a.jquery=Aloha.settings.jQuery);for(var p in a)a.hasOwnProperty(p)&&(b(p,a[p]),delete d.paths[p]);var n=require.config(d);Aloha.require=function(a){return 1===
arguments.length&&typeof a==="function"?n(["aloha"],a):n.apply(this,arguments)};Aloha.bind=function(a,b){Aloha.require(["aloha/jquery"],function(d){Aloha.bind=function(a,b){switch(k.getReadiness(a)){case "deferred":var c=k.getPhaseByEvent(a);if(!c.deferred)c.deferred=d.Deferred();c.deferred.done(b);break;case "immediate":b();break;case "normal":d(Aloha,"body").bind(a,b);break;default:throw"Unknown readiness";}return this};Aloha.bind(a,b)});return this};Aloha.trigger=function(a,b){Aloha.require(["aloha/jquery"],
function(d){Aloha.trigger=function(a,b){var c=k.getPhaseByEvent(a);if(c&&c.deferred){d(c.deferred.resolve);c.deferred=null}d(Aloha,"body").trigger(a,b);return this};Aloha.trigger(a,b)});return this};Aloha.unbind=function(a){Aloha.require(["aloha/jquery"],function(b){Aloha.unbind=function(a){b(Aloha,"body").unbind(a)};Aloha.unbind(a)})};Aloha.ready=function(a){this.bind("aloha-ready",a);return this};var s=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(a){return s||a});Aloha.jQuery=
s;define("aloha","aloha/jquery util/json2 aloha/rangy-core util/class util/lang util/range util/dom aloha/core aloha/editable aloha/console aloha/markup aloha/plugin aloha/selection aloha/command aloha/jquery.aloha aloha/sidebar util/position aloha/repositorymanager aloha/repository aloha/repositoryobjects aloha/contenthandlermanager".split(" "),function(a){Aloha.features.jquery=true;Aloha.jQuery=a;Aloha.settings=a.extendObjects(true,{},Aloha.defaults,Aloha.settings);return Aloha});require(d,["aloha",
"aloha/jquery"],function(a,b){require(d,e.entryPoints,function(){b(function(){window.rangy.init();a.init()})})})}var k={phases:[],completed:[],start:function(a,b){k.phases=k.phases.concat(a);k.proceed(0,a,b)},proceed:function(a,b,d){if(a<b.length){var c=b[a],e=function(){k.proceed(++a,b,d)},g=function(){k.completed.push(c);c.event&&Aloha.trigger(c.event)};c.fn?c.fn(g,e):(g(),e())}else d&&d()},getPhaseByEvent:function(a){var b;for(b=0;b<k.phases.length;b++)if(a===k.phases[b].event)return k.phases[b];
return null},getReadiness:function(a){var b;for(b=0;b<k.completed.length;b++)if(a===k.completed[b].event)return"immediate";return k.getPhaseByEvent(a)?"deferred":"normal"}};l.Aloha=l.Aloha||{};l.Aloha.deferInit||a()?l.Aloha.deferInit=e:Aloha._load=e})(window);define("ui/context",["aloha","jquery","util/class"],function(l,f,a){var g;g=f("#aloha-ui-context");g.length||(g=f("<div>",{"class":"aloha",id:"aloha-ui-context"}),f(function(){g.appendTo("body")}));l=a.extend({surfaces:[],containers:[]});f.extend(l,
{selector:"#aloha-ui-context",element:g});return l});define("ui/scopes",["jquery","PubSub","util/maps"],function(l,f,a){function g(a,b){if(c.hasOwnProperty(b))for(var j=c[b],e=0;e<j.length;e++){var k=j[e];a.push(k);g(a,k)}}var c={"Aloha.empty":[],"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},b=[],e={},k=!1;Aloha.bind("aloha-selection-changed-before",function(){k=!1});Aloha.bind("aloha-selection-changed-after",function(a,b,c){"undefined"!==typeof c&&!k&&j.setScope("Aloha.continuoustext")});
var j={enterScope:function(a,b){var b=b||"_globalCounter",c=e[a];c||(c=e[a]={});var j=c[b]||0;c[b]=j+1;j||f.pub("aloha.ui.scope.change")},leaveScope:function(b,d,c){var d=d||"_globalCounter",j=e[b];if(j){var k=j[d];k&&((k-=1)&&!c?j[d]=k:(delete j[d],a.isEmpty(j)&&delete e[b],f.pub("aloha.ui.scope.change")))}},isActiveScope:function(a){return e[a]||-1!==l.inArray(a,b)?!0:!1},getPrimaryScope:function(){return b[0]},setScope:function(a){k=!0;b[0]!=a&&(b=[a],g(b,a),f.pub("aloha.ui.scope.change"))},createScope:function(a,
b){b?"string"===typeof b&&(b=[b]):b=["Aloha.empty"];c[a]=b}};return j});define("ui/container",["jquery","util/class","ui/scopes"],function(l,f,a){function g(c,j){switch(l.type(j)){case "function":return j;case "object":if(j.scope)return b[j.scope]?b[j.scope]:b[j.scope]=function(){return a.isActiveScope(j.scope)};throw"Invalid showOn configuration";default:return e}}var c=0,b={},e=function(){return!0},f=f.extend({element:null,_constructor:function(a,b){var e=g(this,b.showOn),d;e.showOnId||(e.showOnId=
++c);d=e.showOnId;var f=a.containers[d];this.context=a;f||(f=a.containers[d]={shouldShow:e,containers:[]});f.containers.push(this)},show:function(){},hide:function(){},focus:function(){},foreground:function(){},childVisible:function(){},childFocus:function(){},childForeground:function(){}});l.extend(f,{showContainersForContext:function(a,b){var c,d,e;if(a.containers)for(d in e=a.containers,e)if(e.hasOwnProperty(d)){c=e[d];var g=c.containers;c=c.shouldShow(b)?"show":"hide";for(var f=void 0,f=0;f<g.length;f++)g[f][c]()}}});
return f});define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(l,f,a){var g=a.extend({_constructor:function(a){a.surfaces.push(this)},isActive:function(){return!0}});f.extend(g,{range:null,show:function(a){f.each(a.surfaces,function(a,c){c.show()})},hide:function(a){f.each(a.surfaces,function(a,c){c.hide()})},trackRange:function(a){a.bind("mousedown",function(a){a.originalEvent.stopSelectionUpdate=!0;l.eventHandled=!0;g.suppressHide=!0;l.activeEditable&&(a=l.getSelection(),
g.range=0<a.getRangeCount()?a.getRangeAt(0):null)});a.bind("mouseup",function(a){a.originalEvent.stopSelectionUpdate=!0;l.eventHandled=!1;g.suppressHide=!1})}});return g});define("ui/component",["aloha/core","jquery","util/class"],function(l,f,a){var g=0;return a.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=g++;this.init()},adoptParent:function(a){this.container=a},init:function(){},isVisible:function(){return this.visible},show:function(a){!1===a?
this.hide():this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0))},hide:function(){this.visible&&(this.visible=!1,this.element.hide(),this.container&&this.container.childVisible(this,!1))},focus:function(){this.element.focus();this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(){},disable:function(){}})});define("jqueryui",["jquery"],function(l){(function(f,
a){function g(a,b){var e,d;e=a.nodeName.toLowerCase();if("area"===e){e=a.parentNode;d=e.name;if(!a.href||!d||"map"!==e.nodeName.toLowerCase())return!1;e=f("img[usemap=#"+d+"]")[0];return!!e&&c(e)}return(/input|select|textarea|button|object/.test(e)?!a.disabled:"a"===e?a.href||b:b)&&c(a)}function c(a){return!f(a).parents().andSelf().filter(function(){return"hidden"===f.css(this,"visibility")||f.expr.filters.hidden(this)}).length}var b=0,e=/^ui-id-\d+$/;f.ui=f.ui||{};f.ui.version||(f.extend(f.ui,{version:"1.9.0",
keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),f.fn.extend({_focus:f.fn.focus,focus:function(a,b){return"number"===typeof a?this.each(function(){var c=this;setTimeout(function(){f(c).focus();b&&b.call(c)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=f.browser.msie&&
/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(f.css(this,"position"))&&/(auto|scroll)/.test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?f(document):a},zIndex:function(b){if(b!==
a)return this.css("zIndex",b);if(this.length)for(var b=f(this[0]),c;b.length&&b[0]!==document;){c=b.css("position");if("absolute"===c||"relative"===c||"fixed"===c)if(c=parseInt(b.css("zIndex"),10),!isNaN(c)&&0!==c)return c;b=b.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++b)})},removeUniqueId:function(){return this.each(function(){e.test(this.id)&&f(this).removeAttr("id")})}}),f("<a>").outerWidth(1).jquery||f.each(["Width","Height"],function(b,c){function e(a,
b,c,j){f.each(d,function(){b-=parseFloat(f.css(a,"padding"+this))||0;c&&(b-=parseFloat(f.css(a,"border"+this+"Width"))||0);j&&(b-=parseFloat(f.css(a,"margin"+this))||0)});return b}var d="Width"===c?["Left","Right"]:["Top","Bottom"],g=c.toLowerCase(),n={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};f.fn["inner"+c]=function(b){return b===a?n["inner"+c].call(this):this.each(function(){f(this).css(g,e(this,b)+"px")})};f.fn["outer"+c]=
function(a,b){return"number"!==typeof a?n["outer"+c].call(this,a):this.each(function(){f(this).css(g,e(this,a,!0,b)+"px")})}}),f.extend(f.expr[":"],{data:f.expr.createPseudo?f.expr.createPseudo(function(a){return function(b){return!!f.data(b,a)}}):function(a,b,c){return!!f.data(a,c[3])},focusable:function(a){return g(a,!isNaN(f.attr(a,"tabindex")))},tabbable:function(a){var b=f.attr(a,"tabindex"),c=isNaN(b);return(c||0<=b)&&g(a,!c)}}),f(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));
b.offsetHeight;f.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});f.support.minHeight=100===b.offsetHeight;f.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"}),f.fn.extend({disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),f.extend(f.ui,{plugin:{add:function(a,b,c){var d,
a=f.ui[a].prototype;for(d in c)a.plugins[d]=a.plugins[d]||[],a.plugins[d].push([b,c[d]])},call:function(a,b,c){var d=a.plugins[b];if(d&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;b<d.length;b++)a.options[d[b][0]]&&d[b][1].apply(a.element,c)}},contains:f.contains,hasScroll:function(a,b){if("hidden"===f(a).css("overflow"))return!1;var c=b&&"left"===b?"scrollLeft":"scrollTop",d=!1;if(0<a[c])return!0;a[c]=1;d=0<a[c];a[c]=0;return d},isOverAxis:function(a,b,c){return a>b&&a<
b+c},isOver:function(a,b,c,d,e,g){return f.ui.isOverAxis(a,c,e)&&f.ui.isOverAxis(b,d,g)}}))})(l);(function(f,a){var g=0,c=Array.prototype.slice,b=f.cleanData;f.cleanData=function(a){for(var c=0,j;null!=(j=a[c]);c++)try{f(j).triggerHandler("remove")}catch(m){}b(a)};f.widget=function(a,b,c){var m,d,g,n,l=a.split(".")[0],a=a.split(".")[1];m=l+"-"+a;c||(c=b,b=f.Widget);f.expr[":"][m.toLowerCase()]=function(a){return!!f.data(a,m)};f[l]=f[l]||{};d=f[l][a];g=f[l][a]=function(a,b){if(!this._createWidget)return new g(a,
b);arguments.length&&this._createWidget(a,b)};f.extend(g,d,{version:c.version,_proto:f.extend({},c),_childConstructors:[]});n=new b;n.options=f.widget.extend({},n.options);f.each(c,function(a,d){f.isFunction(d)&&(c[a]=function(){var c=function(){return b.prototype[a].apply(this,arguments)},j=function(d){return b.prototype[a].apply(this,d)};return function(){var a=this._super,b=this._superApply,e;this._super=c;this._superApply=j;e=d.apply(this,arguments);this._super=a;this._superApply=b;return e}}())});
g.prototype=f.widget.extend(n,{widgetEventPrefix:a},c,{constructor:g,namespace:l,widgetName:a,widgetBaseClass:m,widgetFullName:m});d?(f.each(d._childConstructors,function(a,b){var d=b.prototype;f.widget(d.namespace+"."+d.widgetName,g,b._proto)}),delete d._childConstructors):b._childConstructors.push(g);f.widget.bridge(a,g)};f.widget.extend=function(b){for(var k=c.call(arguments,1),j=0,m=k.length,d,g;j<m;j++)for(d in k[j])g=k[j][d],k[j].hasOwnProperty(d)&&g!==a&&(b[d]=f.isPlainObject(g)?f.widget.extend({},
b[d],g):g);return b};f.widget.bridge=function(b,k){var j=k.prototype.widgetFullName;f.fn[b]=function(m){var d="string"===typeof m,g=c.call(arguments,1),n=this,m=!d&&g.length?f.widget.extend.apply(null,[m].concat(g)):m;d?this.each(function(){var d,c=f.data(this,j);if(!c)return f.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+m+"'");if(!f.isFunction(c[m])||"_"===m.charAt(0))return f.error("no such method '"+m+"' for "+b+" widget instance");d=c[m].apply(c,g);
if(d!==c&&d!==a)return n=d&&d.jquery?n.pushStack(d.get()):d,!1}):this.each(function(){var a=f.data(this,j);a?a.option(m||{})._init():new k(m,this)});return n}};f.Widget=function(){};f.Widget._childConstructors=[];f.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,b){b=f(b||this.defaultElement||this)[0];this.element=f(b);this.uuid=g++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=f.widget.extend({},
this.options,this._getCreateOptions(),a);this.bindings=f();this.hoverable=f();this.focusable=f();b!==this&&(f.data(b,this.widgetName,this),f.data(b,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=f(b.style?b.ownerDocument:b.document||b),this.window=f(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:f.noop,_getCreateEventData:f.noop,_create:f.noop,_init:f.noop,destroy:function(){this._destroy();
this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(f.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:f.noop,widget:function(){return this.element},option:function(b,c){var j=b,m,d,g;
if(0===arguments.length)return f.widget.extend({},this.options);if("string"===typeof b)if(j={},m=b.split("."),b=m.shift(),m.length){d=j[b]=f.widget.extend({},this.options[b]);for(g=0;g<m.length-1;g++)d[m[g]]=d[m[g]]||{},d=d[m[g]];b=m.pop();if(c===a)return d[b]===a?null:d[b];d[b]=c}else{if(c===a)return this.options[b]===a?null:this.options[b];j[b]=c}this._setOptions(j);return this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){this.options[a]=
b;"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"));return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(a,b){b?(a=f(a),this.bindings=this.bindings.add(a)):(b=a,a=this.element);var c=this;f.each(b,function(b,d){function k(){if(!(c.options.disabled===
true||f(this).hasClass("ui-state-disabled")))return(typeof d==="string"?c[d]:d).apply(c,arguments)}if(typeof d!=="string")k.guid=d.guid=d.guid||k.guid||f.guid++;var g=b.match(/^(\w+)\s*(.*)$/),l=g[1]+c.eventNamespace;(g=g[2])?c.widget().delegate(g,l,k):a.bind(l,k)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var c=this;return setTimeout(function(){return("string"===typeof a?c[a]:a).apply(c,arguments)},
b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){f(a.currentTarget).addClass("ui-state-hover")},mouseleave:function(a){f(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){f(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){f(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,b,c){var m,d=this.options[a],c=c||{},b=f.Event(b);
b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();b.target=this.element[0];if(a=b.originalEvent)for(m in a)m in b||(b[m]=a[m]);this.element.trigger(b,c);return!(f.isFunction(d)&&!1===d.apply(this.element[0],[b].concat(c))||b.isDefaultPrevented())}};f.each({show:"fadeIn",hide:"fadeOut"},function(a,b){f.Widget.prototype["_"+a]=function(c,m,d){"string"===typeof m&&(m={effect:m});var g,n=!m?a:!0===m||"number"===typeof m?b:m.effect||b,m=m||{};"number"===typeof m&&(m={duration:m});
g=!f.isEmptyObject(m);m.complete=d;m.delay&&c.delay(m.delay);if(g&&f.effects&&(f.effects.effect[n]||!1!==f.uiBackCompat&&f.effects[n]))c[a](m);else if(n!==a&&c[n])c[n](m.duration,m.easing,d);else c.queue(function(b){f(this)[a]();d&&d.call(c[0]);b()})}});!1!==f.uiBackCompat&&(f.Widget.prototype._getCreateOptions=function(){return f.metadata&&f.metadata.get(this.element[0])[this.widgetName]})})(l);(function(f){var a=!1;f(document).mouseup(function(){a=!1});f.widget("ui.mouse",{version:"1.9.0",options:{cancel:"input,textarea,button,select,option",
distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(!0===f.data(c.target,a.widgetName+".preventClickEvent"))return f.removeData(c.target,a.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&f(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+
this.widgetName,this._mouseUpDelegate)},_mouseDown:function(g){if(!a){this._mouseStarted&&this._mouseUp(g);this._mouseDownEvent=g;var c=this,b=1===g.which,e="string"===typeof this.options.cancel&&g.target.nodeName?f(g.target).closest(this.options.cancel).length:!1;if(!b||e||!this._mouseCapture(g))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(g)&&this._mouseDelayMet(g)&&
(this._mouseStarted=!1!==this._mouseStart(g),!this._mouseStarted))return g.preventDefault(),!0;!0===f.data(g.target,this.widgetName+".preventClickEvent")&&f.removeData(g.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return c._mouseMove(a)};this._mouseUpDelegate=function(a){return c._mouseUp(a)};f(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);g.preventDefault();return a=!0}},_mouseMove:function(a){if(f.browser.msie&&
!(9<=document.documentMode)&&!a.button)return this._mouseUp(a);if(this._mouseStarted)return this._mouseDrag(a),a.preventDefault();this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a))?this._mouseDrag(a):this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){f(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=
!1,a.target===this._mouseDownEvent.target&&f.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(l);(function(f,a){function g(a,b,d){return[parseInt(a[0],
10)*(s.test(a[0])?b/100:1),parseInt(a[1],10)*(s.test(a[1])?d/100:1)]}function c(a,b){return parseInt(f.css(a,b),10)||0}f.ui=f.ui||{};var b,e=Math.max,k=Math.abs,j=Math.round,m=/left|center|right/,d=/top|center|bottom/,p=/[\+\-]\d+%?/,n=/^\w+/,s=/%$/,o=f.fn.position;f.position={scrollbarWidth:function(){if(b!==a)return b;var d,c,j=f("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");c=j.children()[0];f("body").append(j);d=c.offsetWidth;
j.css("overflow","scroll");c=c.offsetWidth;d===c&&(c=j[0].clientWidth);j.remove();return b=d-c},getScrollInfo:function(a){var b=a.isWindow?"":a.element.css("overflow-x"),d=a.isWindow?"":a.element.css("overflow-y"),d="scroll"===d||"auto"===d&&a.height<a.element[0].scrollHeight;return{width:"scroll"===b||"auto"===b&&a.width<a.element[0].scrollWidth?f.position.scrollbarWidth():0,height:d?f.position.scrollbarWidth():0}},getWithinInfo:function(a){var a=f(a||window),b=f.isWindow(a[0]);return{element:a,
isWindow:b,offset:a.offset()||{left:0,top:0},scrollLeft:a.scrollLeft(),scrollTop:a.scrollTop(),width:b?a.width():a.outerWidth(),height:b?a.height():a.outerHeight()}}};f.fn.position=function(a){if(!a||!a.of)return o.apply(this,arguments);var a=f.extend({},a),b,l,s,t,v,B=f(a.of),C=f.position.getWithinInfo(a.within),z=f.position.getScrollInfo(C),A=B[0],E=(a.collision||"flip").split(" "),K={};9===A.nodeType?(l=B.width(),s=B.height(),t={top:0,left:0}):f.isWindow(A)?(l=B.width(),s=B.height(),t={top:B.scrollTop(),
left:B.scrollLeft()}):A.preventDefault?(a.at="left top",l=s=0,t={top:A.pageY,left:A.pageX}):(l=B.outerWidth(),s=B.outerHeight(),t=B.offset());v=f.extend({},t);f.each(["my","at"],function(){var b=(a[this]||"").split(" "),c,j;b.length===1&&(b=m.test(b[0])?b.concat(["center"]):d.test(b[0])?["center"].concat(b):["center","center"]);b[0]=m.test(b[0])?b[0]:"center";b[1]=d.test(b[1])?b[1]:"center";c=p.exec(b[0]);j=p.exec(b[1]);K[this]=[c?c[0]:0,j?j[0]:0];a[this]=[n.exec(b[0])[0],n.exec(b[1])[0]]});1===E.length&&
(E[1]=E[0]);"right"===a.at[0]?v.left+=l:"center"===a.at[0]&&(v.left+=l/2);"bottom"===a.at[1]?v.top+=s:"center"===a.at[1]&&(v.top+=s/2);b=g(K.at,l,s);v.left+=b[0];v.top+=b[1];return this.each(function(){var d,m,n=f(this),p=n.outerWidth(),o=n.outerHeight(),A=c(this,"marginLeft"),V=c(this,"marginTop"),G=p+A+c(this,"marginRight")+z.width,Q=o+V+c(this,"marginBottom")+z.height,H=f.extend({},v),O=g(K.my,n.outerWidth(),n.outerHeight());if(a.my[0]==="right")H.left=H.left-p;else if(a.my[0]==="center")H.left=
H.left-p/2;if(a.my[1]==="bottom")H.top=H.top-o;else if(a.my[1]==="center")H.top=H.top-o/2;H.left=H.left+O[0];H.top=H.top+O[1];if(!f.support.offsetFractions){H.left=j(H.left);H.top=j(H.top)}d={marginLeft:A,marginTop:V};f.each(["left","top"],function(c,j){if(f.ui.position[E[c]])f.ui.position[E[c]][j](H,{targetWidth:l,targetHeight:s,elemWidth:p,elemHeight:o,collisionPosition:d,collisionWidth:G,collisionHeight:Q,offset:[b[0]+O[0],b[1]+O[1]],my:a.my,at:a.at,within:C,elem:n})});f.fn.bgiframe&&n.bgiframe();
a.using&&(m=function(b){var d=t.left-H.left,c=d+l-p,j=t.top-H.top,m=j+s-o,g={target:{element:B,left:t.left,top:t.top,width:l,height:s},element:{element:n,left:H.left,top:H.top,width:p,height:o},horizontal:c<0?"left":d>0?"right":"center",vertical:m<0?"top":j>0?"bottom":"middle"};if(l<p&&k(d+c)<l)g.horizontal="center";if(s<o&&k(j+m)<s)g.vertical="middle";g.important=e(k(d),k(c))>e(k(j),k(m))?"horizontal":"vertical";a.using.call(this,b,g)});n.offset(f.extend(H,{using:m}))})};f.ui.position={fit:{left:function(a,
b){var d=b.within,c=d.isWindow?d.scrollLeft:d.offset.left,j=d.width,m=a.left-b.collisionPosition.marginLeft,d=c-m,k=m+b.collisionWidth-j-c;b.collisionWidth>j?0<d&&0>=k?(c=a.left+d+b.collisionWidth-j-c,a.left+=d-c):a.left=0<k&&0>=d?c:d>k?c+j-b.collisionWidth:c:a.left=0<d?a.left+d:0<k?a.left-k:e(a.left-m,a.left)},top:function(a,b){var d=b.within,c=d.isWindow?d.scrollTop:d.offset.top,j=b.within.height,m=a.top-b.collisionPosition.marginTop,d=c-m,k=m+b.collisionHeight-j-c;b.collisionHeight>j?0<d&&0>=k?
(c=a.top+d+b.collisionHeight-j-c,a.top+=d-c):a.top=0<k&&0>=d?c:d>k?c+j-b.collisionHeight:c:a.top=0<d?a.top+d:0<k?a.top-k:e(a.top-m,a.top)}},flip:{left:function(a,b){var d=b.within,c=d.offset.left+d.scrollLeft,j=d.width,e=d.isWindow?d.scrollLeft:d.offset.left,m=a.left-b.collisionPosition.marginLeft,d=m-e,g=m+b.collisionWidth-j-e,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,f="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,n=-2*b.offset[0];if(0>d){if(c=a.left+m+
f+n+b.collisionWidth-j-c,0>c||c<k(d))a.left+=m+f+n}else if(0<g&&(c=a.left-b.collisionPosition.marginLeft+m+f+n-e,0<c||k(c)<g))a.left+=m+f+n},top:function(a,b){var d=b.within,c=d.offset.top+d.scrollTop,j=d.height,e=d.isWindow?d.scrollTop:d.offset.top,m=a.top-b.collisionPosition.marginTop,d=m-e,g=m+b.collisionHeight-j-e,m="top"===b.my[1]?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,f="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,n=-2*b.offset[1];if(0>d){if(c=a.top+m+f+n+b.collisionHeight-
j-c,a.top+m+f+n>d&&(0>c||c<k(d)))a.top+=m+f+n}else if(0<g&&(c=a.top-b.collisionPosition.marginTop+m+f+n-e,a.top+m+f+n>g&&(0<c||k(c)<g)))a.top+=m+f+n}},flipfit:{left:function(){f.ui.position.flip.left.apply(this,arguments);f.ui.position.fit.left.apply(this,arguments)},top:function(){f.ui.position.flip.top.apply(this,arguments);f.ui.position.fit.top.apply(this,arguments)}}};(function(){var a,b,d,c,j=document.getElementsByTagName("body")[0];d=document.createElement("div");a=document.createElement(j?
"div":"body");b={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};j&&f.extend(b,{position:"absolute",left:"-1000px",top:"-1000px"});for(c in b)a.style[c]=b[c];a.appendChild(d);b=j||document.documentElement;b.insertBefore(a,b.firstChild);d.style.cssText="position: absolute; left: 10.7432222px;";d=f(d).offset().left;f.support.offsetFractions=10<d&&11>d;a.innerHTML="";b.removeChild(a)})();!1!==f.uiBackCompat&&function(b){var d=b.fn.position;b.fn.position=function(c){if(!c||!c.offset)return d.call(this,
c);var j=c.offset.split(" "),e=c.at.split(" ");1===j.length&&(j[1]=j[0]);/^\d/.test(j[0])&&(j[0]="+"+j[0]);/^\d/.test(j[1])&&(j[1]="+"+j[1]);1===e.length&&(/left|center|right/.test(e[0])?e[1]="center":(e[1]=e[0],e[0]="center"));return d.call(this,b.extend(c,{at:e[0]+j[0]+" "+e[1]+j[1],offset:a}))}}(l)})(l);(function(f){f.widget("ui.draggable",f.ui.mouse,{version:"1.9.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,
grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");
this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(a){var g=this.options;if(this.helper||g.disabled||f(a.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(a);if(!this.handle)return!1;f(!0===g.iframeFix?"iframe":g.iframeFix).each(function(){f('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+
"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(f(this).offset()).appendTo("body")});return!0},_mouseStart:function(a){var g=this.options;this.helper=this._createHelper(a);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();f.ui.ddmanager&&(f.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,
left:this.offset.left-this.margins.left};f.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt);g.containment&&this._setContainment();if(!1===this._trigger("start",a))return this._clear(),!1;this._cacheHelperProportions();f.ui.ddmanager&&
!g.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,a);this._mouseDrag(a,!0);f.ui.ddmanager&&f.ui.ddmanager.dragStart(this,a);return!0},_mouseDrag:function(a,g){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!g){var c=this._uiHash();if(!1===this._trigger("drag",a,c))return this._mouseUp({}),!1;this.position=c.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=
this.position.top+"px";f.ui.ddmanager&&f.ui.ddmanager.drag(this,a);return!1},_mouseStop:function(a){var g=!1;f.ui.ddmanager&&!this.options.dropBehaviour&&(g=f.ui.ddmanager.drop(this,a));this.dropped&&(g=this.dropped,this.dropped=!1);for(var c=this.element[0],b=!1;c&&(c=c.parentNode);)c==document&&(b=!0);if(!b&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!g||"valid"==this.options.revert&&g||!0===this.options.revert||f.isFunction(this.options.revert)&&this.options.revert.call(this.element,
g)){var e=this;f(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",a)!==false&&e._clear()})}else!1!==this._trigger("stop",a)&&this._clear();return!1},_mouseUp:function(a){f("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});f.ui.ddmanager&&f.ui.ddmanager.dragStop(this,a);return f.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();
return this},_getHandle:function(a){var g=!this.options.handle||!f(this.options.handle,this.element).length?!0:!1;f(this.options.handle,this.element).find("*").andSelf().each(function(){this==a.target&&(g=!0)});return g},_createHelper:function(a){var g=this.options,a=f.isFunction(g.helper)?f(g.helper.apply(this.element[0],[a])):"clone"==g.helper?this.element.clone().removeAttr("id"):this.element;a.parents("body").length||a.appendTo("parent"==g.appendTo?this.element[0].parentNode:g.appendTo);a[0]!=
this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));f.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+
this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),
10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),
10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=["document"==a.containment?0:f(window).scrollLeft()-this.offset.relative.left-
this.offset.parent.left,"document"==a.containment?0:f(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==a.containment?0:f(window).scrollLeft())+f("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==a.containment?0:f(window).scrollTop())+(f("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&
a.containment.constructor!=Array){var a=f(a.containment),g=a[0];if(g){a.offset();var c="hidden"!=f(g).css("overflow");this.containment=[(parseInt(f(g).css("borderLeftWidth"),10)||0)+(parseInt(f(g).css("paddingLeft"),10)||0),(parseInt(f(g).css("borderTopWidth"),10)||0)+(parseInt(f(g).css("paddingTop"),10)||0),(c?Math.max(g.scrollWidth,g.offsetWidth):g.offsetWidth)-(parseInt(f(g).css("borderLeftWidth"),10)||0)-(parseInt(f(g).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-
this.margins.right,(c?Math.max(g.scrollHeight,g.offsetHeight):g.offsetHeight)-(parseInt(f(g).css("borderTopWidth"),10)||0)-(parseInt(f(g).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=a}}else a.containment.constructor==Array&&(this.containment=a.containment)},_convertPositionTo:function(a,g){g||(g=this.position);var c="absolute"==a?1:-1,b="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(b[0].tagName);return{top:g.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:b.scrollTop())*c,left:g.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:b.scrollLeft())*c}},_generatePosition:function(a){var g=this.options,c="absolute"==this.cssPosition&&!(this.scrollParent[0]!=document&&
f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,b=/(html|body)/i.test(c[0].tagName),e=a.pageX,k=a.pageY;if(this.originalPosition){var j;this.containment&&(this.relative_container?(j=this.relative_container.offset(),j=[this.containment[0]+j.left,this.containment[1]+j.top,this.containment[2]+j.left,this.containment[3]+j.top]):j=this.containment,a.pageX-this.offset.click.left<j[0]&&(e=j[0]+this.offset.click.left),a.pageY-this.offset.click.top<j[1]&&(k=j[1]+
this.offset.click.top),a.pageX-this.offset.click.left>j[2]&&(e=j[2]+this.offset.click.left),a.pageY-this.offset.click.top>j[3]&&(k=j[3]+this.offset.click.top));g.grid&&(k=g.grid[1]?this.originalPageY+Math.round((k-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,k=j?!(k-this.offset.click.top<j[1]||k-this.offset.click.top>j[3])?k:!(k-this.offset.click.top<j[1])?k-g.grid[1]:k+g.grid[1]:k,e=g.grid[0]?this.originalPageX+Math.round((e-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,
e=j?!(e-this.offset.click.left<j[0]||e-this.offset.click.left>j[2])?e:!(e-this.offset.click.left<j[0])?e-g.grid[0]:e+g.grid[0]:e)}return{top:k-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():b?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():b?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(a,g,c){c=c||this._uiHash();f.ui.plugin.call(this,a,[g,c]);"drag"==a&&(this.positionAbs=this._convertPositionTo("absolute"));return f.Widget.prototype._trigger.call(this,a,g,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});f.ui.plugin.add("draggable","connectToSortable",
{start:function(a,g){var c=f(this).data("draggable"),b=c.options,e=f.extend({},g,{item:c.element});c.sortables=[];f(b.connectToSortable).each(function(){var b=f.data(this,"sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,e))})},stop:function(a,g){var c=f(this).data("draggable"),b=f.extend({},g,{item:c.element});f.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=
!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"==c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,b))})},drag:function(a,g){var c=f(this).data("draggable"),b=this;f.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=
c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=f(b).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return g.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,
!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=
!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}});f.ui.plugin.add("draggable","cursor",{start:function(){var a=f("body"),g=f(this).data("draggable").options;a.css("cursor")&&(g._cursor=a.css("cursor"));a.css("cursor",
g.cursor)},stop:function(){var a=f(this).data("draggable").options;a._cursor&&f("body").css("cursor",a._cursor)}});f.ui.plugin.add("draggable","opacity",{start:function(a,g){var c=f(g.helper),b=f(this).data("draggable").options;c.css("opacity")&&(b._opacity=c.css("opacity"));c.css("opacity",b.opacity)},stop:function(a,g){var c=f(this).data("draggable").options;c._opacity&&f(g.helper).css("opacity",c._opacity)}});f.ui.plugin.add("draggable","scroll",{start:function(){var a=f(this).data("draggable");
a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName&&(a.overflowOffset=a.scrollParent.offset())},drag:function(a){var g=f(this).data("draggable"),c=g.options,b=!1;if(g.scrollParent[0]!=document&&"HTML"!=g.scrollParent[0].tagName){if(!c.axis||"x"!=c.axis)g.overflowOffset.top+g.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity?g.scrollParent[0].scrollTop=b=g.scrollParent[0].scrollTop+c.scrollSpeed:a.pageY-g.overflowOffset.top<c.scrollSensitivity&&(g.scrollParent[0].scrollTop=b=g.scrollParent[0].scrollTop-
c.scrollSpeed);if(!c.axis||"y"!=c.axis)g.overflowOffset.left+g.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity?g.scrollParent[0].scrollLeft=b=g.scrollParent[0].scrollLeft+c.scrollSpeed:a.pageX-g.overflowOffset.left<c.scrollSensitivity&&(g.scrollParent[0].scrollLeft=b=g.scrollParent[0].scrollLeft-c.scrollSpeed)}else{if(!c.axis||"x"!=c.axis)a.pageY-f(document).scrollTop()<c.scrollSensitivity?b=f(document).scrollTop(f(document).scrollTop()-c.scrollSpeed):f(window).height()-(a.pageY-f(document).scrollTop())<
c.scrollSensitivity&&(b=f(document).scrollTop(f(document).scrollTop()+c.scrollSpeed));if(!c.axis||"y"!=c.axis)a.pageX-f(document).scrollLeft()<c.scrollSensitivity?b=f(document).scrollLeft(f(document).scrollLeft()-c.scrollSpeed):f(window).width()-(a.pageX-f(document).scrollLeft())<c.scrollSensitivity&&(b=f(document).scrollLeft(f(document).scrollLeft()+c.scrollSpeed))}!1!==b&&(f.ui.ddmanager&&!c.dropBehaviour)&&f.ui.ddmanager.prepareOffsets(g,a)}});f.ui.plugin.add("draggable","snap",{start:function(){var a=
f(this).data("draggable"),g=a.options;a.snapElements=[];f(g.snap.constructor!=String?g.snap.items||":data(draggable)":g.snap).each(function(){var c=f(this),b=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:b.top,left:b.left})})},drag:function(a,g){for(var c=f(this).data("draggable"),b=c.options,e=b.snapTolerance,k=g.offset.left,j=k+c.helperProportions.width,m=g.offset.top,d=m+c.helperProportions.height,p=c.snapElements.length-1;0<=p;p--){var n=
c.snapElements[p].left,l=n+c.snapElements[p].width,o=c.snapElements[p].top,q=o+c.snapElements[p].height;if(n-e<k&&k<l+e&&o-e<m&&m<q+e||n-e<k&&k<l+e&&o-e<d&&d<q+e||n-e<j&&j<l+e&&o-e<m&&m<q+e||n-e<j&&j<l+e&&o-e<d&&d<q+e){if("inner"!=b.snapMode){var r=Math.abs(o-d)<=e,u=Math.abs(q-m)<=e,x=Math.abs(n-j)<=e,t=Math.abs(l-k)<=e;r&&(g.position.top=c._convertPositionTo("relative",{top:o-c.helperProportions.height,left:0}).top-c.margins.top);u&&(g.position.top=c._convertPositionTo("relative",{top:q,left:0}).top-
c.margins.top);x&&(g.position.left=c._convertPositionTo("relative",{top:0,left:n-c.helperProportions.width}).left-c.margins.left);t&&(g.position.left=c._convertPositionTo("relative",{top:0,left:l}).left-c.margins.left)}var v=r||u||x||t;if("outer"!=b.snapMode&&(r=Math.abs(o-m)<=e,u=Math.abs(q-d)<=e,x=Math.abs(n-k)<=e,t=Math.abs(l-j)<=e,r&&(g.position.top=c._convertPositionTo("relative",{top:o,left:0}).top-c.margins.top),u&&(g.position.top=c._convertPositionTo("relative",{top:q-c.helperProportions.height,
left:0}).top-c.margins.top),x&&(g.position.left=c._convertPositionTo("relative",{top:0,left:n}).left-c.margins.left),t))g.position.left=c._convertPositionTo("relative",{top:0,left:l-c.helperProportions.width}).left-c.margins.left;!c.snapElements[p].snapping&&(r||u||x||t||v)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,a,f.extend(c._uiHash(),{snapItem:c.snapElements[p].item}));c.snapElements[p].snapping=r||u||x||t||v}else c.snapElements[p].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,
a,f.extend(c._uiHash(),{snapItem:c.snapElements[p].item})),c.snapElements[p].snapping=!1}}});f.ui.plugin.add("draggable","stack",{start:function(){var a=f(this).data("draggable").options,a=f.makeArray(f(a.stack)).sort(function(a,b){return(parseInt(f(a).css("zIndex"),10)||0)-(parseInt(f(b).css("zIndex"),10)||0)});if(a.length){var g=parseInt(a[0].style.zIndex)||0;f(a).each(function(a){this.style.zIndex=g+a});this[0].style.zIndex=g+a.length}}});f.ui.plugin.add("draggable","zIndex",{start:function(a,
g){var c=f(g.helper),b=f(this).data("draggable").options;c.css("zIndex")&&(b._zIndex=c.css("zIndex"));c.css("zIndex",b.zIndex)},stop:function(a,g){var c=f(this).data("draggable").options;c._zIndex&&f(g.helper).css("zIndex",c._zIndex)}})})(l);(function(f){f.widget("ui.droppable",{version:"1.9.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var a=this.options,g=a.accept;this.isover=0;this.isout=
1;this.accept=f.isFunction(g)?g:function(a){return a.is(g)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};f.ui.ddmanager.droppables[a.scope]=f.ui.ddmanager.droppables[a.scope]||[];f.ui.ddmanager.droppables[a.scope].push(this);a.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var a=f.ui.ddmanager.droppables[this.options.scope],g=0;g<a.length;g++)a[g]==this&&a.splice(g,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},
_setOption:function(a,g){"accept"==a&&(this.accept=f.isFunction(g)?g:function(a){return a.is(g)});f.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var g=f.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);g&&this._trigger("activate",a,this.ui(g))},_deactivate:function(a){var g=f.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);g&&this._trigger("deactivate",a,this.ui(g))},_over:function(a){var g=
f.ui.ddmanager.current;if(g&&(g.currentItem||g.element)[0]!=this.element[0])if(this.accept.call(this.element[0],g.currentItem||g.element))this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",a,this.ui(g))},_out:function(a){var g=f.ui.ddmanager.current;if(g&&(g.currentItem||g.element)[0]!=this.element[0])if(this.accept.call(this.element[0],g.currentItem||g.element))this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",
a,this.ui(g))},_drop:function(a,g){var c=g||f.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var b=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var a=f.data(this,"droppable");if(a.options.greedy&&!a.options.disabled&&a.options.scope==c.options.scope&&a.accept.call(a.element[0],c.currentItem||c.element)&&f.ui.intersect(c,f.extend(a,{offset:a.element.offset()}),a.options.tolerance))return b=!0,!1});return b?!1:this.accept.call(this.element[0],
c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(c)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});f.ui.intersect=function(a,g,c){if(!g.offset)return!1;var b=(a.positionAbs||a.position.absolute).left,e=b+a.helperProportions.width,k=(a.positionAbs||a.position.absolute).top,
j=k+a.helperProportions.height,m=g.offset.left,d=m+g.proportions.width,p=g.offset.top,n=p+g.proportions.height;switch(c){case "fit":return m<=b&&e<=d&&p<=k&&j<=n;case "intersect":return m<b+a.helperProportions.width/2&&e-a.helperProportions.width/2<d&&p<k+a.helperProportions.height/2&&j-a.helperProportions.height/2<n;case "pointer":return f.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,
p,m,g.proportions.height,g.proportions.width);case "touch":return(k>=p&&k<=n||j>=p&&j<=n||k<p&&j>n)&&(b>=m&&b<=d||e>=m&&e<=d||b<m&&e>d);default:return!1}};f.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,g){var c=f.ui.ddmanager.droppables[a.options.scope]||[],b=g?g.type:null,e=(a.currentItem||a.element).find(":data(droppable)").andSelf(),k=0;a:for(;k<c.length;k++)if(!(c[k].options.disabled||a&&!c[k].accept.call(c[k].element[0],a.currentItem||a.element))){for(var j=
0;j<e.length;j++)if(e[j]==c[k].element[0]){c[k].proportions.height=0;continue a}c[k].visible="none"!=c[k].element.css("display");c[k].visible&&("mousedown"==b&&c[k]._activate.call(c[k],g),c[k].offset=c[k].element.offset(),c[k].proportions={width:c[k].element[0].offsetWidth,height:c[k].element[0].offsetHeight})}},drop:function(a,g){var c=!1;f.each(f.ui.ddmanager.droppables[a.options.scope]||[],function(){if(this.options&&(!this.options.disabled&&(this.visible&&f.ui.intersect(a,this,this.options.tolerance))&&
(c=this._drop.call(this,g)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)))this.isout=1,this.isover=0,this._deactivate.call(this,g)});return c},dragStart:function(a,g){a.element.parentsUntil("body").bind("scroll.droppable",function(){a.options.refreshPositions||f.ui.ddmanager.prepareOffsets(a,g)})},drag:function(a,g){a.options.refreshPositions&&f.ui.ddmanager.prepareOffsets(a,g);f.each(f.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!this.options.disabled&&
!this.greedyChild&&this.visible){var c=f.ui.intersect(a,this,this.options.tolerance);if(c=!c&&1==this.isover?"isout":c&&0==this.isover?"isover":null){var b;if(this.options.greedy){var e=this.options.scope,k=this.element.parents(":data(droppable)").filter(function(){return f.data(this,"droppable").options.scope===e});k.length&&(b=f.data(k[0],"droppable"),b.greedyChild="isover"==c?1:0)}b&&"isover"==c&&(b.isover=0,b.isout=1,b._out.call(b,g));this[c]=1;this["isout"==c?"isover":"isout"]=0;this["isover"==
c?"_over":"_out"].call(this,g);b&&"isout"==c&&(b.isout=0,b.isover=1,b._over.call(b,g))}}})},dragStop:function(a,g){a.element.parentsUntil("body").unbind("scroll.droppable");a.options.refreshPositions||f.ui.ddmanager.prepareOffsets(a,g)}}})(l);(function(f){f.widget("ui.resizable",f.ui.mouse,{version:"1.9.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,
maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var a=this,b=this.options;this.element.addClass("ui-resizable");f.extend(this,{_aspectRatio:!!b.aspectRatio,aspectRatio:b.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:b.helper||b.ghost||b.animate?b.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(f('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),
width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,
marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=b.handles||(!f(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",
se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var e=this.handles.split(",");this.handles={};for(var k=0;k<e.length;k++){var j=f.trim(e[k]),m=f('<div class="ui-resizable-handle ui-resizable-'+j+'"></div>');m.css({zIndex:b.zIndex});"se"==j&&m.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[j]=".ui-resizable-"+j;this.element.append(m)}}this._renderAxis=
function(a){var a=a||this.element,b;for(b in this.handles){this.handles[b].constructor==String&&(this.handles[b]=f(this.handles[b],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var c=f(this.handles[b],this.element),j=0,j=/sw|ne|nw|se|n|s/.test(b)?c.outerHeight():c.outerWidth(),c=["padding",/ne|nw|n/.test(b)?"Top":/se|sw|s/.test(b)?"Bottom":/^e$/.test(b)?"Right":"Left"].join("");a.css(c,j);this._proportionallyResize()}f(this.handles[b])}};
this._renderAxis(this.element);this._handles=f(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!a.resizing){if(this.className)var b=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);a.axis=b&&b[1]?b[1]:"se"}});b.autoHide&&(this._handles.hide(),f(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(!b.disabled){f(this).removeClass("ui-resizable-autohide");a._handles.show()}}).mouseleave(function(){if(!b.disabled&&!a.resizing){f(this).addClass("ui-resizable-autohide");
a._handles.hide()}}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var a=function(a){f(a).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){a(this.element);var b=this.element;b.after(this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")})).remove()}this.originalElement.css("resize",
this.originalResizeStyle);a(this.originalElement);return this},_mouseCapture:function(a){var b=!1,e;for(e in this.handles)f(this.handles[e])[0]==a.target&&(b=!0);return!this.options.disabled&&b},_mouseStart:function(c){var b=this.options,e=this.element.position(),k=this.element;this.resizing=!0;this.documentScroll={top:f(document).scrollTop(),left:f(document).scrollLeft()};(k.is(".ui-draggable")||/absolute/.test(k.css("position")))&&k.css({position:"absolute",top:e.top,left:e.left});this._renderProxy();
var e=a(this.helper.css("left")),j=a(this.helper.css("top"));b.containment&&(e+=f(b.containment).scrollLeft()||0,j+=f(b.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:e,top:j};this.size=this._helper?{width:k.outerWidth(),height:k.outerHeight()}:{width:k.width(),height:k.height()};this.originalSize=this._helper?{width:k.outerWidth(),height:k.outerHeight()}:{width:k.width(),height:k.height()};this.originalPosition={left:e,top:j};this.sizeDiff={width:k.outerWidth()-
k.width(),height:k.outerHeight()-k.height()};this.originalMousePosition={left:c.pageX,top:c.pageY};this.aspectRatio="number"==typeof b.aspectRatio?b.aspectRatio:this.originalSize.width/this.originalSize.height||1;b=f(".ui-resizable-"+this.axis).css("cursor");f("body").css("cursor","auto"==b?this.axis+"-resize":b);k.addClass("ui-resizable-resizing");this._propagate("start",c);return!0},_mouseDrag:function(a){var b=this.helper,e=this.originalMousePosition,k=this._change[this.axis];if(!k)return!1;e=
k.apply(this,[a,a.pageX-e.left||0,a.pageY-e.top||0]);this._updateVirtualBoundaries(a.shiftKey);if(this._aspectRatio||a.shiftKey)e=this._updateRatio(e,a);e=this._respectSize(e,a);this._propagate("resize",a);b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(e);this._trigger("resize",a,this.ui());return!1},_mouseStop:function(a){this.resizing=
!1;var b=this.options;if(this._helper){var e=this._proportionallyResizeElements,k=e.length&&/textarea/i.test(e[0].nodeName),e=k&&f.ui.hasScroll(e[0],"left")?0:this.sizeDiff.height,k=k?0:this.sizeDiff.width,k={width:this.helper.width()-k,height:this.helper.height()-e},e=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,j=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;b.animate||this.element.css(f.extend(k,{top:j,left:e}));
this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!b.animate&&this._proportionallyResize()}f("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",a);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(a){var b=this.options,e,k,j,b={minWidth:g(b.minWidth)?b.minWidth:0,maxWidth:g(b.maxWidth)?b.maxWidth:Infinity,minHeight:g(b.minHeight)?b.minHeight:0,maxHeight:g(b.maxHeight)?b.maxHeight:Infinity};
if(this._aspectRatio||a)if(a=b.minHeight*this.aspectRatio,k=b.minWidth/this.aspectRatio,e=b.maxHeight*this.aspectRatio,j=b.maxWidth/this.aspectRatio,a>b.minWidth&&(b.minWidth=a),k>b.minHeight&&(b.minHeight=k),e<b.maxWidth&&(b.maxWidth=e),j<b.maxHeight)b.maxHeight=j;this._vBoundaries=b},_updateCache:function(a){this.offset=this.helper.offset();g(a.left)&&(this.position.left=a.left);g(a.top)&&(this.position.top=a.top);g(a.height)&&(this.size.height=a.height);g(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=
this.position,e=this.size,k=this.axis;g(a.height)?a.width=a.height*this.aspectRatio:g(a.width)&&(a.height=a.width/this.aspectRatio);"sw"==k&&(a.left=b.left+(e.width-a.width),a.top=null);"nw"==k&&(a.top=b.top+(e.height-a.height),a.left=b.left+(e.width-a.width));return a},_respectSize:function(a){var b=this._vBoundaries,e=this.axis,k=g(a.width)&&b.maxWidth&&b.maxWidth<a.width,j=g(a.height)&&b.maxHeight&&b.maxHeight<a.height,m=g(a.width)&&b.minWidth&&b.minWidth>a.width,d=g(a.height)&&b.minHeight&&b.minHeight>
a.height;m&&(a.width=b.minWidth);d&&(a.height=b.minHeight);k&&(a.width=b.maxWidth);j&&(a.height=b.maxHeight);var f=this.originalPosition.left+this.originalSize.width,n=this.position.top+this.size.height,l=/sw|nw|w/.test(e),e=/nw|ne|n/.test(e);m&&l&&(a.left=f-b.minWidth);k&&l&&(a.left=f-b.maxWidth);d&&e&&(a.top=n-b.minHeight);j&&e&&(a.top=n-b.maxHeight);(b=!a.width&&!a.height)&&!a.left&&a.top?a.top=null:b&&(!a.top&&a.left)&&(a.left=null);return a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a=
this.helper||this.element,b=0;b<this._proportionallyResizeElements.length;b++){var e=this._proportionallyResizeElements[b];if(!this.borderDif){var k=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],j=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=f.map(k,function(a,b){var c=parseInt(a,10)||0,e=parseInt(j[b],10)||0;return c+e})}e.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||
0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var a=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||f('<div style="overflow:hidden;"></div>');var b=f.browser.msie&&7>f.browser.version,e=b?1:0,b=b?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+b,height:this.element.outerHeight()+b,position:"absolute",left:this.elementOffset.left-e+"px",top:this.elementOffset.top-e+"px",zIndex:++a.zIndex});
this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,e){return{top:this.originalPosition.top+e,height:this.originalSize.height-e}},s:function(a,b,e){return{height:this.originalSize.height+e}},se:function(a,b,e){return f.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[a,b,e]))},sw:function(a,
b,e){return f.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[a,b,e]))},ne:function(a,b,e){return f.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[a,b,e]))},nw:function(a,b,e){return f.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[a,b,e]))}},_propagate:function(a,b){f.ui.plugin.call(this,a,[b,this.ui()]);"resize"!=a&&this._trigger(a,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,
helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});f.ui.plugin.add("resizable","alsoResize",{start:function(){var a=f(this).data("resizable").options,b=function(a){f(a).each(function(){var a=f(this);a.data("resizable-alsoresize",{width:parseInt(a.width(),10),height:parseInt(a.height(),10),left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)})})};"object"==typeof a.alsoResize&&!a.alsoResize.parentNode?a.alsoResize.length?
(a.alsoResize=a.alsoResize[0],b(a.alsoResize)):f.each(a.alsoResize,function(a){b(a)}):b(a.alsoResize)},resize:function(a,b){var e=f(this).data("resizable"),k=e.options,j=e.originalSize,m=e.originalPosition,d={height:e.size.height-j.height||0,width:e.size.width-j.width||0,top:e.position.top-m.top||0,left:e.position.left-m.left||0},g=function(a,c){f(a).each(function(){var a=f(this),j=f(this).data("resizable-alsoresize"),e={},m=c&&c.length?c:a.parents(b.originalElement[0]).length?["width","height"]:
["width","height","top","left"];f.each(m,function(a,b){var c=(j[b]||0)+(d[b]||0);c&&0<=c&&(e[b]=c||null)});a.css(e)})};"object"==typeof k.alsoResize&&!k.alsoResize.nodeType?f.each(k.alsoResize,function(a,b){g(a,b)}):g(k.alsoResize)},stop:function(){f(this).removeData("resizable-alsoresize")}});f.ui.plugin.add("resizable","animate",{stop:function(a){var b=f(this).data("resizable"),e=b.options,k=b._proportionallyResizeElements,j=k.length&&/textarea/i.test(k[0].nodeName),m=j&&f.ui.hasScroll(k[0],"left")?
0:b.sizeDiff.height,j={width:b.size.width-(j?0:b.sizeDiff.width),height:b.size.height-m},m=parseInt(b.element.css("left"),10)+(b.position.left-b.originalPosition.left)||null,d=parseInt(b.element.css("top"),10)+(b.position.top-b.originalPosition.top)||null;b.element.animate(f.extend(j,d&&m?{top:d,left:m}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var d={width:parseInt(b.element.css("width"),10),height:parseInt(b.element.css("height"),10),top:parseInt(b.element.css("top"),
10),left:parseInt(b.element.css("left"),10)};k&&k.length&&f(k[0]).css({width:d.width,height:d.height});b._updateCache(d);b._propagate("resize",a)}})}});f.ui.plugin.add("resizable","containment",{start:function(){var c=f(this).data("resizable"),b=c.element,e=c.options.containment;if(b=e instanceof f?e.get(0):/parent/.test(e)?b.parent().get(0):e)if(c.containerElement=f(b),/document/.test(e)||e==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:f(document),
left:0,top:0,width:f(document).width(),height:f(document).height()||document.body.parentNode.scrollHeight};else{var k=f(b),j=[];f(["Top","Right","Left","Bottom"]).each(function(b,d){j[b]=a(k.css("padding"+d))});c.containerOffset=k.offset();c.containerPosition=k.position();c.containerSize={height:k.innerHeight()-j[3],width:k.innerWidth()-j[1]};var e=c.containerOffset,m=c.containerSize.height,d=c.containerSize.width,d=f.ui.hasScroll(b,"left")?b.scrollWidth:d,m=f.ui.hasScroll(b)?b.scrollHeight:m;c.parentData=
{element:b,left:e.left,top:e.top,width:d,height:m}}},resize:function(a){var b=f(this).data("resizable"),e=b.options,k=b.containerOffset,j=b.position,a=b._aspectRatio||a.shiftKey,m={top:0,left:0},d=b.containerElement;d[0]!=document&&/static/.test(d.css("position"))&&(m=k);if(j.left<(b._helper?k.left:0))b.size.width+=b._helper?b.position.left-k.left:b.position.left-m.left,a&&(b.size.height=b.size.width/b.aspectRatio),b.position.left=e.helper?k.left:0;if(j.top<(b._helper?k.top:0))b.size.height+=b._helper?
b.position.top-k.top:b.position.top,a&&(b.size.width=b.size.height*b.aspectRatio),b.position.top=b._helper?k.top:0;b.offset.left=b.parentData.left+b.position.left;b.offset.top=b.parentData.top+b.position.top;e=Math.abs(b.offset.left-m.left+b.sizeDiff.width);k=Math.abs((b._helper?b.offset.top-m.top:b.offset.top-k.top)+b.sizeDiff.height);j=b.containerElement.get(0)==b.element.parent().get(0);m=/relative|absolute/.test(b.containerElement.css("position"));j&&m&&(e-=b.parentData.left);e+b.size.width>=
b.parentData.width&&(b.size.width=b.parentData.width-e,a&&(b.size.height=b.size.width/b.aspectRatio));k+b.size.height>=b.parentData.height&&(b.size.height=b.parentData.height-k,a&&(b.size.width=b.size.height*b.aspectRatio))},stop:function(){var a=f(this).data("resizable"),b=a.options,e=a.containerOffset,k=a.containerPosition,j=a.containerElement,m=f(a.helper),d=m.offset(),g=m.outerWidth()-a.sizeDiff.width,m=m.outerHeight()-a.sizeDiff.height;a._helper&&(!b.animate&&/relative/.test(j.css("position")))&&
f(this).css({left:d.left-k.left-e.left,width:g,height:m});a._helper&&(!b.animate&&/static/.test(j.css("position")))&&f(this).css({left:d.left-k.left-e.left,width:g,height:m})}});f.ui.plugin.add("resizable","ghost",{start:function(){var a=f(this).data("resizable"),b=a.options,e=a.size;a.ghost=a.originalElement.clone();a.ghost.css({opacity:0.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof b.ghost?b.ghost:
"");a.ghost.appendTo(a.helper)},resize:function(){var a=f(this).data("resizable");a.ghost&&a.ghost.css({position:"relative",height:a.size.height,width:a.size.width})},stop:function(){var a=f(this).data("resizable");a.ghost&&a.helper&&a.helper.get(0).removeChild(a.ghost.get(0))}});f.ui.plugin.add("resizable","grid",{resize:function(){var a=f(this).data("resizable"),b=a.options,e=a.size,k=a.originalSize,j=a.originalPosition,m=a.axis;b.grid="number"==typeof b.grid?[b.grid,b.grid]:b.grid;var d=Math.round((e.width-
k.width)/(b.grid[0]||1))*(b.grid[0]||1),b=Math.round((e.height-k.height)/(b.grid[1]||1))*(b.grid[1]||1);/^(se|s|e)$/.test(m)?(a.size.width=k.width+d,a.size.height=k.height+b):/^(ne)$/.test(m)?(a.size.width=k.width+d,a.size.height=k.height+b,a.position.top=j.top-b):(/^(sw)$/.test(m)?(a.size.width=k.width+d,a.size.height=k.height+b):(a.size.width=k.width+d,a.size.height=k.height+b,a.position.top=j.top-b),a.position.left=j.left-d)}});var a=function(a){return parseInt(a,10)||0},g=function(a){return!isNaN(parseInt(a,
10))}})(l);(function(f){f.widget("ui.selectable",f.ui.mouse,{version:"1.9.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var a=this;this.element.addClass("ui-selectable");this.dragged=!1;var g;this.refresh=function(){g=f(a.options.filter,a.element[0]);g.addClass("ui-selectee");g.each(function(){var a=f(this),b=a.offset();f.data(this,"selectable-item",{element:this,$element:a,left:b.left,top:b.top,right:b.left+a.outerWidth(),bottom:b.top+a.outerHeight(),
startselected:!1,selected:a.hasClass("ui-selected"),selecting:a.hasClass("ui-selecting"),unselecting:a.hasClass("ui-unselecting")})})};this.refresh();this.selectees=g.addClass("ui-selectee");this._mouseInit();this.helper=f("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(a){var g=this;this.opos=[a.pageX,
a.pageY];if(!this.options.disabled){var c=this.options;this.selectees=f(c.filter,this.element[0]);this._trigger("start",a);f(c.appendTo).append(this.helper);this.helper.css({left:a.clientX,top:a.clientY,width:0,height:0});c.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var b=f.data(this,"selectable-item");b.startselected=!0;!a.metaKey&&!a.ctrlKey&&(b.$element.removeClass("ui-selected"),b.selected=!1,b.$element.addClass("ui-unselecting"),b.unselecting=!0,g._trigger("unselecting",
a,{unselecting:b.element}))});f(a.target).parents().andSelf().each(function(){var b=f.data(this,"selectable-item");if(b){var c=!a.metaKey&&!a.ctrlKey||!b.$element.hasClass("ui-selected");b.$element.removeClass(c?"ui-unselecting":"ui-selected").addClass(c?"ui-selecting":"ui-unselecting");b.unselecting=!c;b.selecting=c;(b.selected=c)?g._trigger("selecting",a,{selecting:b.element}):g._trigger("unselecting",a,{unselecting:b.element});return!1}})}},_mouseDrag:function(a){var g=this;this.dragged=!0;if(!this.options.disabled){var c=
this.options,b=this.opos[0],e=this.opos[1],k=a.pageX,j=a.pageY;if(b>k)var m=k,k=b,b=m;e>j&&(m=j,j=e,e=m);this.helper.css({left:b,top:e,width:k-b,height:j-e});this.selectees.each(function(){var d=f.data(this,"selectable-item");if(d&&d.element!=g.element[0]){var m=false;c.tolerance=="touch"?m=!(d.left>k||d.right<b||d.top>j||d.bottom<e):c.tolerance=="fit"&&(m=d.left>b&&d.right<k&&d.top>e&&d.bottom<j);if(m){if(d.selected){d.$element.removeClass("ui-selected");d.selected=false}if(d.unselecting){d.$element.removeClass("ui-unselecting");
d.unselecting=false}if(!d.selecting){d.$element.addClass("ui-selecting");d.selecting=true;g._trigger("selecting",a,{selecting:d.element})}}else{if(d.selecting)if((a.metaKey||a.ctrlKey)&&d.startselected){d.$element.removeClass("ui-selecting");d.selecting=false;d.$element.addClass("ui-selected");d.selected=true}else{d.$element.removeClass("ui-selecting");d.selecting=false;if(d.startselected){d.$element.addClass("ui-unselecting");d.unselecting=true}g._trigger("unselecting",a,{unselecting:d.element})}if(d.selected&&
!a.metaKey&&!a.ctrlKey&&!d.startselected){d.$element.removeClass("ui-selected");d.selected=false;d.$element.addClass("ui-unselecting");d.unselecting=true;g._trigger("unselecting",a,{unselecting:d.element})}}}});return!1}},_mouseStop:function(a){var g=this;this.dragged=!1;f(".ui-unselecting",this.element[0]).each(function(){var c=f.data(this,"selectable-item");c.$element.removeClass("ui-unselecting");c.unselecting=!1;c.startselected=!1;g._trigger("unselected",a,{unselected:c.element})});f(".ui-selecting",
this.element[0]).each(function(){var c=f.data(this,"selectable-item");c.$element.removeClass("ui-selecting").addClass("ui-selected");c.selecting=!1;c.selected=!0;c.startselected=!0;g._trigger("selected",a,{selected:c.element})});this._trigger("stop",a);this.helper.remove();return!1}})})(l);(function(f){f.widget("ui.sortable",f.ui.mouse,{version:"1.9.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,
forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();
this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(a,g){"disabled"===a?(this.options[a]=g,this.widget().toggleClass("ui-sortable-disabled",!!g)):f.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,g){var c=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;
this._refreshItems(a);var b=null;f(a.target).parents().each(function(){if(f.data(this,c.widgetName+"-item")==c)return b=f(this),!1});f.data(a.target,c.widgetName+"-item")==c&&(b=f(a.target));if(!b)return!1;if(this.options.handle&&!g){var e=!1;f(this.options.handle,b).find("*").andSelf().each(function(){this==a.target&&(e=!0)});if(!e)return!1}this.currentItem=b;this._removeCurrentsFromItems();return!0},_mouseStart:function(a,g,c){g=this.options;this.currentContainer=this;this.refreshPositions();this.helper=
this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};f.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=
this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();g.containment&&this._setContainment();g.cursor&&(f("body").css("cursor")&&(this._storedCursor=f("body").css("cursor")),f("body").css("cursor",g.cursor));g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=
this.helper.css("opacity")),this.helper.css("opacity",g.opacity));g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!c)for(c=this.containers.length-1;0<=c;c--)this.containers[c]._trigger("activate",a,this._uiHash(this));
f.ui.ddmanager&&(f.ui.ddmanager.current=this);f.ui.ddmanager&&!g.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,a);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(a);return!0},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var g=this.options,c=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?
(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+g.scrollSpeed:a.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<g.scrollSensitivity)?this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+g.scrollSpeed:a.pageX-this.overflowOffset.left<g.scrollSensitivity&&
(this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-g.scrollSpeed):(a.pageY-f(document).scrollTop()<g.scrollSensitivity?c=f(document).scrollTop(f(document).scrollTop()-g.scrollSpeed):f(window).height()-(a.pageY-f(document).scrollTop())<g.scrollSensitivity&&(c=f(document).scrollTop(f(document).scrollTop()+g.scrollSpeed)),a.pageX-f(document).scrollLeft()<g.scrollSensitivity?c=f(document).scrollLeft(f(document).scrollLeft()-g.scrollSpeed):f(window).width()-(a.pageX-f(document).scrollLeft())<
g.scrollSensitivity&&(c=f(document).scrollLeft(f(document).scrollLeft()+g.scrollSpeed)));!1!==c&&(f.ui.ddmanager&&!g.dropBehaviour)&&f.ui.ddmanager.prepareOffsets(this,a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(g=this.items.length-1;0<=g;g--){var c=this.items[g],b=c.item[0],e=this._intersectsWithPointer(c);
if(e&&c.instance===this.currentContainer&&b!=this.currentItem[0]&&this.placeholder[1==e?"next":"prev"]()[0]!=b&&!f.contains(this.placeholder[0],b)&&("semi-dynamic"==this.options.type?!f.contains(this.element[0],b):1)){this.direction=1==e?"down":"up";if("pointer"==this.options.tolerance||this._intersectsWithSides(c))this._rearrange(a,c);else break;this._trigger("change",a,this._uiHash());break}}this._contactContainers(a);f.ui.ddmanager&&f.ui.ddmanager.drag(this,a);this._trigger("sort",a,this._uiHash());
this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(a,g){if(a){f.ui.ddmanager&&!this.options.dropBehaviour&&f.ui.ddmanager.drop(this,a);if(this.options.revert){var c=this,b=this.placeholder.offset();this.reverting=!0;f(this.helper).animate({left:b.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:b.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},
parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,g);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var a=this.containers.length-1;0<=a;a--)this.containers[a]._trigger("deactivate",null,this._uiHash(this)),this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=
0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&(this.helper&&this.helper[0].parentNode)&&this.helper.remove(),f.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?f(this.domPosition.prev).after(this.currentItem):f(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(a){var g=this._getItemsAsjQuery(a&&a.connected),c=[],a=a||
{};f(g).each(function(){var b=(f(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);b&&c.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))});!c.length&&a.key&&c.push(a.key+"=");return c.join("&")},toArray:function(a){var g=this._getItemsAsjQuery(a&&a.connected),c=[],a=a||{};g.each(function(){c.push(f(a.item||this).attr(a.attribute||"id")||"")});return c},_intersectsWith:function(a){var g=this.positionAbs.left,c=g+this.helperProportions.width,b=this.positionAbs.top,
e=b+this.helperProportions.height,k=a.left,j=k+a.width,m=a.top,d=m+a.height,f=this.offset.click.top,n=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?b+f>m&&b+f<d&&g+n>k&&g+n<j:k<g+this.helperProportions.width/2&&c-this.helperProportions.width/2<j&&m<b+this.helperProportions.height/2&&e-this.helperProportions.height/2<d},
_intersectsWithPointer:function(a){var g="x"===this.options.axis||f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),a="y"===this.options.axis||f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),g=g&&a,a=this._getDragVerticalDirection(),c=this._getDragHorizontalDirection();return!g?!1:this.floating?c&&"right"==c||"down"==a?2:1:a&&("down"==a?2:1)},_intersectsWithSides:function(a){var g=f.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+
a.height/2,a.height),a=f.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),c=this._getDragVerticalDirection(),b=this._getDragHorizontalDirection();return this.floating&&b?"right"==b&&a||"left"==b&&!a:c&&("down"==c&&g||"up"==c&&!g)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":
"left")},refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var g=[],c=[],b=this._connectWith();if(b&&a)for(a=b.length-1;0<=a;a--)for(var e=f(b[a]),k=e.length-1;0<=k;k--){var j=f.data(e[k],this.widgetName);j&&(j!=this&&!j.options.disabled)&&c.push([f.isFunction(j.options.items)?j.options.items.call(j.element):f(j.options.items,
j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}c.push([f.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):f(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(a=c.length-1;0<=a;a--)c[a][0].each(function(){g.push(this)});return f(g)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data("+this.widgetName+"-item)"),g=0;g<this.items.length;g++)for(var c=
0;c<a.length;c++)a[c]==this.items[g].item[0]&&this.items.splice(g,1)},_refreshItems:function(a){this.items=[];this.containers=[this];var g=this.items,c=[[f.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):f(this.options.items,this.element),this]],b=this._connectWith();if(b&&this.ready)for(var e=b.length-1;0<=e;e--)for(var k=f(b[e]),j=k.length-1;0<=j;j--){var m=f.data(k[j],this.widgetName);m&&(m!=this&&!m.options.disabled)&&(c.push([f.isFunction(m.options.items)?
m.options.items.call(m.element[0],a,{item:this.currentItem}):f(m.options.items,m.element),m]),this.containers.push(m))}for(e=c.length-1;0<=e;e--){a=c[e][1];b=c[e][0];j=0;for(k=b.length;j<k;j++)m=f(b[j]),m.data(this.widgetName+"-item",a),g.push({item:m,instance:a,width:0,height:0,left:0,top:0})}},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var g=this.items.length-1;0<=g;g--){var c=this.items[g];if(!(c.instance!=this.currentContainer&&
this.currentContainer&&c.item[0]!=this.currentItem[0])){var b=this.options.toleranceElement?f(this.options.toleranceElement,c.item):c.item;a||(c.width=b.outerWidth(),c.height=b.outerHeight());b=b.offset();c.left=b.left;c.top=b.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(g=this.containers.length-1;0<=g;g--)b=this.containers[g].element.offset(),this.containers[g].containerCache.left=b.left,this.containers[g].containerCache.top=
b.top,this.containers[g].containerCache.width=this.containers[g].element.outerWidth(),this.containers[g].containerCache.height=this.containers[g].element.outerHeight();return this},_createPlaceholder:function(a){var a=a||this,g=a.options;if(!g.placeholder||g.placeholder.constructor==String){var c=g.placeholder;g.placeholder={element:function(){var b=f(document.createElement(a.currentItem[0].nodeName)).addClass(c||a.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
c||(b.style.visibility="hidden");return b},update:function(b,e){if(!c||g.forcePlaceholderSize)e.height()||e.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10))}}}a.placeholder=f(g.placeholder.element.call(a.element,a.currentItem));a.currentItem.after(a.placeholder);g.placeholder.update(a,
a.placeholder)},_contactContainers:function(a){for(var g=null,c=null,b=this.containers.length-1;0<=b;b--)if(!f.contains(this.currentItem[0],this.containers[b].element[0]))if(this._intersectsWith(this.containers[b].containerCache)){if(!g||!f.contains(this.containers[b].element[0],g.element[0]))g=this.containers[b],c=b}else this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",a,this._uiHash(this)),this.containers[b].containerCache.over=0);if(g)if(1===this.containers.length)this.containers[c]._trigger("over",
a,this._uiHash(this)),this.containers[c].containerCache.over=1;else if(this.currentContainer!=this.containers[c]){for(var g=1E4,b=null,e=this.positionAbs[this.containers[c].floating?"left":"top"],k=this.items.length-1;0<=k;k--)if(f.contains(this.containers[c].element[0],this.items[k].item[0])){var j=this.containers[c].floating?this.items[k].item.offset().left:this.items[k].item.offset().top;Math.abs(j-e)<g&&(g=Math.abs(j-e),b=this.items[k],this.direction=0<j-e?"down":"up")}if(b||this.options.dropOnEmpty)this.currentContainer=
this.containers[c],b?this._rearrange(a,b,null,!0):this._rearrange(a,null,this.containers[c].element,!0),this._trigger("change",a,this._uiHash()),this.containers[c]._trigger("change",a,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[c]._trigger("over",a,this._uiHash(this)),this.containers[c].containerCache.over=1}},_createHelper:function(a){var g=this.options,a=f.isFunction(g.helper)?f(g.helper.apply(this.element[0],[a,this.currentItem])):
"clone"==g.helper?this.currentItem.clone():this.currentItem;a.parents("body").length||f("parent"!=g.appendTo?g.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]);a[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==a[0].style.width||g.forceHelperSize)&&a.width(this.currentItem.width());(""==a[0].style.height||
g.forceHelperSize)&&a.height(this.currentItem.height());return a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));f.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,f("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,(f("document"==a.containment?document:window).height()||
document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var g=f(a.containment)[0],a=f(a.containment).offset(),c="hidden"!=f(g).css("overflow");this.containment=[a.left+(parseInt(f(g).css("borderLeftWidth"),10)||0)+(parseInt(f(g).css("paddingLeft"),10)||0)-this.margins.left,a.top+(parseInt(f(g).css("borderTopWidth"),10)||0)+(parseInt(f(g).css("paddingTop"),10)||0)-this.margins.top,a.left+(c?Math.max(g.scrollWidth,
g.offsetWidth):g.offsetWidth)-(parseInt(f(g).css("borderLeftWidth"),10)||0)-(parseInt(f(g).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(c?Math.max(g.scrollHeight,g.offsetHeight):g.offsetHeight)-(parseInt(f(g).css("borderTopWidth"),10)||0)-(parseInt(f(g).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(a,g){g||(g=this.position);var c="absolute"==a?1:-1,b="absolute"==this.cssPosition&&!(this.scrollParent[0]!=
document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(b[0].tagName);return{top:g.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:b.scrollTop())*c,left:g.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:b.scrollLeft())*c}},_generatePosition:function(a){var g=this.options,c="absolute"==this.cssPosition&&
!(this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,b=/(html|body)/i.test(c[0].tagName);"relative"==this.cssPosition&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var e=a.pageX,k=a.pageY;if(this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(e=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<
this.containment[1]&&(k=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(e=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(k=this.containment[3]+this.offset.click.top)),g.grid))k=this.originalPageY+Math.round((k-this.originalPageY)/g.grid[1])*g.grid[1],k=this.containment?!(k-this.offset.click.top<this.containment[1]||k-this.offset.click.top>this.containment[3])?k:!(k-this.offset.click.top<this.containment[1])?
k-g.grid[1]:k+g.grid[1]:k,e=this.originalPageX+Math.round((e-this.originalPageX)/g.grid[0])*g.grid[0],e=this.containment?!(e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2])?e:!(e-this.offset.click.left<this.containment[0])?e-g.grid[0]:e+g.grid[0]:e;return{top:k-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():b?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():b?0:c.scrollLeft())}},_rearrange:function(a,g,c,b){c?c[0].appendChild(this.placeholder[0]):g.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?g.item[0]:g.item[0].nextSibling);var e=this.counter=this.counter?++this.counter:1;this._delay(function(){e==this.counter&&this.refreshPositions(!b)})},_clear:function(a,g){this.reverting=!1;var c=[];!this._noFinalSort&&this.currentItem.parent().length&&
this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var b in this._storedCSS)if("auto"==this._storedCSS[b]||"static"==this._storedCSS[b])this._storedCSS[b]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!g&&c.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||
this.domPosition.parent!=this.currentItem.parent()[0])&&!g&&c.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&!g&&(c.push(function(a){this._trigger("remove",a,this._uiHash())}),c.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),c.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)));for(b=this.containers.length-1;0<=b;b--)g||c.push(function(a){return function(b){a._trigger("deactivate",
b,this._uiHash(this))}}.call(this,this.containers[b])),this.containers[b].containerCache.over&&(c.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[b])),this.containers[b].containerCache.over=0);this._storedCursor&&f("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!g){this._trigger("beforeStop",
a,this._uiHash());for(b=0;b<c.length;b++)c[b].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1}g||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!g){for(b=0;b<c.length;b++)c[b].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===f.Widget.prototype._trigger.apply(this,arguments)&&
this.cancel()},_uiHash:function(a){var g=a||this;return{helper:g.helper,placeholder:g.placeholder||f([]),position:g.position,originalPosition:g.originalPosition,offset:g.positionAbs,item:g.currentItem,sender:a?a.element:null}}})})(l);(function(f){var a=0,g={},c={};g.height=g.paddingTop=g.paddingBottom=g.borderTopWidth=g.borderBottomWidth="hide";c.height=c.paddingTop=c.paddingBottom=c.borderTopWidth=c.borderBottomWidth="show";f.widget("ui.accordion",{version:"1.9.0",options:{active:0,animate:{},collapsible:!1,
event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var b=this.accordionId="ui-accordion-"+(this.element.attr("id")||++a),c=this.options;this.prevShow=this.prevHide=f();this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.headers=this.element.find(c.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");
this._hoverable(this.headers);this._focusable(this.headers);this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();!c.collapsible&&!1===c.active&&(c.active=0);0>c.active&&(c.active+=this.headers.length);this.active=this._findActive(c.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top");this.active.next().addClass("ui-accordion-content-active").show();this._createIcons();this.originalHeight=
this.element[0].style.height;this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").each(function(a){var c=f(this),e=c.attr("id"),d=c.next(),g=d.attr("id");if(!e){e=b+"-header-"+a;c.attr("id",e)}if(!g){g=b+"-panel-"+a;d.attr("id",g)}c.attr("aria-controls",g);d.attr("aria-labelledby",e)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?
this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._on(this.headers,{keydown:"_keydown"});this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._setupEvents(c.event)},_getCreateEventData:function(){return{header:this.active,content:!this.active.length?f():this.active.next()}},_createIcons:function(){var a=this.options.icons;a&&(f("<span>").addClass("ui-accordion-header-icon ui-icon "+a.header).prependTo(this.headers),
this.active.children(".ui-accordion-header-icon").removeClass(a.header).addClass(a.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&
this.removeAttribute("id")});this._destroyIcons();a=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&(this.element.css("height",this.originalHeight),a.css("height",
""))},_setOption:function(a,c){"active"===a?this._activate(c):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(c)),this._super(a,c),"collapsible"===a&&(!c&&!1===this.options.active)&&this._activate(0),"icons"===a&&(this._destroyIcons(),c&&this._createIcons()),"disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!c))},_keydown:function(a){if(!a.altKey&&!a.ctrlKey){var c=f.ui.keyCode,k=this.headers.length,j=this.headers.index(a.target),
m=!1;switch(a.keyCode){case c.RIGHT:case c.DOWN:m=this.headers[(j+1)%k];break;case c.LEFT:case c.UP:m=this.headers[(j-1+k)%k];break;case c.SPACE:case c.ENTER:this._eventHandler(a);break;case c.HOME:m=this.headers[0];break;case c.END:m=this.headers[k-1]}m&&(f(a.target).attr("tabIndex",-1),f(m).attr("tabIndex",0),m.focus(),a.preventDefault())}},_panelKeyDown:function(a){a.keyCode===f.ui.keyCode.UP&&a.ctrlKey&&f(a.currentTarget).prev().focus()},refresh:function(){var a,c,k=this.options.heightStyle,j=
this.element.parent();this.element.css("height",this.originalHeight);"fill"===k?(f.support.minHeight||(c=j.css("overflow"),j.css("overflow","hidden")),a=j.height(),this.element.siblings(":visible").each(function(){var c=f(this),d=c.css("position");d==="absolute"||d==="fixed"||(a=a-c.outerHeight(true))}),c&&j.css("overflow",c),this.headers.each(function(){a=a-f(this).outerHeight(true)}),this.headers.next().each(function(){f(this).height(Math.max(0,a-f(this).innerHeight()+f(this).height()))}).css("overflow",
"auto")):"auto"===k&&(a=0,this.headers.next().each(function(){a=Math.max(a,f(this).height("").height())}).height(a));"content"!==k&&this.element.height(this.element.height())},_activate:function(a){a=this._findActive(a)[0];a!==this.active[0]&&(a=a||this.active[0],this._eventHandler({target:a,currentTarget:a,preventDefault:f.noop}))},_findActive:function(a){return"number"===typeof a?this.headers.eq(a):f()},_setupEvents:function(a){var c={};a&&(f.each(a.split(" "),function(a,b){c[b]="_eventHandler"}),
this._on(this.headers,c))},_eventHandler:function(a){var c=this.options,k=this.active,j=f(a.currentTarget),m=j[0]===k[0],d=m&&c.collapsible,g=d?f():j.next(),n=k.next(),g={oldHeader:k,oldPanel:n,newHeader:d?f():j,newPanel:g};a.preventDefault();m&&!c.collapsible||!1===this._trigger("beforeActivate",a,g)||(c.active=d?!1:this.headers.index(j),this.active=m?f():j,this._toggle(g),k.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&k.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),
m||(j.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&j.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),j.next().addClass("ui-accordion-content-active")))},_toggle:function(a){var c=a.newPanel,k=this.prevShow.length?this.prevShow:a.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=c;this.prevHide=k;this.options.animate?this._animate(c,k,a):(k.hide(),c.show(),this._toggleComplete(a));
k.attr({"aria-expanded":"false","aria-hidden":"true"});k.prev().attr("aria-selected","false");c.length&&k.length?k.prev().attr("tabIndex",-1):c.length&&this.headers.filter(function(){return f(this).attr("tabIndex")===0}).attr("tabIndex",-1);c.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(a,e,k){var j,m,d,f=this,n=0,l=this.options.animate||{},o=a.length&&(!e.length||a.index()<e.index())&&l.down||l,q=function(){f._toggleComplete(k)};
"number"===typeof o&&(d=o);"string"===typeof o&&(m=o);m=m||o.easing||l.easing;d=d||o.duration||l.duration;if(!e.length)return a.animate(c,d,m,q);if(!a.length)return e.animate(g,d,m,q);j=a.show().outerHeight();e.animate(g,{duration:d,easing:m,step:function(a,b){b.now=Math.round(a)}});a.hide().animate(c,{duration:d,easing:m,complete:q,step:function(a,b){b.now=Math.round(a);"height"!==b.prop?n+=b.now:"content"!==f.options.heightStyle&&(b.now=Math.round(j-e.outerHeight()-n),n=0)}})},_toggleComplete:function(a){var c=
a.oldPanel;c.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");c.length&&(c.parent()[0].className=c.parent()[0].className);this._trigger("activate",null,a)}});!1!==f.uiBackCompat&&(function(a,c){a.extend(c.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var k=c._create;c._create=function(){if(this.options.navigation){var c=this,e=this.element.find(this.options.header),d=e.next(),
g=e.add(d).find("a").filter(this.options.navigationFilter)[0];g&&e.add(d).each(function(d){if(a.contains(this,g))return c.options.active=Math.floor(d/2),!1})}k.call(this)}}(l,l.ui.accordion.prototype),function(a,c){a.extend(c.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var k=c._create,j=c._setOption;a.extend(c,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();k.call(this)},_setOption:function(a,b){if("autoHeight"===a||"clearStyle"===
a||"fillSpace"===a)this.options.heightStyle=this._mergeHeightStyle();j.apply(this,arguments)},_mergeHeightStyle:function(){var a=this.options;if(a.fillSpace)return"fill";if(a.clearStyle)return"content";if(a.autoHeight)return"auto"}})}(l,l.ui.accordion.prototype),function(a,c){a.extend(c.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var k=c._createIcons;c._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected);
k.call(this)}}(l,l.ui.accordion.prototype),function(a,c){c.activate=c._activate;var k=c._findActive;c._findActive=function(a){-1===a&&(a=!1);a&&"number"!==typeof a&&(a=this.headers.index(this.headers.filter(a)),-1===a&&(a=!1));return k.call(this,a)}}(l,l.ui.accordion.prototype),l.ui.accordion.prototype.resize=l.ui.accordion.prototype.refresh,function(a,c){a.extend(c.options,{change:null,changestart:null});var k=c._trigger;c._trigger=function(a,b,d){var c=k.apply(this,arguments);if(!c)return!1;"beforeActivate"===
a?c=k.call(this,"changestart",b,{oldHeader:d.oldHeader,oldContent:d.oldPanel,newHeader:d.newHeader,newContent:d.newPanel}):"activate"===a&&(c=k.call(this,"change",b,{oldHeader:d.oldHeader,oldContent:d.oldPanel,newHeader:d.newHeader,newContent:d.newPanel}));return c}}(l,l.ui.accordion.prototype),function(a,c){a.extend(c.options,{animate:null,animated:"slide"});var k=c._create;c._create=function(){var a=this.options;null===a.animate&&(a.animate=a.animated?"slide"===a.animated?300:"bounceslide"===a.animated?
{duration:200,down:{easing:"easeOutBounce",duration:1E3}}:a.animated:!1);k.call(this)}}(l,l.ui.accordion.prototype))})(l);(function(f){var a=0;f.widget("ui.autocomplete",{version:"1.9.0",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var a,c,b;this.isMultiLine=this._isMultiLine();
this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on({keydown:function(e){if(this.element.prop("readOnly"))c=b=a=!0;else{c=b=a=!1;var k=f.ui.keyCode;switch(e.keyCode){case k.PAGE_UP:a=!0;this._move("previousPage",e);break;case k.PAGE_DOWN:a=!0;this._move("nextPage",e);break;case k.UP:a=!0;this._keyEvent("previous",e);break;case k.DOWN:a=!0;this._keyEvent("next",e);break;case k.ENTER:case k.NUMPAD_ENTER:this.menu.active&&
(a=!0,e.preventDefault(),this.menu.select(e));break;case k.TAB:this.menu.active&&this.menu.select(e);break;case k.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}}},keypress:function(b){if(a)a=!1,b.preventDefault();else if(!c){var k=f.ui.keyCode;switch(b.keyCode){case k.PAGE_UP:this._move("previousPage",b);break;case k.PAGE_DOWN:this._move("nextPage",b);break;case k.UP:this._keyEvent("previous",b);break;case k.DOWN:this._keyEvent("next",
b)}}},input:function(a){b?(b=!1,a.preventDefault()):this._searchTimeout(a)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),this._change(a))}});this._initSource();this.menu=f("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:f(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu");this._on(this.menu.element,
{mousedown:function(a){a.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var b=this.menu.element[0];f(a.target).closest(".ui-menu-item").length||this._delay(function(){var a=this;this.document.one("mousedown",function(c){c.target!==a.element[0]&&(c.target!==b&&!f.contains(b,c.target))&&a.close()})})},menufocus:function(a,b){if(this.isNewMenu&&(this.isNewMenu=!1,a.originalEvent&&/^mouse/.test(a.originalEvent.type))){this.menu.blur();this.document.one("mousemove",
function(){f(a.target).trigger(a.originalEvent)});return}var c=b.item.data("ui-autocomplete-item")||b.item.data("item.autocomplete");!1!==this._trigger("focus",a,{item:c})?a.originalEvent&&/^key/.test(a.originalEvent.type)&&this._value(c.value):this.liveRegion.text(c.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item")||b.item.data("item.autocomplete"),m=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=m,this._delay(function(){this.previous=
m;this.selectedItem=c}));!1!==this._trigger("select",a,{item:c})&&this._value(c.value);this.term=this._value();this.close(a);this.selectedItem=c}});this.liveRegion=f("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element);f.fn.bgiframe&&this.menu.element.bgiframe();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");
this.menu.element.remove();this.liveRegion.remove()},_setOption:function(a,c){this._super(a,c);"source"===a&&this._initSource();"appendTo"===a&&this.menu.element.appendTo(this.document.find(c||"body")[0]);"disabled"===a&&(c&&this.xhr)&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var a,c,b=this;f.isArray(this.options.source)?(a=this.options.source,this.source=function(b,c){c(f.ui.autocomplete.filter(a,
b.term))}):"string"===typeof this.options.source?(c=this.options.source,this.source=function(a,k){b.xhr&&b.xhr.abort();b.xhr=f.ajax({url:c,data:a,dataType:"json",success:function(a){k(a)},error:function(){k([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,c){a=null!=a?a:this._value();this.term=this._value();
if(a.length<this.options.minLength)return this.close(c);if(!1!==this._trigger("search",c))return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:a},this._response())},_response:function(){var g=this,c=++a;return function(b){c===a&&g.__response(b);g.pending--;g.pending||g.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a));this._trigger("response",null,{content:a});
!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0;this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){return a.length&&a[0].label&&a[0].value?a:f.map(a,function(a){return"string"===
typeof a?{label:a,value:a}:f.extend({label:a.label||a.value,value:a.value||a.label},a)})},_suggest:function(a){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,a);this.menu.refresh();c.show();this._resizeMenu();c.position(f.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(a,c){var b=
this;f.each(c,function(c,k){b._renderItemData(a,k)})},_renderItemData:function(a,c){return this._renderItem(a,c).data("ui-autocomplete-item",c)},_renderItem:function(a,c){return f("<li>").append(f("<a>").text(c.label)).appendTo(a)},_move:function(a,c){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a))this._value(this.term),this.menu.blur();else this.menu[a](c);else this.search(null,c)},widget:function(){return this.menu.element},
_value:function(a){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,c){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(a,c),c.preventDefault()}});f.extend(f.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(a,c){var b=RegExp(f.ui.autocomplete.escapeRegex(c),"i");return f.grep(a,function(a){return b.test(a.label||a.value||a)})}});f.widget("ui.autocomplete",f.ui.autocomplete,{options:{messages:{noResults:"No search results.",
results:function(a){return a+(1<a?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var c;this._superApply(arguments);!this.options.disabled&&!this.cancelSearch&&(c=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(c))}})})(l);(function(f){var a,g,c,b,e=function(){var a=f(this).find(":ui-button");setTimeout(function(){a.button("refresh")},1)},k=function(a){var b=a.name,d=a.form,c=f([]);
b&&(c=d?f(d).find("[name='"+b+"']"):f("[name='"+b+"']",a.ownerDocument).filter(function(){return!this.form}));return c};f.widget("ui.button",{version:"1.9.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,e);"boolean"!==typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",
this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var j=this,m=this.options,d="checkbox"===this.type||"radio"===this.type,p="ui-state-hover"+(!d?" ui-state-active":"");null===m.label&&(m.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(!m.disabled){f(this).addClass("ui-state-hover");
this===a&&f(this).addClass("ui-state-active")}}).bind("mouseleave"+this.eventNamespace,function(){m.disabled||f(this).removeClass(p)}).bind("click"+this.eventNamespace,function(a){if(m.disabled){a.preventDefault();a.stopImmediatePropagation()}});this.element.bind("focus"+this.eventNamespace,function(){j.buttonElement.addClass("ui-state-focus")}).bind("blur"+this.eventNamespace,function(){j.buttonElement.removeClass("ui-state-focus")});d&&(this.element.bind("change"+this.eventNamespace,function(){b||
j.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){if(!m.disabled){b=false;g=a.pageX;c=a.pageY}}).bind("mouseup"+this.eventNamespace,function(a){if(!m.disabled&&(g!==a.pageX||c!==a.pageY))b=true}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(m.disabled||b)return false;f(this).toggleClass("ui-state-active");j.buttonElement.attr("aria-pressed",j.element[0].checked)}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,
function(){if(m.disabled||b)return false;f(this).addClass("ui-state-active");j.buttonElement.attr("aria-pressed","true");var a=j.element[0];k(a).not(a).map(function(){return f(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(m.disabled)return false;f(this).addClass("ui-state-active");a=this;j.document.one("mouseup",function(){a=null})}).bind("mouseup"+this.eventNamespace,function(){if(m.disabled)return false;
f(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(a){if(m.disabled)return false;(a.keyCode===f.ui.keyCode.SPACE||a.keyCode===f.ui.keyCode.ENTER)&&f(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){f(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===f.ui.keyCode.SPACE&&f(this).click()}));this._setOption("disabled",m.disabled);this._resetButton()},_determineButtonType:function(){var a,
b;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button";"checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),
(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",a)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var a=this.element.is(":disabled");a!==this.options.disabled&&this._setOption("disabled",a);"radio"===this.type?k(this.element[0]).each(function(){f(this).is(":checked")?f(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):f(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",
"false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var a=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
b=f("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(a.empty()).text(),d=this.options.icons,c=d.primary&&d.secondary,e=[];d.primary||d.secondary?(this.options.text&&e.push("ui-button-text-icon"+(c?"s":d.primary?"-primary":"-secondary")),d.primary&&a.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&a.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(e.push(c?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||a.attr("title",f.trim(b)))):e.push("ui-button-text-only");a.addClass(e.join(" "))}}});f.widget("ui.buttonset",{version:"1.9.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b);this._super(a,b)},refresh:function(){var a=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return f(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(a?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return f(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(l);
(function(f,a){function g(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};f.extend(this._defaults,this.regional[""]);this.dpDiv=c(f('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function c(a){return a.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){f(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&f(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){if(!f.datepicker._isDisabledDatepicker(k.inline?a.parent()[0]:k.input[0]))f(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
f(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&f(this).addClass("ui-datepicker-next-hover")})}function b(b,c){f.extend(b,c);for(var d in c)if(null==c[d]||c[d]==a)b[d]=c[d];return b}f.extend(f.ui,{datepicker:{version:"1.9.0"}});var e=(new Date).getTime(),k;f.extend(g.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){b(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var d=null,c;for(c in this._defaults){var e=a.getAttribute("date:"+c);if(e){d=d||{};try{d[c]=eval(e)}catch(k){d[c]=e}}}c=a.nodeName.toLowerCase();e="div"==c||"span"==c;a.id||(this.uuid+=1,a.id="dp"+this.uuid);var g=this._newInst(f(a),e);g.settings=f.extend({},b||{},d||{});"input"==c?this._connectDatepicker(a,g):e&&this._inlineDatepicker(a,g)},_newInst:function(a,
b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:c(f('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(a,b){var d=f(a);b.append=f([]);b.trigger=f([]);d.hasClass(this.markerClassName)||(this._attachments(d,b),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,d,c){b.settings[d]=c}).bind("getData.datepicker",function(a,d){return this._get(b,d)}),this._autoSize(b),f.data(a,"datepicker",b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var d=this._get(b,"appendText"),c=this._get(b,"isRTL");b.append&&b.append.remove();d&&(b.append=f('<span class="'+this._appendClass+'">'+d+"</span>"),a[c?"before":"after"](b.append));a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();d=this._get(b,"showOn");("focus"==
d||"both"==d)&&a.focus(this._showDatepicker);if("button"==d||"both"==d){var d=this._get(b,"buttonText"),e=this._get(b,"buttonImage");b.trigger=f(this._get(b,"buttonImageOnly")?f("<img/>").addClass(this._triggerClass).attr({src:e,alt:d,title:d}):f('<button type="button"></button>').addClass(this._triggerClass).html(""==e?d:f("<img/>").attr({src:e,alt:d,title:d})));a[c?"before":"after"](b.trigger);b.trigger.click(function(){if(f.datepicker._datepickerShowing&&f.datepicker._lastInput==a[0])f.datepicker._hideDatepicker();
else{f.datepicker._datepickerShowing&&f.datepicker._lastInput!=a[0]&&f.datepicker._hideDatepicker();f.datepicker._showDatepicker(a[0])}return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),d=this._get(a,"dateFormat");if(d.match(/[DM]/)){var c=function(a){for(var b=0,d=0,c=0;c<a.length;c++)a[c].length>b&&(b=a[c].length,d=c);return d};b.setMonth(c(this._get(a,d.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(c(this._get(a,d.match(/DD/)?"dayNames":
"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var d=f(a);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,d,c){b.settings[d]=c}).bind("getData.datepicker",function(a,d){return this._get(b,d)}),f.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),
b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,c,d,e,k){a=this._dialogInst;a||(this.uuid+=1,this._dialogInput=f('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),f("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},f.data(this._dialogInput[0],"datepicker",a));b(a.settings,e||{});c=c&&c.constructor==Date?this._formatDate(a,c):c;this._dialogInput.val(c);
this._pos=k?k.length?k:[k.pageX,k.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=d;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);f.blockUI&&f.blockUI(this.dpDiv);
f.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=f(a),d=f.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var c=a.nodeName.toLowerCase();f.removeData(a,"datepicker");"input"==c?(d.append.remove(),d.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==c||"span"==c)&&b.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(a){var b=f(a),d=f.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var c=a.nodeName.toLowerCase();if("input"==c)a.disabled=!1,d.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==c||"span"==c)b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=f.map(this._disabledInputs,
function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=f(a),d=f.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var c=a.nodeName.toLowerCase();if("input"==c)a.disabled=!0,d.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==c||"span"==c)b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0);this._disabledInputs=f.map(this._disabledInputs,function(b){return b==a?null:b});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return f.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(c,e,d){var k=this._getInst(c);if(2==arguments.length&&"string"==typeof e)return"defaults"==
e?f.extend({},f.datepicker._defaults):k?"all"==e?f.extend({},k.settings):this._get(k,e):null;var g=e||{};"string"==typeof e&&(g={},g[e]=d);if(k){this._curInst==k&&this._hideDatepicker();var l=this._getDateDatepicker(c,!0),o=this._getMinMaxDate(k,"min"),q=this._getMinMaxDate(k,"max");b(k.settings,g);null!==o&&(g.dateFormat!==a&&g.minDate===a)&&(k.settings.minDate=this._formatDate(k,o));null!==q&&(g.dateFormat!==a&&g.maxDate===a)&&(k.settings.maxDate=this._formatDate(k,q));this._attachments(f(c),k);
this._autoSize(k);this._setDate(k,l);this._updateAlternate(k);this._updateDatepicker(k)}},_changeDatepicker:function(a,b,d){this._optionDatepicker(a,b,d)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var d=this._getInst(a);d&&(this._setDate(d,b),this._updateDatepicker(d),this._updateAlternate(d))},_getDateDatepicker:function(a,b){var d=this._getInst(a);d&&!d.inline&&this._setDateFromField(d,b);return d?this._getDate(d):null},_doKeyDown:function(a){var b=
f.datepicker._getInst(a.target),d=!0,c=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(f.datepicker._datepickerShowing)switch(a.keyCode){case 9:f.datepicker._hideDatepicker();d=!1;break;case 13:return d=f("td."+f.datepicker._dayOverClass+":not(."+f.datepicker._currentClass+")",b.dpDiv),d[0]&&f.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,d[0]),(a=f.datepicker._get(b,"onSelect"))?(d=f.datepicker._formatDate(b),a.apply(b.input?b.input[0]:null,[d,b])):f.datepicker._hideDatepicker(),
!1;case 27:f.datepicker._hideDatepicker();break;case 33:f.datepicker._adjustDate(a.target,a.ctrlKey?-f.datepicker._get(b,"stepBigMonths"):-f.datepicker._get(b,"stepMonths"),"M");break;case 34:f.datepicker._adjustDate(a.target,a.ctrlKey?+f.datepicker._get(b,"stepBigMonths"):+f.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&f.datepicker._clearDate(a.target);d=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&f.datepicker._gotoToday(a.target);d=a.ctrlKey||a.metaKey;
break;case 37:if(a.ctrlKey||a.metaKey)f.datepicker._adjustDate(a.target,c?1:-1,"D");d=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&f.datepicker._adjustDate(a.target,a.ctrlKey?-f.datepicker._get(b,"stepBigMonths"):-f.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&f.datepicker._adjustDate(a.target,-7,"D");d=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)f.datepicker._adjustDate(a.target,c?-1:1,"D");d=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&f.datepicker._adjustDate(a.target,
a.ctrlKey?+f.datepicker._get(b,"stepBigMonths"):+f.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&f.datepicker._adjustDate(a.target,7,"D");d=a.ctrlKey||a.metaKey;break;default:d=!1}else 36==a.keyCode&&a.ctrlKey?f.datepicker._showDatepicker(this):d=!1;d&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(b){var c=f.datepicker._getInst(b.target);if(f.datepicker._get(c,"constrainInput")){var c=f.datepicker._possibleChars(f.datepicker._get(c,"dateFormat")),d=String.fromCharCode(b.charCode==
a?b.keyCode:b.charCode);return b.ctrlKey||b.metaKey||" ">d||!c||-1<c.indexOf(d)}},_doKeyUp:function(a){a=f.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{if(f.datepicker.parseDate(f.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,f.datepicker._getFormatConfig(a)))f.datepicker._setDateFromField(a),f.datepicker._updateAlternate(a),f.datepicker._updateDatepicker(a)}catch(b){f.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a;"input"!=a.nodeName.toLowerCase()&&
(a=f("input",a.parentNode)[0]);if(!(f.datepicker._isDisabledDatepicker(a)||f.datepicker._lastInput==a)){var c=f.datepicker._getInst(a);f.datepicker._curInst&&f.datepicker._curInst!=c&&(f.datepicker._curInst.dpDiv.stop(!0,!0),c&&f.datepicker._datepickerShowing&&f.datepicker._hideDatepicker(f.datepicker._curInst.input[0]));var d=f.datepicker._get(c,"beforeShow"),d=d?d.apply(a,[a,c]):{};if(!1!==d){b(c.settings,d);c.lastVal=null;f.datepicker._lastInput=a;f.datepicker._setDateFromField(c);f.datepicker._inDialog&&
(a.value="");f.datepicker._pos||(f.datepicker._pos=f.datepicker._findPos(a),f.datepicker._pos[1]+=a.offsetHeight);var e=!1;f(a).parents().each(function(){e=e|f(this).css("position")=="fixed";return!e});d={left:f.datepicker._pos[0],top:f.datepicker._pos[1]};f.datepicker._pos=null;c.dpDiv.empty();c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});f.datepicker._updateDatepicker(c);d=f.datepicker._checkOffset(c,d,e);c.dpDiv.css({position:f.datepicker._inDialog&&f.blockUI?"static":e?"fixed":
"absolute",display:"none",left:d.left+"px",top:d.top+"px"});if(!c.inline){var d=f.datepicker._get(c,"showAnim"),k=f.datepicker._get(c,"duration"),g=function(){var a=c.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var b=f.datepicker._getBorders(c.dpDiv);a.css({left:-b[0],top:-b[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})}};c.dpDiv.zIndex(f(a).zIndex()+1);f.datepicker._datepickerShowing=!0;if(f.effects&&(f.effects.effect[d]||f.effects[d]))c.dpDiv.show(d,f.datepicker._get(c,
"showOptions"),k,g);else c.dpDiv[d||"show"](d?k:null,g);(!d||!k)&&g();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();f.datepicker._curInst=c}}}},_updateDatepicker:function(a){this.maxRows=4;var b=f.datepicker._getBorders(a.dpDiv);k=a;a.dpDiv.empty().append(this._generateHTML(a));this._attachHandlers(a);var d=a.dpDiv.find("iframe.ui-datepicker-cover");d.length&&d.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()});a.dpDiv.find("."+this._dayOverClass+
" a").mouseover();b=this._getNumberOfMonths(a);d=b[1];a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<d&&a.dpDiv.addClass("ui-datepicker-multi-"+d).css("width",17*d+"em");a.dpDiv[(1!=b[0]||1!=b[1]?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==f.datepicker._curInst&&(f.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=
document.activeElement)&&a.input.focus();if(a.yearshtml){var c=a.yearshtml;setTimeout(function(){c===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);c=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,d){var c=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),k=a.input?a.input.outerWidth():
0,g=a.input?a.input.outerHeight():0,q=document.documentElement.clientWidth+(d?0:f(document).scrollLeft()),l=document.documentElement.clientHeight+(d?0:f(document).scrollTop());b.left-=this._get(a,"isRTL")?c-k:0;b.left-=d&&b.left==a.input.offset().left?f(document).scrollLeft():0;b.top-=d&&b.top==a.input.offset().top+g?f(document).scrollTop():0;b.left-=Math.min(b.left,b.left+c>q&&q>c?Math.abs(b.left+c-q):0);b.top-=Math.min(b.top,b.top+e>l&&l>e?Math.abs(e+g):0);return b},_findPos:function(a){for(var b=
this._get(this._getInst(a),"isRTL");a&&("hidden"==a.type||1!=a.nodeType||f.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=f(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(b&&!(a&&b!=f.data(a,"datepicker"))&&this._datepickerShowing){var a=this._get(b,"showAnim"),d=this._get(b,"duration"),c=function(){f.datepicker._tidyDialog(b)};if(f.effects&&(f.effects.effect[a]||f.effects[a]))b.dpDiv.hide(a,f.datepicker._get(b,"showOptions"),d,c);else b.dpDiv["slideDown"==
a?"slideUp":"fadeIn"==a?"fadeOut":"hide"](a?d:null,c);a||c();this._datepickerShowing=!1;(a=this._get(b,"onClose"))&&a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),f.blockUI&&(f.unblockUI(),f("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(f.datepicker._curInst){var a=
f(a.target),b=f.datepicker._getInst(a[0]);(a[0].id!=f.datepicker._mainDivId&&0==a.parents("#"+f.datepicker._mainDivId).length&&!a.hasClass(f.datepicker.markerClassName)&&!a.closest("."+f.datepicker._triggerClass).length&&f.datepicker._datepickerShowing&&(!f.datepicker._inDialog||!f.blockUI)||a.hasClass(f.datepicker.markerClassName)&&f.datepicker._curInst!=b)&&f.datepicker._hideDatepicker()}},_adjustDate:function(a,b,d){var a=f(a),c=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(c,
b+("M"==d?this._get(c,"showCurrentAtPos"):0),d),this._updateDatepicker(c))},_gotoToday:function(a){var a=f(a),b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var d=new Date;b.selectedDay=d.getDate();b.drawMonth=b.selectedMonth=d.getMonth();b.drawYear=b.selectedYear=d.getFullYear()}this._notifyChange(b);this._adjustDate(a)},_selectMonthYear:function(a,b,d){var a=f(a),
c=this._getInst(a[0]);c["selected"+("M"==d?"Month":"Year")]=c["draw"+("M"==d?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(c);this._adjustDate(a)},_selectDay:function(a,b,d,c){var e=f(a);!f(c).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(e[0])&&(e=this._getInst(e[0]),e.selectedDay=e.currentDay=f("a",c).html(),e.selectedMonth=e.currentMonth=b,e.selectedYear=e.currentYear=d,this._selectDate(a,this._formatDate(e,e.currentDay,e.currentMonth,e.currentYear)))},
_clearDate:function(a){a=f(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){var d=this._getInst(f(a)[0]),b=null!=b?b:this._formatDate(d);d.input&&d.input.val(b);this._updateAlternate(d);var c=this._get(d,"onSelect");c?c.apply(d.input?d.input[0]:null,[b,d]):d.input&&d.input.trigger("change");d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],"object"!=typeof d.input[0]&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=
this._get(a,"altField");if(b){var d=this._get(a,"altFormat")||this._get(a,"dateFormat"),c=this._getDate(a),e=this.formatDate(d,c,this._getFormatConfig(a));f(b).each(function(){f(this).val(e)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,d){if(null==a||null==b)throw"Invalid arguments";
b="object"==typeof b?b.toString():b+"";if(""==b)return null;for(var c=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),e=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,k=(d?d.dayNames:null)||this._defaults.dayNames,g=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,q=(d?d.monthNames:null)||this._defaults.monthNames,l=d=-1,u=-1,x=-1,t=!1,v=function(b){(b=E+1<a.length&&a.charAt(E+1)==b)&&E++;return b},B=function(a){var d=
v(a),a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&d?4:"o"==a?3:2)+"}"),a=b.substring(A).match(a);if(!a)throw"Missing number at position "+A;A+=a[0].length;return parseInt(a[0],10)},C=function(a,d,c){var a=f.map(v(a)?c:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),e=-1;f.each(a,function(a,d){var c=d[1];if(b.substr(A,c.length).toLowerCase()==c.toLowerCase())return e=d[0],A+=c.length,!1});if(-1!=e)return e+1;throw"Unknown name at position "+A;},z=function(){if(b.charAt(A)!=
a.charAt(E))throw"Unexpected literal at position "+A;A++},A=0,E=0;E<a.length;E++)if(t)"'"==a.charAt(E)&&!v("'")?t=!1:z();else switch(a.charAt(E)){case "d":u=B("d");break;case "D":C("D",e,k);break;case "o":x=B("o");break;case "m":l=B("m");break;case "M":l=C("M",g,q);break;case "y":d=B("y");break;case "@":var K=new Date(B("@")),d=K.getFullYear(),l=K.getMonth()+1,u=K.getDate();break;case "!":K=new Date((B("!")-this._ticksTo1970)/1E4);d=K.getFullYear();l=K.getMonth()+1;u=K.getDate();break;case "'":v("'")?
z():t=!0;break;default:z()}if(A<b.length&&(e=b.substr(A),!/^\s+/.test(e)))throw"Extra/unparsed characters found in date: "+e;-1==d?d=(new Date).getFullYear():100>d&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=c?0:-100));if(-1<x){l=1;u=x;do{c=this._getDaysInMonth(d,l-1);if(u<=c)break;l++;u-=c}while(1)}K=this._daylightSavingAdjust(new Date(d,l-1,u));if(K.getFullYear()!=d||K.getMonth()+1!=l||K.getDate()!=u)throw"Invalid date";return K},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,d){if(!b)return"";var c=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,e=(d?d.dayNames:null)||this._defaults.dayNames,k=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,d=(d?d.monthNames:null)||this._defaults.monthNames,g=
function(b){(b=t+1<a.length&&a.charAt(t+1)==b)&&t++;return b},f=function(a,b,d){b=""+b;if(g(a))for(;b.length<d;)b="0"+b;return b},l=function(a,b,d,c){return g(a)?c[b]:d[b]},u="",x=!1;if(b)for(var t=0;t<a.length;t++)if(x)"'"==a.charAt(t)&&!g("'")?x=!1:u+=a.charAt(t);else switch(a.charAt(t)){case "d":u+=f("d",b.getDate(),2);break;case "D":u+=l("D",b.getDay(),c,e);break;case "o":u+=f("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/
864E5),3);break;case "m":u+=f("m",b.getMonth()+1,2);break;case "M":u+=l("M",b.getMonth(),k,d);break;case "y":u+=g("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":u+=b.getTime();break;case "!":u+=1E4*b.getTime()+this._ticksTo1970;break;case "'":g("'")?u+="'":x=!0;break;default:u+=a.charAt(t)}return u},_possibleChars:function(a){for(var b="",d=!1,c=function(b){(b=e+1<a.length&&a.charAt(e+1)==b)&&e++;return b},e=0;e<a.length;e++)if(d)"'"==a.charAt(e)&&!c("'")?d=!1:b+=
a.charAt(e);else switch(a.charAt(e)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":c("'")?b+="'":d=!0;break;default:b+=a.charAt(e)}return b},_get:function(b,c){return b.settings[c]!==a?b.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var d=this._get(a,"dateFormat"),c=a.lastVal=a.input?a.input.val():null,e,k;e=k=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(d,c,g)||k}catch(f){this.log(f),
c=b?"":c}a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();a.currentDay=c?e.getDate():0;a.currentMonth=c?e.getMonth():0;a.currentYear=c?e.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,d){var c=function(a){var b=new Date;b.setDate(b.getDate()+a);return b},e=function(b){try{return f.datepicker.parseDate(f.datepicker._get(a,
"dateFormat"),b,f.datepicker._getFormatConfig(a))}catch(d){}for(var c=(b.toLowerCase().match(/^c/)?f.datepicker._getDate(a):null)||new Date,e=c.getFullYear(),k=c.getMonth(),c=c.getDate(),m=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,g=m.exec(b);g;){switch(g[2]||"d"){case "d":case "D":c+=parseInt(g[1],10);break;case "w":case "W":c+=7*parseInt(g[1],10);break;case "m":case "M":k+=parseInt(g[1],10);c=Math.min(c,f.datepicker._getDaysInMonth(e,k));break;case "y":case "Y":e+=parseInt(g[1],10),c=Math.min(c,f.datepicker._getDaysInMonth(e,
k))}g=m.exec(b)}return new Date(e,k,c)};if(b=(b=null==b||""===b?d:"string"==typeof b?e(b):"number"==typeof b?isNaN(b)?d:c(b):new Date(b.getTime()))&&"Invalid Date"==b.toString()?d:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,b,d){var c=!b,e=a.selectedMonth,k=a.selectedYear,b=this._restrictMinMax(a,this._determineDate(a,
b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(e!=a.selectedMonth||k!=a.selectedYear)&&!d&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(c?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_attachHandlers:function(a){var b=this._get(a,
"stepMonths"),d="#"+a.id.replace(/\\\\/g,"\\");a.dpDiv.find("[data-handler]").map(function(){f(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+e].datepicker._adjustDate(d,-b,"M")},next:function(){window["DP_jQuery_"+e].datepicker._adjustDate(d,+b,"M")},hide:function(){window["DP_jQuery_"+e].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+e].datepicker._gotoToday(d)},selectDay:function(){window["DP_jQuery_"+e].datepicker._selectDay(d,+this.getAttribute("data-month"),
+this.getAttribute("data-year"),this);return!1},selectMonth:function(){window["DP_jQuery_"+e].datepicker._selectMonthYear(d,this,"M");return!1},selectYear:function(){window["DP_jQuery_"+e].datepicker._selectMonthYear(d,this,"Y");return!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b=new Date,b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate())),d=this._get(a,"isRTL"),c=this._get(a,"showButtonPanel"),e=this._get(a,"hideIfNoPrevNext"),k=this._get(a,
"navigationAsDateFormat"),g=this._getNumberOfMonths(a),q=this._get(a,"showCurrentAtPos"),l=this._get(a,"stepMonths"),u=1!=g[0]||1!=g[1],x=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),t=this._getMinMaxDate(a,"min"),v=this._getMinMaxDate(a,"max"),q=a.drawMonth-q,B=a.drawYear;0>q&&(q+=12,B--);if(v)for(var C=this._daylightSavingAdjust(new Date(v.getFullYear(),v.getMonth()-g[0]*g[1]+1,v.getDate())),C=t&&C<t?t:C;this._daylightSavingAdjust(new Date(B,
q,1))>C;)q--,0>q&&(q=11,B--);a.drawMonth=q;a.drawYear=B;var C=this._get(a,"prevText"),C=!k?C:this.formatDate(C,this._daylightSavingAdjust(new Date(B,q-l,1)),this._getFormatConfig(a)),C=this._canAdjustMonth(a,-1,B,q)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+C+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"e":"w")+'">'+C+"</span></a>":e?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+C+'"><span class="ui-icon ui-icon-circle-triangle-'+
(d?"e":"w")+'">'+C+"</span></a>",z=this._get(a,"nextText"),z=!k?z:this.formatDate(z,this._daylightSavingAdjust(new Date(B,q+l,1)),this._getFormatConfig(a)),e=this._canAdjustMonth(a,1,B,q)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+z+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"w":"e")+'">'+z+"</span></a>":e?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+z+'"><span class="ui-icon ui-icon-circle-triangle-'+(d?"w":
"e")+'">'+z+"</span></a>",l=this._get(a,"currentText"),z=this._get(a,"gotoCurrent")&&a.currentDay?x:b,l=!k?l:this.formatDate(l,z,this._getFormatConfig(a)),k=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(a,"closeText")+"</button>":"",c=c?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(d?k:"")+(this._isInRange(a,z)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
l+"</button>":"")+(d?"":k)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),z=this._get(a,"dayNames");this._get(a,"dayNamesShort");var A=this._get(a,"dayNamesMin"),E=this._get(a,"monthNames"),K=this._get(a,"monthNamesShort"),U=this._get(a,"beforeShowDay"),y=this._get(a,"showOtherMonths"),S=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var D=this._getDefaultDate(a),Y="",X=0;X<g[0];X++){var V="";this.maxRows=4;for(var G=0;G<g[1];G++){var Q=
this._daylightSavingAdjust(new Date(B,q,a.selectedDay)),H=" ui-corner-all",O="";if(u){O+='<div class="ui-datepicker-group';if(1<g[1])switch(G){case 0:O+=" ui-datepicker-group-first";H=" ui-corner-"+(d?"right":"left");break;case g[1]-1:O+=" ui-datepicker-group-last";H=" ui-corner-"+(d?"left":"right");break;default:O+=" ui-datepicker-group-middle",H=""}O+='">'}for(var O=O+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+H+'">'+(/all|left/.test(H)&&0==X?d?e:C:"")+(/all|right/.test(H)&&
0==X?d?C:e:"")+this._generateMonthYearHeader(a,q,B,t,v,0<X||0<G,E,K)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),$=l?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"",H=0;7>H;H++)var W=(H+k)%7,$=$+("<th"+(5<=(H+k+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+z[W]+'">'+A[W]+"</span></th>");O+=$+"</tr></thead><tbody>";$=this._getDaysInMonth(B,q);B==a.selectedYear&&q==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,$));H=(this._getFirstDayOfMonth(B,
q)-k+7)%7;$=Math.ceil((H+$)/7);this.maxRows=$=u?this.maxRows>$?this.maxRows:$:$;for(var W=this._daylightSavingAdjust(new Date(B,q,1-H)),fa=0;fa<$;fa++){for(var O=O+"<tr>",ha=!l?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(W)+"</td>",H=0;7>H;H++){var L=U?U.apply(a.input?a.input[0]:null,[W]):[!0,""],I=W.getMonth()!=q,P=I&&!S||!L[0]||t&&W<t||v&&W>v,ha=ha+('<td class="'+(5<=(H+k+6)%7?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(W.getTime()==Q.getTime()&&
q==a.selectedMonth&&a._keyEvent||D.getTime()==W.getTime()&&D.getTime()==Q.getTime()?" "+this._dayOverClass:"")+(P?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!y?"":" "+L[1]+(W.getTime()==x.getTime()?" "+this._currentClass:"")+(W.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!I||y)&&L[2]?' title="'+L[2]+'"':"")+(P?"":' data-handler="selectDay" data-event="click" data-month="'+W.getMonth()+'" data-year="'+W.getFullYear()+'"')+">"+(I&&!y?"&#xa0;":P?'<span class="ui-state-default">'+
W.getDate()+"</span>":'<a class="ui-state-default'+(W.getTime()==b.getTime()?" ui-state-highlight":"")+(W.getTime()==x.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+'" href="#">'+W.getDate()+"</a>")+"</td>");W.setDate(W.getDate()+1);W=this._daylightSavingAdjust(W)}O+=ha+"</tr>"}q++;11<q&&(q=0,B++);O+="</tbody></table>"+(u?"</div>"+(0<g[0]&&G==g[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");V+=O}Y+=V}Y+=c+(f.browser.msie&&7>parseInt(f.browser.version,10)&&!a.inline?
'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");a._keyEvent=!1;return Y},_generateMonthYearHeader:function(a,b,d,c,e,k,g,f){var l=this._get(a,"changeMonth"),u=this._get(a,"changeYear"),x=this._get(a,"showMonthAfterYear"),t='<div class="ui-datepicker-title">',v="";if(k||!l)v+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{for(var g=c&&c.getFullYear()==d,B=e&&e.getFullYear()==d,v=v+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',
C=0;12>C;C++)if((!g||C>=c.getMonth())&&(!B||C<=e.getMonth()))v+='<option value="'+C+'"'+(C==b?' selected="selected"':"")+">"+f[C]+"</option>";v+="</select>"}x||(t+=v+(k||!l||!u?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",k||!u)t+='<span class="ui-datepicker-year">'+d+"</span>";else{var f=this._get(a,"yearRange").split(":"),z=(new Date).getFullYear(),g=function(a){a=a.match(/c[+-].*/)?d+parseInt(a.substring(1),10):a.match(/[+-].*/)?z+parseInt(a,10):parseInt(a,10);return isNaN(a)?z:a},b=g(f[0]),
f=Math.max(b,g(f[1]||"")),b=c?Math.max(b,c.getFullYear()):b,f=e?Math.min(f,e.getFullYear()):f;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=f;b++)a.yearshtml+='<option value="'+b+'"'+(b==d?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";t+=a.yearshtml;a.yearshtml=null}t+=this._get(a,"yearSuffix");x&&(t+=(k||!l||!u?"&#xa0;":"")+v);return t+"</div>"},_adjustInstDate:function(a,b,d){var c=a.drawYear+("Y"==d?b:0),e=a.drawMonth+
("M"==d?b:0),b=Math.min(a.selectedDay,this._getDaysInMonth(c,e))+("D"==d?b:0),c=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(c,e,b)));a.selectedDay=c.getDate();a.drawMonth=a.selectedMonth=c.getMonth();a.drawYear=a.selectedYear=c.getFullYear();("M"==d||"Y"==d)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var d=this._getMinMaxDate(a,"min"),c=this._getMinMaxDate(a,"max"),d=d&&b<d?d:b;return c&&d>c?c:d},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?
a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,d,c){var e=this._getNumberOfMonths(a),d=this._daylightSavingAdjust(new Date(d,
c+(0>b?b:e[0]*e[1]),1));0>b&&d.setDate(this._getDaysInMonth(d.getFullYear(),d.getMonth()));return this._isInRange(a,d)},_isInRange:function(a,b){var d=this._getMinMaxDate(a,"min"),c=this._getMinMaxDate(a,"max");return(!d||b.getTime()>=d.getTime())&&(!c||b.getTime()<=c.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff"),b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,
"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,d,c){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(c,d,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});f.fn.datepicker=function(a){if(!this.length)return this;
f.datepicker.initialized||(f(document).mousedown(f.datepicker._checkExternalClick).find(document.body).append(f.datepicker.dpDiv),f.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&("isDisabled"==a||"getDate"==a||"widget"==a)||"option"==a&&2==arguments.length&&"string"==typeof arguments[1]?f.datepicker["_"+a+"Datepicker"].apply(f.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?f.datepicker["_"+a+"Datepicker"].apply(f.datepicker,
[this].concat(b)):f.datepicker._attachDatepicker(this,a)})};f.datepicker=new g;f.datepicker.initialized=!1;f.datepicker.uuid=(new Date).getTime();f.datepicker.version="1.9.0";window["DP_jQuery_"+e]=f})(l);(function(f,a){var g={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},c={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};f.widget("ui.dialog",{version:"1.9.0",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,
height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(a){var c=f(this).css(a).offset().top;0>c&&f(this).css("top",a.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};
this.options.title=this.options.title||this.originalTitle;var a=this,c=this.options,k=c.title||"&#160;",j=(this.uiDialog=f("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({display:"none",outline:0,zIndex:c.zIndex}).attr("tabIndex",-1).keydown(function(d){if(c.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===f.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}}).mousedown(function(d){a.moveToTop(false,d)}).appendTo("body");this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(j);
var g=(this.uiDialogTitlebar=f("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(j),d=f("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(d){d.preventDefault();a.close(d)}).appendTo(g);(this.uiDialogTitlebarCloseText=f("<span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(d);var k=f("<span>").uniqueId().addClass("ui-dialog-title").html(k).prependTo(g),p=(this.uiDialogButtonPane=
f("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=f("<div>")).addClass("ui-dialog-buttonset").appendTo(p);j.attr({role:"dialog","aria-labelledby":k.attr("id")});g.find("*").add(g).disableSelection();this._hoverable(d);this._focusable(d);c.draggable&&f.fn.draggable&&this._makeDraggable();c.resizable&&f.fn.resizable&&this._makeResizable();this._createButtons(c.buttons);this._isOpen=!1;f.fn.bgiframe&&j.bgiframe();this._on(j,{keydown:function(a){if(c.modal&&
a.keyCode===f.ui.keyCode.TAB){var b=f(":tabbable",j),d=b.filter(":first"),b=b.filter(":last");if(a.target===b[0]&&!a.shiftKey){d.focus(1);return false}if(a.target===d[0]&&a.shiftKey){b.focus(1);return false}}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var a,c=this.oldPosition;this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",
this.originalTitle);a=c.parent.children().eq(c.index);a.length&&a[0]!==this.element[0]?a.before(this.element):c.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(a){var c=this,k,j;if(this._isOpen&&!1!==this._trigger("beforeClose",a))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this.uiDialog.hide(this.options.hide,function(){c._trigger("close",a)}):(this.uiDialog.hide(),this._trigger("close",a)),f.ui.dialog.overlay.resize(),this.options.modal&&
(k=0,f(".ui-dialog").each(function(){if(this!==c.uiDialog[0]){j=f(this).css("z-index");isNaN(j)||(k=Math.max(k,j))}}),f.ui.dialog.maxZ=k),this},isOpen:function(){return this._isOpen},moveToTop:function(a,c){var k=this.options;if(k.modal&&!a||!k.stack&&!k.modal)return this._trigger("focus",c);k.zIndex>f.ui.dialog.maxZ&&(f.ui.dialog.maxZ=k.zIndex);this.overlay&&(f.ui.dialog.maxZ+=1,f.ui.dialog.overlay.maxZ=f.ui.dialog.maxZ,this.overlay.$el.css("z-index",f.ui.dialog.overlay.maxZ));k={scrollTop:this.element.scrollTop(),
scrollLeft:this.element.scrollLeft()};f.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",f.ui.dialog.maxZ);this.element.attr(k);this._trigger("focus",c);return this},open:function(){if(!this._isOpen){var a;a=this.options;var c=this.uiDialog;this._size();this._position(a.position);c.show(a.show);this.overlay=a.modal?new f.ui.dialog.overlay(this):null;this.moveToTop(!0);a=this.element.find(":tabbable");a.length||(a=this.uiDialogButtonPane.find(":tabbable"),a.length||(a=c));a.eq(0).focus();this._isOpen=
!0;this._trigger("open");return this}},_createButtons:function(a){var c=this,k=!1;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();"object"===typeof a&&null!==a&&f.each(a,function(){return!(k=!0)});k?(f.each(a,function(a,b){var b=f.isFunction(b)?{click:b,text:a}:b,d=f("<button type='button'>").attr(b,!0).unbind("click").click(function(){b.click.apply(c.element[0],arguments)}).appendTo(c.uiButtonSet);f.fn.button&&d.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):
this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function a(b){return{position:b.position,offset:b.offset}}var c=this,k=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(j,k){f(this).addClass("ui-dialog-dragging");c._trigger("dragStart",j,a(k))},drag:function(j,k){c._trigger("drag",j,a(k))},stop:function(j,g){k.position=[g.position.left-c.document.scrollLeft(),g.position.top-
c.document.scrollTop()];f(this).removeClass("ui-dialog-dragging");c._trigger("dragStop",j,a(g));f.ui.dialog.overlay.resize()}})},_makeResizable:function(b){function c(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var b=b===a?this.options.resizable:b,k=this,j=this.options,g=this.uiDialog.css("position"),b="string"===typeof b?b:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,
maxWidth:j.maxWidth,maxHeight:j.maxHeight,minWidth:j.minWidth,minHeight:this._minHeight(),handles:b,start:function(a,b){f(this).addClass("ui-dialog-resizing");k._trigger("resizeStart",a,c(b))},resize:function(a,b){k._trigger("resize",a,c(b))},stop:function(a,b){f(this).removeClass("ui-dialog-resizing");j.height=f(this).height();j.width=f(this).width();k._trigger("resizeStop",a,c(b));f.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},
_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var c=[],k=[0,0],j;if(a){if("string"===typeof a||"object"===typeof a&&"0"in a)c=a.split?a.split(" "):[a[0],a[1]],1===c.length&&(c[1]=c[0]),f.each(["left","top"],function(a,b){+c[a]===c[a]&&(k[a]=c[a],c[a]=b)}),a={my:c.join(" "),at:c.join(" "),offset:k.join(" ")};a=f.extend({},f.ui.dialog.prototype.options.position,a)}else a=f.ui.dialog.prototype.options.position;(j=this.uiDialog.is(":visible"))||
this.uiDialog.show();this.uiDialog.position(a);j||this.uiDialog.hide()},_setOptions:function(a){var e=this,k={},j=!1;f.each(a,function(a,b){e._setOption(a,b);a in g&&(j=!0);a in c&&(k[a]=b)});j&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",k)},_setOption:function(a,c){var k,j=this.uiDialog;switch(a){case "buttons":this._createButtons(c);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+c);break;case "dialogClass":j.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+
c);break;case "disabled":c?j.addClass("ui-dialog-disabled"):j.removeClass("ui-dialog-disabled");break;case "draggable":(k=j.is(":data(draggable)"))&&!c&&j.draggable("destroy");!k&&c&&this._makeDraggable();break;case "position":this._position(c);break;case "resizable":(k=j.is(":data(resizable)"))&&!c&&j.resizable("destroy");k&&"string"===typeof c&&j.resizable("option","handles",c);!k&&!1!==c&&this._makeResizable(c);break;case "title":f(".ui-dialog-title",this.uiDialogTitlebar).html(""+(c||"&#160;"))}this._super(a,
c)},_size:function(){var a,c,k=this.options,j=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});k.minWidth>k.width&&(k.width=k.minWidth);a=this.uiDialog.css({height:"auto",width:k.width}).outerHeight();c=Math.max(0,k.minHeight-a);"auto"===k.height?f.support.minHeight?this.element.css({minHeight:c,height:"auto"}):(this.uiDialog.show(),a=this.element.css("height","auto").height(),j||this.uiDialog.hide(),this.element.height(Math.max(a,c))):this.element.height(Math.max(k.height-
a,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});f.extend(f.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(a){this.$el=f.ui.dialog.overlay.create(a)}});f.extend(f.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:f.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){0===
this.instances.length&&(setTimeout(function(){f.ui.dialog.overlay.instances.length&&f(document).bind(f.ui.dialog.overlay.events,function(a){if(f(a.target).zIndex()<f.ui.dialog.overlay.maxZ)return!1})},1),f(window).bind("resize.dialog-overlay",f.ui.dialog.overlay.resize));var c=this.oldInstances.pop()||f("<div>").addClass("ui-widget-overlay");f(document).bind("keydown.dialog-overlay",function(k){var j=f.ui.dialog.overlay.instances;if(j.length!==0&&j[j.length-1]===c&&a.options.closeOnEscape&&!k.isDefaultPrevented()&&
k.keyCode&&k.keyCode===f.ui.keyCode.ESCAPE){a.close(k);k.preventDefault()}});c.appendTo(document.body).css({width:this.width(),height:this.height()});f.fn.bgiframe&&c.bgiframe();this.instances.push(c);return c},destroy:function(a){var c=f.inArray(a,this.instances),k=0;-1!==c&&this.oldInstances.push(this.instances.splice(c,1)[0]);0===this.instances.length&&f([document,window]).unbind(".dialog-overlay");a.height(0).width(0).remove();f.each(this.instances,function(){k=Math.max(k,this.css("z-index"))});
this.maxZ=k},height:function(){var a,c;return f.browser.msie?(a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),a<c?f(window).height()+"px":a+"px"):f(document).height()+"px"},width:function(){var a,c;return f.browser.msie?(a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),a<c?f(window).width()+"px":
a+"px"):f(document).width()+"px"},resize:function(){var a=f([]);f.each(f.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,height:0}).css({width:f.ui.dialog.overlay.width(),height:f.ui.dialog.overlay.height()})}});f.extend(f.ui.dialog.overlay.prototype,{destroy:function(){f.ui.dialog.overlay.destroy(this.$el)}})})(l);(function(f){var a=!1;f.widget("ui.menu",{version:"1.9.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",
at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,f.proxy(function(a){this.options.disabled&&a.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");
this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(g){var c=f(g.target).closest(".ui-menu-item");!a&&c.not(".ui-state-disabled").length&&(a=!0,this.select(g),c.has(".ui-menu").length?this.expand(g):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(a){var c=
f(a.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(a,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,c){var b=this.active||this.element.children(".ui-menu-item").eq(0);c||this.focus(a,b)},blur:function(a){this._delay(function(){f.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(a)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(g){f(g.target).closest(".ui-menu").length||
this.collapseAll(g);a=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var a=
f(this);a.data("ui-menu-submenu-carat")&&a.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(a){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var b,e,k,j,m=!0;switch(a.keyCode){case f.ui.keyCode.PAGE_UP:this.previousPage(a);break;case f.ui.keyCode.PAGE_DOWN:this.nextPage(a);break;case f.ui.keyCode.HOME:this._move("first","first",a);break;case f.ui.keyCode.END:this._move("last","last",a);break;case f.ui.keyCode.UP:this.previous(a);
break;case f.ui.keyCode.DOWN:this.next(a);break;case f.ui.keyCode.LEFT:this.collapse(a);break;case f.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(a);break;case f.ui.keyCode.ENTER:case f.ui.keyCode.SPACE:this._activate(a);break;case f.ui.keyCode.ESCAPE:this.collapse(a);break;default:(m=!1,b=this.previousFilter||"",e=String.fromCharCode(a.keyCode),k=!1,clearTimeout(this.filterTimer),e===b?k=!0:e=b+e,j=RegExp("^"+c(e),"i"),b=this.activeMenu.children(".ui-menu-item").filter(function(){return j.test(f(this).children("a").text())}),
b=k&&-1!==b.index(this.active.next())?this.active.nextAll(".ui-menu-item"):b,b.length||(e=String.fromCharCode(a.keyCode),j=RegExp("^"+c(e),"i"),b=this.activeMenu.children(".ui-menu-item").filter(function(){return j.test(f(this).children("a").text())})),b.length)?(this.focus(a,b),1<b.length?(this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}m&&a.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||
(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var a,c=this.options.icons.submenu,b=this.element.find(this.options.menus+":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"});a=b.add(this.element);a.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,
role:this._itemRole()});a.children(":not(.ui-menu-item)").each(function(){var a=f(this);/[^\-—–\s]/.test(a.text())||a.addClass("ui-widget-content ui-menu-divider")});a.children(".ui-state-disabled").attr("aria-disabled","true");b.each(function(){var a=f(this),b=a.prev("a"),j=f("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);b.attr("aria-haspopup","true").prepend(j);a.attr("aria-labelledby",b.attr("id"))});this.active&&!f.contains(this.element[0],this.active[0])&&this.blur()},
_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(a,c){var b;this.blur(a,a&&"focus"===a.type);this._scrollIntoView(c);this.active=c.first();b=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",b.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);
b=c.children(".ui-menu");b.length&&/^mouse/.test(a.type)&&this._startOpening(b);this.activeMenu=c.parent();this._trigger("focus",a,{item:c})},_scrollIntoView:function(a){var c,b,e;this._hasScroll()&&(c=parseFloat(f.css(this.activeMenu[0],"borderTopWidth"))||0,b=parseFloat(f.css(this.activeMenu[0],"paddingTop"))||0,c=a.offset().top-this.activeMenu.offset().top-c-b,b=this.activeMenu.scrollTop(),e=this.activeMenu.height(),a=a.height(),0>c?this.activeMenu.scrollTop(b+c):c+a>e&&this.activeMenu.scrollTop(b+
c-e+a))},blur:function(a,c){c||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer);"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(a)},this.delay))},_open:function(a){var c=f.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(a.parents(".ui-menu")).hide().attr("aria-hidden",
"true");a.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(a,c){clearTimeout(this.timer);this.timer=this._delay(function(){var b=c?this.element:f(a&&a.target).closest(this.element.find(".ui-menu"));b.length||(b=this.element);this._close(b);this.blur(a);this.activeMenu=b},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element);a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},
collapse:function(a){var c=this.active&&this.active.parent().closest(".ui-menu-item",this.element);c&&c.length&&(this._close(),this.focus(a,c))},expand:function(a){var c=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();c&&c.length&&(this._open(c.parent()),this._delay(function(){this.focus(a,c)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},
isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,c,b){var e;this.active&&(e="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0));if(!e||!e.length||!this.active)e=this.activeMenu.children(".ui-menu-item")[c]();this.focus(b,e)},nextPage:function(a){var c,b,e;this.active?this.isLastItem()||(this._hasScroll()?(b=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){c=
f(this);return 0>c.offset().top-b-e}),this.focus(a,c)):this.focus(a,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())):this.next(a)},previousPage:function(a){var c,b,e;this.active?this.isFirstItem()||(this._hasScroll()?(b=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){c=f(this);return 0<c.offset().top-b+e}),this.focus(a,c)):this.focus(a,this.activeMenu.children(".ui-menu-item").first())):this.next(a)},_hasScroll:function(){return this.element.outerHeight()<
this.element.prop("scrollHeight")},select:function(a){this.active=this.active||f(a.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(a,!0);this._trigger("select",a,c)}})})(l);(function(f,a){f.widget("ui.progressbar",{version:"1.9.0",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,
"aria-valuenow":this._value()});this.valueDiv=f("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(g){if(g===a)return this._value();this._setOption("value",
g);return this},_setOption:function(a,c){"value"===a&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super(a,c)},_value:function(){var a=this.options.value;"number"!==typeof a&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),c=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change"));this.valueDiv.toggle(a>
this.min).toggleClass("ui-corner-right",a===this.options.max).width(c.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}})})(l);(function(f){f.widget("ui.slider",f.ui.mouse,{version:"1.9.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a,g=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),b=g.values&&g.values.length||1,e=[];this._mouseSliding=
this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(g.disabled?" ui-slider-disabled ui-disabled":""));this.range=f([]);if(g.range){if(!0===g.range&&(g.values||(g.values=[this._valueMin(),this._valueMin()]),g.values.length&&2!==g.values.length))g.values=[g.values[0],g.values[0]];this.range=f("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+
("min"===g.range||"max"===g.range?" ui-slider-range-"+g.range:""))}for(a=c.length;a<b;a++)e.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=c.add(f(e.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).mouseenter(function(){g.disabled||f(this).addClass("ui-state-hover")}).mouseleave(function(){f(this).removeClass("ui-state-hover")}).focus(function(){g.disabled?
f(this).blur():(f(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),f(this).addClass("ui-state-focus"))}).blur(function(){f(this).removeClass("ui-state-focus")});this.handles.each(function(a){f(this).data("ui-slider-handle-index",a)});this._on(this.handles,{keydown:function(a){var b,c,d,e=f(a.target).data("ui-slider-handle-index");switch(a.keyCode){case f.ui.keyCode.HOME:case f.ui.keyCode.END:case f.ui.keyCode.PAGE_UP:case f.ui.keyCode.PAGE_DOWN:case f.ui.keyCode.UP:case f.ui.keyCode.RIGHT:case f.ui.keyCode.DOWN:case f.ui.keyCode.LEFT:if(a.preventDefault(),
!this._keySliding&&(this._keySliding=!0,f(a.target).addClass("ui-state-active"),b=this._start(a,e),!1===b))return}d=this.options.step;b=this.options.values&&this.options.values.length?c=this.values(e):c=this.value();switch(a.keyCode){case f.ui.keyCode.HOME:c=this._valueMin();break;case f.ui.keyCode.END:c=this._valueMax();break;case f.ui.keyCode.PAGE_UP:c=this._trimAlignValue(b+(this._valueMax()-this._valueMin())/5);break;case f.ui.keyCode.PAGE_DOWN:c=this._trimAlignValue(b-(this._valueMax()-this._valueMin())/
5);break;case f.ui.keyCode.UP:case f.ui.keyCode.RIGHT:if(b===this._valueMax())return;c=this._trimAlignValue(b+d);break;case f.ui.keyCode.DOWN:case f.ui.keyCode.LEFT:if(b===this._valueMin())return;c=this._trimAlignValue(b-d)}this._slide(a,e,c)},keyup:function(a){var b=f(a.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(a,b),this._change(a,b),f(a.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();
this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(a){var g,c,b,e,k,j=this;k=this.options;if(k.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();g=this._normValueFromMouse({x:a.pageX,y:a.pageY});c=this._valueMax()-this._valueMin()+1;this.handles.each(function(a){var d=
Math.abs(g-j.values(a));c>d&&(c=d,b=f(this),e=a)});!0===k.range&&this.values(1)===k.min&&(e+=1,b=f(this.handles[e]));if(!1===this._start(a,e))return!1;this._mouseSliding=!0;this._handleIndex=e;b.addClass("ui-state-active").focus();k=b.offset();this._clickOffset=!f(a.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:a.pageX-k.left-b.width()/2,top:a.pageY-k.top-b.height()/2-(parseInt(b.css("borderTopWidth"),10)||0)-(parseInt(b.css("borderBottomWidth"),10)||0)+(parseInt(b.css("marginTop"),
10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(a,e,g);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(a){var g=this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,g);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation=
"vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var g;"horizontal"===this.orientation?(g=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(g=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));g=a/g;1<g&&(g=1);0>g&&(g=0);"vertical"===this.orientation&&(g=1-g);a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+g*a)},_start:function(a,
g){var c={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(g),c.values=this.values());return this._trigger("start",a,c)},_slide:function(a,g,c){var b;if(this.options.values&&this.options.values.length){b=this.values(g?0:1);if(2===this.options.values.length&&!0===this.options.range&&(0===g&&c>b||1===g&&c<b))c=b;c!==this.values(g)&&(b=this.values(),b[g]=c,a=this._trigger("slide",a,{handle:this.handles[g],value:c,values:b}),this.values(g?
0:1),!1!==a&&this.values(g,c,!0))}else c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[g],value:c}),!1!==a&&this.value(c))},_stop:function(a,g){var c={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(g),c.values=this.values());this._trigger("stop",a,c)},_change:function(a,g){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(c.value=
this.values(g),c.values=this.values());this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(a,g){var c,b,e;if(1<arguments.length)this.options.values[a]=this._trimAlignValue(g),this._refreshValue(),this._change(null,a);else if(arguments.length)if(f.isArray(arguments[0])){c=this.options.values;b=arguments[0];for(e=0;e<c.length;e+=1)c[e]=this._trimAlignValue(b[e]),
this._change(null,e);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(a):this.value();else return this._values()},_setOption:function(a,g){var c,b=0;f.isArray(this.options.values)&&(b=this.options.values.length);f.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":g?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",
!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(c=0;c<b;c+=1)this._change(null,c);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},
_values:function(a){var g,c;if(arguments.length)return g=this.options.values[a],g=this._trimAlignValue(g);g=this.options.values.slice();for(c=0;c<g.length;c+=1)g[c]=this._trimAlignValue(g[c]);return g},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var g=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%g,a=a-c;2*Math.abs(c)>=g&&(a+=0<c?g:-g);return parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},
_valueMax:function(){return this.options.max},_refreshValue:function(){var a,g,c,b,e,k=this.options.range,j=this.options,m=this,d=!this._animateOff?j.animate:!1,p={};if(this.options.values&&this.options.values.length)this.handles.each(function(b){g=100*((m.values(b)-m._valueMin())/(m._valueMax()-m._valueMin()));p["horizontal"===m.orientation?"left":"bottom"]=g+"%";f(this).stop(1,1)[d?"animate":"css"](p,j.animate);if(!0===m.options.range)if("horizontal"===m.orientation){if(0===b)m.range.stop(1,1)[d?
"animate":"css"]({left:g+"%"},j.animate);if(1===b)m.range[d?"animate":"css"]({width:g-a+"%"},{queue:!1,duration:j.animate})}else{if(0===b)m.range.stop(1,1)[d?"animate":"css"]({bottom:g+"%"},j.animate);if(1===b)m.range[d?"animate":"css"]({height:g-a+"%"},{queue:!1,duration:j.animate})}a=g});else{c=this.value();b=this._valueMin();e=this._valueMax();g=e!==b?100*((c-b)/(e-b)):0;p["horizontal"===this.orientation?"left":"bottom"]=g+"%";this.handle.stop(1,1)[d?"animate":"css"](p,j.animate);if("min"===k&&
"horizontal"===this.orientation)this.range.stop(1,1)[d?"animate":"css"]({width:g+"%"},j.animate);if("max"===k&&"horizontal"===this.orientation)this.range[d?"animate":"css"]({width:100-g+"%"},{queue:!1,duration:j.animate});if("min"===k&&"vertical"===this.orientation)this.range.stop(1,1)[d?"animate":"css"]({height:g+"%"},j.animate);if("max"===k&&"vertical"===this.orientation)this.range[d?"animate":"css"]({height:100-g+"%"},{queue:!1,duration:j.animate})}}})})(l);(function(f){function a(a){return function(){var c=
this.element.val();a.apply(this,arguments);this._refresh();c!==this.element.val()&&this._trigger("change")}}f.widget("ui.spinner",{version:"1.9.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",
this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var a={},c=this.element;f.each(["min","max","step"],function(b,e){var k=c.attr(e);void 0!==k&&k.length&&(a[e]=k)});return a},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active");
this.previous=this.element.val()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(this._refresh(),this.uiSpinner.removeClass("ui-state-active"),this.previous!==this.element.val()&&this._trigger("change",a))},mousewheel:function(a,c){if(c){if(!this.spinning&&!this._start(a))return!1;this._spin((0<c?1:-1)*this.options.step,a);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100);a.preventDefault()}},"mousedown .ui-spinner-button":function(a){function c(){this.element[0]!==
this.document[0].activeElement&&(this.element.focus(),this.previous=b,this._delay(function(){this.previous=b}))}var b;b=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();a.preventDefault();c.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;c.call(this)});!1!==this._start(a)&&this._repeat(null,f(a.currentTarget).hasClass("ui-spinner-up")?1:-1,a)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(a){if(f(a.currentTarget).hasClass("ui-state-active")){if(!1===
this._start(a))return!1;this._repeat(null,f(a.currentTarget).hasClass("ui-spinner-up")?1:-1,a)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(a);this.element.attr("role","spinbutton");this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*
a.height())&&0<a.height()&&a.height(a.height());this.options.disabled&&this.disable()},_keydown:function(a){var c=this.options,b=f.ui.keyCode;switch(a.keyCode){case b.UP:return this._repeat(null,1,a),!0;case b.DOWN:return this._repeat(null,-1,a),!0;case b.PAGE_UP:return this._repeat(null,c.page,a),!0;case b.PAGE_DOWN:return this._repeat(null,-c.page,a),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+
this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){if(!this.spinning&&!1===this._trigger("start",a))return!1;this.counter||(this.counter=1);return this.spinning=!0},_repeat:function(a,c,b){a=a||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,c,b)},a);this._spin(c*this.options.step,b)},_spin:function(a,c){var b=this.value()||0;this.counter||
(this.counter=1);b=this._adjustValue(b+a*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",c,{value:b}))this._value(b),this.counter++},_increment:function(a){var c=this.options.incremental;return c?f.isFunction(c)?c(a):Math.floor(a*a*a/5E4-a*a/500+17*a/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min)));return a},_precisionOf:function(a){var a=a.toString(),c=a.indexOf(".");
return-1===c?0:a.length-c-1},_adjustValue:function(a){var c,b=this.options;c=null!==b.min?b.min:0;a=Math.round((a-c)/b.step)*b.step;a=parseFloat((c+a).toFixed(this._precision()));return null!==b.max&&a>b.max?b.max:null!==b.min&&a<b.min?b.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,c){if("culture"===a||"numberFormat"===a){var b=this._parse(this.element.val());this.options[a]=
c;this.element.val(this._format(b))}else{if("max"===a||"min"===a||"step"===a)"string"===typeof c&&(c=this._parse(c));this._super(a,c);"disabled"===a&&(c?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))}},_setOptions:a(function(a){this._super(a);this._value(this.element.val())}),_parse:function(a){"string"===typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):
+a);return""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,c){var b;""!==a&&(b=this._parse(a),null!==b&&(c||(b=this._adjustValue(b)),a=this._format(b)));this.element.val(a);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",
!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:a(function(a){this._stepUp(a)}),_stepUp:function(a){this._spin((a||1)*this.options.step)},stepDown:a(function(a){this._stepDown(a)}),_stepDown:function(a){this._spin((a||1)*-this.options.step)},pageUp:a(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:a(function(a){this._stepDown((a||1)*this.options.page)}),
value:function(g){if(!arguments.length)return this._parse(this.element.val());a(this._value).call(this,g)},widget:function(){return this.uiSpinner}})})(l);(function(f,a){function g(a){a=a.cloneNode(!1);return 1<a.hash.length&&a.href.replace(b,"")===location.href.replace(b,"")}var c=0,b=/#.*$/;f.widget("ui.tabs",{version:"1.9.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var a=
this,b=this.options,c=b.active;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",b.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(a){f(this).is(".ui-state-disabled")&&a.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){f(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();if(null===c&&(location.hash&&this.anchors.each(function(a,
b){if(b.hash===location.hash)return c=a,!1}),null===c&&(c=this.tabs.filter(".ui-tabs-active").index()),null===c||-1===c))c=this.tabs.length?0:!1;!1!==c&&(c=this.tabs.index(this.tabs.eq(c)),-1===c&&(c=b.collapsible?!1:0));b.active=c;!b.collapsible&&(!1===b.active&&this.anchors.length)&&(b.active=0);f.isArray(b.disabled)&&(b.disabled=f.unique(b.disabled.concat(f.map(this.tabs.filter(".ui-state-disabled"),function(b){return a.tabs.index(b)}))).sort());this.active=!1!==this.options.active&&this.anchors.length?
this._findActive(this.options.active):f();this._refresh();this.active.length&&this.load(b.active)},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?f():this._getPanelForTab(this.active)}},_tabKeydown:function(a){var b=f(this.document[0].activeElement).closest("li"),c=this.tabs.index(b),m=!0;if(!this._handlePageNav(a)){switch(a.keyCode){case f.ui.keyCode.RIGHT:case f.ui.keyCode.DOWN:c++;break;case f.ui.keyCode.UP:case f.ui.keyCode.LEFT:m=!1;c--;break;case f.ui.keyCode.END:c=
this.anchors.length-1;break;case f.ui.keyCode.HOME:c=0;break;case f.ui.keyCode.SPACE:a.preventDefault();clearTimeout(this.activating);this._activate(c);return;case f.ui.keyCode.ENTER:a.preventDefault();clearTimeout(this.activating);this._activate(c===this.options.active?!1:c);return;default:return}a.preventDefault();clearTimeout(this.activating);c=this._focusNextTab(c,m);a.ctrlKey||(b.attr("aria-selected","false"),this.tabs.eq(c).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",
c)},this.delay))}},_panelKeydown:function(a){!this._handlePageNav(a)&&(a.ctrlKey&&a.keyCode===f.ui.keyCode.UP)&&(a.preventDefault(),this.active.focus())},_handlePageNav:function(a){if(a.altKey&&a.keyCode===f.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(a.altKey&&a.keyCode===f.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(a,b){function c(){a>m&&(a=0);0>a&&(a=m);return a}for(var m=this.tabs.length-
1;-1!==f.inArray(c(),this.options.disabled);)a=b?a+1:a-1;return a},_focusNextTab:function(a,b){a=this._findNextTab(a,b);this.tabs.eq(a).focus();return a},_setOption:function(a,b){"active"===a?this._activate(b):"disabled"===a?this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),!b&&!1===this.options.active&&this._activate(0)),"event"===a&&this._setupEvents(b),"heightStyle"===a&&this._setupHeightStyle(b))},_tabId:function(a){return a.attr("aria-controls")||
"ui-tabs-"+ ++c},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var a=this.options,b=this.tablist.children(":has(a[href])");a.disabled=f.map(b.filter(".ui-state-disabled"),function(a){return b.index(a)});this._processTabs();!1===a.active||!this.anchors.length?(a.active=!1,this.active=f()):this.active.length&&!f.contains(this.tablist[0],this.active[0])?this.tabs.length===a.disabled.length?(a.active=!1,this.active=f()):this._activate(this._findNextTab(Math.max(0,
a.active-1),!1)):a.active=this.tabs.index(this.active);this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",
tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var a=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return f("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",
tabIndex:-1});this.panels=f();this.anchors.each(function(b,c){var m,d,p,n=f(c).uniqueId().attr("id"),l=f(c).closest("li"),o=l.attr("aria-controls");g(c)?(m=c.hash,d=a.element.find(a._sanitizeSelector(m))):(p=a._tabId(l),m="#"+p,d=a.element.find(m),d.length||(d=a._createPanel(p),d.insertAfter(a.panels[b-1]||a.tablist)),d.attr("aria-live","polite"));d.length&&(a.panels=a.panels.add(d));o&&l.data("ui-tabs-aria-controls",o);l.attr({"aria-controls":m.substring(1),"aria-labelledby":n});d.attr("aria-labelledby",
n)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(a){return f("<div>").attr("id",a).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(a){f.isArray(a)&&(a.length?a.length===this.anchors.length&&(a=!0):a=!1);for(var b=0,c;c=this.tabs[b];b++)!0===a||-1!==f.inArray(b,a)?f(c).addClass("ui-state-disabled").attr("aria-disabled",
"true"):f(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=a},_setupEvents:function(a){var b={click:function(a){a.preventDefault()}};a&&f.each(a.split(" "),function(a,c){b[c]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,b);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(a){var b,c,m=this.element.parent();
"fill"===a?(f.support.minHeight||(c=m.css("overflow"),m.css("overflow","hidden")),b=m.height(),this.element.siblings(":visible").each(function(){var a=f(this),c=a.css("position");c==="absolute"||c==="fixed"||(b=b-a.outerHeight(true))}),c&&m.css("overflow",c),this.element.children().not(this.panels).each(function(){b=b-f(this).outerHeight(true)}),this.panels.each(function(){f(this).height(Math.max(0,b-f(this).innerHeight()+f(this).height()))}).css("overflow","auto")):"auto"===a&&(b=0,this.panels.each(function(){b=
Math.max(b,f(this).height("").height())}).height(b))},_eventHandler:function(a){var b=this.options,c=this.active,m=f(a.currentTarget).closest("li"),d=m[0]===c[0],g=d&&b.collapsible,n=g?f():this._getPanelForTab(m),l=!c.length?f():this._getPanelForTab(c),c={oldTab:c,oldPanel:l,newTab:g?f():m,newPanel:n};a.preventDefault();if(!m.hasClass("ui-state-disabled")&&!m.hasClass("ui-tabs-loading")&&!this.running&&!(d&&!b.collapsible||!1===this._trigger("beforeActivate",a,c)))b.active=g?!1:this.tabs.index(m),
this.active=d?f():m,this.xhr&&this.xhr.abort(),!l.length&&!n.length&&f.error("jQuery UI Tabs: Mismatching fragment identifier."),n.length&&this.load(this.tabs.index(m),a),this._toggle(a,c)},_toggle:function(a,b){function c(){d.running=!1;d._trigger("activate",a,b)}function m(){b.newTab.closest("li").addClass("ui-tabs-active ui-state-active");g.length&&d.options.show?d._show(g,d.options.show,c):(g.show(),c())}var d=this,g=b.newPanel,n=b.oldPanel;this.running=!0;n.length&&this.options.hide?this._hide(n,
this.options.hide,function(){b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");m()}):(b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n.hide(),m());n.attr({"aria-expanded":"false","aria-hidden":"true"});b.oldTab.attr("aria-selected","false");g.length&&n.length?b.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return f(this).attr("tabIndex")===0}).attr("tabIndex",-1);g.attr({"aria-expanded":"true","aria-hidden":"false"});b.newTab.attr({"aria-selected":"true",
tabIndex:0})},_activate:function(a){a=this._findActive(a);a[0]!==this.active[0]&&(a.length||(a=this.active),a=a.find(".ui-tabs-anchor")[0],this._eventHandler({target:a,currentTarget:a,preventDefault:f.noop}))},_findActive:function(a){return!1===a?f():this.tabs.eq(a)},_getIndex:function(a){"string"===typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']")));return a},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");
this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId();this.tabs.add(this.panels).each(function(){f.data(this,"ui-tabs-destroy")?f(this).remove():f(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});
this.tabs.each(function(){var a=f(this),b=a.data("ui-tabs-aria-controls");b?a.attr("aria-controls",b):a.removeAttr("aria-controls")});"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var c=this.options.disabled;!1!==c&&(b===a?c=!1:(b=this._getIndex(b),c=f.isArray(c)?f.map(c,function(a){return a!==b?a:null}):f.map(this.tabs,function(a,c){return c!==b?c:null})),this._setupDisabled(c))},disable:function(b){var c=this.options.disabled;if(!0!==c){if(b===a)c=!0;else{b=
this._getIndex(b);if(-1!==f.inArray(b,c))return;c=f.isArray(c)?f.merge([b],c).sort():[b]}this._setupDisabled(c)}},load:function(a,b){var a=this._getIndex(a),c=this,m=this.tabs.eq(a),d=m.find(".ui-tabs-anchor"),p=this._getPanelForTab(m),n={tab:m,panel:p};if(!g(d[0])&&(this.xhr=f.ajax(this._ajaxSettings(d,b,n)))&&"canceled"!==this.xhr.statusText)m.addClass("ui-tabs-loading"),p.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){p.html(a);c._trigger("load",b,n)},1)}).complete(function(a,
b){setTimeout(function(){"abort"===b&&c.panels.stop(!1,!0);m.removeClass("ui-tabs-loading");p.removeAttr("aria-busy");a===c.xhr&&delete c.xhr},1)})},_ajaxSettings:function(a,b,c){var m=this;return{url:a.attr("href"),beforeSend:function(a,e){return m._trigger("beforeLoad",b,f.extend({jqXHR:a,ajaxSettings:e},c))}}},_getPanelForTab:function(a){return this.element.find(this._sanitizeSelector("#"+f(a).attr("aria-controls")))}});!1!==f.uiBackCompat&&(f.ui.tabs.prototype._ui=function(a,b){return{tab:a,panel:b,
index:this.anchors.index(a)}},f.widget("ui.tabs",f.ui.tabs,{url:function(a,b){this.anchors.eq(a).attr("href",b)}}),f.widget("ui.tabs",f.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var a=this;this._on({tabsbeforeload:function(b,c){f.data(c.tab[0],"cache.tabs")?b.preventDefault():c.jqXHR.success(function(){a.options.cache&&f.data(c.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(a,b,c){var m=this.options.ajaxOptions;return f.extend({},m,{error:function(a,b){try{m.error(a,
b,c.tab.closest("li").index(),c.tab[0])}catch(e){}}},this._superApply(arguments))},_setOption:function(a,b){"cache"===a&&!1===b&&this.anchors.removeData("cache.tabs");this._super(a,b)},_destroy:function(){this.anchors.removeData("cache.tabs");this._super()},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs");this._superApply(arguments)}}),f.widget("ui.tabs",f.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),f.widget("ui.tabs",f.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},
_create:function(){this._super();this._on({tabsbeforeload:function(a,b){if(a.target===this.element[0]&&this.options.spinner){var c=b.tab.find("span"),m=c.html();c.html(this.options.spinner);b.jqXHR.complete(function(){c.html(m)})}}})}}),f.widget("ui.tabs",f.ui.tabs,{options:{enable:null,disable:null},enable:function(a){var b=this.options,c;if(a&&!0===b.disabled||f.isArray(b.disabled)&&-1!==f.inArray(a,b.disabled))c=!0;this._superApply(arguments);c&&this._trigger("enable",null,this._ui(this.anchors[a],
this.panels[a]))},disable:function(a){var b=this.options,c;if(a&&!1===b.disabled||f.isArray(b.disabled)&&-1===f.inArray(a,b.disabled))c=!0;this._superApply(arguments);c&&this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a]))}}),f.widget("ui.tabs",f.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(b,c,j){j===a&&(j=this.anchors.length);var m,d=this.options,c=f(d.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,
c)),g=!b.indexOf("#")?b.replace("#",""):this._tabId(c);c.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0);c.attr("aria-controls",g);b=j>=this.tabs.length;m=this.element.find("#"+g);m.length||(m=this._createPanel(g),b?0<j?m.insertAfter(this.panels.eq(-1)):m.appendTo(this.element):m.insertBefore(this.panels[j]));m.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();b?c.appendTo(this.tablist):c.insertBefore(this.tabs[j]);d.disabled=f.map(d.disabled,function(a){return a>=
j?++a:a});this.refresh();1===this.tabs.length&&!1===d.active&&this.option("active",0);this._trigger("add",null,this._ui(this.anchors[j],this.panels[j]));return this},remove:function(a){var a=this._getIndex(a),b=this.options,c=this.tabs.eq(a).remove(),m=this._getPanelForTab(c).remove();c.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(a+(a+1<this.anchors.length?1:-1));b.disabled=f.map(f.grep(b.disabled,function(b){return b!==a}),function(b){return b>=a?--b:b});this.refresh();this._trigger("remove",
null,this._ui(c.find("a")[0],m[0]));return this}}),f.widget("ui.tabs",f.ui.tabs,{length:function(){return this.anchors.length}}),f.widget("ui.tabs",f.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(a){a=a.is("li")?a.find("a[href]"):a;a=a[0];return f(a).closest("li").attr("aria-controls")||a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+ ++c}}),f.widget("ui.tabs",f.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(a){return f(this.options.panelTemplate).attr("id",
a).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),f.widget("ui.tabs",f.ui.tabs,{_create:function(){var b=this.options;null===b.active&&b.selected!==a&&(b.active=-1===b.selected?!1:b.selected);this._super();b.selected=b.active;!1===b.selected&&(b.selected=-1)},_setOption:function(a,b){if("selected"!==a)return this._super(a,b);var c=this.options;this._super("active",-1===b?!1:b);c.selected=c.active;!1===c.selected&&(c.selected=-1)},_eventHandler:function(a){this._superApply(arguments);
this.options.selected=this.options.active;!1===this.options.selected&&(this.options.selected=-1)}}),f.widget("ui.tabs",f.ui.tabs,{options:{show:null,select:null},_create:function(){this._super();!1!==this.options.active&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(a,b,c){var m=this._superApply(arguments);if(!m)return!1;"beforeActivate"===a&&c.newTab.length?m=this._super("select",b,{tab:c.newTab.find(".ui-tabs-anchor")[0],
panel:c.newPanel[0],index:c.newTab.closest("li").index()}):"activate"===a&&c.newTab.length&&(m=this._super("show",b,{tab:c.newTab.find(".ui-tabs-anchor")[0],panel:c.newPanel[0],index:c.newTab.closest("li").index()}));return m}}),f.widget("ui.tabs",f.ui.tabs,{select:function(a){a=this._getIndex(a);if(-1===a)if(this.options.collapsible&&-1!==this.options.selected)a=this.options.selected;else return;this.anchors.eq(a).trigger(this.options.event+this.eventNamespace)}}),function(){var a=0;f.widget("ui.tabs",
f.ui.tabs,{options:{cookie:null},_create:function(){var a=this.options,b;null==a.active&&a.cookie&&(b=parseInt(this._cookie(),10),-1===b&&(b=!1),a.active=b);this._super()},_cookie:function(b){var c=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++a)];arguments.length&&(c.push(!1===b?-1:b),c.push(this.options.cookie));return f.cookie.apply(null,c)},_refresh:function(){this._super();this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(a){this._superApply(arguments);
this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super();this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),f.widget("ui.tabs",f.ui.tabs,{_trigger:function(a,b,c){c=f.extend({},c);"load"===a&&(c.panel=c.panel[0],c.tab=c.tab.find(".ui-tabs-anchor")[0]);return this._super(a,b,c)}}),f.widget("ui.tabs",f.ui.tabs,{options:{fx:null},_getFx:function(){var a,b,c=this.options.fx;c&&(f.isArray(c)?(a=c[0],b=c[1]):a=b=c);return c?{show:b,hide:a}:
null},_toggle:function(a,b){function c(){d.running=!1;d._trigger("activate",a,b)}function m(){b.newTab.closest("li").addClass("ui-tabs-active ui-state-active");g.length&&l.show?g.animate(l.show,l.show.duration,function(){c()}):(g.show(),c())}var d=this,g=b.newPanel,f=b.oldPanel,l=this._getFx();if(!l)return this._super(a,b);d.running=!0;f.length&&l.hide?f.animate(l.hide,l.hide.duration,function(){b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");m()}):(b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
f.hide(),m())}}))})(l);(function(f){function a(a,c){var k=(a.attr("aria-describedby")||"").split(/\s+/);k.push(c);a.data("ui-tooltip-id",c).attr("aria-describedby",f.trim(k.join(" ")))}function g(a){var c=a.data("ui-tooltip-id"),k=(a.attr("aria-describedby")||"").split(/\s+/),c=f.inArray(c,k);-1!==c&&k.splice(c,1);a.removeData("ui-tooltip-id");(k=f.trim(k.join(" ")))?a.attr("aria-describedby",k):a.removeAttr("aria-describedby")}var c=0;f.widget("ui.tooltip",{version:"1.9.0",options:{content:function(){return f(this).attr("title")},
hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(a,c){var k=this;"disabled"===a?(this[c?"_disable":"_enable"](),this.options[a]=c):(this._super(a,c),"content"===a&&f.each(this.tooltips,function(a,b){k._updateContent(b)}))},_disable:function(){var a=this;f.each(this.tooltips,function(c,k){var j=
f.Event("blur");j.target=j.currentTarget=k[0];a.close(j,!0)});this.element.find(this.options.items).andSelf().each(function(){var a=f(this);a.is("[title]")&&a.data("ui-tooltip-title",a.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var a=f(this);a.data("ui-tooltip-title")&&a.attr("title",a.data("ui-tooltip-title"))})},open:function(a){var c=f(a?a.target:this.element).closest(this.options.items);c.length&&(this.options.track&&c.data("ui-tooltip-id")?
(this._find(c).position(f.extend({of:c},this.options.position)),this._off(this.document,"mousemove")):(c.attr("title")&&c.data("ui-tooltip-title",c.attr("title")),c.data("tooltip-open",!0),this._updateContent(c,a)))},_updateContent:function(a,c){var k;k=this.options.content;var j=this;if("string"===typeof k)return this._open(c,a,k);(k=k.call(a[0],function(k){a.data("tooltip-open")&&j._delay(function(){this._open(c,a,k)})}))&&this._open(c,a,k)},_open:function(b,c,k){function j(a){d.of=a;m.position(d)}
var m,d;k&&(m=this._find(c),m.length?m.find(".ui-tooltip-content").html(k):(c.is("[title]")&&(b&&"mouseover"===b.type?c.attr("title",""):c.removeAttr("title")),m=this._tooltip(c),a(c,m.attr("id")),m.find(".ui-tooltip-content").html(k),this.options.track&&b&&/^mouse/.test(b.originalEvent.type)?(d=f.extend({},this.options.position),this._on(this.document,{mousemove:j}),j(b)):m.position(f.extend({of:c},this.options.position)),m.hide(),this._show(m,this.options.show),this._trigger("open",b,{tooltip:m}),
this._on(c,{mouseleave:"close",focusout:"close",keyup:function(a){if(a.keyCode===f.ui.keyCode.ESCAPE){a=f.Event(a);a.currentTarget=c[0];this.close(a,true)}}})))},close:function(a,c){var k=this,j=f(a?a.currentTarget:this.element),m=this._find(j);if(!this.closing&&(c||!a||!("focusout"!==a.type&&this.document[0].activeElement===j[0])))j.data("ui-tooltip-title")&&j.attr("title",j.data("ui-tooltip-title")),g(j),m.stop(!0),this._hide(m,this.options.hide,function(){f(this).remove();delete k.tooltips[this.id]}),
j.removeData("tooltip-open"),this._off(j,"mouseleave focusout keyup"),this._off(this.document,"mousemove"),this.closing=!0,this._trigger("close",a,{tooltip:m}),this.closing=!1},_tooltip:function(a){var e="ui-tooltip-"+c++,k=f("<div>").attr({id:e,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));f("<div>").addClass("ui-tooltip-content").appendTo(k);k.appendTo(this.document[0].body);f.fn.bgiframe&&k.bgiframe();this.tooltips[e]=a;return k},
_find:function(a){return(a=a.data("ui-tooltip-id"))?f("#"+a):f()},_destroy:function(){var a=this;f.each(this.tooltips,function(c,k){var j=f.Event("blur");j.target=j.currentTarget=k[0];a.close(j,!0);f("#"+c).remove();k.data("ui-tooltip-title")&&(k.attr("title",k.data("ui-tooltip-title")),k.removeData("ui-tooltip-title"))})}})})(l);l.effects||function(f,a){var g=!1!==f.uiBackCompat;f.effects={effect:{}};(function(a,b){function e(a,b,c){var d=l[b.type]||{};if(null==a)return c||!b.def?null:b.def;a=d.floor?
~~a:parseFloat(a);return isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a}function k(b){var e=g(),j=e._rgba=[],b=b.toLowerCase();u(d,function(a,c){var d,k=c.re.exec(b);d=k&&c.parse(k);k=c.space||"rgba";if(d)return d=e[k](d),e[n[k].cache]=d[n[k].cache],j=e._rgba=d._rgba,!1});return j.length?("0,0,0,0"===j.join()&&a.extend(j,r.transparent),e):r[b]}function j(a,b,c){c=(c+1)%1;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var m=/^([\-+])=\s*(\d+\.?\d*)/,d=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],g=a.Color=function(b,d,e,j){return new a.Color.fn.parse(b,d,e,j)},n={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},o=g.support={},q=a("<p>")[0],r,u=a.each;q.style.cssText="background-color:rgba(1,1,1,.5)";
o.rgba=-1<q.style.backgroundColor.indexOf("rgba");u(n,function(a,b){b.cache="_"+a;b.props.alpha={idx:3,type:"percent",def:1}});g.fn=a.extend(g.prototype,{parse:function(d,j,m,l){if(d===b)return this._rgba=[null,null,null,null],this;if(d.jquery||d.nodeType)d=a(d).css(j),j=b;var o=this,q=a.type(d),s=this._rgba=[];j!==b&&(d=[d,j,m,l],q="array");if("string"===q)return this.parse(k(d)||r._default);if("array"===q)return u(n.rgba.props,function(a,b){s[b.idx]=e(d[b.idx],b)}),this;if("object"===q)return d instanceof
g?u(n,function(a,b){d[b.cache]&&(o[b.cache]=d[b.cache].slice())}):u(n,function(a,b){var c=b.cache;u(b.props,function(a,j){if(!o[c]&&b.to){if(a==="alpha"||d[a]==null)return;o[c]=b.to(o._rgba)}o[c][j.idx]=e(d[a],j,true)});if(o[c]&&f.inArray(null,o[c].slice(0,3))<0){o[c][3]=1;if(b.from)o._rgba=b.from(o[c])}}),this},is:function(a){var b=g(a),c=!0,d=this;u(n,function(a,e){var j,k=b[e.cache];k&&(j=d[e.cache]||e.to&&e.to(d._rgba)||[],u(e.props,function(a,b){if(null!=k[b.idx])return c=k[b.idx]===j[b.idx]}));
return c});return c},_space:function(){var a=[],b=this;u(n,function(c,d){b[d.cache]&&a.push(c)});return a.pop()},transition:function(a,b){var c=g(a),d=c._space(),j=n[d],k=0===this.alpha()?g("transparent"):this,m=k[j.cache]||j.to(k._rgba),f=m.slice(),c=c[j.cache];u(j.props,function(a,d){var j=d.idx,k=m[j],g=c[j],n=l[d.type]||{};null!==g&&(null===k?f[j]=g:(n.mod&&(g-k>n.mod/2?k+=n.mod:k-g>n.mod/2&&(k-=n.mod)),f[j]=e((g-k)*b+k,d)))});return this[d](f)},blend:function(b){if(1===this._rgba[3])return this;
var d=this._rgba.slice(),e=d.pop(),j=g(b)._rgba;return g(a.map(d,function(a,b){return(1-e)*j[b]+e*a}))},toRgbaString:function(){var b="rgba(",d=a.map(this._rgba,function(a,b){return null==a?2<b?1:0:a});1===d[3]&&(d.pop(),b="rgb(");return b+d.join()+")"},toHslaString:function(){var b="hsla(",d=a.map(this.hsla(),function(a,b){null==a&&(a=2<b?1:0);b&&3>b&&(a=Math.round(100*a)+"%");return a});1===d[3]&&(d.pop(),b="hsl(");return b+d.join()+")"},toHexString:function(b){var d=this._rgba.slice(),e=d.pop();
b&&d.push(~~(255*e));return"#"+a.map(d,function(a){a=(a||0).toString(16);return 1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});g.fn.parse.prototype=g.fn;n.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,a=a[3],e=Math.max(b,c,d),j=Math.min(b,c,d),k=e-j,m=e+j,g=0.5*m;return[Math.round(j===e?0:b===e?60*(c-d)/k+360:c===e?60*(d-b)/k+120:60*(b-c)/k+240)%360,0===
g||1===g?g:0.5>=g?k/m:k/(2-m),g,null==a?1:a]};n.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],a=a[3],c=0.5>=d?d*(1+c):d+c-d*c,d=2*d-c;return[Math.round(255*j(d,c,b+1/3)),Math.round(255*j(d,c,b)),Math.round(255*j(d,c,b-1/3)),a]};u(n,function(d,j){var k=j.props,f=j.cache,n=j.to,l=j.from;g.fn[d]=function(d){n&&!this[f]&&(this[f]=n(this._rgba));if(d===b)return this[f].slice();var j,m=a.type(d),o="array"===m||"object"===m?d:arguments,
q=this[f].slice();u(k,function(a,b){var c=o["object"===m?a:b.idx];null==c&&(c=q[b.idx]);q[b.idx]=e(c,b)});return l?(j=g(l(q)),j[f]=q,j):g(q)};u(k,function(b,e){g.fn[b]||(g.fn[b]=function(j){var k=a.type(j),g="alpha"===b?this._hsla?"hsla":"rgba":d,f=this[g](),n=f[e.idx];if("undefined"===k)return n;"function"===k&&(j=j.call(this,n),k=a.type(j));if(null==j&&e.empty)return this;"string"===k&&(k=m.exec(j))&&(j=n+parseFloat(k[2])*("+"===k[1]?1:-1));f[e.idx]=j;return this[g](f)})})});u("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),
function(b,d){a.cssHooks[d]={set:function(b,e){var j,m="";if(a.type(e)!=="string"||(j=k(e))){e=g(j||e);if(!o.rgba&&e._rgba[3]!==1){for(j=d==="backgroundColor"?b.parentNode:b;(m===""||m==="transparent")&&j&&j.style;)try{m=a.css(j,"backgroundColor");j=j.parentNode}catch(f){}e=e.blend(m&&m!=="transparent"?m:"_default")}e=e.toRgbaString()}try{b.style[d]=e}catch(n){}}};a.fx.step[d]=function(b){if(!b.colorInit){b.start=g(b.elem,d);b.end=g(b.end);b.colorInit=true}a.cssHooks[d].set(b.elem,b.start.transition(b.end,
b.pos))}});a.cssHooks.borderColor={expand:function(a){var b={};u(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a});return b}};r=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(l);(function(){function c(){var a=
this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]])for(d=a.length;d--;)c=a[d],"string"===typeof a[c]&&(b[f.camelCase(c)]=a[c]);else for(c in a)"string"===typeof a[c]&&(b[c]=a[c]);return b}var b=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],
function(a,b){f.fx.step[b]=function(a){if("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)l.style(a.elem,b,a.end),a.setAttr=!0}});f.effects.animateClass=function(a,j,m,d){var g=f.speed(j,m,d);return this.queue(function(){var d=f(this),j=d.attr("class")||"",m,q=g.children?d.find("*").andSelf():d,q=q.map(function(){return{el:f(this),start:c.call(this)}});m=function(){f.each(b,function(b,c){if(a[c])d[c+"Class"](a[c])})};m();q=q.map(function(){this.end=c.call(this.el[0]);var a=this.start,b=this.end,
d={},j,k;for(j in b)if(k=b[j],a[j]!==k&&!e[j]&&(f.fx.step[j]||!isNaN(parseFloat(k))))d[j]=k;this.diff=d;return this});d.attr("class",j);q=q.map(function(){var a=this,b=f.Deferred();this.el.animate(this.diff,l.extend({},g,{queue:!1,complete:function(){b.resolve(a)}}));return b.promise()});f.when.apply(f,q.get()).done(function(){m();f.each(arguments,function(){var a=this.el;f.each(this.diff,function(b){a.css(b,"")})});g.complete.call(d[0])})})};f.fn.extend({_addClass:f.fn.addClass,addClass:function(a,
b,c,d){return b?f.effects.animateClass.call(this,{add:a},b,c,d):this._addClass(a)},_removeClass:f.fn.removeClass,removeClass:function(a,b,c,d){return b?f.effects.animateClass.call(this,{remove:a},b,c,d):this._removeClass(a)},_toggleClass:f.fn.toggleClass,toggleClass:function(b,c,e,d,g){return"boolean"===typeof c||c===a?e?f.effects.animateClass.call(this,c?{add:b}:{remove:b},e,d,g):this._toggleClass(b,c):f.effects.animateClass.call(this,{toggle:b},c,e,d)},switchClass:function(a,b,c,d,e){return f.effects.animateClass.call(this,
{add:b,remove:a},c,d,e)}})})();(function(){function c(b,c,j,m){f.isPlainObject(b)&&(c=b,b=b.effect);b={effect:b};c===a&&(c={});f.isFunction(c)&&(m=c,j=null,c={});if("number"===typeof c||f.fx.speeds[c])m=j,j=c,c={};f.isFunction(j)&&(m=j,j=null);c&&f.extend(b,c);j=j||c.duration;b.duration=f.fx.off?0:"number"===typeof j?j:j in f.fx.speeds?f.fx.speeds[j]:f.fx.speeds._default;b.complete=m||c.complete;return b}function b(a){return!a||"number"===typeof a||f.fx.speeds[a]?!0:"string"===typeof a&&!f.effects.effect[a]?
g&&f.effects[a]?!1:!0:!1}f.extend(f.effects,{version:"1.9.0",save:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.data("ui-effects-"+b[c],a[0].style[b[c]])},restore:function(b,c){var j,m;for(m=0;m<c.length;m++)null!==c[m]&&(j=b.data("ui-effects-"+c[m]),j===a&&(j=""),b.css(c[m],j))},setMode:function(a,b){"toggle"===b&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var c,m;switch(a[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=1;break;default:c=a[0]/
b.height}switch(a[1]){case "left":m=0;break;case "center":m=0.5;break;case "right":m=1;break;default:m=a[1]/b.width}return{x:m,y:c}},createWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent();var b={width:a.outerWidth(!0),height:a.outerHeight(!0),"float":a.css("float")},c=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),m={width:a.width(),height:a.height()},d=document.activeElement;try{d.id}catch(g){d=
document.body}a.wrap(c);(a[0]===d||f.contains(a[0],d))&&f(d).focus();c=a.parent();"static"===a.css("position")?(c.css({position:"relative"}),a.css({position:"relative"})):(f.extend(b,{position:a.css("position"),zIndex:a.css("z-index")}),f.each(["top","left","bottom","right"],function(c,d){b[d]=a.css(d);isNaN(parseInt(b[d],10))&&(b[d]="auto")}),a.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));a.css(m);return c.css(b).show()},removeWrapper:function(a){var b=document.activeElement;
a.parent().is(".ui-effects-wrapper")&&(a.parent().replaceWith(a),(a[0]===b||f.contains(a[0],b))&&f(b).focus());return a},setTransition:function(a,b,c,m){m=m||{};f.each(b,function(b,k){var g=a.cssUnit(k);0<g[0]&&(m[k]=g[0]*c+g[1])});return m}});f.fn.extend({effect:function(a,b,j,m){function d(a){function b(){f.isFunction(d)&&d.call(c[0]);f.isFunction(a)&&a()}var c=f(this),d=p.complete,e=p.mode;(c.is(":hidden")?"hide"===e:"show"===e)?b():o.call(c[0],p,b)}var p=c.apply(this,arguments),n=p.mode,l=p.queue,
o=f.effects.effect[p.effect],q=!o&&g&&f.effects[p.effect];return f.fx.off||!o&&!q?n?this[n](p.duration,p.complete):this.each(function(){p.complete&&p.complete.call(this)}):o?!1===l?this.each(d):this.queue(l||"fx",d):q.call(this,{options:p,duration:p.duration,callback:p.complete,mode:p.mode})},_show:f.fn.show,show:function(a){if(b(a))return this._show.apply(this,arguments);var k=c.apply(this,arguments);k.mode="show";return this.effect.call(this,k)},_hide:f.fn.hide,hide:function(a){if(b(a))return this._hide.apply(this,
arguments);var k=c.apply(this,arguments);k.mode="hide";return this.effect.call(this,k)},__toggle:f.fn.toggle,toggle:function(a){if(b(a)||"boolean"===typeof a||f.isFunction(a))return this.__toggle.apply(this,arguments);var k=c.apply(this,arguments);k.mode="toggle";return this.effect.call(this,k)},cssUnit:function(a){var b=this.css(a),c=[];f.each(["em","px","%","pt"],function(a,d){0<b.indexOf(d)&&(c=[parseFloat(b),d])});return c}})})();(function(){var a={};f.each(["Quad","Cubic","Quart","Quint","Expo"],
function(b,e){a[e]=function(a){return Math.pow(a,b+2)}});f.extend(a,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var c,k=4;a<((c=Math.pow(2,--k))-1)/11;);return 1/Math.pow(4,3-k)-7.5625*Math.pow((3*c-2)/22-a,2)}});f.each(a,function(a,c){f.easing["easeIn"+a]=c;f.easing["easeOut"+a]=function(a){return 1-
c(1-a)};f.easing["easeInOut"+a]=function(a){return 0.5>a?c(2*a)/2:1-c(-2*a+2)/2}})})()}(l);(function(f){var a=/up|down|vertical/,g=/up|left|vertical|horizontal/;f.effects.effect.blind=function(c,b){var e=f(this),k="position top bottom left right height width".split(" "),j=f.effects.setMode(e,c.mode||"hide"),m=c.direction||"up",d=a.test(m),p=d?"height":"width",n=d?"top":"left",m=g.test(m),l={},o="show"===j,q,r,u;e.parent().is(".ui-effects-wrapper")?f.effects.save(e.parent(),k):f.effects.save(e,k);
e.show();q=f.effects.createWrapper(e).css({overflow:"hidden"});r=q[p]();u=parseFloat(q.css(n))||0;l[p]=o?r:0;m||(e.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),l[n]=o?u:r+u);o&&(q.css(p,0),m||q.css(n,u+r));q.animate(l,{duration:c.duration,easing:c.easing,queue:!1,complete:function(){j==="hide"&&e.hide();f.effects.restore(e,k);f.effects.removeWrapper(e);b()}})}})(l);(function(f){f.effects.effect.bounce=function(a,g){var c=f(this),b="position top bottom left right height width".split(" "),
e=f.effects.setMode(c,a.mode||"effect"),k="hide"===e,j="show"===e,m=a.direction||"up",e=a.distance,d=a.times||5,p=2*d+(j||k?1:0),n=a.duration/p,l=a.easing,o="up"===m||"down"===m?"top":"left",m="up"===m||"left"===m,q,r,u=c.queue(),x=u.length;(j||k)&&b.push("opacity");f.effects.save(c,b);c.show();f.effects.createWrapper(c);e||(e=c["top"===o?"outerHeight":"outerWidth"]()/3);j&&(r={opacity:1},r[o]=0,c.css("opacity",0).css(o,m?2*-e:2*e).animate(r,n,l));k&&(e/=Math.pow(2,d-1));r={};for(j=r[o]=0;j<d;j++)q=
{},q[o]=(m?"-=":"+=")+e,c.animate(q,n,l).animate(r,n,l),e=k?2*e:e/2;k&&(q={opacity:0},q[o]=(m?"-=":"+=")+e,c.animate(q,n,l));c.queue(function(){k&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);g()});1<x&&u.splice.apply(u,[1,0].concat(u.splice(x,p+1)));c.dequeue()}})(l);(function(f){f.effects.effect.clip=function(a,g){var c=f(this),b="position top bottom left right height width".split(" "),e="show"===f.effects.setMode(c,a.mode||"hide"),k="vertical"===(a.direction||"vertical"),j=k?"height":
"width",k=k?"top":"left",m={},d,p;f.effects.save(c,b);c.show();d=f.effects.createWrapper(c).css({overflow:"hidden"});d="IMG"===c[0].tagName?d:c;p=d[j]();e&&(d.css(j,0),d.css(k,p/2));m[j]=e?p:0;m[k]=e?0:p/2;d.animate(m,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){e||c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);g()}})}})(l);(function(f){f.effects.effect.drop=function(a,g){var c=f(this),b="position top bottom left right opacity height width".split(" "),e=f.effects.setMode(c,
a.mode||"hide"),k="show"===e,j=a.direction||"left",m="up"===j||"down"===j?"top":"left",j="up"===j||"left"===j?"pos":"neg",d={opacity:k?1:0},p;f.effects.save(c,b);c.show();f.effects.createWrapper(c);p=a.distance||c["top"===m?"outerHeight":"outerWidth"](!0)/2;k&&c.css("opacity",0).css(m,"pos"===j?-p:p);d[m]=(k?"pos"===j?"+=":"-=":"pos"===j?"-=":"+=")+p;c.animate(d,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){"hide"===e&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);
g()}})}})(l);(function(f){f.effects.effect.explode=function(a,g){function c(){n.push(this);n.length===b*e&&(k.css({visibility:"visible"}),f(n).remove(),j||k.hide(),g())}var b=a.pieces?Math.round(Math.sqrt(a.pieces)):3,e=b,k=f(this),j="show"===f.effects.setMode(k,a.mode||"hide"),m=k.show().css("visibility","hidden").offset(),d=Math.ceil(k.outerWidth()/e),p=Math.ceil(k.outerHeight()/b),n=[],l,o,q,r,u,x;for(l=0;l<b;l++){r=m.top+l*p;x=l-(b-1)/2;for(o=0;o<e;o++)q=m.left+o*d,u=o-(e-1)/2,k.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",
visibility:"visible",left:-o*d,top:-l*p}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:d,height:p,left:q+(j?u*d:0),top:r+(j?x*p:0),opacity:j?0:1}).animate({left:q+(j?0:u*d),top:r+(j?0:x*p),opacity:j?1:0},a.duration||500,a.easing,c)}}})(l);(function(f){f.effects.effect.fade=function(a,g){var c=f(this),b=f.effects.setMode(c,a.mode||"toggle");c.animate({opacity:b},{queue:!1,duration:a.duration,easing:a.easing,complete:g})}})(l);(function(f){f.effects.effect.fold=
function(a,g){var c=f(this),b="position top bottom left right height width".split(" "),e=f.effects.setMode(c,a.mode||"hide"),k="show"===e,j="hide"===e,e=a.size||15,m=/([0-9]+)%/.exec(e),d=!!a.horizFirst,p=k!==d,n=p?["width","height"]:["height","width"],l=a.duration/2,o,q={},r={};f.effects.save(c,b);c.show();o=f.effects.createWrapper(c).css({overflow:"hidden"});p=p?[o.width(),o.height()]:[o.height(),o.width()];m&&(e=parseInt(m[1],10)/100*p[j?0:1]);k&&o.css(d?{height:0,width:e}:{height:e,width:0});
q[n[0]]=k?p[0]:e;r[n[1]]=k?p[1]:0;o.animate(q,l,a.easing).animate(r,l,a.easing,function(){j&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);g()})}})(l);(function(f){f.effects.effect.highlight=function(a,g){var c=f(this),b=["backgroundImage","backgroundColor","opacity"],e=f.effects.setMode(c,a.mode||"show"),k={backgroundColor:c.css("backgroundColor")};"hide"===e&&(k.opacity=0);f.effects.save(c,b);c.show().css({backgroundImage:"none",backgroundColor:a.color||"#ffff99"}).animate(k,{queue:!1,
duration:a.duration,easing:a.easing,complete:function(){e==="hide"&&c.hide();f.effects.restore(c,b);g()}})}})(l);(function(f){f.effects.effect.pulsate=function(a,g){var c=f(this),b=f.effects.setMode(c,a.mode||"show"),e="show"===b,k="hide"===b,b=2*(a.times||5)+(e||"hide"===b?1:0),j=a.duration/b,m=0,d=c.queue(),p=d.length;if(e||!c.is(":visible"))c.css("opacity",0).show(),m=1;for(e=1;e<b;e++)c.animate({opacity:m},j,a.easing),m=1-m;c.animate({opacity:m},j,a.easing);c.queue(function(){k&&c.hide();g()});
1<p&&d.splice.apply(d,[1,0].concat(d.splice(p,b+1)));c.dequeue()}})(l);(function(f){f.effects.effect.puff=function(a,g){var c=f(this),b=f.effects.setMode(c,a.mode||"hide"),e="hide"===b,k=parseInt(a.percent,10)||150,j=k/100,m={height:c.height(),width:c.width()};f.extend(a,{effect:"scale",queue:!1,fade:!0,mode:b,complete:g,percent:e?k:100,from:e?m:{height:m.height*j,width:m.width*j}});c.effect(a)};f.effects.effect.scale=function(a,g){var c=f(this),b=f.extend(!0,{},a),e=f.effects.setMode(c,a.mode||"effect"),
k=parseInt(a.percent,10)||(0===parseInt(a.percent,10)?0:"hide"===e?0:100),j=a.direction||"both",m=a.origin,d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()},p="horizontal"!==j?k/100:1,k="vertical"!==j?k/100:1;b.effect="size";b.queue=!1;b.complete=g;"effect"!==e&&(b.origin=m||["middle","center"],b.restore=!0);b.from=a.from||("show"===e?{height:0,width:0}:d);b.to={height:d.height*p,width:d.width*k,outerHeight:d.outerHeight*p,outerWidth:d.outerWidth*k};if(b.fade&&
("show"===e&&(b.from.opacity=0,b.to.opacity=1),"hide"===e))b.from.opacity=1,b.to.opacity=0;c.effect(b)};f.effects.effect.size=function(a,g){var c,b,e,k,j=f(this),m="position top bottom left right width height overflow opacity".split(" "),d="position top bottom left right overflow opacity".split(" "),p=["width","height","overflow"],n=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],o=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],q=f.effects.setMode(j,
a.mode||"effect"),r=a.restore||"effect"!==q,u=a.scale||"both",x=a.origin||["middle","center"],t,v=j.css("position");"show"===q&&j.show();t={height:j.height(),width:j.width(),outerHeight:j.outerHeight(),outerWidth:j.outerWidth()};j.from=a.from||t;j.to=a.to||t;e=j.from.height/t.height;k=j.from.width/t.width;c=j.to.height/t.height;b=j.to.width/t.width;if("box"===u||"both"===u)if(e!==c&&(m=m.concat(l),j.from=f.effects.setTransition(j,l,e,j.from),j.to=f.effects.setTransition(j,l,c,j.to)),k!==b)m=m.concat(o),
j.from=f.effects.setTransition(j,o,k,j.from),j.to=f.effects.setTransition(j,o,b,j.to);if(("content"===u||"both"===u)&&e!==c)m=m.concat(n),j.from=f.effects.setTransition(j,n,e,j.from),j.to=f.effects.setTransition(j,n,c,j.to);f.effects.save(j,r?m:d);j.show();f.effects.createWrapper(j);j.css("overflow","hidden").css(j.from);x&&(x=f.effects.getBaseline(x,t),j.from.top=(t.outerHeight-j.outerHeight())*x.y,j.from.left=(t.outerWidth-j.outerWidth())*x.x,j.to.top=(t.outerHeight-j.to.outerHeight)*x.y,j.to.left=
(t.outerWidth-j.to.outerWidth)*x.x);j.css(j.from);if("content"===u||"both"===u)l=l.concat(["marginTop","marginBottom"]).concat(n),o=o.concat(["marginLeft","marginRight"]),p=m.concat(l).concat(o),j.find("*[width]").each(function(){var d=f(this),j=d.height(),m=d.width();r&&f.effects.save(d,p);d.from={height:j*e,width:m*k};d.to={height:j*c,width:m*b};if(e!==c){d.from=f.effects.setTransition(d,l,e,d.from);d.to=f.effects.setTransition(d,l,c,d.to)}if(k!==b){d.from=f.effects.setTransition(d,o,k,d.from);
d.to=f.effects.setTransition(d,o,b,d.to)}d.css(d.from);d.animate(d.to,a.duration,a.easing,function(){r&&f.effects.restore(d,p)})});j.animate(j.to,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){j.to.opacity===0&&j.css("opacity",j.from.opacity);q==="hide"&&j.hide();f.effects.restore(j,r?m:d);r||(v==="static"?j.css({position:"relative",top:j.to.top,left:j.to.left}):f.each(["top","left"],function(a,b){j.css(b,function(b,c){var d=parseInt(c,10),e=a?j.to.left:j.to.top;return c==="auto"?
e+"px":d+e+"px"})}));f.effects.removeWrapper(j);g()}})}})(l);(function(f){f.effects.effect.shake=function(a,g){var c=f(this),b="position top bottom left right height width".split(" "),e=f.effects.setMode(c,a.mode||"effect"),k=a.direction||"left",j=a.distance||20,m=a.times||3,d=2*m+1,p=Math.round(a.duration/d),n="up"===k||"down"===k?"top":"left",l="up"===k||"left"===k,k={},o={},q={},r=c.queue(),u=r.length;f.effects.save(c,b);c.show();f.effects.createWrapper(c);k[n]=(l?"-=":"+=")+j;o[n]=(l?"+=":"-=")+
2*j;q[n]=(l?"-=":"+=")+2*j;c.animate(k,p,a.easing);for(j=1;j<m;j++)c.animate(o,p,a.easing).animate(q,p,a.easing);c.animate(o,p,a.easing).animate(k,p/2,a.easing).queue(function(){"hide"===e&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);g()});1<u&&r.splice.apply(r,[1,0].concat(r.splice(u,d+1)));c.dequeue()}})(l);(function(f){f.effects.effect.slide=function(a,g){var c=f(this),b="position top bottom left right width height".split(" "),e=f.effects.setMode(c,a.mode||"show"),k="show"===e,j=
a.direction||"left",m="up"===j||"down"===j?"top":"left",j="up"===j||"left"===j,d,p={};f.effects.save(c,b);c.show();d=a.distance||c["top"===m?"outerHeight":"outerWidth"](!0);f.effects.createWrapper(c).css({overflow:"hidden"});k&&c.css(m,j?isNaN(d)?"-"+d:-d:d);p[m]=(k?j?"+=":"-=":j?"-=":"+=")+d;c.animate(p,{queue:!1,duration:a.duration,easing:a.easing,complete:function(){"hide"===e&&c.hide();f.effects.restore(c,b);f.effects.removeWrapper(c);g()}})}})(l);(function(f){f.effects.effect.transfer=function(a,
g){var c=f(this),b=f(a.to),e="fixed"===b.css("position"),k=f("body"),j=e?k.scrollTop():0,k=e?k.scrollLeft():0,m=b.offset(),b={top:m.top-j,left:m.left-k,height:b.innerHeight(),width:b.innerWidth()},m=c.offset(),d=f('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.className).css({top:m.top-j,left:m.left-k,height:c.innerHeight(),width:c.innerWidth(),position:e?"fixed":"absolute"}).animate(b,a.duration,a.easing,function(){d.remove();g()})}})(l)});define("ui/tab","aloha/core jquery ui/container ui/component PubSub jqueryui".split(" "),
function(l,f,a,g,c){var b=0,e={},l=a.extend({_elemBySlot:null,_groupBySlot:null,_groupByComponent:null,_constructor:function(a,c,e){var d,g,n,l,o;this._elemBySlot={};this._groupBySlot={};this._groupByComponent={};this._slotsList=[];this._super(a,c);this.container=c.container;this.list=this.container.data("list");this.panels=this.container.data("panels");this.id="tab-ui-container-"+ ++b;this.panel=f("<div>",{id:this.id,unselectable:"on"});this.handle=f('<li><a href="'+location.href.replace(/#.*$/,
"")+"#"+this.id+'">'+c.label+"</a></li>");for(a=0;a<e.length;a++)if(typeof e[a]==="string")if(1===e[a].length&&e[a].charCodeAt(0)===10)this.panel.append("<div>",{unselectable:"on"});else{g=f("<span>",{unselectable:"on"});this._elemBySlot[e[a]]=g;this.panel.append(g)}else{l=f("<div>",{"class":"aloha-ui-component-group aloha-ui-hidden",unselectable:"on"}).appendTo(this.panel);o={element:l,visibleCounter:0};n=e[a];for(d=0;d<n.length;d++){this._groupBySlot[n[d]]=o;if(n[d]&&1===n[d].length&&n[d].charCodeAt(0)===
10)l.append(f("<div>",{unselectable:"on"}));else{g=f("<span>",{unselectable:"on"});this._elemBySlot[n[d]]=g;l.append(g)}}}this.panel.append(f("<div>",{"class":"aloha-ui-clear",unselectable:"on"}));this.handle.appendTo(this.list);this.panel.appendTo(this.panels);this.container.tabs("refresh");c=c.container.data("aloha-tabs");this.index=c.length;c.push(this)},adoptInto:function(a,b){var c=this._elemBySlot[a];if(!c)return false;e[a]=b;b.adoptParent(this);c.append(b.element);c=this._groupBySlot[a];this._slotsList.push(a);
if(c){this._groupByComponent[b.id]=c;if(b.isVisible()){c.visibleCounter||c.element.removeClass("aloha-ui-hidden");c.visibleCounter=c.visibleCounter+1}}return true},foreground:function(){this.container.tabs("select",this.index)},childForeground:function(){this.foreground()},hasVisibleComponents:function(){var a=this._elemBySlot,b;for(b in a)if(a.hasOwnProperty(b)&&e[b]&&e[b].visible)return true;return false},childVisible:function(a,b){b?a.container.show():a.container.hasVisibleComponents()||a.container.hide();
var c=this._groupByComponent[a.id];if(c)if(b){0===c.visibleCounter&&c.element.removeClass("aloha-ui-hidden");c.visibleCounter=c.visibleCounter+1}else{c.visibleCounter=c.visibleCounter-1;0===c.visibleCounter&&c.element.addClass("aloha-ui-hidden")}},show:function(){var a;if(!(a=!this.list.children().length)){a=false;f("button:not(.aloha-multisplit-toggle)",this.panel).length!==0&&(a=true);a=!a}if(!a){this.handle.show();this.visible=true;this.container.show();(!this.container.find(".ui-tabs-active").length||
this.container.tabs("option","selected")===this.index)&&this.foreground()}},hide:function(){var a=this.list.children();if(0!==a.length){this.handle.hide();this.visible=false;if(this.index===this.container.tabs("option","selected")){var a=this.container.data("aloha-tabs"),b;for(b=0;b<a.length;++b)if(a[b].visible){this.container.tabs("select",b);return}this.handle.removeClass("ui-tabs-active");this.container.hide()}}}});f.extend(l,{createContainer:function(){var a=f("<div>",{unselectable:"on"}),b=f("<ul>",
{unselectable:"on"}).appendTo(a),e=f("<div>",{unselectable:"on"}).appendTo(a);a.data("list",b).data("panels",e).data("aloha-tabs",[]).tabs({select:function(b,e){var j=a.data("aloha-tabs");a.data("aloha-active-container",j[e.index]);c.pub("aloha.ui.container.selected",{data:j[e.index]})}});return a}});return l});define("ui/subguarded",["aloha/core","jquery","PubSub"],function(l,f,a){function g(a){a.alohaUid||(a.alohaUid=++k);return a.alohaUid}function c(a,b){j[a.alohaUid]||(j[a.alohaUid]=[]);j[a.alohaUid].push(b);
return j[a.alohaUid]}function b(a,b){m[a]||(m[a]=[]);m[a].push(b);return m[a]}function e(a){var b=m[a]||[],c;for(c=0;c<b.length;c++)b[c].apply(null,[j[b[c].alohaUid]||[]].concat(arguments))}var k=0,j={},m={};return function(){var d=Array.prototype.slice.call(arguments),j=d.shift();"string"===typeof j&&(j=[j]);var m=d.shift();g(m);c(m,d);for(var k,f=function(a,b,c){e(k,a,b,c)},q=function(){e(k)},d=0;d<j.length;d++)k=j[d],b(k,m),l.bind(k,f),a.sub(k,q)}});define("vendor/amplify.store",["util/json2"],
function(){var l={};(function(f,a){function g(e,d){c.addType(e,function(j,g,k){var f,l=g,r=(new Date).getTime();if(!j){l={};k=[];g=0;try{for(j=d.length;j=d.key(g++);)b.test(j)&&(f=ja.parse(d.getItem(j)),f.expires&&f.expires<=r?k.push(j):l[j.replace(b,"")]=f.data);for(;j=k.pop();)d.removeItem(j)}catch(u){}return l}j="__amplify__"+j;if(g===a)if(f=(f=d.getItem(j))?ja.parse(f):{expires:-1},f.expires&&f.expires<=r)d.removeItem(j);else return f.data;else if(null===g)d.removeItem(j);else{f=ja.stringify({data:g,
expires:k.expires?r+k.expires:null});try{d.setItem(j,f)}catch(x){c[e]();try{d.setItem(j,f)}catch(t){throw c.error();}}}return l})}var c=f.store=function(a,b,e,j){j=c.type;e&&(e.type&&e.type in c.types)&&(j=e.type);return c.types[j](a,b,e||{})};c.types={};c.type=null;c.addType=function(a,b){c.type||(c.type=a);c.types[a]=b;c[a]=function(b,d,e){e=e||{};e.type=a;return c(b,d,e)}};c.error=function(){return"amplify.store quota exceeded"};var b=/^__amplify__/,e;for(e in{localStorage:1,sessionStorage:1})try{window[e].getItem&&
g(e,window[e])}catch(k){}if(window.globalStorage)try{g("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===c.type&&(c.type="globalStorage")}catch(j){}(function(){if(!c.types.localStorage){var b=document.createElement("div");b.style.display="none";document.getElementsByTagName("head")[0].appendChild(b);try{b.addBehavior("#default#userdata"),b.load("amplify")}catch(d){b.parentNode.removeChild(b);return}c.addType("userData",function(d,e,j){b.load("amplify");var g,k,f=e,
l=(new Date).getTime();if(!d){f={};k=[];for(d=0;e=b.XMLDocument.documentElement.attributes[d++];)g=ja.parse(e.value),g.expires&&g.expires<=l?k.push(e.name):f[e.name]=g.data;for(;d=k.pop();)b.removeAttribute(d);b.save("amplify");return f}d=d.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(e===a)if(g=(e=b.getAttribute(d))?ja.parse(e):{expires:-1},g.expires&&g.expires<=l)b.removeAttribute(d);else return g.data;else null===e?b.removeAttribute(d):
(k=b.getAttribute(d),g=ja.stringify({data:e,expires:j.expires?l+j.expires:null}),b.setAttribute(d,g));try{b.save("amplify")}catch(x){null===k?b.removeAttribute(d):b.setAttribute(d,k);c.userData();try{b.setAttribute(d,g),b.save("amplify")}catch(t){throw null===k?b.removeAttribute(d):b.setAttribute(d,k),c.error();}}return f})}})();(function(){var b={},d={};c.addType("memory",function(c,e,j){if(!c)return b===a?a:ja.parse(ja.stringify(b));if(e===a)return b[c]===a?a:ja.parse(ja.stringify(b[c]));d[c]&&
(clearTimeout(d[c]),delete d[c]);if(null===e)return delete b[c],null;b[c]=e;j.expires&&(d[c]=setTimeout(function(){delete b[c];delete d[c]},j.expires));return e})})()})(l);return l});define("ui/floating","jquery aloha/core ui/surface ui/subguarded PubSub vendor/amplify.store util/browser".split(" "),function(l,f,a,g,c,b,e){function k(a,b,d,e){if("absolute"===n){b.top=b.top+p.scrollTop();b.left=b.left+p.scrollLeft()}s.offset=b;a.stop().animate(b,d,function(){e(b);c.pub("aloha.floating.changed",{position:l.extend({},
s)})})}function j(a){b.store("Aloha.FloatingMenu.pinned","true");b.store("Aloha.FloatingMenu.top",a.top);b.store("Aloha.FloatingMenu.left",a.left)}function m(a,b,c,d,e){for(b=0;b<a.length;b++)if(a[b][0].isActive())a[b][1](c,d,e)}function d(a){if(l.browser.msie){var b=a.$element.parent();a.$element.appendTo("body");a.$element.css("position",n);b.length?a.$element.appendTo(b):a.$element.detach()}else a.$element.css("position",n)}var p=l(window),n=e.ie7?"absolute":"fixed",s={style:n,offset:{top:0,left:0}};
return{getPinState:function(){return b.store("Aloha.FloatingMenu.pinned")==="true"?{top:parseInt(b.store("Aloha.FloatingMenu.top"),10),left:parseInt(b.store("Aloha.FloatingMenu.left"),10),isPinned:true}:{top:null,left:null,isPinned:false}},makeFloating:function(a,b){g(["aloha-selection-changed","aloha.ui.container.selected"],m,a,function(){a._move()});var c=function(){var c;c=b.pinLeft;var d=b.pinTop;d<0?d=0:d>p.height()&&(d=p.height()/2);c<0?c=0:c>p.width()&&(c=p.width()/2);c={top:d,left:c};b.setFloatingPosition(c);
a.$element.css({top:c.top,left:c.left})};p.scroll(function(){a._move(0)});p.resize(function(){b.isFloatingMode||c()});a.addPin();d(a);b.isFloatingMode||c();a.$element.css("z-index",10100).draggable({distance:20,stop:function(a,c){b.setFloatingPosition(c.position);b.isFloatingMode||j(c.position)}})},floatSurface:function(a,b,c,d){typeof c!=="number"&&(c=500);var e=(parseInt(l("body").css("marginTop"),10)||0)+(parseInt(l("body").css("paddingTop"),10)||0),a=a.$element,j=b.obj.offset(),g=j.top,j=j.left,
m=p.scrollTop(),f=g-m-e,n=j+a.width()-p.width();n>0&&(j=Math.max(0,j-n));if(f>=a.height()){b={top:g-m,left:j};b.top=b.top-(a.height()+10)}else{b=f+a.height()>f+b.obj.height()?{top:g+b.obj.height(),left:j}:{top:e,left:j};b.top=b.top+10}k(a,b,c,d)},togglePinSurface:function(a,c,d){a=a.$element;if(d){b.store("Aloha.FloatingMenu.pinned",null);b.store("Aloha.FloatingMenu.top",null);b.store("Aloha.FloatingMenu.left",null);a.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")}else{j(c);a.find(".aloha-ui-pin").addClass("aloha-ui-pin-down")}a.css({position:"fixed",
top:c.top})},POSITION_STYLE:n}});(function(){function l(a,b,e,g,j,m){b[a]&&(e.push(a),(!0===b[a]||1===b[a])&&g.push(j+a+"/"+m))}function f(a,b,e,g,j){b=g+b+"/"+j;require._fileExists(a.toUrl(b))&&e.push(b)}function a(c,b,e){for(var g in b)b.hasOwnProperty(g)&&(!c.hasOwnProperty(g)||e)?c[g]=b[g]:"object"===typeof b[g]&&a(c[g],b[g],e)}var g=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(c){var b=c.config();return{version:"2.0.1",load:function(c,k,j,m){m=m||{};m.locale&&(b.locale=
m.locale);var d=g.exec(c),p=d[1],n=d[4],s=d[5],o=n.split("-"),q=[],r={},u,x="";d[5]?(p=d[1],c=p+s):(s=d[4],n=b.locale,n||(n=b.locale="undefined"===typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),o=n.split("-"));if(m.isBuild){q.push(c);f(k,"root",q,p,s);for(u=0;u<o.length;u++)m=o[u],x+=(x?"-":"")+m,f(k,x,q,p,s);k(q,function(){j()})}else k([c],function(b){var c=[],d;l("root",b,c,q,p,s);for(u=0;u<o.length;u++){d=o[u];x=x+((x?"-":"")+d);l(x,b,c,q,p,s)}k(q,function(){var d,
e,g;for(d=c.length-1;d>-1&&c[d];d--){g=c[d];e=b[g];if(e===true||e===1)e=k(p+g+"/"+s);a(r,e)}r.t=function(a,b){return this[a]?this[a]:b?b:a};j(r)})})}}})})();define("ui/nls/i18n",{root:{"button.dismiss.label":"Dismiss","button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough","button.subscript.label":"Subscript","button.superscript.label":"Superscript","button.underline.label":"Underline","button.yes.label":"Yes","button.no.label":"No","button.p.label":"Paragraph",
"button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list","button.outdent.label":"Outdent list","button.createLink.label":"Insert link","button.removeLink.label":"Remove link",
"button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right","button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule",
"button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view","button.quote.label":"Format selection as quote","button.blockquote.label":"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link","tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.cell.label":"Table Cell",
"tab.wai-lang.label":"Language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("ui/toolbar","jquery aloha/core ui/surface ui/tab ui/floating ui/context i18n!ui/nls/i18n jqueryui".split(" "),function(l,f,a,g,c,b,e){var k=a.extend({_moveTimeout:null,$_container:null,_tabBySlot:null,_tabs:[],_constructor:function(a,b){var d,f,n,s;this._super(a);this.$element=l("<div>",{"class":"aloha-ui aloha-ui-toolbar",unselectable:"on"});this.$_container=g.createContainer().appendTo(this.$element);
this._tabBySlot={};for(n=0;n<b.length;n++){d=b[n];f=new g(a,{label:e.t(d.label,d.label),showOn:d.showOn,container:this.$_container},d.components);for(s in f._elemBySlot)f._elemBySlot.hasOwnProperty(s)&&(this._tabBySlot[s]=f);this._tabs.push({tab:f,settings:d})}c.makeFloating(this,k)},adoptInto:function(a,b){var c=this._tabBySlot[a];return c&&c.adoptInto(a,b)},getActiveContainer:function(){return this.$_container.data("aloha-active-container")},getContainers:function(){return this.$_container.data("aloha-tabs")},
_move:function(a){var b=this;b._moveTimeout&&clearTimeout(b._moveTimeout);b._moveTimeout=setTimeout(function(){b._moveTimeout=null;f.activeEditable&&k.isFloatingMode&&c.floatSurface(b,f.activeEditable,a,k.setFloatingPosition)},20)},addPin:function(){var a=l('<div class="aloha-ui-pin">'),b=this.$element;b.find(".ui-tabs").append(a);b.find(".ui-tabs").hover(function(){b.addClass("aloha-ui-hover")},function(){b.removeClass("aloha-ui-hover")});k.isFloatingMode||a.addClass("aloha-ui-pin-down");var d=this;
a.click(function(){k.isFloatingMode=!k.isFloatingMode;var a;if(k.isFloatingMode)a={top:k.pinTop,left:k.pinLeft};else{a=d.$element.offset();a.top=a.top-l(window).scrollTop()}k.setFloatingPosition(a);c.togglePinSurface(d,a,k.isFloatingMode)})},show:function(){k.$surfaceContainer.children().detach();k.$surfaceContainer.append(this.$element);k.$surfaceContainer.stop().fadeTo(200,1);var a=k.getFloatingPosition();this.$element.stop().css({top:a.top,left:a.left});this._move()},hide:function(){k.$surfaceContainer.stop().fadeOut(200,
function(){k.$surfaceContainer.children().detach()})}});l.extend(k,{$surfaceContainer:null,isFloatingMode:true,pinLeft:0,pinTop:0,init:function(){k.$surfaceContainer=l("<div>",{"class":"aloha aloha-surface aloha-toolbar",unselectable:"on"}).hide();l(function(){k.$surfaceContainer.appendTo("body")});a.trackRange(k.$surfaceContainer);var b=c.getPinState();k.pinTop=b.top;k.pinLeft=b.left;k.isFloatingMode=!b.isPinned},setFloatingPosition:function(a){k.pinTop=a.top;k.pinLeft=a.left},getFloatingPosition:function(){return{top:k.pinTop,
left:k.pinLeft}}});k.init();return k});define("ui/settings",["jquery","util/arrays","util/maps","util/trees"],function(l,f,a,g){function c(a,b,c){var d,e,f=[],s;for(d=0;d<a.length;d++)if(e=a[d],!b[e.label]&&(s=g.postprune(e.components,c)))e=l.extend({},e),e.components=s,f.push(e);return f}function b(a,b,c){var d,e,f=[],s,o,q;for(d=0;d<a.length;d++)e=a[d],s=e.components||[],o=b[e.label],!e.exclusive&&o&&(q=g.postprune(o.components,c))&&(s=s.concat(q)),e=l.extend({},o||{},e),e.components=s,f.push(e);
return f}function e(b,c){var e,d=a.fillKeys({},c,!0);for(e=0;e<b.length;e++)d[b[e].label]=!0,a.fillKeys(d,g.flatten(b[e].components),!0);return d}return{defaultToolbarSettings:{tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:["bold strong italic emphasis underline \n subscript superscript strikethrough quote".split(" "),"formatLink formatAbbr formatNumeratedHeaders toggleDragDrop \n toggleMetaView wailang toggleFormatlessPaste".split(" "),"alignLeft alignCenter alignRight alignJustify \n orderedList unorderedList indentList outdentList colorPicker".split(" "),
["formatBlock"]]},{label:"tab.insert.label",showOn:{scope:"Aloha.continuoustext"},components:["createTable characterPicker insertLink insertImage insertAbbr insertToc insertHorizontalRule insertTag".split(" ")]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],["imageResizeWidth","\n","imageResizeHeight"],"imageAlignLeft imageAlignRight imageAlignNone imageIncPadding \n imageCropButton imageCnrReset imageCnrRatio imageDecPadding".split(" "),
["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText","removeAbbr"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","tableSummary","naturalFit"],["formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:["addcolumnleft addcolumnright deletecolumns columnheader mergecellsColumn splitcellsColumn formatColumn".split(" ")]},
{label:"tab.row.label",showOn:{scope:"table.row"},components:["addrowbefore addrowafter deleterows rowheader mergecellsRow splitcellsRow formatRow".split(" ")]},{label:"tab.cell.label",showOn:{scope:"table.cell"},components:[["alignTop","alignMiddle","alignBottom","formatCell"]]}]},combineToolbarSettings:function(g,j,m){function d(a){return"array"===l.type(a)?!a.length:n[a]}var p=a.fillTuples({},f.map(j,function(a){return[a.label,a]})),n=e(g,m),g=b(g,p,d),j=c(j,n,d);return g.concat(j)}}});define("ui/ui-plugin",
"jquery aloha ui/context ui/container ui/surface ui/toolbar ui/scopes ui/settings PubSub jqueryui".split(" "),function(l,f,a,g,c,b,e,k,j){var m=new a,d=new b(m,function(){var a=f.settings.toolbar,b=k.defaultToolbarSettings;return!a?b.tabs:k.combineToolbarSettings(a.tabs||[],b.tabs,a.exclude||[])}());f.bind("aloha-editable-activated",function(a){c.show(m);g.showContainersForContext(m,a)});f.bind("aloha-editable-deactivated",function(){c.suppressHide||c.hide(m)});j.sub("aloha.ui.scope.change",function(){g.showContainersForContext(m);
e.getPrimaryScope();var a=d._tabs,b=e.getPrimaryScope(),c,j;for(j=0;j<a.length;j++){c=a[j].settings;if("object"===l.type(c.showOn)&&c.showOn.scope===b){a[j].tab.foreground();break}}});return{adoptInto:function(a,b){return d.adoptInto(a,b)},showToolbar:function(a){c.show(m);g.showContainersForContext(m,a)}}});define("ui/ui",["jquery","ui/ui-plugin"],function(l,f){var a={};return{adopt:function(g,c,b){"string"!==l.type(g)?(b=c,c=g,g=b.name):b=l.extend({name:g},b);c.isInstance||(c=b?c.extend(b):c,c=
new c);a[g]=c;f.adoptInto(g,c);return c},getAdoptedComponent:function(g){return a[g]||null}}});define("ui/utils",["jquery","jqueryui"],function(l){function f(a){return a.html||a.text||a.tooltip}function a(a){return'<img class="aloha-ui-inline-icon" src="'+a+'">'}return{wrapWithLabel:function(a,c){return l("<label>",{"class":"aloha-ui-label"}).append(l("<span>",{"class":"aloha-ui-label-text",text:a})).append(c)},makeButton:function(g,c,b){g.button({label:f(c),text:!(!c.text&&!c.html),icons:{primary:c.icon||
c.iconUrl&&"aloha-ui-inline-icon-container"||null,secondary:b&&"aloha-jqueryui-icon ui-icon-triangle-1-s"||null}});c.iconUrl&&g.button("widget").children(".ui-button-icon-primary").append(a(c.iconUrl));return g},makeButtonElement:function(a){return l("<button>",a).attr("type","button")},makeButtonLabel:f,makeButtonLabelWithIcon:function(g){var c=f(g);g.iconUrl&&(c=a(g.iconUrl)+c);return c},makeButtonIconFromUrl:a}});define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(l){(function(f){function a(a,
c){var g=RegExp(f.ui.autocomplete.escapeRegex(c),"i");return f.grep(a,function(a){return g.test(f("<div>").html(a.label||a.value||a).text())})}var g=f.ui.autocomplete.prototype,c=g._initSource;f.extend(g,{_initSource:function(){this.options.html&&f.isArray(this.options.source)?this.source=function(b,c){c(a(this.options.source,b.term))}:c.call(this)},_renderItem:function(a,c){return f("<li></li>").data("item.autocomplete",c).append(f("<a></a>")[this.options.html?"html":"text"](c.label)).appendTo(a)}})})(l)});
define("ui/port-helper-attribute-field","jquery ui/ui ui/component ui/scopes ui/context ui/utils aloha/repositorymanager aloha/selection aloha/console ui/vendor/jquery-ui-autocomplete-html".split(" "),function(l,f,a,g,c,b,e,k){return function(j){function g(a,b){b.item&&u(b.item.obj);p()}function d(){p()}function p(){n();if(D&&X!==l(D).attr(Y)){y||e.markObject(D);q()===""&&o()}}function n(){var a=l(D);A&&a.removeClass(A);if(!z){var b=a.attr("data-original-background-color");a.css("background-color",
b||"");a.attr("style")||a.removeAttr("style");a.removeAttr("data-original-background-color")}}function s(a,b){return a.replace(/\{([^}]+)\}/g,function(a,c){return c in b?b[c]:""})}function o(){if(null!==C){E.css("color","#AAA");E.val(C)}}function q(){return E.val()}function r(a){E.val(a);E.css("color","black")}function u(a){if(y=a){var b=a[v];r(b);S=b;x(Y,a[t]);e.markObject(D,a)}else S=null}function x(a,b,c,d){if(D){var e=true;typeof d!="undefined"&&(d.match(RegExp(c))||(e=false));e?l(D).attr(a,b):
l(D).removeAttr(a)}}var t=j.valueField||"id",v=j.displayField||"name",B=j.objectTypeFilter||["all"],C=j.placeholder,z=!!j.noTargetHighlight,A=j.targetHighlightClass,E=j.element?l(j.element):l('<input id="aloha-attribute-field-'+j.name+'">'),K,U,y,S,D,Y,X;j.cls&&E.addClass(j.cls);j.width&&E.width(j.width);K=f.adopt(j.name,a,{scope:j.scope,init:function(){if(j.element)this.element=E;else if(j.label){this.element=b.wrapWithLabel(j.label,E);j.labelClass&&this.element.addClass(j.labelClass)}else this.element=
l("<span>").append(E);E.autocomplete({html:true,appendTo:c.selector,source:function(a,b){e.query({queryString:a.term,objectTypeFilter:B},function(a){b(l.map(a.items,function(a){return{label:s(U,a),value:a.name,obj:a}}))})},select:g})}});E.bind("focus",function(a){if(l(a.target).is(":visible")){a=l(D);A&&a.addClass(A);if(!z){n();a.context&&(a.context.style&&a.context.style["background-color"])&&a.attr("data-original-background-color",a.context.style["background-color"]);a.css("background-color","#80B5F2")}q()===
C&&r("")}}).bind("blur",d).bind("keydown",function(a){(a.keyCode==13||a.keyCode==27)&&a.preventDefault()}).bind("keyup",function(a){if(y&&S!==q())S=y=null;y||x(Y,q());if(a.keyCode==13||a.keyCode==27){k.getRangeObject().select();p()}});o();Aloha.bind("aloha-editable-deactivated",d);var V={getInputElem:function(){return E[0]},hasInputElem:function(){return true},getInputId:function(){return E.attr("id")},hide:function(){E.hide()},show:function(){E.show()},foreground:function(){K.foreground()},focus:function(){K.focus();
E.focus()},getTargetObject:function(){return D},setTargetObject:function(a,b){D=a;Y=b;u(null);if(a&&b){X=l(a).attr(b);r(l(D).attr(Y));e.getObject(a,function(a){a&&a.length>0&&u(a[0])})}else r("")},setAttribute:x,getItem:function(){return y},setItem:u,setValue:r,getValue:q,addListener:function(a,b){E.bind(a,l.proxy(b,V))},setObjectTypeFilter:function(a){B=a},setTemplate:function(a){U=a},setPlaceholder:o};return V}});define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(l,f,a){return f.extend({init:function(){this._super();
this.createButtonElement();a.makeButton(this.buttonElement,this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).click(l.proxy(function(){this.buttonElement.tooltip("close",null,!0);this._onClick()},this))},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var g=a.makeButtonElement();this["class"]&&g.addClass(this["class"]);return this.element=this.buttonElement=g},disable:function(){this.element.button("option",
"disabled",!1)},enable:function(a){this.element.button("option","disabled",!1===a)}})});define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(l,f){return f.extend({_checked:!1,setState:function(a){this._checked!==a&&((this._checked=a)?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active"))},getState:function(){return this._checked},_onClick:function(){this.setState(!this._checked);this.click()}})});define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link",
"button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title",insertLink:"ctrl+k"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("aloha/nls/i18n",{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format",
"floatingmenu.tab.insert":"Insert",yes:"Yes",no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("util/keys",["jquery"],function(l){var f=function(){var a={};l.each({8:"backspace",9:"tab",13:"enter",16:"shift control alt",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",37:"left up right down",45:"insert",46:"delete",48:"0 1 2 3 4 5 6 7 8 9",
65:"a b c d e f g h i j k l m n o p q r s t u v w x y z",112:"f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 f11 f12 f13 f14 f15"},function(g,c){var b=parseInt(g,10);l.each(c.split(" "),function(c,g){a[b+c]=g})});return a}();return{getToken:function(a){return f[a]},keyCodeTokenMap:l.extend({},f)}});define("link/link-plugin","aloha aloha/plugin aloha/ephemera jquery ui/port-helper-attribute-field ui/ui ui/scopes ui/surface ui/button ui/toggleButton i18n!link/nls/i18n i18n!aloha/nls/i18n aloha/console PubSub util/keys".split(" "),
function(l,f,a,g,c,b,e,k,j,m,d,p,n,s,o){function q(){g(document).bind("keydown.aloha-link.pointer-fix",function(a){(a.metaKey||o.getToken(a.keyCode)==="control")&&g("body").addClass("aloha-link-pointer")}).bind("keyup.aloha-link.pointer-fix",function(a){(a.metaKey||o.getToken(a.keyCode)==="control")&&g("body").removeClass("aloha-link-pointer")})}function r(a){a.obj.delegate("a","click.aloha-link.meta-click-link",function(a){if(a.metaKey||a.ctrlKey){l.activeEditable.blur();window.setTimeout(function(){location.href=
a.target},0);a.stopPropagation();return false}})}function u(a,b){var c,d=false;if(!a.ignoreNextSelectionChangedEvent&&l.Selection.isSelectionEditable()&&l.activeEditable!=null)if(c=a.findLinkMarkup(b)){a.toggleLinkScope(true);a.hrefField.setTargetObject(c,"href");if(g("#"+a.hrefField.getInputId()).length==0){a.hrefUpdateInt!==null&&clearInterval(a.hrefUpdateInt);a.hrefUpdateInt=setInterval(function(){if(g("#"+a.hrefField.getInputId()).length>0){a.hrefField.setTargetObject(c,"href");clearInterval(a.hrefUpdateInt)}},
200)}l.trigger("aloha-link-selected");d=true;s.pub("aloha.link.selected",{input:a.hrefField.getInputElem(),href:a.hrefField.getValue(),element:a.hrefField.getTargetObject()})}else{a.toggleLinkScope(false);a.hrefField.setTargetObject(null);l.trigger("aloha-link-unselected")}else a.toggleLinkScope(false);a.ignoreNextSelectionChangedEvent=false;return d}var x=window.GENTICS,t="",v,B={merge:true,mergeable:function(a){return"aloha-new-link"===a.className&&a.nextSibling&&"aloha-new-link"===a.nextSibling.className}};
a.classes("aloha-link-pointer","aloha-link-text","aloha-focus");return f.create("link",{config:["a"],title:null,titleregex:null,targetregex:"",target:"",cssclassregex:null,cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:false,hrefUpdateInt:null,hotKey:{insertLink:d.t("insertLink","ctrl+k")},hrefValue:"http://",init:function(){var a=this;if("undefined"!==typeof this.settings.title)this.title=this.settings.title;if("undefined"!==typeof this.settings.titleregex)this.titleregex=
this.settings.titleregex;if(typeof this.settings.targetregex!="undefined")this.targetregex=this.settings.targetregex;if(typeof this.settings.target!="undefined")this.target=this.settings.target;if(typeof this.settings.cssclassregex!="undefined")this.cssclassregex=this.settings.cssclassregex;if(typeof this.settings.cssclass!="undefined")this.cssclass=this.settings.cssclass;if(typeof this.settings.objectTypeFilter!="undefined")this.objectTypeFilter=this.settings.objectTypeFilter;if(typeof this.settings.onHrefChange!=
"undefined")this.onHrefChange=this.settings.onHrefChange;typeof this.settings.hotKey!="undefined"&&g.extend(true,this.hotKey,this.settings.hotKey);if(typeof this.settings.hrefValue!="undefined")this.hrefValue=this.settings.hrefValue;this.createButtons();this.subscribeEvents();this.bindInteractions();l.bind("aloha-plugins-loaded",function(){a.initSidebar(l.Sidebar.right);s.pub("aloha.link.ready",{plugin:a})})},nsSel:function(){var a=[];g.each(arguments,function(){a.push("."+(this==""?"aloha-link":
"aloha-link-"+this))});return g.trim(a.join(" "))},nsClass:function(){var a=[];g.each(arguments,function(){a.push(this==""?"aloha-link":"aloha-link-"+this)});return g.trim(a.join(" "))},initSidebar:function(a){var b=this;b.sidebar=a;a.addPanel({id:b.nsClass("sidebar-panel-target"),title:d.t("floatingmenu.tab.link"),content:"",expanded:true,activeOn:"a, link",onInit:function(){var a=this;this.setContent('<div class="'+b.nsClass("target-container")+'"><fieldset><legend>'+d.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+
b.nsClass("radioTarget")+'" value="_self" /><span>'+d.t("link.target.self")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_blank" /><span>'+d.t("link.target.blank")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_parent" /><span>'+d.t("link.target.parent")+'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="_top" /><span>'+d.t("link.target.top")+
'</span></li><li><input type="radio" name="targetGroup" class="'+b.nsClass("radioTarget")+'" value="framename" /><span>'+d.t("link.target.framename")+'</span></li><li><input type="text" class="'+b.nsClass("framename")+'" /></li></ul></fieldset></div><div class="'+b.nsClass("title-container")+'" ><fieldset><legend>'+d.t("link.title.legend")+'</legend><input type="text" class="'+b.nsClass("linkTitle")+'" /></fieldset></div>');g(b.nsSel("framename")).live("keyup",function(){g(a.effective).attr("target",
g(this).val().replace('"',"&quot;").replace("'","&#39;"))});g(b.nsSel("radioTarget")).live("change",function(){if(g(this).val()=="framename")g(b.nsSel("framename")).slideDown();else{g(b.nsSel("framename")).slideUp().val("");g(a.effective).attr("target",g(this).val())}});g(b.nsSel("linkTitle")).live("keyup",function(){g(a.effective).attr("title",g(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(a){var c=this;c.effective=a;if(g(c.effective).attr("target")!=null){var d=
true;g(b.nsSel("framename")).hide().val("");g(b.nsSel("radioTarget")).each(function(){g(this).removeAttr("checked");if(g(this).val()===g(c.effective).attr("target")){d=false;g(this).attr("checked","checked")}});if(d){g(b.nsSel('radioTarget[value="framename"]')).attr("checked","checked");g(b.nsSel("framename")).val(g(c.effective).attr("target")).show()}}else{g(b.nsSel("radioTarget")).first().attr("checked","checked");g(c.effective).attr("target",g(b.nsSel("radioTarget")).first().val())}c=this;c.effective=
a;g(b.nsSel("linkTitle")).val(g(c.effective).attr("title"))}});a.show()},subscribeEvents:function(){var a=this,b={},c=0;l.bind("aloha-editable-created",function(d,e){var j=a.getEditableConfig(e.obj),j=g.inArray("a",j)!==-1;if(b[e.getId()]=j){e.obj.bind("keydown.aloha-link",a.hotKey.insertLink,function(){if(a.findLinkMarkup()){a.hrefField.foreground();a.hrefField.focus()}else a.insertLink(true);return false});e.obj.find("a").each(function(){a.addLinkEventHandlers(this)});0===c++&&q()}});l.bind("aloha-editable-destroyed",
function(a,b){b.obj.unbind(".aloha-link");0===--c&&g(document).unbind(".aloha-link.pointer-fix")});l.bind("aloha-editable-activated",function(c,d){if(b[l.activeEditable.getId()]){a._formatLinkButton.show();a._insertLinkButton.show()}else{a._formatLinkButton.hide();a._insertLinkButton.hide()}r(d.editable)});var d=false;l.bind("aloha-selection-changed",function(c,e){var j=false;if(l.activeEditable&&b[l.activeEditable.getId()])(j=u(a,e))&&d!==j&&a.hrefField.foreground();d=j});var e=this;l.bind("aloha-editable-deactivated",
function(a,b){if(d){setTimeout(function(){d||e.toggleLinkScope(false)},100);d=false}b.editable.obj.unbind(".aloha-link.meta-click-link")})},toggleLinkScope:function(a){if(!(this._isScopeActive===a&&l.activeEditable&&this._isScopeActive_editableId===l.activeEditable.getId())){this._isScopeActive=a;this._isScopeActive_editableId=l.activeEditable&&l.activeEditable.getId();if(a){this.hrefField.show();this._insertLinkButton.hide();l.activeEditable&&l.activeEditable.obj[0].nodeName==="A"?this._removeLinkButton.hide():
this._removeLinkButton.show();this._formatLinkButton.setState(true);e.enterScope(this.name,"link")}else{this.hrefField.hide();this._insertLinkButton.show();this._removeLinkButton.hide();this._formatLinkButton.setState(false);e.leaveScope(this.name,"link",true)}}},addLinkEventHandlers:function(a){var b=this;g(a).mouseenter(function(){l.Log.debug(b,"mouse over link.");b.mouseOverLink=a;b.updateMousePointer()});g(a).mouseleave(function(){l.Log.debug(b,"mouse left link.");b.mouseOverLink=null;b.updateMousePointer()});
g(a).click(function(a){if(a.metaKey){l.activeEditable.blur();window.setTimeout(function(){location.href=a.target},0);a.stopPropagation();return false}})},createButtons:function(){var a=this;this._formatLinkButton=b.adopt("formatLink",m,{tooltip:d.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){a.formatLink()}});this._insertLinkButton=b.adopt("insertLink",j,{tooltip:d.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",
click:function(){a.insertLink(false)}});this.hrefField=c({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext",noTargetHighlight:true,targetHighlightClass:"aloha-focus"});this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.hrefField.setObjectTypeFilter(this.objectTypeFilter);this._removeLinkButton=b.adopt("removeLink",j,{tooltip:d.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){a.removeLink()}})},
bindInteractions:function(){var a=this;this.hrefField.addListener("keyup",function(b){if(o.getToken(b.keyCode)==="escape"){var c=a.hrefField.getValue();if(!(c[0]=="/"||c[0]=="#"||c.match(/^.*\.([a-z]){2,4}$/i)||c.match(/^([a-z]){3,10}:\/\/.+/i)||c.match(/^(mailto|tel):.+/i))){c=a.hrefField.getValue();a.hrefField.setValue(c);(c==a.hrefValue||c=="")&&a.removeLink(false)}}a.hrefChange();if(o.getToken(b.keyCode)==="enter"){b=l.Selection.getRangeObject();a.ignoreNextSelectionChangedEvent=true;b.startContainer=
b.endContainer;b.startOffset=b.endOffset;b.select();a.ignoreNextSelectionChangedEvent=true;c=g(a.hrefField.getInputElem()).attr("value");(c==a.hrefValue||c=="")&&a.removeLink(false);window.setTimeout(function(){e.setScope("Aloha.continuoustext")},100)}else{v=g(a.hrefField.getInputElem()).attr("value");t!=v&&(t=v)}});g(document).keydown(function(b){l.Log.debug(a,"Meta key down.");a.metaKey=b.metaKey;a.updateMousePointer()}).keyup(function(b){l.Log.debug(a,"Meta key up.");a.metaKey=b.metaKey;a.updateMousePointer()})},
updateMousePointer:function(){if(this.metaKey&&this.mouseOverLink){l.Log.debug(this,"set pointer");g(this.mouseOverLink).removeClass("aloha-link-text");g(this.mouseOverLink).addClass("aloha-link-pointer")}else{g(this.mouseOverLink).removeClass("aloha-link-pointer");g(this.mouseOverLink).addClass("aloha-link-text")}},findLinkMarkup:function(a){typeof a=="undefined"&&(a=l.Selection.getRangeObject());if(l.activeEditable){var b=l.activeEditable.obj;b[0]&&b[0].nodeName==="A"&&(b=b.parent());return a.findMarkup(function(){return this.nodeName==
"A"},b)}return null},formatLink:function(){l.activeEditable&&(this.findLinkMarkup(l.Selection.getRangeObject())?this.removeLink():this.insertLink())},insertLink:function(a){var b=this,c=l.Selection.getRangeObject(),e;if(c.startContainer&&c.endContainer&&!this.findLinkMarkup(c)){this.hrefField.foreground();c.isCollapsed()&&a!==false&&x.Utils.Dom.extendToWord(c);if(c.isCollapsed()){a=d.t("newlink.defaulttext");e=g('<a href="'+b.hrefValue+'" class="aloha-new-link">'+a+"</a>");x.Utils.Dom.insertIntoDOM(e,
c,g(l.activeEditable.obj));c.startContainer=c.endContainer=e.contents().get(0);c.startOffset=0;c.endOffset=a.length}else{e=g('<a href="'+b.hrefValue+'" class="aloha-new-link"></a>');x.Utils.Dom.addMarkup(c,e,false);x.Utils.Dom.doCleanup(B,c)}l.activeEditable.obj.find("a.aloha-new-link").each(function(){b.addLinkEventHandlers(this);g(this).removeClass("aloha-new-link")});c.select();this.hrefField.focus();this.hrefField.hasInputElem()&&g(this.hrefField.getInputElem()).attr("value",b.hrefValue).select();
a=l.createRange();a.setStart(c.startContainer,c.startOffset);a.setEnd(c.endContainer,c.endOffset);s.pub("aloha.link.insert",{range:a});this.hrefChange()}},removeLink:function(a){var b=l.Selection.getRangeObject(),c=this.findLinkMarkup();this.hrefField.setItem(null);if(c){x.Utils.Dom.removeFromDOM(c,b,true);b.startContainer=b.endContainer;b.startOffset=b.endOffset;b.select();(typeof a=="undefined"||a===true)&&e.setScope("Aloha.continuoustext")}},automaticallySetTitle:function(a,b,c){var d=g(a.getTargetObject()).attr("title");
b&&(!d||b===d)&&a.setAttribute("title",b,c,a.getValue())},hrefChange:function(){this.automaticallySetTitle(this.hrefField,this.title,this.titleregex);this.target!=""&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue());null!=this.cssclassregex&&this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue());var a=this.hrefField.getValue(),b=this.hrefField.getTargetObject();l.trigger("aloha-link-href-change",{href:a,obj:b,item:this.hrefField.getItem()});
s.pub("aloha.link.changed",{href:a,element:b,input:this.hrefField.getInputElem()});typeof this.onHrefChange=="function"&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem())}})});define("ui/dialog",["jquery","ui/component","i18n!ui/nls/i18n"],function(l,f,a){function g(a){var b={};a.text&&(b.text=a.text);a.html&&(b.html=a.html);return l("<div>",b)}function c(a){return function(){a.apply(this);l(this).dialog("destroy").remove()}}function b(a){for(var b in a)a.hasOwnProperty(b)&&
(a[b]=c(a[b]));return a}function e(a,b){var c="aloha aloha-dialog";a.cls&&(c+=" "+a.cls);return{resizable:!1,modal:!0,title:a.title||b,dialogClass:c,zIndex:10200}}return{confirm:function(c){var j=c.buttons||{},m=a.t("button.yes.label"),d=a.t("button.no.label");null!==j.Yes&&"Yes"!==m&&(j[m]=j.Yes,delete j.Yes);null!==j.No&&"No"!==d&&(j[d]=j.No,delete j.No);j[m]=j[m]||c.yes||l.noop;j[d]=j[d]||c.no||l.noop;if(c.answer){var f=j[m],n=j[d];j[m]=function(){f();c.answer(true)};j[d]=function(){n();c.answer(false)}}var s=
g(c).dialog(l.extend(e(c,"Confirm"),{buttons:b(j)}));return function(){s.dialog("destroy").remove()}},alert:function(c){var j={};j[a.t("button.dismiss.label")]=l.noop;var m=g(c).dialog(l.extend(e(c,"Alert"),{buttons:b(j)}));return function(){m.dialog("destroy").remove()}},modal:function(a){a=g(a).dialog(l.extend(e(a,""),a));a.parent().find(".ui-dialog-titlebar").remove();return a},progress:function(a){var b=l("<div>").progressbar({value:null!=a.value?a.value:100}),c=g(a).dialog(l.extend(e(a,"Progress"),
{open:function(){l(this).append(b)}}));return function(a){null!=a?b.progressbar({value:a}):c.dialog("destroy").remove()}}}});define("ui/multiSplit",["jquery","ui/component","ui/button","ui/utils"],function(l,f,a,g){return f.extend({_activeButton:null,_isOpen:!1,init:function(){this._super();var a=this,b=this.element=l("<div>",{"class":"aloha-multisplit"});this.contentElement=l("<div>",{"class":"aloha-multisplit-content"}).appendTo(b);this.toggleButton=g.makeButtonElement({"class":"aloha-multisplit-toggle",
click:function(){a.toggle()}}).button().appendTo(b);this.buttons=[];var e=this.getButtons();0===e.length&&b.hide();for(b=0;b<e.length;b++)this.addButton(e[b]);l("body").click(function(b){a._isOpen&&(!a.element.is(b.target)&&0===a.element.find(b.target).length)&&a.close()})},addButton:function(c){var b=this,e=new (a.extend({tooltip:c.tooltip,icon:c.wide?c.icon:"aloha-large-icon "+c.icon,iconOnly:c.wide?!1:!0,init:function(){this._super();c.init&&c.init.call(this)},click:function(){c.click.apply(b,
arguments);b.close()}}));c.wide||e.element.addClass("aloha-large-button");b.buttons[c.name]={settings:c,component:e,element:e.element,visible:!0};var g=this.contentElement.children(".aloha-ui-multisplit-fullwidth");!c.wide&&g.length?g.before(e.element[0]):this.contentElement.append(e.element[0])},setActiveButton:function(a){a||(a=null);null!==this._activeButton&&this.buttons[this._activeButton].element.removeClass("aloha-multisplit-active");this._activeButton=a;null!==a&&this.buttons[a].element.addClass("aloha-multisplit-active")},
toggle:function(){this.element.toggleClass("aloha-multisplit-open");this._isOpen=!this._isOpen},open:function(){this.element.addClass("aloha-multisplit-open");this._isOpen=!0},close:function(){this.element.removeClass("aloha-multisplit-open");this._isOpen=!1},show:function(a){a||(a=null);null!==a&&void 0!==this.buttons[a]&&(this.buttons[a].element.show(),this.buttons[a].visible=!0,this.element.show())},hide:function(a){var b,e=!1;a||(a=null);if(null!==a&&void 0!==this.buttons[a]){this.buttons[a].element.hide();
this.buttons[a].visible=!1;for(b in this.buttons)if(this.buttons.hasOwnProperty(b)&&this.buttons[b].visible){this.element.show();e=!0;break}e||this.element.hide()}}})});define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(l,f,a,g){return function(c){var b;b=a.adopt(c.name,g,{scope:c.scope,getButtons:function(){var a=[];f.each(c.items,function(b,c){a.push({tooltip:c.tooltip,text:c.text,name:c.name,icon:c.iconClass,click:c.click,init:function(){c.cls&&this.element.addClass(c.cls);
c.init&&c.init.call(this)},wide:c.wide})});return a}});return{pushItem:function(a){b.addButton(a)},showItem:function(a){b.show(a)},hideItem:function(a){b.hide(a)},setActiveItem:function(a){b.setActiveButton(a)}}}});define("table/nls/i18n",{root:{"floatingmenu.tab.table":"Table","floatingmenu.tab.tablelayout":"Table Layout","deleterows.confirm":"Do you really want to delete the selected rows?","deletecolumns.confirm":"Do you really want to delete the selected columns?","deletetable.confirm":"Do you really want to delete the table?",
Table:"Table","button.createtable.tooltip":"Insert Table","button.addcolleft.tooltip":"Add Column left","button.addcolright.tooltip":"Add Column right","button.delcols.tooltip":"Delete Columns","button.addrowbefore.tooltip":"Add Row before","button.addrowafter.tooltip":"Add Row after","button.delrows.tooltip":"Delete Rows","button.caption.tooltip":"Table caption","button.naturalfit.tooltip":"Reset table sizing","empty.caption":"Table caption","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",
"button.rowheader.tooltip":"Format row as table header","button.columnheader.tooltip":"Format column as table header","button.mergecells.tooltip":"Merge Cells","button.splitcells.tooltip":"Split Cells","table.label.target":"Summary","table.sidebar.title":"Table","table.mergeCells.notRectangular":"Only a rectangular selection can be merged","table.addColumns.nonConsecutive":"Please select a single column or a consecutive range of columns","table.createTable.nestedTablesNoSupported":"Sorry, nested tables are not supported"},
ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("table/table-create-layer",["jquery"],function(l){CreateLayer=function(f){this.TablePlugin=f};CreateLayer.prototype.parameters={elemId:"aloha-table-createLayer",className:"aloha-table-createdialog",numX:10,numY:10,layer:void 0,target:void 0};CreateLayer.prototype.config={};CreateLayer.prototype.visible=!1;CreateLayer.prototype.show=function(){var f=this.get("layer");null==f?this.create():(this.setPosition(f),f.find("td").removeClass("hover"),
f.show());this.visible=!0};CreateLayer.prototype.create=function(){var f=this,a=l("<div></div>");a.id=this.get("elemId");a.addClass(this.get("className"));var g=l("<table></table>");g.css("width",15*(this.get("numX")+6));for(var c,b,e=0;e<this.get("numY");e++){c=l("<tr></tr>");for(var k=0;k<this.get("numX");k++)b=l("<td> </td>"),0==e&&0==k&&b.addClass("hover"),b.bind("mouseover",{rowId:e,colId:k},function(a){f.handleMouseOver(a,g)}),b.bind("click",{rowId:e,colId:k},function(a){f.TablePlugin.createTable(a.data.colId+
1,a.data.rowId+1);f.hide()}),c.append(b);g.append(c)}a.append(g);this.set("layer",a);this.setPosition();a.bind("click",function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()});l("body").append(a).bind("click",function(a){f.visible&&!(a.target===f.get("target")[0]||l.contains(f.get("target")[0],a.target))&&f.hide()})};CreateLayer.prototype.handleMouseOver=function(f,a){for(var g=f.data.rowId,c=f.data.colId,b=a.find("tr"),e=0;e<=b.length;e++)for(var k=l(b[e]).find("td"),j=0;j<=
k.length;j++)e<=g&&j<=c?l(k[j]).addClass("hover"):l(k[j]).removeClass("hover")};CreateLayer.prototype.setPosition=function(){var f=l(this.get("target")),a=f.offset();this.get("layer").css("left",a.left+"px");this.get("layer").css("top",a.top+f.height()+"px")};CreateLayer.prototype.hide=function(){this.get("layer").hide();this.visible=!1};CreateLayer.prototype.get=function(f){if(this.config[f])return this.config[f];if(this.parameters[f])return this.parameters[f]};CreateLayer.prototype.set=function(f,
a){this.config[f]?this.config[f]=a:this.parameters[f]=a};return CreateLayer});define("table/table-plugin-utils",["jquery"],function(l){var f={cellIndexToGridColumn:function(a,g,c){var b=null;f.walkCells(a,function(a,f,j){if(a===g&&f===c)return b=j,!1});return b},walkCells:function(a,g){for(var c=[],b=0;b<a.length;b++){for(var e=a[b].cells,k=0,j=0;j<e.length;j++){for(var m=e[j],d=f.colspan(m),m=f.rowspan(m);c[j+k];)c[j+k]-=1,k+=1;if(!1===g(b,j,j+k,d,m))return;for(var p=0;p<d;p++){if(c[j+k+p])throw"an impossible case has occurred";
c[j+k+p]=m-1}k+=d-1}for(;j+k<c.length;k++)c[j+k]&&(c[j+k]-=1)}},makeGrid:function(a){var g=[];f.walkCells(a,function(c,b,e,f,j){for(var b=a[c].cells[b],m=0;m<j;m++){g[c+m]=g[c+m]||[];for(var d=0;d<f;d++)g[c+m][e+d]={cell:b,colspan:f,rowspan:j,spannedX:d,spannedY:m}}});return g},containsDomCell:function(a){return 0===a.spannedX&&0===a.spannedY},leftDomCell:function(a,g,c){do{var b=a[g][c];if(0===b.spannedY)return b.cell;c-=b.spannedX+1}while(0<=c);return null},splitCell:function(a,g){var c=l(a),b=
f.colspan(a),e=f.rowspan(a);if(!(1===b&&1===e)){for(var k=c.parent(),j=k.parent().children(),k=k.index(),m=c.index(),d=f.makeGrid(j),m=f.cellIndexToGridColumn(j,k,m),p=0;p<e;p++)for(var n=0===p?1:0;n<b;n++){var s=f.leftDomCell(d,k+p,m);null==s?j.eq(k+p).prepend(g()):l(s).after(g())}c.removeAttr("colSpan");c.removeAttr("rowSpan")}},rowspan:function(a){return parseInt(l(a).attr("rowspan"))||1},colspan:function(a){return parseInt(l(a).attr("colspan"))||1},walkGrid:function(a,g){for(var c=0;c<a.length;c++)for(var b=
0;b<a[c].length;b++)if(!1===g(a[c][b],b,c))return},walkGridInsideRect:function(a,g,c){f.walkGrid(a,function(a,e,f){if(f>=g.top&&f<g.bottom&&e>=g.left&&e<g.right)return c(a,e,f)})},leftTrimArray:function(a){for(var g=0;g<a.length;g++)if(null!=a[g])return a.slice(g,a.length);return[]},makeContour:function(a,g){var c=[],b=[],e=[],k=[];f.walkGrid(a,function(a,f,d){if(g(a,f,d)){if(null==c[d]||f<c[d])c[d]=f;if(null==b[d]||f>b[d])b[d]=f;if(null==e[f]||d<e[f])e[f]=d;if(null==k[f]||d>k[f])k[f]=d}});c=f.leftTrimArray(c);
b=f.leftTrimArray(b);e=f.leftTrimArray(e);k=f.leftTrimArray(k);return{left:c,right:b,top:e,bottom:k}},indexOfAnyBut:function(a,g){for(var c=0;c<a.length;c++)if(g!==a[c])return c;return-1},isConsecutive:function(a){for(var g=1;g<a.length;g++)if(1!==Math.abs(a[g]-a[g-1]))return!1;return!0},resizeCellWidth:function(a,g){l(a).css("width",g);l(a).find(".aloha-table-cell-editable").eq(0).css({width:g,"word-wrap":"break-word"})},getMinColWidth:function(a){var g=a.closest("tbody").children("tr"),c=a.closest("tr"),
b=f.cellIndexToGridColumn(g,g.index(c),c.children().index(a)),e="";f.walkCells(g,function(a,c,f,d){if(f===b&&(a=l(l(g[a]).children()[c]),!(1<d))){d=a.text().split(" ");for(a=0;a<d.length;a++)d[a].length>e.length&&(e=d[a])}});c=l("<span></span>");c.css("text-indent",-9999);c.css("display","inline");c.text(e);l(a).append(c);a=c.width();l(c).remove();return a},getCellResizeBoundaries:function(a,g,c){var b,e;f.walkCells(g,function(k,j,m,d){k=l(l(g[k]).children()[j]);if(k.hasClass("aloha-table-selectrow")||
k.closest("tr").hasClass("aloha-table-selectcolumn"))return!0;m===a&&1===d&&(b=k.offset().left+f.getCellBorder(k)+k.width()-f.getMinColWidth(k));m===a-1&&1===d&&(e=k.offset().left+f.getCellBorder(k)+f.getCellPadding(k)+f.getMinColWidth(k));if(b&&e)return c(b,e),!1})},getCellBorder:function(a){return(a.outerWidth()-a.innerWidth())/2},getCellPadding:function(a){return a.innerWidth()-a.width()}};return f});define("table/table-cell",["jquery","table/table-plugin-utils"],function(l,f){var a=function(a,
c){null==a&&(a="<td>&nbsp;</td>");a=l(a).get(0);this.obj=l(a);this.tableObj=c;c.cells.push(this)};a.prototype.tableObj=void 0;a.prototype.obj=void 0;a.prototype.wrapper=void 0;a.prototype.hasFocus=!1;a.prototype.activate=function(){var a=this,c=a.obj;c.wrapInner("<div/>");var b=c.children("div").eq(0);b.contentEditable(!0);b.addClass("aloha-table-cell-editable aloha-ephemera-filler");b.bind("focus",function(b){1<f.colspan(a.obj)||1<f.rowspan(a.obj)?a.tableObj.tablePlugin._splitcellsButton.enable(!0):
a.tableObj.tablePlugin._splitcellsButton.enable(!1);b.currentTarget&&(b.currentTarget.indexOf=function(){return-1});a._editableFocus(b)});b.bind("mousedown",function(b){b.currentTarget&&(b.currentTarget.indexOf=function(){return-1});a._editableMouseDown(b);a.tableObj.selection.baseCellPosition=[a._virtualY(),a._virtualX()];if(b.shiftKey){var b=a.tableObj.selection.lastBaseCellPosition[1],c=a.tableObj.selection.lastBaseCellPosition[0],j=a.tableObj.selection.baseCellPosition,m=j[1];m>b&&(m=b,b=j[1]);
var d=j[0];d>c&&(d=c,c=j[0]);var p=d,n=b,s=c,o=m,q=a.tableObj,b=q.obj.children().children("tr"),b=f.makeGrid(b);q.selection.selectedCells=[];var r=q.get("classCellSelected");f.walkGrid(b,function(a,b,c){if(f.containsDomCell(a))if(c>=p&&c<=s&&b>=o&&b<=n){l(a.cell).addClass(r);q.selection.selectedCells.push(a.cell)}else l(a.cell).removeClass(r)});q.selection.notifyCellsSelected()}else a.tableObj.selection.lastBaseCellPosition=a.tableObj.selection.baseCellPosition,a._editableMouseDown(b),a._startCellSelection()});
b.bind("blur",function(b){a._editableBlur(b)});b.bind("keyup",function(b){a._editableKeyUp(b)});b.bind("keydown",function(b){a._editableKeyDown(b)});b.bind("mouseover",function(){a._selectCellRange()});b.contentEditableSelectionChange(function(a){Aloha.Selection.onChange(b,a);return b});c.bind("mousedown",function(c){window.setTimeout(function(){a.wrapper.trigger("focus");a._selectAll(b)},1);c.shiftKey||(a.tableObj.selection.unselectCells(),a._startCellSelection());c.stopPropagation()});c.get(0)&&
(c.get(0).onselectstart=function(){return!1});this.wrapper=c.children();this.wrapper.get(0)&&(this.wrapper.get(0).onselectstart=function(){window.event.cancelBubble=true},this.wrapper.get(0).ondragstart=function(){return false});return this};a.prototype.deactivate=function(){var a=l(this.obj.children(".aloha-table-cell-editable"));a.length&&(a.parent().append(a.contents()),a.remove(),this.obj.unbind("click"),this.obj.unbind("mousedown"),""==l.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"))};
a.prototype.toString=function(){return"TableCell"};a.prototype._editableFocus=function(){this.hasFocus||(this.tableObj.focus(),this.obj.addClass("aloha-table-cell_active"),this.hasFocus=!0,this.tableObj.selection.selectionType="cell")};a.prototype._editableBlur=function(){this.hasFocus=!1;this.obj.removeClass("aloha-table-cell_active")};a.prototype._virtualX=function(){var a=this.tableObj.obj.children().children("tr"),c=this.obj.parent().index(),b=this.obj.index();return f.cellIndexToGridColumn(a,
c,b)};a.prototype._virtualY=function(){return this.obj.parent("tr").index()};a.prototype._startCellSelection=function(){if(!this.tableObj.selection.cellSelectionMode){this.tableObj.selection.unselectCells();this.tableObj.selection.cellSelectionMode=!0;var a=this;l("body").bind("mouseup.cellselection",function(){a._endCellSelection()});this.tableObj.selection.baseCellPosition=[this._virtualY(),this._virtualX()]}};a.prototype._endCellSelection=function(){this.tableObj.selection.cellSelectionMode&&(this.tableObj.selection.cellSelectionMode=
!1,this.tableObj.selection.baseCellPosition=null,this.tableObj.selection.lastSelectionRange=null,this.tableObj.selection.selectionType="cell",l("body").unbind("mouseup.cellselection"))};a.prototype._getSelectedRect=function(){var a=this._virtualX(),c=this._virtualY(),b=this.tableObj.selection.baseCellPosition,e=b[1];e>a&&(e=a,a=b[1]);var f=b[0];f>c&&(f=c,c=b[0]);return{top:f,right:a,bottom:c,left:e}};a.prototype._selectCellRange=function(){if(!this.tableObj.selection.resizeMode&&this.tableObj.selection.cellSelectionMode){var a=
this._getSelectedRect(),c=this.tableObj,b=c.obj.children().children("tr"),b=f.makeGrid(b);c.selection.selectedCells=[];var e=c.get("classCellSelected");f.walkGrid(b,function(b,j,m){f.containsDomCell(b)&&(m>=a.top&&m<=a.bottom&&j>=a.left&&j<=a.right?(l(b.cell).addClass(e),c.selection.selectedCells.push(b.cell)):l(b.cell).removeClass(e))});c.selection.notifyCellsSelected()}};a.prototype._selectAll=function(a){a=a.jquery?a.get(0):a;if(l.browser.msie)document.getSelection?(c=document.getSelection(),b=
document.createRange(),b.selectNodeContents(a),c.removeAllRanges(),c.addRange(b)):document.selection&&(b=document.body.createTextRange(),b.moveToElementText(a),b.select());else{var c=window.getSelection();if(c.setBaseAndExtent)c.setBaseAndExtent(a,0,a,Math.max(0,a.innerText.length-1));else{window.opera&&"<BR>"==a.innerHTML.substring(a.innerHTML.length-4)&&(a.innerHTML+="&#160;");var b=document.createRange();b.selectNodeContents(a);c.removeAllRanges();c.addRange(b)}}};a.prototype._editableMouseDown=
function(a){this.tableObj.selection.unselectCells();this.tableObj.hasFocus&&a.stopPropagation()};a.prototype._editableKeyUp=function(){};a.prototype._editableKeyDown=function(a){this._checkForEmptyEvent(a);this.obj[0]===this.tableObj.obj.find("tr:last td:last")[0]&&(9==a.keyCode&&!a.altKey&&!a.shiftKey&&!a.ctrlKey)&&(this.tableObj.addRow(this.obj.parent().index()+1),this.tableObj.cells[this.tableObj.cells.length-1]._selectAll(this.wrapper.get(0)),a.stopPropagation())};a.prototype._checkForEmptyEvent=
function(){var a=l(this.wrapper),c=a.text();!(0<a.children().length)&&""===c&&(this.wrapper.text(" "),this.wrapper.get(0).blur(),this.wrapper.get(0).focus())};a.getContainer=function(a){return l(a.firstChild).hasClass("aloha-table-cell-editable")?a.firstChild:a};return a});define("table/table-selection","aloha jquery table/table-plugin-utils table/table-cell ui/dialog i18n!table/nls/i18n".split(" "),function(l,f,a,g,c,b){function e(a){return{top:a.top[0],right:a.right[0]+1,bottom:a.bottom[0]+1,left:a.left[0]}}
function k(b,c,j){var f=true;if(-1!==a.indexOfAnyBut(c.top,c.top[0])||-1!==a.indexOfAnyBut(c.right,c.right[0])||-1!==a.indexOfAnyBut(c.bottom,c.bottom[0])||-1!==a.indexOfAnyBut(c.left,c.left[0]))f=false;else{c=e(c);a.walkGridInsideRect(b,c,function(a){if(!j(a))return f=false})}return f}var j=function(a){this.table=a};j.prototype.selectionType=void 0;j.prototype.selectedCells=[];j.prototype.selectedColumnIdxs=[];j.prototype.selectedRowIdxs=[];j.prototype.cellSelectionMode=false;j.prototype.baseCellPosition=
null;j.prototype.lastSelectionRange=null;j.prototype.selectColumns=function(b){this.unselectCells();var c=this.table.getRows();c.shift();for(var c=a.makeGrid(c),e=0;e<b.length;e++)if(-1===f.inArray(b[e],this.selectedColumnIdxs)){this.selectedColumnIdxs.push(b[e]);for(var j=0;j<c.length;j++){var g=c[j][b[e]];if(a.containsDomCell(g)){f(g.cell).addClass(this.table.get("classCellSelected"));this.selectedCells.push(g.cell)}}}this.selectionType="column"};j.prototype.selectRows=function(a){this.unselectCells();
var b=this.table.getRows();a.sort(function(a,b){return a-b});for(var c=0;c<a.length;c++)if(b[a[c]]){for(var e=0;e<this.selectedRowIdxs.length;e++)if(a[c]==this.selectedRowIdxs[e])return;this.selectedRowIdxs.push(a[c]);for(e=1;e<b[a[c]].cells.length;e++){this.selectedCells.push(b[a[c]].cells[e]);f(b[a[c]].cells[e]).addClass(this.table.get("classCellSelected"))}}this.selectionType="row"};j.prototype.selectAll=function(){var a=f.map(this.table.getRows(),function(a,b){return b});a.shift();this.selectRows(a)};
j.prototype.notifyCellsSelected=function(){l.trigger("aloha-table-selection-changed")};j.prototype._notifyCellsUnselected=function(){l.trigger("aloha-table-selection-changed")};j.prototype.isHeader=function(){if(this.selectedCells.length==0)return false;for(var a=0;a<this.selectedCells.length;a++)if(!this.selectedCells[a]||this.selectedCells[a].nodeName.toLowerCase()!="th")return false;return true};j.prototype.unselectCells=function(){var a;if(!this.cellSelectionMode&&this.selectedCells.length>0){a=
this.table.getRows();for(var b=0;b<a.length;b++)for(var c=1;c<a[b].cells.length;c++)f(a[b].cells[c]).removeClass(this.table.get("classCellSelected"));this.selectedCells=[];this.selectedColumnIdxs=[];this.selectedRowIdxs=[];this.selectionType="cell";this._notifyCellsUnselected()}};j.prototype.selectionIndex=function(a){for(var b=0;b<this.selectedCells.length;b++)if(this.selectedCells[b]===a)return b;return-1};j.prototype.mergeCells=function(){var j=this.selectedCells;if(0!==j.length){var d=function(a){return-1!=
f.inArray(a.cell,j)},p=a.makeGrid(this.table.getRows()),n=a.makeContour(p,d);if(k(p,n,d)){var s=e(n),d=f(p[s.top][s.left].cell),o=f(g.getContainer(d.get(0)));a.walkGridInsideRect(p,s,function(a,b,c){if(!(b-a.spannedX===s.left&&c-a.spannedY===s.top)){a=a.cell;b=f(g.getContainer(a)).contents();for(c=0;c<b.length;c++)if("string"===typeof b[c]&&""!==f.trim(b[c])||b[c].nodeType&&(b[c].nodeType===document.TEXT_NODE&&""!==f.trim(b[c].data)||b[c].nodeType===document.ELEMENT_NODE)){o.append(" ");o.append(b);
break}f(a).remove()}});d.attr({rowspan:s.bottom-s.top,colspan:s.right-s.left});this.selectedCells=[d.get(0)];this.cellSelectionMode=false;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";l.trigger("aloha-table-selection-changed")}else c.alert({title:b.t("Table"),text:b.t("table.mergeCells.notRectangular")})}};j.prototype.splitCells=function(){var b=this,c=this.selectedCells;if(c.length>0){f(c).each(function(){a.splitCell(this,function(){return b.table.newActiveCell().obj})});
this.cellSelectionMode=false;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";l.trigger("aloha-table-selection-changed")}};j.prototype.cellsAreMergeable=function(){var b=this.selectedCells;if(b.length<2)return false;var c=function(a){return-1!=f.inArray(a.cell,b)},e=a.makeGrid(this.table.getRows()),j=a.makeContour(e,c);return k(e,j,c)?true:false};j.prototype.cellsAreSplitable=function(){var b=0;if(this.selectedCells.length>0){f(this.selectedCells).each(function(){var c=
a.colspan(this),e=a.rowspan(this);(c>1||e>1)&&b++});return b>0?true:false}return false};return j});define("table/table","aloha aloha/ephemera jquery ui/scopes ui/dialog i18n!table/nls/i18n table/table-cell table/table-selection table/table-plugin-utils util/html util/dom2".split(" "),function(l,f,a,g,c,b,e,k,j,m,d){function p(a){a.jquery&&(a=a[0]);var b,c=[],d;for(b=0;b<a.childNodes.length;b++){d=a.childNodes[b];c.push(d);d.nodeType===1&&(c=c.concat(p(d)))}return c}function n(b,c){var d;if("first"===
b){d=a("[contenteditable]",c).first()[0].firstChild;if(q===d)d=a("*",c).first()[0].firstChild}else"last"===b&&(d=p(a("td:last",c)).reverse()[0]);return d}function s(b,c,d,e){for(var j,f=false,g=0;g<d.length;g++)e.showItem(d[g].name);e.setActiveItem();for(g=0;g<c.length;g++)if(a(b[0]).hasClass(c[g].cssClass)){f=true;j=c[g].name;break}a(b).each(function(){a(this).hasClass(j)||(f=false)});f&&e.setActiveItem(j)}function o(a,b){var c=-1,d=null;"before"===a?d=b.selectedCells[0]:"after"===a&&(d=b.selectedCells[b.selectedCells.length-
1]);if(d&&d.nodeType==1)c=d.parentNode.rowIndex;return c}var q=void 0,r=window.GENTICS,u=function(b,c){this.obj=a(b);var d,e,f=this.getRows(),g=f.length,m,n=0,p=[g],l;for(d=0;d<g;d++){e=a(f[d]);e=e.children("td, th");m=e.length;m=j.cellIndexToGridColumn(f,d,m-1)+1;l=parseInt(e.last().attr("colspan"),10);if(l!=0&&!isNaN(l)){l==1&&e.last().removeAttr("colspan");m=m+(l-1)}rowSpan=parseInt(e.last().attr("rowspan"),10);if(rowSpan>1)for(e=1;e<rowSpan-1;e++)p[d+e]=l>1?p[d+e]+l:p[d+e]+1;p[d]=p[d]+m;p[d]>
n&&(n=p[d])}for(d=0;d<g;d++){e=n-p[d];e>0&&a(f[d]).append(Array(e+1).join("<td></td>"))}this.obj.attr("id")||this.obj.attr("id",r.Utils.guid());this.tablePlugin=c;this.selection=new k(this);this.refresh()};a.extend(u.prototype,{obj:q,tableWrapper:q,cells:q,numRows:q,numCols:q,isActive:false,hasFocus:false,parentEditable:q,mousedown:false,clickedColumnId:-1,clickedRowId:-1,columnsToSelect:[],rowsToSelect:[],fmPluginId:q});u.prototype.refresh=function(){this.numCols=this.countVirtualCols();var b=this.getRows();
this.numRows=b.length;this.cells=[];for(var c=0;c<b.length;c++)for(var d=a(b[c]).children(),e=0;e<d.length;e++)this.newCell(d[e])};u.prototype.countVirtualCols=function(){var a=this.obj.children().children("tr:first-child").children();return a.length-a.filter("."+this.get("classLeftUpperCorner")).length};u.prototype.get=function(a){return this.tablePlugin.get(a)};u.prototype.set=function(a,b){this.tablePlugin.set(a,b)};u.prototype.activate=function(){function b(a){return!m.isUnrenderedNode(a)}if(!this.isActive){var c=
this,e;this.obj.addClass(this.get("className"));this.obj.contentEditable(false);this.obj.attr("id")==""&&this.obj.attr("id",r.Utils.guid());f.markAttr(this.obj,"id");f.markAttr(this.obj,"contenteditable");f.markAttr(this.obj,"contentEditable");this.selection.selectionType=q;e=this.obj.children("tbody");if(e.length===0)e=this.obj;e.bind("keydown",function(a){!a.ctrlKey&&!a.shiftKey&&c.selection.selectedCells.length>0&&c.selection.selectedCells[0].length>0&&c.selection.selectedCells[0][0].firstChild.focus()});
l.bind("aloha-command-will-execute",function(a,e){var j=l.getSelection();if(j.getRangeCount()){var j=j.getRangeAt(0),f;if("forwarddelete"===e.commandId){var g;if(!(g=!j.collapsed)){g=j.startOffset;var k=j.startContainer;g=!(d.nodeLength(k)===g||(1===k.nodeType?!m.findNodeLeft(k.childNodes[g-1],b):3===k.nodeType&&m.isWSPorZWSPText(k.data.substr(g))))}if(!g){j=j.commonAncestorContainer;3===j.nodeType?f=j.parentNode&&m.findNodeLeft(j.parentNode.nextSibling,b):1===j.nodeType&&(f=m.findNodeLeft(j.nextSibling,
b));if(f===c.tableWrapper){e.preventDefault=true;l.getSelection().collapse(n("first",c.obj),0)}}}else if("delete"===e.commandId){if(!(g=!j.collapsed)){g=j.startOffset;k=j.startContainer;g=!(0===g||(1===k.nodeType?!m.findNodeRight(k.childNodes[g-1],b):3===k.nodeType&&m.isWSPorZWSPText(k.data.substr(0,g))))}if(!g){j=j.commonAncestorContainer;3===j.nodeType?f=j.parentNode&&m.findNodeRight(j.parentNode.previousSibling,b):1===j.nodeType&&(f=m.findNodeRight(j.previousSibling,b));if(f===c.tableWrapper){f=
n("last",c.obj);e.preventDefault=true;l.getSelection().collapse(f,d.nodeLength(f))}}}}});e.delegate("td","mousemove",function(b){var d=a(this);if(!a(this).hasClass("aloha-table-selectrow")&&!a(this).closest("tr").hasClass("aloha-table-selectcolumn")){var e=c.tablePlugin.rowResize;if(c.tablePlugin.colResize&&b.pageX-d.offset().left<3){d.css("cursor","col-resize");return c.attachColumnResize(d)}if(e&&b.pageY-d.offset().top<3){d.css("cursor","row-resize");return c.attachRowResize(d)}if(e){e=d.closest("tr");
if(e.next("tr").length>0)e=false;else{b=b.pageY-(e.offset().top+e.outerHeight());e=b>-3&&b<3}}if(e){d.css("cursor","row-resize");return c.attachRowResize(d,true)}d.css("cursor","default");return c.detachRowColResize(d)}});e.bind("mousemove",function(b){var d=a(this).closest("table"),e;if(e=c.tablePlugin.tableResize){b=b.pageX-(d.offset().left+d.outerWidth());e=b>-5&&b<5}if(e)return c.attachTableResizeWidth(d)});e.bind("mousedown",function(a){c.hasFocus||c.focus();a.stopPropagation();a.preventDefault();
return false});e=a('<div class="'+this.get("classTableWrapper")+' aloha-ephemera-wrapper" data-block-skip-scope="true"></div>');e.contentEditable(false);this.obj.wrap(e);e=this.obj.parent();e.alohaBlock&&e.alohaBlock();e=this.obj.parents("."+this.get("classTableWrapper"));e.get(0).onresizestart=function(){return false};e.get(0).oncontrolselect=function(){return false};e.get(0).ondragstart=function(){return false};e.get(0).onmovestart=function(){return false};this.tableWrapper=this.obj.parents("."+
this.get("classTableWrapper")).get(0);a(this.cells).each(function(){this.activate()});this.attachSelectionColumn();this.attachSelectionRow();this.makeCaptionEditable();this.checkWai();this.isActive=true;l.trigger("aloha-table-activated")}};u.prototype.makeCaptionEditable=function(){var a=this.obj.find("caption").eq(0);a&&this.tablePlugin.makeCaptionEditable(a)};u.prototype.checkWai=function(){var b=this.wai;if(b){b.removeClass(this.get("waiGreen"));b.removeClass(this.get("waiRed"));a.trim(this.obj[0].summary)!=
""?b.addClass(this.get("waiGreen")):b.addClass(this.get("waiRed"))}};u.prototype.attachSelectionColumn=function(){var b=a("<td>"),c,d,e,j;b.html(" ");e=this.obj.context.rows;for(j=0;j<e.length;j++){d=a(e[j]);c=b.clone();c.addClass(this.get("classSelectionColumn"));c.addClass("aloha-ephemera aloha-anchor-first");c.css("width",this.get("selectionArea")+"px");d.prepend(c);this.attachRowSelectionEventsToCell(c)}};u.prototype.attachRowSelectionEventsToCell=function(a){var b=this;a.unbind("mousedown");
a.unbind("mouseover");a.get(0).onselectstart=function(){return false};a.bind("mousedown",function(a){return b.rowSelectionMouseDown(a)});a.bind("mouseover",function(a){if(b.mousedown)return b.rowSelectionMouseOver(a)})};u.prototype.rowSelectionMouseDown=function(b){this.focus();if(this.selection.selectedCells.length==0)this.rowsToSelect=[];this.clickedRowId=b.currentTarget.parentNode.rowIndex;if(b.metaKey){var c=a.inArray(this.clickedRowId,this.rowsToSelect);c>=0?this.rowsToSelect.splice(c,1):this.rowsToSelect.push(this.clickedRowId)}else if(b.shiftKey){this.rowsToSelect.sort(function(a,
b){return a-b});var d=this.rowsToSelect[0],c=this.clickedRowId;if(d>c){d=c;c=this.rowsToSelect[0]}for(this.rowsToSelect=[];d<=c;d++)this.rowsToSelect.push(d)}else this.rowsToSelect=[this.clickedRowId];this.selectRows();b.preventDefault();b.stopPropagation();this.tablePlugin.summary.focus();return false};u.prototype.rowSelectionMouseOver=function(b){var c=b.currentTarget.parentNode.rowIndex,d;if(this.mousedown&&this.clickedRowId>=0){a.inArray(c,this.rowsToSelect);d=c<this.clickedRowId?c:this.clickedRowId;
c=c<this.clickedRowId?this.clickedRowId:c;for(this.rowsToSelect=[];d<=c;d++)this.rowsToSelect.push(d);this.selectRows();b.preventDefault();b.stopPropagation();return false}};u.prototype.attachSelectionRow=function(){var b=this,c=a("<td>");c.html(" ");for(var d=0,e=0;e<this.obj.context.rows.length;e++){for(var f=0,g=0;g<this.obj.context.rows[e].cells.length;g++)var k=j.colspan(this.obj.context.rows[e].cells[g]),f=f+k;d<f&&(d=f)}f=a("<tr>");f.addClass(this.get("classSelectionRow"));f.addClass("aloha-ephemera aloha-anchor-first");
f.css("height",this.get("selectionArea")+"px");for(e=0;e<d;e++){g=c.clone();if(e>0)this.attachColumnSelectEventsToCell(g);else{g=a("<td>").clone();g.addClass(this.get("classLeftUpperCorner"));this.wai=a("<div/>").width(25).height(12).click(function(a){b.focus();b.selection.selectAll();b.tablePlugin.activeTable.selection.selectionType="cell";b.tablePlugin.updateFloatingMenuScope();b._removeCursorSelection();if(b.tablePlugin.settings.summaryinsidebar){b.tablePlugin.sidebar.open();b.tablePlugin.sidebarPanel.activate(b.obj);
b.tablePlugin.sidebar.correctHeight()}try{b.tablePlugin.summary.focus();a.stopPropagation();a.preventDefault()}catch(c){}return false});g.append(this.wai)}f.append(g)}a(document).bind("mouseup",function(a){b.columnSelectionMouseUp(a)});this.obj.find("tr:first").before(f)};u.prototype.attachColumnSelectEventsToCell=function(a){var b=this;a.unbind("mousedown");a.unbind("mouseover");a.get(0).onselectstart=function(){return false};a.bind("mousedown",function(a){b.columnSelectionMouseDown(a)});a.bind("mouseover",
function(a){b.columnSelectionMouseOver(a)})};u.prototype.columnSelectionMouseDown=function(b){this.focus();if(this.selection.selectedCells.length==0)this.columnsToSelect=[];this.clickedColumnId=a(b.currentTarget.parentNode).children().index(b.currentTarget);if(b.metaKey){var c=a.inArray(this.clickedColumnId,this.columnsToSelect);c>=0?this.columnsToSelect.splice(c,1):this.columnsToSelect.push(this.clickedColumnId)}else if(b.shiftKey){this.columnsToSelect.sort(function(a,b){return a-b});var d=this.columnsToSelect[0],
c=this.clickedColumnId;if(d>c){d=c;c=this.columnsToSelect[0]}for(this.columnsToSelect=[];d<=c;d++)this.columnsToSelect.push(d)}else this.columnsToSelect=[this.clickedColumnId];this.selectColumns();b.preventDefault();b.stopPropagation();return false};u.prototype.columnSelectionMouseOver=function(a){var b=a.currentTarget.cellIndex,a=[],c;if(this.mouseDownColIdx){c=b<this.mouseDownColIdx?b:this.mouseDownColIdx;for(b=b<this.mouseDownColIdx?this.mouseDownColIdx:b;c<=b;c++)a.push(c);this.selectColumns(a)}};
u.prototype.columnSelectionMouseUp=function(){this.mouseDownColIdx=false};u.prototype.deleteRows=function(){var d=[],e={},f=this;if(0!==this.selection.selectedCells.length){for(var g=0;g<this.selection.selectedCells.length;g++)e[this.selection.selectedCells[g].parentNode.rowIndex]=true;for(rowId in e)d.push(rowId);e=false;d.length==this.numRows&&(e=true);if(e){var k=this;c.confirm({title:b.t("Table"),text:b.t("deletetable.confirm"),yes:function(){k.deleteTable()}})}else{d.sort(function(a,b){return a-
b});var m=d[0];m>this.numRows-d.length&&m--;var n=this.getRows();a.each(d,function(a,b){for(var c=n[b],d=0;d<c.cells.length;d++)j.splitCell(c.cells[d],function(){return f.newActiveCell().obj})});var p=j.makeGrid(n);a.each(d,function(b,c){for(var d=p[c],e=0;e<d.length;){var f=d[e],g=j.rowspan(f.cell);1<g&&a(f.cell).attr("rowspan",g-1);e=e+f.colspan}a(n[c]).remove()});this.numRows=this.numRows-d.length;window.setTimeout(function(){a(n[1].cells[m+1]).focus()},5);this.selection.unselectCells()}}};u.prototype.deleteColumns=
function(){var d=[],e=this.getRows(),f=this,g,k=j.makeGrid(e);if(this.selection.selectedColumnIdxs.length==k[0].length-1)c.confirm({title:b.t("Table"),text:b.t("deletetable.confirm"),yes:function(){f.deleteTable()}});else{d.sort(function(a,b){return a-b});for(var m=this.selection.selectedColumnIdxs.sort(function(a,b){return b-a}),n=0;n<m.length;n++){for(var p=m[n],l=0;l<e.length;l++)if(g=k[l][p]){if(0===g.spannedX){if(1<g.colspan){var q=this.newActiveCell().obj;a(g.cell).after(q);q.attr("rowspan",
g.rowspan);q.attr("colspan",g.colspan-1)}a(g.cell).remove()}else a(g.cell).attr("colspan",g.colspan-1);l=l+(g.rowspan-1)}k=j.makeGrid(e)}this.numCols=this.numCols-d.length;window.setTimeout(function(){a(e[1].cells[1]).focus()},5);this.selection.unselectCells()}};u.prototype.deleteTable=function(){for(var a=-1,b=0;b<this.tablePlugin.TableRegistry.length;b++)if(this.tablePlugin.TableRegistry[b].obj.attr("id")==this.obj.attr("id")){a=b;break}if(a>=0){this.deactivate();this.selection.selectionType=q;
this.tablePlugin.TableRegistry.splice(b,1);a=l.Selection.rangeObject;a.endContainer=this.obj.get(0).parentNode;a.startContainer=a.endContainer;a.endOffset=r.Utils.Dom.getIndexInParent(this.obj.get(0));a.startOffset=a.endOffset;a.clearCaches();this.obj.remove();this.parentEditable.obj.focus();a.correctRange();a.select()}};u.prototype.addRowBeforeSelection=function(){var a=o("before",this.selection);-1!==a&&this.addRow(a)};u.prototype.addRowAfterSelection=function(){var a=o("after",this.selection);
-1!==a&&this.addRow(a+1)};u.prototype.addRow=function(b){this.countVirtualCols();for(var c=this.obj.children().children("tr"),d=0;d<1;d++){var e=a("<tr>"),f=a("<td>");f.addClass(this.get("classSelectionColumn"));f.addClass("aloha-ephemera aloha-anchor-first");this.attachRowSelectionEventsToCell(f);e.append(f);f=j.makeGrid(c);if(b>=f.length)for(var g=1;g<f[0].length;g++)e.append(this.newActiveCell().obj);else for(g=1;g<f[b].length;){var k=f[b][g];if(j.containsDomCell(k))for(var m=k.colspan;m--;)e.append(this.newActiveCell().obj);
else a(k.cell).attr("rowspan",k.rowspan+1);g=g+k.colspan}b>=c.length?c.eq(c.length-1).after(e):c.eq(b).before(e)}this.numRows=this.numRows+1};u.prototype.addColumnsRight=function(){this.addColumns("right")};u.prototype.addColumnsLeft=function(){this.addColumns("left")};u.prototype.addColumns=function(d){var e=a("<td>"),f=this.getRows(),g,k;g=this.selection.selectedColumnIdxs;if(0!==g.length){g.sort(function(a,b){return a-b});if(j.isConsecutive(g)){if("left"===d){k=g[0];for(var m=0;m<this.selection.selectedColumnIdxs.length;m++)this.selection.selectedColumnIdxs[m]=
this.selection.selectedColumnIdxs[m]+1}else k=g[g.length-1];for(var n=j.makeGrid(f),m=0;m<f.length;m++){g=e.clone();g.html(" ");if(m==0)this.attachColumnSelectEventsToCell(g);else{cellObj=this.newActiveCell(g.get(0));g=cellObj.obj}var p=j.leftDomCell(n,m,k);null==p?a(f[m]).prepend(g):"left"===d&&j.containsDomCell(n[m][k])?a(p).before(g):a(p).after(g);this.numCols++}}else c.alert({title:b.t("Table"),text:b.t("table.addColumns.nonConsecutive")})}};u.prototype.focus=function(){if(!this.hasFocus){this.parentEditable.isActive||
this.parentEditable.obj.focus();this.tablePlugin.setFocusedTable(this)}};u.prototype.focusOut=function(){if(this.hasFocus){this.tablePlugin.setFocusedTable(q);this.selection.selectionType=q}};u.prototype._removeCursorSelection=function(){var b=l.getSelection();if(b&&b._nativeSelection&&b._nativeSelection._ranges.length!=0){b=b.getRangeAt(0);if(null!=b.startContainer&&0===a(b.startContainer).closest("table").length&&0!==this.selection.selectedCells.length){b=e.getContainer(this.selection.selectedCells[0]);
a(b).focus()}}};u.prototype.selectColumns=function(a){a=a?a:this.columnsToSelect;g.setScope(this.tablePlugin.name+".column");this.selection.selectColumns(a);this.tablePlugin._columnheaderButton.setState(this.selection.isHeader());s(this.selection.selectedCells,this.tablePlugin.columnConfig,this.tablePlugin.columnMSItems,this.tablePlugin.columnMSButton);this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.notifyCellsSelected();this._removeCursorSelection()};u.prototype.selectRows=
function(){g.setScope(this.tablePlugin.name+".row");this.selection.selectRows(this.rowsToSelect);this.tablePlugin._rowheaderButton.setState(this.selection.isHeader());s(this.selection.selectedCells,this.tablePlugin.rowConfig,this.tablePlugin.rowMSItems,this.tablePlugin.rowMSButton);this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.notifyCellsSelected();this._removeCursorSelection()};u.prototype.deactivate=function(){var b=this.obj.parent();b.mahaloBlock&&b.mahaloBlock();this.obj.removeClass(this.get("className"));
a.trim(this.obj.attr("class"))==""&&this.obj.removeAttr("class");this.obj.removeAttr("contenteditable");this.obj.parents("."+this.get("classTableWrapper")).length&&this.obj.unwrap();this.obj.find("tr."+this.get("classSelectionRow")+":first").remove();var c=this;a.each(this.obj.context.rows,function(){a(this).children("td."+c.get("classSelectionColumn")).remove()});this.obj.find("td, th").removeClass(this.get("classCellSelected"));this.obj.find("td, th").removeClass("aloha-table-cell_active");this.obj.find("td, th").css("cursor",
"");this.obj.unbind();this.obj.children("tbody").unbind();for(b=0;b<this.cells.length;b++)this.cells[b].deactivate();this.obj.find("caption div").each(function(){a(this).contents().unwrap()});this.isActive=false};u.prototype.attachColumnResize=function(b){var c=this;c.detachRowColResize(b);var d=b.closest("tbody").children("tr"),e=b.closest("tr"),f=j.cellIndexToGridColumn(d,d.index(e),e.children().index(b)),g=function(b){var c,e;j.walkCells(d,function(g,k,m,n){g=a(a(d[g]).children()[k]);if(g.hasClass("aloha-table-selectrow")||
g.closest("tr").hasClass("aloha-table-selectcolumn")||n>1)return true;if(m===f){e||(e=g.width()-b);j.resizeCellWidth(g,e)}else if(m===f-1){c||(c=g.width()+b);j.resizeCellWidth(g,c)}return true})};b.bind("mousedown.resize",function(){var e=a("<div></div>");e.css({height:a(b).closest("tbody").innerHeight(),width:a(b).outerWidth()-a(b).innerWidth(),top:a(b).closest("tbody").offset().top,left:a(b).offset().left,position:"absolute","background-color":"#80B5F2"});a("body").append(e);j.getCellResizeBoundaries(f,
d,function(d,j){c.selection.resizeMode=true;a("body").bind("mousemove.dnd_col_resize",function(a){a.pageX>j&&a.pageX<d&&e.css("left",a.pageX)});a("body").bind("mouseup.dnd_col_resize",function(f){var k=0;f.pageX<j?k=j-b.offset().left:f.pageX>j&&f.pageX<d?k=f.pageX-b.offset().left:f.pageX>d&&(k=d-b.offset().left);k!==0&&g(k);a("body").unbind("mousemove.dnd_col_resize");a("body").unbind("mouseup.dnd_col_resize");c.selection.resizeMode=false;e.remove()})})})};u.prototype.attachRowResize=function(b,c){var d=
this;d.detachRowColResize(b);b.bind("mousedown.resize",function(){var e=a("<div></div>");e.css({width:b.closest("tbody").innerWidth(),height:b.outerHeight()-b.innerHeight(),top:c?b.offset().top+b.outerHeight():b.offset().top,left:b.closest("tbody").offset().left,position:"absolute","background-color":"#80B5F2"});a("body").append(e);d.selection.resizeMode=true;a("body").bind("mousemove.dnd_row_resize",function(a){var d=a.pageY,j;j=c?b.closest("tr").offset().top:b.closest("tr").prev("tr").offset().top;
d>j&&e.css("top",a.pageY)});a("body").bind("mouseup.dnd_row_resize",function(j){var g=0,g=c?j.pageY-(b.offset().top+b.outerHeight()):j.pageY-b.offset().top,j=c?b.closest("tr"):b.closest("tr").prev("tr"),g=j.height()+g;g<0&&(g=1);j.css("height",g);a("body").unbind("mousemove.dnd_row_resize");a("body").unbind("mouseup.dnd_row_resize");d.selection.resizeMode=false;e.remove()})})};u.prototype.attachTableResizeWidth=function(b){var c=this,d=b.closest(".aloha-table-wrapper"),e=b.find("tr:not(.aloha-table-selectcolumn) td:last-child"),
g;a.each(e,function(){if(!a(this).attr("colspan")||a(this).attr("colspan")<2){g=a(this);return false}});e.css("cursor","col-resize");var f=function(c){var d=b.find("tr"),e=g.closest("tr"),f=j.cellIndexToGridColumn(d,d.index(e),e.children().index(g)),k=c-j.getCellBorder(g)-j.getCellPadding(g);j.walkCells(d,function(b,c,e,g){b=a(a(d[b]).children()[c]);if(b.hasClass("aloha-table-selectrow")||b.closest("tr").hasClass("aloha-table-selectcolumn")||g>1)return true;e===f?j.resizeCellWidth(b,k):j.resizeCellWidth(b,
b.width());return true})};e.bind("mousedown.resize",function(){var k=a("<div></div>");k.css({height:b.children("tbody").innerHeight(),width:g.outerWidth()-g.innerWidth(),top:b.find("tbody").offset().top,left:b.offset().left+b.outerWidth(),position:"absolute","background-color":"#80B5F2"});a("body").append(k);var m=d.offset().left+d.width(),n=g.offset().left+(g.innerWidth()-g.width())+j.getMinColWidth(g);c.selection.resizeMode=true;a("body").bind("mousemove.dnd_col_resize",function(a){a.pageX>n&&a.pageX<
m&&k.css("left",a.pageX)});a("body").bind("mouseup.dnd_col_resize",function(b){var d=0;b.pageX<=n?d=n-g.offset().left:b.pageX>n&&b.pageX<m?d=b.pageX-g.offset().left:b.pageX>m&&(d=m-g.offset().left);f(d);a("body").unbind("mousemove.dnd_col_resize");a("body").unbind("mouseup.dnd_col_resize");e.unbind("mousedown.resize");e.css("cursor","default");c.selection.resizeMode=false;k.remove()})})};u.prototype.detachRowColResize=function(a){return a.unbind("mousedown.resize")};u.prototype.toString=function(){return"Table"};
u.prototype.newCell=function(a){return new e(a,this)};u.prototype.newActiveCell=function(a){a=new e(a,this);a.activate();return a};u.prototype.getRows=function(){var b=this.obj.get(0).rows;return a.makeArray(b)};return u});define("table/table-plugin","aloha jquery aloha/plugin aloha/pluginmanager aloha/ephemera ui/ui ui/scopes ui/button ui/toggleButton ui/dialog ui/port-helper-attribute-field ui/port-helper-multi-split i18n!table/nls/i18n i18n!aloha/nls/i18n table/table-create-layer table/table table/table-plugin-utils util/dom aloha/console".split(" "),
function(l,f,a,g,c,b,e,k,j,m,d,p,n,s,o,q,r,u,x){function t(a){var b=K(a),c;if(c=U.Utils.Dom.isEditable(a))if(c=!(0<b.parents(".aloha-editable table").length)){a:{var d,e=b.parents();for(c=0;c<e.length;c++){d=e.eq(c);if(d.is(".aloha-editable")){c=false;break a}if(d.is(".aloha-block")){c=true;break a}}c=false}c=!c}if(c){c=new q(a,y);a=K(u.getEditingHostOf(a));c.parentEditable=l.getEditableById(a.attr("id"));y.TableRegistry.push(c);a=b.is("table")?"table":"table table";b.find(a).length&&x.warn("Table Plugin",
"Nested tables found. They will not be initialized.");l.activeEditable===c.parentEditable&&c.activate();return c}return null}function v(a,b){var c,d,e=a.selection.isHeader(),j;for(c=0;c<a.selection.selectedCells.length;c++){j=a.selection.selectedCells[c];for(d=0;d<a.cells.length;d++)if(j===a.cells[d].obj[0]){cell=a.cells[d];break}d=e?l.Markup.transformDomObject(j,"td").removeAttr("scope").get(0):l.Markup.transformDomObject(j,"th").attr("scope",b).get(0);if(cell!=null){cell.obj[0]=d;cell.deactivate();
cell.activate()}f(a.selection.selectedCells[c]).bind("mousedown",function(){var a=f(this).children("div").eq(0);window.setTimeout(function(){a.trigger("focus")},1)})}}function B(a,b,c){for(var d=true,e=0;e<c.length;e++)if(f(c[e]).attr("class").indexOf(b)<0){d=false;break}if(d)for(e=0;e<c.length;e++)f(c[e]).removeClass(b);else for(e=0;e<c.length;e++){f(c[e]).addClass(b);for(d=0;d<a.length;d++)a[d].cssClass!=b&&f(c[e]).removeClass(a[d].cssClass)}}function C(){var a=[],b=S;f.each(arguments,function(){a.push("."+
(this==""?b:b+"-"+this))});return f.trim(a.join(" "))}function z(){var a=[],b=S;f.each(arguments,function(){a.push(this==""?b:b+"-"+this)});return f.trim(a.join(" "))}function A(a,b){var c=a.endContainer,d=a.startContainer,e=c.nodeType==3?c.length:c.childNodes.length;if(d.nodeType==3&&d.parentNode.tagName=="P"&&d.parentNode.childNodes.length==1&&/^(\s|%A0)$/.test(escape(d.data))){d.data="";a.startOffset=0;if(c==d)a.endOffset=0}if(!U.Utils.Dom.allowsNesting(d.nodeType==3?d.parentNode:d,b)){a.startOffset==
0&&f(d.nodeType==3?d.parentNode:d).addClass("aloha-table-cleanme");a.endOffset==e&&f(c.nodeType==3?c.parentNode:c).addClass("aloha-table-cleanme")}}function E(){for(var a=f(".aloha-table-cleanme").removeClass("aloha-table-cleanme"),b=0;b<a.length;b++)f.trim(f(a[b]).html())==""&&!U.Utils.Dom.isEditingHost(a[b])&&f(a[b]).remove()}var K=f,U=window.GENTICS,y=new a("table");y.createLayer=void 0;y.config=["table"];y.TableRegistry=[];y.activeTable=void 0;y.parameters={className:"aloha-table",classSelectionRow:"aloha-table-selectcolumn",
classSelectionColumn:"aloha-table-selectrow",classLeftUpperCorner:"aloha-table-leftuppercorner",classTableWrapper:"aloha-table-wrapper",classCellSelected:"aloha-cell-selected",waiRed:"aloha-wai-red",waiGreen:"aloha-wai-green",selectionArea:10};y.checkConfig=function(a){if(typeof a=="object"&&a.length){for(var b=[],c=0;c<a.length;c++)a[c]&&b.push({name:a[c].name,text:a[c].text?a[c].text:a[c].name,tooltip:a[c].tooltip?a[c].tooltip:a[c].text,iconClass:a[c].iconClass?a[c].iconClass:"aloha-icon-"+a[c].name,
cssClass:a[c].cssClass?a[c].cssClass:a[c].name});a=b}else a=[];return a};y.init=function(){var a=this,b={};this.tableConfig=this.checkConfig(this.tableConfig||this.settings.tableConfig);this.columnConfig=this.checkConfig(this.columnConfig||this.settings.columnConfig);this.rowConfig=this.checkConfig(this.rowConfig||this.settings.rowConfig);this.cellConfig=this.checkConfig(this.cellConfig||this.settings.cellConfig);this.tableResize=this.settings.tableResize===void 0?false:this.settings.tableResize;
this.colResize=this.settings.colResize===void 0?false:this.settings.colResize;this.rowResize=this.settings.rowResize===void 0?false:this.settings.rowResize;if(f.browser.msie&&parseInt(f.browser.version,10)<8)this.rowResize=this.colResize=this.tableResize=false;this.createLayer=new o(this);l.bind("aloha-editable-created",function(c,d){var e=a.getEditableConfig(d.obj);b[d.getId()]=-1!==f.inArray("table",e);d.obj.bind("mousedown",function(){y.setFocusedTable(void 0)});d.obj.find("table").each(function(a,
b){t(b)})});this.initTableButtons();l.bind("aloha-table-selection-changed",function(){if(typeof y.activeTable!=="undefined"&&y.activeTable.selection){y.updateFloatingMenuScope();if(y.activeTable.selection.cellsAreSplitable()){a._splitcellsButton.enable(true);a._splitcellsRowButton.enable(true);a._splitcellsColumnButton.enable(true)}else{a._splitcellsButton.enable(false);a._splitcellsRowButton.enable(false);a._splitcellsColumnButton.enable(false)}if(y.activeTable.selection.cellsAreMergeable()){a._mergecellsButton.enable(true);
a._mergecellsRowButton.enable(true);a._mergecellsColumnButton.enable(true)}else{a._mergecellsButton.enable(false);a._mergecellsRowButton.enable(false);a._mergecellsColumnButton.enable(false)}}});l.bind("aloha-selection-changed",function(c,d){if(d.startContainer&&l.activeEditable){b[l.activeEditable.getId()]&&l.Selection.mayInsertTag("table")?a._createTableButton.show():a._createTableButton.hide();if(a.activeTable)if(d.findMarkup(function(){return this.nodeName==="TABLE"},l.activeEditable.obj)){y.updateFloatingMenuScope();
y.setActiveCellStyle()}else{a.activeTable.selection.cellSelectionMode=false;a.activeTable.selection.baseCellPosition=null;a.activeTable.selection.lastSelectionRange=null;a.activeTable.focusOut()}}});l.bind("aloha-editable-activated",function(b,c){a._splitcellsButton.enable(false);a._mergecellsButton.enable(false);a._splitcellsRowButton.enable(false);a._mergecellsRowButton.enable(false);a._splitcellsColumnButton.enable(false);a._mergecellsColumnButton.enable(false);c.editable.obj.find("table").each(function(){for(var a=
y.TableRegistry,b=0;b<a.length;b++)if(a[b].obj.attr("id")===f(this).attr("id")){a[b].activate();return true}t(this)})});l.bind("aloha-editable-deactivated",function(){y.activeTable&&y.activeTable.selection.unselectCells();y.setFocusedTable(void 0);for(var a=y.TableRegistry,b=0;b<a.length;b++)a[b].deactivate()});l.bind("aloha-smart-content-changed",function(){l.activeEditable&&l.activeEditable.obj.find("table").each(function(){if(y.indexOfTableInRegistry(this)==-1&&t(this))this.id=U.Utils.guid()})});
this.settings.summaryinsidebar&&l.bind("aloha-plugins-loaded",function(){a.initSidebar(l.Sidebar.right.show())})};var S="aloha-table";y.initSidebar=function(a){var b=this;b.sidebar=a;b.sidebarPanel=a.addPanel({id:z("sidebar-panel"),title:n.t("table.sidebar.title"),content:"",expanded:true,activeOn:"table",onInit:function(){var a=this;this.setContent('<label class="'+z("label")+'" for="'+z("textarea")+'" >'+n.t("table.label.target")+'</label><textarea id="'+z("textarea")+'" class="'+z("textarea")+
'" />');f(C("textarea")).live("keyup",function(){f(a.effective).attr("summary",f(C("textarea")).val());var c=f('div[class*="wai"]',"table#"+f(a.effective).attr("id"));c.removeClass(b.get("waiGreen"));c.removeClass(b.get("waiRed"));f(C("textarea")).val().trim()!=""?c.addClass(b.get("waiGreen")):c.addClass(b.get("waiRed"))})},onActivate:function(a){this.effective=a;f(C("textarea")).val(f(this.effective).attr("summary"))}});a.show()};y.isEditableTable=function(a){return U.Utils.Dom.isEditable(a)};y.indexOfTableInRegistry=
function(a){for(var b=this.TableRegistry,c=0;c<b.length;c++)if(b[c].obj[0].id==a.id)return c;return-1};y.getTableFromRegistry=function(a){a=this.indexOfTableInRegistry(a);return a>-1?this.TableRegistry[a]:null};y.isSelectionInTable=function(){var a=l.Selection.getRangeObject(),a=f(a.commonAncestorContainer);return a.length==0?false:a.parents(".aloha-editable table").length?true:false};y.preventNestedTables=function(){if(this.isSelectionInTable()){m.alert({title:n.t("Table"),text:n.t("table.createTable.nestedTablesNoSupported")});
return true}return false};y.initMergeSplitCellsBtns=function(){this._mergecellsButton=b.adopt("mergecells",k,{tooltip:n.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".cell",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsButton=b.adopt("splitcells",k,{tooltip:n.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".cell",click:function(){var a;if(y.activeTable)if(y.activeTable.selection.selectedCells.length>
0)y.activeTable.selection.splitCells();else{a=y.selectedOrActiveCells();if(a.length>0){r.splitCell(a,function(){return y.activeTable.newActiveCell().obj});l.trigger("aloha-table-selection-changed")}}}});this._mergecellsRowButton=b.adopt("mergecellsRow",k,{tooltip:n.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".row",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsRowButton=b.adopt("splitcellsRow",k,{tooltip:n.t("button.splitcells.tooltip"),
icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".row",click:function(){y.activeTable&&y.activeTable.selection.splitCells()}});this._mergecellsColumnButton=b.adopt("mergecellsColumn",k,{tooltip:n.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".column",click:function(){y.activeTable&&y.activeTable.selection.mergeCells()}});this._splitcellsColumnButton=b.adopt("splitcellsColumn",k,{tooltip:n.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",
scope:this.name+".column",click:function(){y.activeTable&&y.activeTable.selection.splitCells()}})};y.initNaturalFitBtn=function(){var a=this;if(this.colResize||this.rowResize)this._tableNaturalFitButton=b.adopt("naturalFit",k,{tooltip:n.t("button.naturalfit.tooltip"),icon:"aloha-icon aloha-icon-table-naturalfit",scope:this.name+".cell",click:function(){if(a.activeTable){var b=a.activeTable.obj;b.find("td, th").each(function(){f(this).find("div").css("width","");f(this).css("width","")});b.find("tr").each(function(){f(this).css("height",
"")})}}})};y.initRowsBtns=function(){var a=this;this._addrowbeforeButton=b.adopt("addrowbefore",k,{tooltip:n.t("button.addrowbefore.tooltip"),icon:"aloha-icon aloha-icon-addrowbefore",scope:this.name+".row",click:function(){a.activeTable&&a.activeTable.addRowBeforeSelection()}});this._addrowafterButton=b.adopt("addrowafter",k,{tooltip:n.t("button.addrowafter.tooltip"),icon:"aloha-icon aloha-icon-addrowafter",scope:this.name+".row",click:function(){a.activeTable&&a.activeTable.addRowAfterSelection()}});
this._deleterowsButton=b.adopt("deleterows",k,{tooltip:n.t("button.delrows.tooltip"),icon:"aloha-icon aloha-icon-deleterows",scope:this.name+".row",click:function(){if(a.activeTable){var b=a.activeTable;m.confirm({title:n.t("Table"),text:n.t("deleterows.confirm"),yes:function(){b.deleteRows()}})}}});this._rowheaderButton=b.adopt("rowheader",j,{tooltip:n.t("button.rowheader.tooltip"),icon:"aloha-icon aloha-icon-rowheader",scope:this.name+".row",click:function(){if(a.activeTable){a.activeTable.refresh();
v(a.activeTable,"column");a.activeTable.selection.unselectCells();a.activeTable.selection.selectRows(a.activeTable.selection.selectedRowIdxs)}}});this.rowMSItems=[];f.each(this.rowConfig,function(b,c){a.rowMSItems.push({name:c.name,text:n.t(c.text),tooltip:n.t(c.tooltip),iconClass:"aloha-icon aloha-row-layout "+c.iconClass,click:function(){if(a.activeTable){B(a.rowConfig,c.cssClass,a.activeTable.selection.selectedCells);a.activeTable.selectRows()}}})});this.rowMSItems.length>0&&this.rowMSItems.push({name:"removeFormat",
text:n.t("button.removeFormat.text"),tooltip:n.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedCells,c=0;c<b.length;c++)for(var d=0;d<a.rowConfig.length;d++)f(b[c]).removeClass(a.rowConfig[d].cssClass);a.activeTable.selectRows()}}});this.rowMSButton=p({items:this.rowMSItems,name:"formatRow",hideIfEmpty:true,scope:this.name+".row"})};y.initColumnBtns=function(){var a=this;this._addcolumnleftButton=
b.adopt("addcolumnleft",k,{tooltip:n.t("button.addcolleft.tooltip"),icon:"aloha-icon aloha-icon-addcolumnleft",scope:this.name+".column",click:function(){a.activeTable&&a.activeTable.addColumnsLeft()}});this._addcolumnrightButton=b.adopt("addcolumnright",k,{tooltip:n.t("button.addcolright.tooltip"),icon:"aloha-icon aloha-icon-addcolumnright",scope:this.name+".column",click:function(){a.activeTable&&a.activeTable.addColumnsRight()}});this._deletecolumnsButton=b.adopt("deletecolumns",k,{tooltip:n.t("button.delcols.tooltip"),
icon:"aloha-icon aloha-icon-deletecolumns",scope:this.name+".column",click:function(){if(a.activeTable){var b=a.activeTable;m.confirm({title:n.t("Table"),text:n.t("deletecolumns.confirm"),yes:function(){b.deleteColumns()}})}}});this._columnheaderButton=b.adopt("columnheader",j,{tooltip:n.t("button.columnheader.tooltip"),icon:"aloha-icon aloha-icon-columnheader",scope:this.name+".column",click:function(){if(a.activeTable){a.activeTable.refresh();v(a.activeTable,"row");a.activeTable.selection.unselectCells();
a.activeTable.selection.selectColumns(a.activeTable.selection.selectedColumnIdxs)}}});this.columnMSItems=[];f.each(this.columnConfig,function(b,c){var d={name:c.name,text:n.t(c.text),tooltip:n.t(c.tooltip),iconClass:"aloha-icon aloha-column-layout "+c.iconClass,click:function(){if(a.activeTable){B(a.columnConfig,c.cssClass,a.activeTable.selection.selectedCells);a.activeTable.selectColumns()}}};a.columnMSItems.push(d)});this.columnMSItems.length>0&&this.columnMSItems.push({name:"removeFormat",text:n.t("button.removeFormat.text"),
tooltip:n.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=a.activeTable.selection.selectedCells,c=0;c<b.length;c++)for(var d=0;d<a.columnConfig.length;d++)f(b[c]).removeClass(a.columnConfig[d].cssClass);a.activeTable.selectColumns()}}});this.columnMSButton=p({items:this.columnMSItems,name:"formatColumn",hideIfEmpty:true,scope:this.name+".column"})};y.initCellBtns=function(){var a=this;this.cellMSItems=[];f.each(this.cellConfig,
function(b,c){var d={name:c.name,text:n.t(c.text),tooltip:n.t(c.tooltip),iconClass:"aloha-icon aloha-column-layout "+c.iconClass,click:function(){if(a.activeTable){B(a.cellConfig,c.cssClass,a.selectedOrActiveCells());a.setActiveCellStyle()}}};a.cellMSItems.push(d)});this.cellMSItems.length>0&&this.cellMSItems.push({name:"removeFormat",text:n.t("button.removeFormat.text"),tooltip:n.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=
a.selectedOrActiveCells(),c=0;c<b.length;c++)for(var d=0;d<a.cellConfig.length;d++)f(b[c]).removeClass(a.cellConfig[d].cssClass);a.setActiveCellStyle()}}});this.cellMSButton=p({items:this.cellMSItems,name:"formatCell",hideIfEmpty:true,scope:this.name+".cell"})};y.initTableButtons=function(){var a=this;e.createScope(this.name+".row","Aloha.continuoustext");e.createScope(this.name+".column","Aloha.continuoustext");e.createScope(this.name+".cell","Aloha.continuoustext");this._createTableButton=b.adopt("createTable",
k,{tooltip:n.t("button.createtable.tooltip"),icon:"aloha-icon aloha-icon-createTable",scope:"Aloha.continuoustext",click:function(){y.createDialog(this.element)}});this.initColumnBtns();this.initRowsBtns();this.initCellBtns();this.initMergeSplitCellsBtns();this.initNaturalFitBtn();this.tableMSItems=[];var c=this.tableConfig;f.each(c,function(b,d){a.tableMSItems.push({name:d.name,text:n.t(d.text),tooltip:n.t(d.tooltip),iconClass:"aloha-icon aloha-table-layout "+d.iconClass,click:function(){if(a.activeTable)if(a.activeTable.obj.hasClass(d.cssClass)){for(b=
0;b<c.length;b++)a.activeTable.obj.removeClass(c[b].cssClass);a.tableMSButton.setActiveItem()}else{for(var b=0;b<c.length;b++)a.activeTable.obj.removeClass(c[b].cssClass);a.activeTable.obj.addClass(d.cssClass);a.tableMSButton.setActiveItem(d.cssClass)}}})});this.tableMSItems.length>0&&this.tableMSItems.push({name:"removeFormat",text:n.t("button.removeFormat.text"),tooltip:n.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:true,click:function(){if(a.activeTable){for(var b=
0;b<c.length;b++)a.activeTable.obj.removeClass(a.tableConfig[b].cssClass);a.tableMSButton.setActiveItem()}}});this.tableMSButton=p({items:this.tableMSItems,name:"formatTable",hideIfEmpty:true,scope:this.name+".cell"});this._tableCaptionButton=b.adopt("tableCaption",j,{tooltip:n.t("button.caption.tooltip"),icon:"aloha-icon aloha-icon-table-caption",scope:this.name+".cell",click:function(){if(a.activeTable)if(a.activeTable.obj.children("caption").is("caption"))a.activeTable.obj.children("caption").remove();
else{var b=n.t("empty.caption"),c=f("<caption></caption>");a.activeTable.obj.prepend(c);a.makeCaptionEditable(c,b);b=c.find("div").eq(0);c=b.contents().eq(0);if(c.length>0){var d=new U.Utils.RangeObject;d.startContainer=d.endContainer=c.get(0);d.startOffset=0;d.endOffset=c.text().length;a.activeTable.obj.find("div.aloha-table-cell-editable").blur();b.focus();d.select();l.Selection.updateSelection()}}}});this.summary=d({width:275,name:"tableSummary",noTargetHighlight:true,scope:this.name+".cell"});
this.summary.addListener("keyup",function(){a.activeTable&&a.activeTable.checkWai()})};y.makeCaptionEditable=function(a,b){var c=a.children("div");if(c.length===0){c=f("<div></div>");f(c).addClass("aloha-ui");f(c).addClass("aloha-editable-caption");a.contents().length>0?c.append(a.contents()):b&&c.text(b);a.append(c)}else if(c.length>1){a.children("div:not(:first-child)").each(function(){$this=f(this);c.eq(0).append($this.contents());$this.remove()});c=c.eq(0)}c.contentEditable(true)};y.createDialog=
function(a){this.createLayer.set("target",a);this.createLayer.show()};y.createTable=function(a,b){if(!this.preventNestedTables())if(l.activeEditable&&typeof l.activeEditable.obj!=="undefined"){for(var c=document.createElement("table"),d=c.id=U.Utils.guid(),e=document.createElement("tbody"),j=0;j<b;j++){for(var g=document.createElement("tr"),k=0;k<a;k++){var m=document.createTextNode(" "),n=document.createElement("td");n.appendChild(m);g.appendChild(n)}e.appendChild(g)}c.appendChild(e);A(l.Selection.getRangeObject(),
c);U.Utils.Dom.insertIntoDOM(f(c),l.Selection.getRangeObject(),l.activeEditable.obj);E();var c=document.getElementById(d),p=t(c);p&&(K.browser.msie?window.setTimeout(function(){p.cells[0].wrapper.get(0).focus()},20):p.cells[0].wrapper.get(0).focus());p.focus();y.activeTable.selection.selectionType="cell";y.updateFloatingMenuScope()}else this.error("There is no active Editable where the table can be\t\t\t\tinserted!")};y.setFocusedTable=function(a){null==a&&null!=this.activeTable&&this.activeTable.selection.unselectCells();
for(var b=0;b<y.TableRegistry.length;b++)y.TableRegistry[b].hasFocus=false;if(typeof a!="undefined"){this.summary.setTargetObject(a.obj,"summary");if(a.obj.children("caption").is("caption")){this._tableCaptionButton.setState(true);this.makeCaptionEditable(a.obj.children("caption"))}a.hasFocus=true}y.activeTable=a;for(b=0;b<this.tableMSItems.length;b++)this.tableMSButton.showItem(this.tableMSItems[b].name);this.tableMSButton.setActiveItem();if(this.activeTable)for(b=0;b<this.tableConfig.length;b++)this.activeTable.obj.hasClass(this.tableConfig[b].cssClass)&&
this.tableMSButton.setActiveItem(this.tableConfig[b].name)};y.error=function(a){l.Log.error(this,a)};y.debug=function(a){l.Log.debug(this,a)};y.info=function(a){l.Log.info(this,a)};y.log=function(a){l.log("log",this,a)};y.get=function(a){if(this.config[a])return this.config[a];if(this.parameters[a])return this.parameters[a]};y.set=function(a,b){this.config[a]?this.config[a]=b:this.parameters[a]=b};y.makeClean=function(a){var b=this;a.find("table").each(function(){if(b.getTableFromRegistry(this)){(new q(this,
b)).deactivate();f(this).attr("id",null)}})};y.toString=function(){return this.prefix};y.updateFloatingMenuScope=function(){null!=y.activeTable&&null!=y.activeTable.selection.selectionType&&e.setScope(y.name+"."+y.activeTable.selection.selectionType)};y.setActiveCellStyle=function(){var a=false,b;this.cellMSButton.setActiveItem();for(var c=this.selectedOrActiveCells(),d=0;d<this.cellConfig.length;d++)if(f(c[0]).hasClass(this.cellConfig[d].cssClass)){b=this.cellConfig[d].name;a=true;break}f(c).each(function(){f(this).hasClass(b)||
(a=false)});a&&this.cellMSButton.setActiveItem(b)};y.selectedOrActiveCells=function(){var a=this.activeTable.selection.selectedCells;if(!a||a.length<1)return(a=function(){var a=l.Selection.getRangeObject();return l.activeEditable?a.findMarkup(function(){return this.nodeName.toLowerCase()==="td"},l.activeEditable.obj):null}())?[a]:[];return a};g.register(y);c.classes("aloha-table","aloha-table-selectcolumn","aloha-table-selectrow","aloha-cell-selected","aloha-table-cell_active");return y});define("format/nls/i18n",
{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize","button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"Tooltip","button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2",
"button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4","button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Preformatted text","button.title.tooltip":"Title","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",
GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},
ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("format/format-plugin","aloha aloha/plugin aloha/state-override jquery util/arrays util/maps ui/ui ui/toggleButton ui/port-helper-multi-split PubSub i18n!format/nls/i18n i18n!aloha/nls/i18n aloha/selection".split(" "),function(l,f,a,g,c,b,e,k,j,m,d){function p(a){var b=g(".aloha-cell-selected");if(b.length>0){var c=0;b.each(function(){var b=g(this).find("div"),d=b.find(a);if(d.length>0){d.contents().unwrap();c++}b.contents().wrap("<"+
a+"></"+a+">")});c===b.length&&b.find(a).contents().unwrap();return true}return false}function n(a,b){var c=t[b];v.hasOwnProperty(b)&&(c=v[b]);return e.adopt(c,k,{tooltip:d.t("button."+b+".tooltip"),icon:"aloha-icon aloha-icon-"+c,scope:"Aloha.continuoustext",click:function(){p(b)||a.addMarkup(b);return false}})}function s(a,b){return{name:b,tooltip:d.t("button."+b+".tooltip"),iconClass:"aloha-icon "+d.t("aloha-large-icon-"+b),markup:g("<"+b+">"),click:function(){var c;if(p(b))c=false;else{a.changeMarkup(b);
l.activeEditable&&g.browser.mozilla&&l.activeEditable.obj.focus();l.activeEditable&&l.trigger("aloha-format-block")}return c}}}function o(a,b){return{name:b,text:d.t("button."+b+".text"),tooltip:d.t("button."+b+".tooltip"),wide:true,cls:"aloha-ui-multisplit-fullwidth",click:function(){a.removeFormat()}}}function q(a,b,c,d,e){d?x.Utils.Dom.removeMarkup(b,c,e):x.Utils.Dom.addMarkup(b,c);b.select();u(a,l.Selection.getRangeObject())}function r(a,b,c,d){return function(e,j){q(a,j,b,c,d)}}function u(b,
c){var d,e,j,f,k;g.each(b.buttons,function(e,k){var m=false,n=z[k.markup[0].nodeName]||[k.markup[0].nodeName];for(j=0;j<c.markupEffectiveAtStart.length;j++){d=c.markupEffectiveAtStart[j];for(f=0;f<n.length;f++){var p=g("<"+n[f]+">");if(l.Selection.standardTextLevelSemanticsComparator(d,p)){k.handle.setState(true);m=true;a.enabled()&&a.setForLinebreakWithRangeObject(t[n[f].toLowerCase()],c,r(b,p,null,l.activeEditable.obj))}}}m||k.handle.setState(false)});if(b.multiSplitItems.length>0){e=false;for(j=
0;j<c.markupEffectiveAtStart.length&&!e;j++){d=c.markupEffectiveAtStart[j];for(f=0;f<b.multiSplitItems.length&&!e;f++){k=b.multiSplitItems[f];if(k.markup&&l.Selection.standardTextLevelSemanticsComparator(d,k.markup)){b.multiSplitButton.setActiveItem(k.name);e=true}}}e||b.multiSplitButton.setActiveItem(null)}}var x=window.GENTICS,t={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},v={strong:"strong",em:"emphasis",s:"strikethrough2"},
B={u:true,em:true,strong:true,b:true,i:true,cite:true,q:true,code:true,abbr:true,del:true,s:true,sub:true,sup:true},C={p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,pre:true},z={B:["STRONG","B"],I:["EM","I"],STRONG:["STRONG","B"],EM:["EM","I"]};return f.create("format",{config:["b","i","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],availableButtons:["u","strong","del","em","b","i","s","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],hotKey:{formatBold:"ctrl+b",
formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",formatH5:"alt+ctrl+5",formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var a=this;typeof this.settings.hotKey!=="undefined"&&g.extend(true,this.hotKey,this.settings.hotKey);this.initButtons();l.bind("aloha-plugins-loaded",function(){a.initSidebar(l.Sidebar.right)});l.bind("aloha-editable-activated",
function(b,c){a.applyButtonConfig(c.editable.obj);c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatBold,function(){a.addMarkup("b");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatItalic,function(){a.addMarkup("i");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatParagraph,function(){a.changeMarkup("p");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatH1,function(){a.changeMarkup("h1");return false});c.editable.obj.bind("keydown.aloha.format",
a.hotKey.formatH2,function(){a.changeMarkup("h2");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatH3,function(){a.changeMarkup("h3");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatH4,function(){a.changeMarkup("h4");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatH5,function(){a.changeMarkup("h5");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatH6,function(){a.changeMarkup("h6");return false});c.editable.obj.bind("keydown.aloha.format",
a.hotKey.formatPre,function(){a.changeMarkup("pre");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatDel,function(){a.addMarkup("del");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatSub,function(){a.addMarkup("sub");return false});c.editable.obj.bind("keydown.aloha.format",a.hotKey.formatSup,function(){a.addMarkup("sup");return false})});l.bind("aloha-editable-deactivated",function(a,b){b.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(a){var a=
this.getEditableConfig(a),b,c;if(typeof a==="object"){var d=[];g.each(a,function(a,b){typeof a==="number"&&typeof b==="string"||d.push(a)});d.length>0&&(a=d)}this.formatOptions=a;for(b in this.buttons)this.buttons.hasOwnProperty(b)&&(g.inArray(b,a)!==-1?this.buttons[b].handle.show():this.buttons[b].handle.hide());c=this.multiSplitItems.length;for(b=0;b<c;b++)g.inArray(this.multiSplitItems[b].name,a)!==-1?this.multiSplitButton.showItem(this.multiSplitItems[b].name):this.multiSplitButton.hideItem(this.multiSplitItems[b].name)},
initButtons:function(){var a=this;this.buttons={};this.multiSplitItems=[];g.each(this.availableButtons,function(b,c){var d=false;if(typeof b!=="number"&&typeof c!=="string"){d=c;c=b}B[c]?a.buttons[c]={handle:n(a,c),markup:g("<"+c+">",{"class":d||""})}:C[c]?a.multiSplitItems.push(s(a,c)):"removeFormat"===c?a.multiSplitItems.push(o(a,c)):l.log("warn",a,'Button "'+c+'" is not defined')});this.multiSplitButton=j({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:true,scope:"Aloha.continuoustext"});
m.sub("aloha.selection.context-change",function(b){u(a,b.range)})},initSidebar:function(a){var b=this;b.sidebar=a;a.addPanel({id:b.nsClass("sidebar-panel-class"),title:d.t("floatingmenu.tab.format"),content:"",expanded:true,activeOn:this.formatOptions||false,onInit:function(){},onActivate:function(a){var c=this;c.effective=a;if(a[0]){c.format=a[0].nodeName.toLowerCase();var e=g("<div>").attr("class",b.nsClass("target-container")),j=g("<fieldset>");j.append(g("<legend>"+c.format+" "+d.t("format.class.legend")).append(g("<select>")));
e.append(j);var f='<div class="'+b.nsClass("target-container")+'"><fieldset><legend>'+d.t("format.class.legend")+'</legend><select name="targetGroup" class="'+b.nsClass("radioTarget")+'"><option value="">'+d.t("format.class.none")+"</option>";b.config[c.format]&&b.config[c.format]["class"]&&g.each(b.config[c.format]["class"],function(a,b){f=f+('<option value="'+a+'" >'+b+"</option>")});f=f+"</select></fieldset></div>";c=this;this.setContent(f);g(b.nsSel("framename")).live("keyup",function(){g(c.effective).attr("target",
g(this).val().replace('"',"&quot;").replace("'","&#39;"))});c=this;c.effective=a;g(b.nsSel("linkTitle")).val(g(c.effective).attr("title"))}}});a.show()},nsClass:function(){var a=[];g.each(arguments,function(){a.push(this==""?"aloha-format":"aloha-format-"+this)});return g.trim(a.join(" "))},nsSel:function(){var a=[];g.each(arguments,function(){a.push("."+(this==""?"aloha-format":"aloha-format-"+this))});return g.trim(a.join(" "))},addMarkup:function(b){var d=g("<"+b+">"),e=l.Selection.rangeObject,
j=l.activeEditable.obj;if(!(typeof b==="undefined"||b=="")){var f=z[d[0].nodeName]||[d[0].nodeName],k=e.findMarkup(function(){return-1!==c.indexOf(f,this.nodeName)},j);k&&(d=g(k));if(e.isCollapsed()){x.Utils.Dom.extendToWord(e);if(e.isCollapsed()&&a.enabled()){d=r(this,d,k,j);a.setWithRangeObject(t[b],e,d);a.setForLinebreakWithRangeObject(t[b],e,d);return}}q(this,e,d,k,j)}},changeMarkup:function(a){l.Selection.changeMarkupOnSelection(g("<"+a+">"))},removeFormat:function(){var a=["u","strong","em",
"b","i","q","del","s","code","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","quote","blockquote"],b=l.Selection.rangeObject,c;if(this.settings.removeFormats)a=this.settings.removeFormats;if(!b.isCollapsed()){for(c=0;c<a.length;c++)x.Utils.Dom.removeMarkup(b,g("<"+a[c]+">"),l.activeEditable.obj);b.select()}},toString:function(){return"format"}})});define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List",
"button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("list/list-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton i18n!list/nls/i18n i18n!aloha/nls/i18n aloha/engine PubSub".split(" "),function(l,f,a,g,c,b,e,k,j,m,d){function p(a,b){f(a).find(a.nodeName).each(function(){var a=l.Selection.getSelectionTree();n(a,this)&&l.Markup.transformDomObject(this,b,l.Selection.rangeObject)});l.Markup.transformDomObject(a,
b,l.Selection.rangeObject)}function n(a,b){var c=false;f.each(a,function(a,d){if(d.domobj===b&&d.selection!=="none"||n(d.children,b))c=true});return c}var s=window.GENTICS,o=a.create("list",{config:["ul","ol"],transformableElements:{p:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,ul:true,ol:true},init:function(){var a=this;this._orderedListButton=g.adopt("orderedList",e,{tooltip:k.t("button.createolist.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){a.transformList(true)}});
this._unorderedListButton=g.adopt("unorderedList",e,{tooltip:k.t("button.createulist.tooltip"),icon:"aloha-icon aloha-icon-unorderedlist",scope:"Aloha.continuoustext",click:function(){a.transformList(false)}});this._indentListButton=g.adopt("indentList",b,{tooltip:k.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){a.indentList()}});this._outdentListButton=g.adopt("outdentList",b,{tooltip:k.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",
scope:"Aloha.continuoustext",click:function(){a.outdentList()}});c.createScope("Aloha.List","Aloha.continuoustext");d.sub("aloha.selection.context-change",function(b){var c,d=b.range;a._outdentListButton.show(false);a._indentListButton.show(false);a._unorderedListButton.setState(false);a._orderedListButton.setState(false);for(b=0;b<d.markupEffectiveAtStart.length;b++){c=d.markupEffectiveAtStart[b];if(l.Selection.standardTagNameComparator(c,f("<ul></ul>"))){a._unorderedListButton.setState(true);a._outdentListButton.show(true);
a._indentListButton.show(true);break}if(l.Selection.standardTagNameComparator(c,f("<ol></ol>"))){a._orderedListButton.setState(true);a._outdentListButton.show(true);a._indentListButton.show(true);break}}l.activeEditable&&a.applyButtonConfig(l.activeEditable.obj)});l.Markup.addKeyHandler(9,function(b){return a.processTab(b)})},applyButtonConfig:function(a){a=this.getEditableConfig(a);if(l.Selection.rangeObject.unmodifiableMarkupAtStart[0]){f.inArray("ul",a)!=-1&&l.Selection.canTag1WrapTag2(l.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,
"ul")!=-1?this._unorderedListButton.show(true):this._unorderedListButton.show(false);f.inArray("ol",a)!=-1&&l.Selection.canTag1WrapTag2(l.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")!=-1?this._orderedListButton.show(true):this._orderedListButton.show(false)}},processTab:function(a){return a.keyCode===9?a.shiftKey?this.outdentList():this.indentList():true},getStartingDomObjectToTransform:function(){var a=l.Selection.rangeObject,b,c;for(b=0;b<a.markupEffectiveAtStart.length;b++){c=
a.markupEffectiveAtStart[b];if(this.transformableElements[c.nodeName.toLowerCase()])return c}return false},getNearestSelectedListItem:function(){var a=l.Selection.rangeObject,b,c;for(b=0;b<a.markupEffectiveAtStart.length;b++){c=a.markupEffectiveAtStart[b];if(s.Utils.Dom.isListElement(c))return c}return false},transformList:function(a){var b=this.getStartingDomObjectToTransform(),c,d,e,j;this._outdentListButton.show(true);this._indentListButton.show(true);if(!b){l.Selection.changeMarkupOnSelection(f("<p></p>"));
b=this.getStartingDomObjectToTransform();if(!b){if(l.Selection.rangeObject.startContainer.contentEditable){a=a?f("<ol></ol>"):f("<ul></ul>");d=f("<li></li>");a.append(d);e=d.get(0);b=l.getActiveEditable().obj;e.appendChild(document.createTextNode(""));b.append(a);b.focus();a=l.createRange();b=l.getSelection();a.setStart(e.firstChild,0);a.setEnd(e.firstChild,0);b.removeAllRanges();b.addRange(a);l.Selection.updateSelection()}else l.Log.error(this,"Could not transform selection into a list");return}}e=
b.nodeName.toLowerCase();if(e=="ul"&&!a){a=f(b);e=a.parent();if(e.length>0&&s.Utils.Dom.isListElement(e.get(0)))if(e.get(0).nodeName.toLowerCase()==="li"){e.after(a.children());a.remove()}else a.children().unwrap();else{a=f(b);f.each(a.children("li"),function(a,b){j=l.Markup.transformDomObject(b,"p",l.Selection.rangeObject);j.after(j.children("ol,ul"));m.ensureContainerEditable(j.get(0))});a.children().unwrap()}}else if(e=="ul"&&a){p(b,"ol");this.mergeAdjacentLists(f(b))}else if(e=="ol"&&!a){p(b,
"ul");this.mergeAdjacentLists(f(b))}else if(e=="ol"&&a){a=f(b);e=a.parent();if(e.length>0&&s.Utils.Dom.isListElement(e.get(0)))if(e.get(0).nodeName.toLowerCase()==="li"){e.after(a.children());a.remove()}else a.children().unwrap();else{a=f(b);f.each(a.children("li"),function(a,b){j=l.Markup.transformDomObject(b,"p",l.Selection.rangeObject);j.after(j.children("ol,ul"));m.ensureContainerEditable(j.get(0))});a.children().unwrap()}}else{e=l.Selection.rangeObject.getSelectedSiblings(b);a=a?f("<ol></ol>"):
f("<ul></ul>");d=f("<li></li>");a.append(d);f(b).contents().appendTo(d);f(b).replaceWith(a);if(l.Selection.rangeObject.startContainer==b)l.Selection.rangeObject.startContainer=d.get(0);if(l.Selection.rangeObject.endContainer==b)l.Selection.rangeObject.endContainer=d.get(0);if(e){b=false;for(c=0;c<e.length;++c)if(s.Utils.Dom.isBlockLevelElement(e[c])){b&&(b=false);d=l.Markup.transformDomObject(e[c],"li",l.Selection.rangeObject);a.append(d)}else if(!(e[c].nodeType==3&&f.trim(e[c].data).length===0)){if(!b){b=
f("<li></li>");a.append(b);d=b}b.append(e[c])}}this.mergeAdjacentLists(a);e=d.get(0);if(s.Utils.Dom.isEmpty(e)){a=l.createRange();b=l.getSelection();e.appendChild(document.createTextNode(""));a.selectNodeContents(e.lastChild);b.removeAllRanges();b.addRange(a);l.Selection.updateSelection()}}this.refreshSelection()},indentList:function(){var a=this.getNearestSelectedListItem(),b,c,d;if(a){d=f(a).prev("li");if(d.length===0)return false;f(a).parent();c=l.Selection.rangeObject.getSelectedSiblings(a);b=
f(a).parent().clone(false).empty();b.append(a);d.append(b);if(c)for(a=0;a<c.length;++a)b.append(f(c[a]));this.mergeAdjacentLists(b,true);this.refreshSelection();return false}return true},outdentList:function(){var a=this.getNearestSelectedListItem(),b,c,d,e,j;if(a){c=f(a);d=c.parent();b=d.parents("ul,ol");e=d.parent("li");if(b.length>0&&s.Utils.Dom.isListElement(b.get(0))){j=(a=l.Selection.rangeObject.getSelectedSiblings(a))&&a.length>0?f(a[a.length-1]):c;if(j.nextAll("li").length>0){b=d.clone(false).empty();
b.append(j.nextAll());j.append(b)}e.length>0?e.after(c):d.before(c);if(a&&a.length>0)for(b=a.length-1;b>=0;--b)c.after(f(a[b]));d.contents("li").length===0&&d.remove();e.length>0&&e.contents().length===0&&e.remove();this.refreshSelection()}return false}return true},refreshSelection:function(){l.Selection.rangeObject.update();l.Selection.rangeObject.select();l.Selection.updateSelection()},mergeAdjacentLists:function(a,b){for(var c=a.get(0),d;c.previousSibling&&c.previousSibling.nodeType===1&&this.isMergable(c.previousSibling,
c,b);)c=c.previousSibling;for(a=f(c);c.nextSibling&&(c.nextSibling.nodeType===1&&this.isMergable(c.nextSibling,c,b)||c.nextSibling.nodeType===3&&f.trim(c.nextSibling.data).length===0);){d=f(c.nextSibling);c.nextSibling.nodeType==1&&d.contents().appendTo(a);d.remove()}},isMergable:function(a,b,c){return c?a.nodeName.toLowerCase()=="ul"||a.nodeName.toLowerCase()=="ol":a.nodeName==b.nodeName}});m.commands.insertorderedlist={action:function(a,b){o.transformList(true);if(b&&l.Selection.rangeObject){b.startContainer=
l.Selection.rangeObject.startContainer;b.startOffset=l.Selection.rangeObject.startOffset;b.endContainer=l.Selection.rangeObject.endContainer;b.endOffset=l.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(l.Selection.standardTagNameComparator(effectiveMarkup,f("<ul></ul>")))break;if(l.Selection.standardTagNameComparator(effectiveMarkup,f("<ol></ol>")))return true}return false}};
m.commands.insertunorderedlist={action:function(a,b){o.transformList(false);if(b&&l.Selection.rangeObject){b.startContainer=l.Selection.rangeObject.startContainer;b.startOffset=l.Selection.rangeObject.startOffset;b.endContainer=l.Selection.rangeObject.endContainer;b.endOffset=l.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(l.Selection.standardTagNameComparator(effectiveMarkup,
f("<ul></ul>")))return true;if(l.Selection.standardTagNameComparator(effectiveMarkup,f("<ol></ol>")))break}return false}};m.commands.indent={action:function(a,b){o.indentList();if(b&&l.Selection.rangeObject){b.startContainer=l.Selection.rangeObject.startContainer;b.startOffset=l.Selection.rangeObject.startOffset;b.endContainer=l.Selection.rangeObject.endContainer;b.endOffset=l.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return false}};m.commands.outdent={action:function(a,
b){o.outdentList();if(b&&l.Selection.rangeObject){b.startContainer=l.Selection.rangeObject.startContainer;b.startOffset=l.Selection.rangeObject.startOffset;b.endContainer=l.Selection.rangeObject.endContainer;b.endOffset=l.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return false}};return o});define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize",
"floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align","button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title","field.img.label":"URL","field.img.tooltip":"Source","border ":"Add Border to Image","padding.increase ":"Increase Padding","padding.decrease ":"Decrease Padding","size.increase ":"Increase Size",
"size.decrease ":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio","field.img.src.label":"Source","field.img.src.tooltip":"Source"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("image/image-floatingMenu","jquery util/class i18n!image/nls/i18n i18n!aloha/nls/i18n ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field".split(" "),function(l,f,a,
g,c,b,e,k,j){return f.extend({_constructor:function(){},init:function(a){a.floatingMenuControl=this;this.plugin=a;b.createScope(a.name,"Aloha.empty");this._addUIInsertButton();this._addUIMetaButtons();this._addUIResetButton();this._addUIAlignButtons();this._addUIMarginButtons();this._addUICropButtons();this._addUIResizeButtons();this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var b=this.plugin;this._imageCnrRatioButton=c.adopt("imageCnrRatio",k,{tooltip:a.t("button.toggle.tooltip"),
icon:"aloha-icon-cnr-ratio",scope:b.name,click:function(){b.toggleKeepAspectRatio()}});if(b.settings.fixedAspectRatio!==false){this._imageCnrRatioButton.setState(true);b.keepAspectRatio=true}},_addUIResetButton:function(){var b=this.plugin;this._imageCnrResetButton=c.adopt("imageCnrReset",e,{tooltip:a.t("Reset"),icon:"aloha-icon-cnr-reset",scope:b.name,click:function(){b.reset()}})},_addUIInsertButton:function(){var b=this.plugin;this._insertImageButton=c.adopt("insertImage",e,{tooltip:a.t("button.addimg.tooltip"),
icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){b.insertImg()}})},_addUIMetaButtons:function(){var b=this.plugin;this.imgSrcField=j({label:a.t("field.img.src.label"),labelClass:"aloha-image-input-label",tooltip:a.t("field.img.src.tooltip"),name:"imageSource",scope:b.name,valueField:"url"});this.imgSrcField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.imgSrcField.setObjectTypeFilter(b.objectTypeFilter);this.imgTitleField=j({label:a.t("field.img.title.label"),
labelClass:"aloha-image-input-label",tooltip:a.t("field.img.title.tooltip"),name:"imageTitle",scope:b.name,valueField:"name"});this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var b=this.plugin;this._imageAlignLeftButton=c.adopt("imageAlignLeft",e,{tooltip:a.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:b.name,click:function(){var a=l(b.getPluginFocus());a.add(a.parent()).css("float","left")}});this._imageAlignRightButton=c.adopt("imageAlignRight",
e,{tooltip:a.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",scope:b.name,click:function(){var a=l(b.getPluginFocus());a.add(a.parent()).css("float","right")}});this._imageAlignNoneButton=c.adopt("imageAlignNone",e,{tooltip:a.t("button.img.align.none.tooltip"),icon:"aloha-img aloha-image-align-none",scope:b.name,click:function(){var a=l(b.getPluginFocus());a.add(a.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var b=this.plugin;
this._imageIncPaddingButton=c.adopt("imageIncPadding",e,{tooltip:a.t("padding.increase"),icon:"aloha-img aloha-image-padding-increase",scope:b.name,click:function(){l(b.getPluginFocus()).increase("padding")}});this._imageDecPaddingButton=c.adopt("imageDecPadding",e,{tooltip:a.t("padding.decrease"),icon:"aloha-img aloha-image-padding-decrease",scope:b.name,click:function(){l(b.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var e=this.plugin;b.createScope("Aloha.img",["Aloha.global"]);
this._imageCropButton=c.adopt("imageCropButton",k,{tooltip:a.t("Crop"),icon:"aloha-icon-cnr-crop",scope:e.name,click:function(){this.getState()?e.crop():e.endCrop()}})},_addUIResizeButtons:function(){var b=this.plugin;this.imgResizeHeightField=j({label:a.t("height"),labelClass:"aloha-image-input-label",name:"imageResizeHeight",width:50,scope:b.name});this.imgResizeHeightField.maxValue=b.settings.maxHeight;this.imgResizeHeightField.minValue=b.settings.minHeight;this.imgResizeWidthField=j({label:a.t("width"),
labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:b.name});this.imgResizeWidthField.maxValue=b.settings.maxWidth;this.imgResizeWidthField.minValue=b.settings.minWidth},setScope:function(){b.setScope(this.plugin.name)},doLayout:function(){}})});define("image/vendor/jcrop/jquery.jcrop.min",["jquery"],function(l){(function(f){f.Jcrop=function(a,g){function c(a){return""+parseInt(a)+"px"}function b(a){a=f(a).offset();return[a.left,a.top]}function e(a){return[a.pageX-O[0],a.pageY-
O[1]]}function k(a,b){return function(c){if(t.aspectRatio)switch(a){case "e":c[1]=b.y+1;break;case "w":c[1]=b.y+1;break;case "n":c[0]=b.x+1;break;case "s":c[0]=b.x+1}else switch(a){case "e":c[1]=b.y2;break;case "w":c[1]=b.y2;break;case "n":c[0]=b.x2;break;case "s":c[0]=b.x2}L.setCurrent(c);I.update()}}function j(a){var b=a;F.watchKeys();return function(a){L.moveOffset([a[0]-b[0],a[1]-b[1]]);b=a;I.update()}}function m(a){switch(a){case "n":return"sw";case "s":return"nw";case "e":return"nw";case "w":return"ne";
case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function d(a){return function(c){if(t.disabled||"move"==a&&!t.allowMove)return!1;$=!0;var d=e(c);O=b(B);P.setCursor("move"==a?a:a+"-resize");if("move"==a)P.activateHandlers(j(d),n);else{var d=L.getFixed(),g=m(a),f=L.getCorner(m(g));L.setPressed(L.getCorner(g));L.setCurrent(f);P.activateHandlers(k(a,d),n)}c.stopPropagation();c.preventDefault();return!1}}function p(a){return{x:parseInt(a.x*Q),y:parseInt(a.y*H),x2:parseInt(a.x2*
Q),y2:parseInt(a.y2*H),w:parseInt(a.w*Q),h:parseInt(a.h*H)}}function n(){var a=L.getFixed();a.w>t.minSelect[0]&&a.h>t.minSelect[1]?(I.enableHandles(),I.done()):I.release();P.setCursor(t.allowSelect?"crosshair":"default")}function l(a){L.setCurrent(a);I.update()}function o(){var a=f("<div></div>").addClass(t.baseClass+"-tracker");f.browser.msie&&a.css({opacity:0,backgroundColor:"white"});return a}function q(a){r([a[0]/Q,a[1]/H,a[2]/Q,a[3]/H])}function r(a){L.setPressed([a[0],a[1]]);L.setCurrent([a[2],
a[3]]);I.update()}function u(a){"object"!=typeof a&&(a={});t=f.extend(t,a);"function"!==typeof t.onChange&&(t.onChange=function(){});"function"!==typeof t.onSelect&&(t.onSelect=function(){})}function x(a){t.allowResize?a?I.enableOnly():I.enableHandles():I.disableHandles();P.setCursor(t.allowSelect?"crosshair":"default");I.setCursor(t.allowMove?"move":"default");A.css("backgroundColor",t.bgColor);"setSelect"in t&&(q(g.setSelect),I.done(),delete t.setSelect);"trueSize"in t&&(Q=t.trueSize[0]/C,H=t.trueSize[1]/
z);Y=t.maxSize[0]||0;X=t.maxSize[1]||0;V=t.minSize[0]||0;G=t.minSize[1]||0;"outerImage"in t&&(B.attr("src",t.outerImage),delete t.outerImage);I.refresh()}"object"!==typeof a&&(a=f(a)[0]);"object"!==typeof g&&(g={});"trackDocument"in g||(g.trackDocument=f.browser.msie?!1:!0,f.browser.msie&&"8"==f.browser.version.split(".")[0]&&(g.trackDocument=!0));"keySupport"in g||(g.keySupport=f.browser.msie?!1:!0);var t={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,borderOpacity:0.4,
handleOpacity:0.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}};u(g);var v=f(a),B=v.clone().removeAttr("id").css({position:"absolute"});B.width(v.width());B.height(v.height());v.after(B).hide();(function(a,b,
c){var d=a.width(),e=a.height();if(d>b&&b>0){d=b;e=b/a.width()*a.height()}if(e>c&&c>0){e=c;d=c/a.height()*a.width()}Q=a.width()/d;H=a.height()/e;a.width(d).height(e)})(B,t.boxWidth,t.boxHeight);var C=B.width(),z=B.height(),A=f("<div />").width(C).height(z).addClass(t.baseClass+"-holder").css({position:"relative",backgroundColor:t.bgColor}).insertAfter(v).append(B);t.addClass&&A.addClass(t.addClass);var E=f("<img />").attr("src",B.attr("src")).css("position","absolute").width(C).height(z),K=f("<div />").width("100%").height("100%").css({zIndex:310,
position:"absolute",overflow:"hidden"}).append(E),U=f("<div />").width("100%").height("100%").css("zIndex",320),y=f("<div />").css({position:"absolute",zIndex:300}).insertBefore(B).append(K,U),S=t.boundary,D=o().width(C+2*S).height(z+2*S).css({position:"absolute",top:c(-S),left:c(-S),zIndex:290}).mousedown(function(a){if(t.disabled||!t.allowSelect)return false;$=true;O=b(B);I.disableHandles();if("crosshair"!=W){P.setCursor("crosshair");W="crosshair"}var c=e(a);L.setPressed(c);P.activateHandlers(l,
n);F.watchKeys();I.update();a.stopPropagation();a.preventDefault();return false}),Y,X,V,G,Q,H,O=b(B),$,W,fa,ha,L=function(){function a(){if(!t.aspectRatio){var b=g-e,k=f-j;Y&&Math.abs(b)>Y&&(g=b>0?e+Y:e-Y);X&&Math.abs(k)>X&&(f=k>0?j+X:j-X);G&&Math.abs(k)<G&&(f=k>0?j+G:j-G);V&&Math.abs(b)<V&&(g=b>0?e+V:e-V);if(e<0){g=g-e;e=e-e}if(j<0){f=f-j;j=j-j}if(g<0){e=e-g;g=g-g}if(f<0){j=j-f;f=f-f}if(g>C){b=g-C;e=e-b;g=g-b}if(f>z){b=f-z;j=j-b;f=f-b}if(e>C){b=e-z;f=f-b;j=j-b}if(j>z){b=j-z;f=f-b;j=j-b}return d(c(e,
j,g,f))}var b=t.aspectRatio,k=t.minSize[0]/Q,m=t.maxSize[0]/Q,n=g-e,p=f-j,l=Math.abs(n),o=Math.abs(p);m==0&&(m=C*10);if(l/o<b){l=f;w=o*b;o=n<0?e-w:w+e;if(o<0){o=0;h=Math.abs((o-e)/b);l=p<0?j-h:h+j}else if(o>C){o=C;h=Math.abs((o-e)/b);l=p<0?j-h:h+j}}else{o=g;h=l/b;l=p<0?j-h:j+h;if(l<0){l=0;w=Math.abs((l-j)*b);o=n<0?e-w:w+e}else if(l>z){l=z;w=Math.abs(l-j)*b;o=n<0?e-w:w+e}}if(o>e){o-e<k?o=e+k:o-e>m&&(o=e+m);l=l>j?j+(o-e)/b:j-(o-e)/b}else if(o<e){e-o<k?o=e-k:e-o>m&&(o=e-m);l=l>j?j+(e-o)/b:j-(e-o)/b}if(o<
0){e=e-o;o=0}else if(o>C){e=e-(o-C);o=C}if(l<0){j=j-l;l=0}else if(l>z){j=j-(l-z);l=z}return last=d(c(e,j,o,l))}function b(a){a[0]<0&&(a[0]=0);a[1]<0&&(a[1]=0);a[0]>C&&(a[0]=C);a[1]>z&&(a[1]=z);return[a[0],a[1]]}function c(a,b,d,e){var j=a,g=d,f=b,k=e;if(d<a){j=d;g=a}if(e<b){f=e;k=b}return[Math.round(j),Math.round(f),Math.round(g),Math.round(k)]}function d(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var e=0,j=0,g=0,f=0,k,m;return{flipCoords:c,setPressed:function(a){a=b(a);g=e=
a[0];f=j=a[1]},setCurrent:function(a){a=b(a);k=a[0]-g;m=a[1]-f;g=a[0];f=a[1]},getOffset:function(){return[k,m]},moveOffset:function(a){var b=a[0],a=a[1];0>e+b&&(b=b-(b+e));0>j+a&&(a=a-(a+j));z<f+a&&(a=a+(z-(f+a)));C<g+b&&(b=b+(C-(g+b)));e=e+b;g=g+b;j=j+a;f=f+a},getCorner:function(b){var c=a();switch(b){case "ne":return[c.x2,c.y];case "nw":return[c.x,c.y];case "se":return[c.x2,c.y2];case "sw":return[c.x,c.y2]}},getFixed:a}}(),I=function(){function a(b){b=f("<div />").css({position:"absolute",opacity:t.borderOpacity}).addClass(t.baseClass+
"-"+b);K.append(b);return b}function b(a,c){var e=f("<div />").mousedown(d(a)).css({cursor:a+"-resize",position:"absolute",zIndex:c});U.append(e);return e}function e(a){var d=t.handleSize,j=C,g=d;switch(a){case "n":case "s":d="100%";break;case "e":case "w":g="100%"}return b(a,u++).width(d).height(g).css({top:c(-j+1),left:c(-j+1)})}function j(a){for(i in a)v[a[i]]=b(a[i],u++).css({top:c(-C+1),left:c(-C+1),opacity:t.handleOpacity}).addClass(t.baseClass+"-handle")}function g(a){var b=Math.round(a.h/
2-C),d=Math.round(a.w/2-C);west=-C+1;var e=a.w-C,a=a.h-C;"e"in v&&v.e.css({top:c(b),left:c(e)})&&v.w.css({top:c(b)})&&v.s.css({top:c(a),left:c(d)})&&v.n.css({left:c(d)});"ne"in v&&v.ne.css({left:c(e)})&&v.se.css({top:c(a),left:c(e)})&&v.sw.css({top:c(a)});"b"in v&&v.b.css({top:c(a)})&&v.r.css({left:c(e)})}function k(){var a=L.getFixed();L.setPressed([a.x,a.y]);L.setCurrent([a.x2,a.y2]);m()}function m(){if(r)return n()}function n(){var a=L.getFixed(),b=a.h;y.width(a.w).height(b);var b=a.x,d=a.y;E.css({top:c(-d),
left:c(-b)});y.css({top:c(d),left:c(b)});t.drawBorders&&x.right.css({left:c(a.w-1)})&&x.bottom.css({top:c(a.h-1)});A&&g(a);if(!r){y.show();B.css("opacity",t.bgOpacity);r=true}t.onChange(p(a))}function l(){A=true;if(t.allowResize){g(L.getFixed());U.show();return true}}function q(){A=false;U.hide()}function s(a){(fa=a)?q():l()}var r,u=370,x={},v={},A=false,C=t.handleOffset;t.drawBorders&&(x={top:a("hline").css("top",f.browser.msie?c(-1):c(0)),bottom:a("hline"),left:a("vline"),right:a("vline")});if(t.dragEdges){v.t=
e("n");v.b=e("s");v.r=e("e");v.l=e("w")}t.sideHandles&&j(["n","s","e","w"]);t.cornerHandles&&j(["sw","nw","ne","se"]);var z=o().mousedown(d("move")).css({cursor:"move",position:"absolute",zIndex:360});K.append(z);q();return{updateVisible:m,update:n,release:function(){q();y.hide();B.css("opacity",1);r=false},refresh:k,setCursor:function(a){z.css("cursor",a)},enableHandles:l,enableOnly:function(){A=true},showHandles:function(){if(A){g(L.getFixed());U.show()}},disableHandles:q,animMode:s,done:function(){s(false);
k()}}}(),P=function(){function a(b){c(e(b))}function b(g){g.preventDefault();g.stopPropagation();if($){$=false;d(e(g));t.onSelect(p(L.getFixed()));D.css({zIndex:290});j&&f(document).unbind("mousemove",a).unbind("mouseup",b);c=function(){};d=function(){}}return false}var c=function(){},d=function(){},j=t.trackDocument;j||D.mousemove(a).mouseup(b).mouseout(b);B.before(D);return{activateHandlers:function(e,g){$=true;c=e;d=g;D.css({zIndex:450});j&&f(document).mousemove(a).mouseup(b);return false},setCursor:function(a){D.css("cursor",
a)}}}(),F=function(){function a(b,c,d){if(t.allowMove){L.moveOffset([c,d]);I.updateVisible()}b.preventDefault();b.stopPropagation()}var b=f('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(function(b){if(b.ctrlKey)return true;var c=(ha=b.shiftKey?true:false)?10:1;switch(b.keyCode){case 37:a(b,-c,0);break;case 39:a(b,c,0);break;case 38:a(b,0,-c);break;case 40:a(b,0,c);break;case 27:I.release();break;case 9:return true}return nothing(b)}).blur(function(){b.hide()}),c=f("<div />").css({position:"absolute",
overflow:"hidden"}).append(b);t.keySupport&&c.insertBefore(B);return{watchKeys:function(){if(t.keySupport){b.show();b.focus()}}}}();U.hide();x(!0);S={animateTo:function(a){var b=a[0]/Q,c=a[1]/H,d=a[2]/Q,e=a[3]/H;if(!fa){var a=L.flipCoords(b,c,d,e),b=L.getFixed(),j=initcr=[b.x,b.y,b.x2,b.y2],g=t.animationDelay,f=j[0],k=j[1],d=j[2],e=j[3],m=a[0]-initcr[0],n=a[1]-initcr[1],l=a[2]-initcr[2],p=a[3]-initcr[3],o=0,q=t.swingSpeed;I.animMode(true);var s=function(){return function(){o=o+(100-o)/q;j[0]=f+o/
100*m;j[1]=k+o/100*n;j[2]=d+o/100*l;j[3]=e+o/100*p;o<100?window.setTimeout(s,g):I.done();o>=99.8&&(o=100);r(j)}}();window.setTimeout(s,g)}},setSelect:q,setOptions:function(a){u(a);x()},tellSelect:function(){return p(L.getFixed())},tellScaled:function(){return L.getFixed()},disable:function(){t.disabled=true;I.disableHandles();I.setCursor("default");P.setCursor("default")},enable:function(){t.disabled=false;x()},cancel:function(){I.done();P.activateHandlers(null,null)},focus:F.watchKeys,getBounds:function(){return[C*
Q,z*H]},getWidgetSize:function(){return[C,z]},release:I.release,destroy:function(){A.remove();v.show()}};v.data("Jcrop",S);return S};f.fn.Jcrop=function(a){function g(c){var b=a.useImg||c.src,e=new Image;e.onload=function(){f.Jcrop(c,a)};e.src=b}"object"!==typeof a&&(a={});this.each(function(){if(f(this).data("Jcrop")){if("api"==a)return f(this).data("Jcrop");f(this).data("Jcrop").setOptions(a)}else g(this)});return this}})(l)});define("image/vendor/mousewheel/mousewheel",["jquery"],function(l){(function(f){function a(a){var c=
a||window.event,g=[].slice.call(arguments,1),j=0,m=0,d=0,a=f.event.fix(c);a.type="mousewheel";c.wheelDelta&&(j=c.wheelDelta/120);c.detail&&(j=-c.detail/3);d=j;void 0!==c.axis&&c.axis===c.HORIZONTAL_AXIS&&(d=0,m=-1*j);void 0!==c.wheelDeltaY&&(d=c.wheelDeltaY/120);void 0!==c.wheelDeltaX&&(m=-1*c.wheelDeltaX/120);g.unshift(a,j,m,d);return(f.event.dispatch||f.event.handle).apply(this,g)}var g=["DOMMouseScroll","mousewheel"];if(f.event.fixHooks)for(var c=g.length;c;)f.event.fixHooks[g[--c]]=f.event.mouseHooks;
f.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var b=g.length;b;)this.addEventListener(g[--b],a,!1);else this.onmousewheel=a},teardown:function(){if(this.removeEventListener)for(var b=g.length;b;)this.removeEventListener(g[--b],a,!1);else this.onmousewheel=null}};f.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(l)});define("image/image-plugin","jquery aloha/plugin image/image-floatingMenu i18n!aloha/nls/i18n i18n!image/nls/i18n jqueryui image/vendor/jcrop/jquery.jcrop.min image/vendor/mousewheel/mousewheel".split(" "),
function(l,f,a,g,c){var b=l,e=window.GENTICS,k=window.Aloha,j=false;String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt((""+this).replace(/px$/,"")||0,10)};String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat((""+this).replace(/px$/,"")||0,10)};Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger;Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat;l.extend(true,l.fn,{increase:l.fn.increase||
function(a){var b=l(this),c,e;if(!b.length)return b;c=b.css(a).toFloat();e=Math.round((c||1)*1.2);c===e&&e++;b.css(a,e);return b},decrease:l.fn.decrease||function(a){var b=l(this),c,e;if(!b.length)return b;c=b.css(a).toFloat();e=Math.round((c||0)*0.8);c===e&&e>0&&e--;b.css(a,e);return b}});return f.create("image",{defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:true,fixedAspectRatio:false,autoResize:false,ui:{meta:true,crop:true,resizable:true},handles:"ne, se, sw, nw",
onCropped:function(a,b){k.Log.info("Default onCropped invoked",a,b)},onReset:function(a){k.Log.info("Default onReset invoked",a);return false},onResize:function(a){k.Log.info("Default onResize invoked",a)},onResized:function(a){k.Log.info("Default onResized invoked",a)}},_onCropped:function(a,c){b("body").trigger("aloha-image-cropped",[a,c]);if(this.keepAspectRatio)this.aspectRatioValue=this.imageObj.width()/this.imageObj.height();this.onCropped(a,c)},_onReset:function(a){b("body").trigger("aloha-image-reset",
a);b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());return this.onReset(a)},_onResize:function(a){b("body").trigger("aloha-image-resize",a);b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(a.width());this.onResize(a)},_onResized:function(a){b("body").trigger("aloha-image-resized",a);b("#"+this.ui.imgResizeHeightField.getInputId()).val(a.height());b("#"+
this.ui.imgResizeWidthField.getInputId()).val(a.width());this.onResized(a)},imageObj:null,jcAPI:null,keepAspectRatio:false,aspectRatioValue:false,restoreProps:[],objectTypeFilter:[],init:function(){k.getPluginUrl("image");if(typeof this.settings.objectTypeFilter!="undefined")this.objectTypeFilter=this.settings.objectTypeFilter;this.config=this.defaultSettings;this.settings=l.extend(true,this.defaultSettings,this.settings);if(typeof this.settings.fixedAspectRatio==="number"){this.aspectRatioValue=
this.settings.fixedAspectRatio;this.keepAspectRatio=true}else this.keepAspectRatio=this.settings.fixedAspectRatio===true?true:false;this.initializeUI();this.bindInteractions();this.subscribeEvents()},initializeUI:function(){this.ui=new a;this.ui.init(this)},bindInteractions:function(){var a=this;if(a.settings.ui.resizable)try{document.execCommand("enableObjectResizing",false,false)}catch(b){k.Log.info(b,"Could not disable enableObjectResizing")}if(a.settings.ui.meta){a.ui.imgSrcField.addListener("keyup",
function(){a.srcChange()});a.ui.imgSrcField.addListener("blur",function(){var b=l(a.ui.imgSrcField.getTargetObject());b.attr("src")===""&&b.remove()})}if(a.settings.onCropped&&typeof a.settings.onCropped==="function")a.onCropped=a.settings.onCropped;if(a.settings.onReset&&typeof a.settings.onReset==="function")a.onReset=a.settings.onReset;if(a.settings.onResized&&typeof a.settings.onResized==="function")a.onResized=a.settings.onResized;if(a.settings.onResize&&typeof a.settings.onResize==="function")a.onResize=
this.settings.onResize},subscribeEvents:function(){var a=this,b=this.settings;l("img").filter(b.globalselector).unbind();l("img").filter(b.globalselector).click(function(b){a.clickImage(b)});k.bind("aloha-drop-files-in-editable",function(b,c){for(var d,j=c.filesObjs.length,g;--j>=0;){g=c.filesObjs[j];if(g.file.type.match(/image\//)){a.getEditableConfig(c.editable);d=l("<img/>");d.css({"max-width":that.maxWidth,"max-height":that.maxHeight});d.attr("id",g.id);typeof g.src==="undefined"?d.attr("src",
g.data):d.attr("src",g.src);e.Utils.Dom.insertIntoDOM(d,c.range,l(k.activeEditable.obj))}}});k.bind("aloha-selection-changed",function(b,c,d){if(d&&d.target&&a.settings.ui.resizable&&!l(d.target).hasClass("ui-resizable-handle")){a.endResize();a.imageObj=null;k.trigger("aloha-image-unselected")}if(k.activeEditable!==null){c=a.findImgMarkup(c);b=a.getEditableConfig(k.activeEditable.obj);if(typeof b!=="undefined"){a.ui._insertImageButton.show();if(c){a.ui._insertImageButton.show();a.ui.setScope();if(a.settings.ui.meta){a.ui.imgSrcField.setTargetObject(c,
"src");a.ui.imgTitleField.setTargetObject(c,"title")}a.ui.imgSrcField.foreground();a.ui.imgSrcField.focus()}else a.settings.ui.meta&&a.ui.imgSrcField.setTargetObject(null);a.ui.doLayout()}else a.ui._insertImageButton.hide()}});k.bind("aloha-editable-created",function(b,c){try{document.execCommand("enableObjectResizing",false,false)}catch(d){k.Log.info(d,"Could not disable enableObjectResizing")}c.obj.delegate("img","mouseup",function(b){if(!j){a.clickImage(b);b.stopPropagation()}})});a._subscribeToResizeFieldEvents()},
autoResize:function(a){var b=l("#"+this.ui.imgResizeWidthField.getInputId()),c=l("#"+this.ui.imgResizeHeightField.getInputId()),e=this.imageObj.width(),j=this.imageObj.height(),g=false;if(e<this.settings.minWidth||e>this.settings.maxWidth||j<this.settings.minHeight||j>this.settings.maxHeight)g=true;var f=e/j;if(g){if(e>this.settings.maxWidth){e=this.settings.maxWidth;j=e/f}if(j>this.settings.maxHeight){j=this.settings.maxHeight;e=j*f}if(e<this.settings.minWidth&&a){e=this.settings.minWidth;j=e/f}if(j<
this.settings.minHeight&&a){j=this.settings.minHeight;e=e*f}b.val(e);c.val(j);this.setSizeByFieldValue();return true}return false},toggleKeepAspectRatio:function(){this.keepAspectRatio=!this.keepAspectRatio;if(!(typeof this.jcAPI!=="undefined"&&this.jcAPI!==null)){this.endResize();this.aspectRatioValue=this.keepAspectRatio?typeof this.settings.fixedAspectRatio!=="number"?this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:false;this.startResize()}},_subscribeToResizeFieldEvents:function(){function a(c){var d=
c.data.fieldName;if(c.keyCode===8||c.keyCode===46)e._updateFields(d,b(this).val(),false)&&(typeof e.jcAPI!=="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():e.setSizeByFieldValue());else if(c.keyCode<=57&&c.keyCode>=48||c.keyCode<=105&&c.keyCode>=96)e._updateFields(d,b(this).val(),false)&&(typeof e.jcAPI!=="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():e.setSizeByFieldValue());else{var j=0;if(c.keyCode===38||c.keyCode===107)j=1;else if(c.keyCode===40||c.keyCode===109)j=-1;if(c.shiftKey||
c.metaKey||c.ctrlKey)j=j*10;var g=false;j<0&&(g=true);j=parseInt(b(this).val(),10)+j;e._updateFields(d,j,g)&&(typeof e.jcAPI!=="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():e.setSizeByFieldValue())}c.preventDefault();return false}function c(a,d){var j=a.data.fieldName;if(a.shiftKey||a.metaKey||a.ctrlKey)d=d*10;var g=parseInt(b(this).val(),10)+d,f=false;d<0&&(f=true);e._updateFields(j,g,f)&&(typeof e.jcAPI!=="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():e.setSizeByFieldValue());
return false}var e=this,j=b("#"+e.ui.imgResizeHeightField.getInputId()),g={fieldName:"height",maxValue:e.ui.imgResizeHeightField.maxValue,minValue:e.ui.imgResizeHeightField.minValue};j.live("keyup",g,a);j.live("mousewheel",g,c);j=b("#"+e.ui.imgResizeWidthField.getInputId());g={fieldName:"width",maxValue:e.ui.imgResizeWidthField.maxValue,minValue:e.ui.imgResizeWidthField.minValue};j.live("keyup",g,a);j.live("mousewheel",g,c)},setSize:function(a,b){this.imageObj.width(a);this.imageObj.height(b);var c=
this.imageObj.closest(".Aloha_Image_Resize");c.height(b);c.width(a);this._onResize(this.imageObj);this._onResized(this.imageObj)},clickImage:function(a){this.endResize();var c=this.imageObj=l(a.target);if(!c.hasClass("aloha-ui")){this.ui.setScope();c.closest(".aloha-editable");this.ui._imageCnrRatioButton.setState(this.keepAspectRatio);this.restoreProps.push({obj:a.srcElement,src:this.imageObj.attr("src"),width:this.imageObj.width(),height:this.imageObj.height()});a=b("#"+this.ui.imgResizeHeightField.getInputId());
a.val(this.imageObj.height());a.css("background-color","");a=b("#"+this.ui.imgResizeWidthField.getInputId());a.val(this.imageObj.width());a.css("background-color","");if(this.settings.ui.meta){this.ui.imgSrcField.setTargetObject(this.imageObj,"src");this.ui.imgTitleField.setTargetObject(this.imageObj,"title")}k.Selection.preventSelectionChanged();try{this.ui.imgSrcField.focus()}catch(e){}this.aspectRatioValue=this.imageObj.width()/this.imageObj.height();this.settings.ui.resizable&&this.startResize();
this.settings.autoResize&&this.autoResize(true);k.Selection.preventSelectionChangedFlag=false;k.trigger("aloha-image-selected")}},findImgMarkup:function(a){var b,c;typeof a==="undefined"&&(a=k.Selection.getRangeObject());c=l(a.startContainer);try{if(k.activeEditable&&(typeof a.startContainer!=="undefined"&&typeof a.startContainer.childNodes!=="undefined"&&typeof a.startOffset!=="undefined"&&typeof a.startContainer.childNodes[a.startOffset]!=="undefined"&&a.startContainer.childNodes[a.startOffset].nodeName.toLowerCase()===
"img"&&a.startOffset+1===a.endOffset||c.hasClass("Aloha_Image_Resize"))){b=c.find("img")[0];if(!b.css)b.css="";if(!b.title)b.title="";if(!b.src)b.src="";return b}}catch(e){k.Log.debug(e,"Error finding img markup.")}return null},getPluginFocus:function(){return this.imageObj},_updateFields:function(a,b,c){var e=null,j=null,g=null,f=null,k=null,u=null,x=null;if(a=="width"){e=l("#"+this.ui.imgResizeWidthField.getInputId());j=l("#"+this.ui.imgResizeHeightField.getInputId());g=1/this.aspectRatioValue;
f=this.settings.minWidth;k=this.settings.maxWidth;u=this.settings.minHeight;x=this.settings.maxHeight}else if(a=="height"){e=l("#"+this.ui.imgResizeHeightField.getInputId());j=l("#"+this.ui.imgResizeWidthField.getInputId());g=this.aspectRatioValue;f=this.settings.minHeight;k=this.settings.maxHeight;u=this.settings.minWidth;x=this.settings.maxWidth}else return false;if(isNaN(b)){e.css("background-color","red");return false}e.val(b);a=true;if(b>k)if(this.settings.autoCorrectManualInput){e.val(k);b=
e.val();e.css("background-color","");a=true}else{e.css("background-color","red");a=false}else if(b<f)if(c){e.val(f);b=e.val();a=true}else{this.settings.autoCorrectManualInput?e.css("background-color","wheat"):e.css("background-color","red");a=false}else{e.css("background-color","");a=true}f=true;if(this.keepAspectRatio){b=Math.round(b*g);if(b>x)if(this.settings.autoCorrectManualInput){j.val(x);e.val(j.val()/g);e.val();e.css("background-color","");j.css("background-color","");f=true}else{b.css("background-color",
"red");f=false}else if(b<u)if(c){j.val(u);e.val(j.val()/g);e.val();a=true}else{if(this.settings.autoCorrectManualInput){j.val(b);j.css("background-color","wheat")}else j.css("background-color","red");f=false}else{j.val(b);j.css("background-color","");f=true}}return a&&f?true:false},setSizeByFieldValue:function(){var a=b("#"+this.ui.imgResizeWidthField.getInputId()).val(),c=b("#"+this.ui.imgResizeHeightField.getInputId()).val();this.setSize(a,c)},setCropAreaByFieldValue:function(){var a=this.jcAPI.tellSelect(),
c=b("#"+this.ui.imgResizeWidthField.getInputId()).val(),c=parseInt(c,10),e=b("#"+this.ui.imgResizeHeightField.getInputId()).val(),e=parseInt(e,10);this.jcAPI.setSelect([a.x,a.y,a.x+c,a.y+e])},insertImg:function(){var a=k.Selection.getRangeObject(),b=this.getEditableConfig(k.activeEditable.obj),c=k.getPluginUrl("image");if(a.isCollapsed()){b="max-width: "+b.maxWidth+"; max-height: "+b.maxHeight;c=l('<img style="'+b+'" src="'+c+'/img/blank.jpg" title="" />');e.Utils.Dom.insertIntoDOM(c,a,l(k.activeEditable.obj))}else k.Log.error("img cannot markup a selection")},
srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var a=l(".jcrop-tracker:first"),b=a.offset(),c=b.top,b=b.left,e=a.height(),a=a.width(),j=l("#aloha-CropNResize-btns");c===0&&b===0&&j.hide();c=parseInt(c+e+3,10);b=parseInt(b+a/2-j.width()/2+10,10);(0!=b||0!=c)&&j.offset({top:c,left:b})},initCropButtons:function(){var a=this,b;l("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+c.t("Accept")+
'"></button><button class="cnr-crop-cancel" title="'+c.t("Cancel")+'"></button></div>');b=l("#aloha-CropNResize-btns");b.find(".cnr-crop-apply").click(function(){a.acceptCrop()});b.find(".cnr-crop-cancel").click(function(){a.endCrop()});this.interval=setInterval(function(){a.positionCropButtons()},10)},destroyCropButtons:function(){l("#aloha-CropNResize-btns").remove();clearInterval(this.interval)},_disableSelection:function(a){a.find("*").attr("unselectable","on").css({"-moz-user-select":"none",
"-webkit-user-select":"none","user-select":"none"})},crop:function(){var a=this;a.initCropButtons();a.settings.ui.resizable&&a.endResize();a.jcAPI=l.Jcrop(a.imageObj,{onSelect:function(){a._onCropSelect();window.setTimeout(function(){a.ui.setScope()},10)}});a._disableSelection(b(".jcrop-holder"));a._disableSelection(b("#imageContainer"));a._disableSelection(b("#aloha-CropNResize-btns"));b("body").trigger("aloha-image-crop-start",[a.imageObj])},_onCropSelect:function(){l("#aloha-CropNResize-btns").fadeIn("slow");
l(".jcrop-handle").mousedown(function(){l("#aloha-CropNResize-btns").hide()});l(".jcrop-tracker").mousedown(function(){l("#aloha-CropNResize-btns").hide()});if(typeof this.jcAPI!=="undefined"&&this.jcAPI!==null){this.positionCropButtons();var a=this.jcAPI.tellSelect();l("#"+this.ui.imgResizeWidthField.getInputId()).val(a.w);l("#"+this.ui.imgResizeHeightField.getInputId()).val(a.h)}},endCrop:function(){if(this.jcAPI){this.jcAPI.destroy();this.jcAPI=null}this.destroyCropButtons();this.ui._imageCropButton.setState(false);
this.settings.ui.resizable&&this.startResize();b("body").trigger("aloha-image-crop-stop",[this.imageObj]);b("#"+this.ui.imgResizeHeightField.getInputId()).val(this.imageObj.height());b("#"+this.ui.imgResizeWidthField.getInputId()).val(this.imageObj.width())},acceptCrop:function(){this._onCropped(this.imageObj,this.jcAPI.tellSelect());this.endCrop()},startResize:function(){var a=this,b=this.imageObj,c=a.keepAspectRatio?a.aspectRatioValue:false,b=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),
position:"relative","max-height":"","max-width":""});b.resizable({maxHeight:a.settings.maxHeight,minHeight:a.settings.minHeight,maxWidth:a.settings.maxWidth,minWidth:a.settings.minWidth,aspectRatio:c,handles:a.settings.handles,grid:a.settings.grid,resize:function(){j=true;a._onResize(a.imageObj)},stop:function(b){j=false;a._onResized(a.imageObj);this.enableCrop&&window.setTimeout(function(){a.ui.setScope();that.done(b)},10)}});b.css("display","inline-block");l(".ui-wrapper").attr("contentEditable",
false).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block","float":a.imageObj.css("float")}).bind("resizestart",function(a){a.preventDefault()}).bind("mouseup",function(a){a.originalEvent.stopSelectionUpdate=true})},endResize:function(){this.imageObj&&this.imageObj.closest(".aloha-editable");this.imageObj&&this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var a=this,b=new Image;b.onload=
function(){var c=a.getPluginFocus();a.settings.ui.resizable&&a.endResize();l(c).add(c.parent()).css({width:b.width+"px",height:b.height+"px","max-width":"","max-height":""});a.settings.ui.resizable&&a.resize()};b.src=a.getPluginFocus().attr("src")},reset:function(){this.settings.ui.crop&&this.endCrop();this.settings.ui.resizable&&this.endResize();if(!this._onReset(this.imageObj))for(var a=0;a<this.restoreProps.length;a++)if(this.imageObj.get(0)===this.restoreProps[a].obj){this.imageObj.attr("src",
this.restoreProps[a].src);this.imageObj.width(this.restoreProps[a].width);this.imageObj.height(this.restoreProps[a].height);break}}})});define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin"],function(l,f,a){var g=window.GENTICS;return a.create("highlighteditables",{config:["highlight"],init:function(){var a=this,b;g.Utils.Position.addMouseMoveCallback(function(){var e,g;for(e=0;e<l.editables.length;e++)g=l.editables[e],b=a.getEditableConfig(g.obj),!l.activeEditable&&
(!g.isDisabled()&&"highlight"==b)&&g.obj.addClass("aloha-editable-highlight")});g.Utils.Position.addMouseStopCallback(function(){a.fade()});l.bind("aloha-editable-activated",function(){a.fade()})},fade:function(){var a,b,e=function(){f(this).css("outline","")};for(a=0;a<l.editables.length;a++)b=l.editables[a].obj,b.hasClass("aloha-editable-highlight")&&b.css("outline",b.css("outlineColor")+" "+b.css("outlineStyle")+" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",
e)}})});define("dom-to-xhtml/dom-to-xhtml","jquery util/dom2 util/misc util/browser aloha/ephemera aloha/console".split(" "),function(l,f,a,g,c,b){function e(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function k(a,b){var d=f.attrs(a),j="",k,m;if(g.ie7)for(var n in s)if(s.hasOwnProperty(n)&&a[n]){k=0;for(m=d.length;k<m;k++)if(n===d[k][0].toLowerCase()){d.splice(k,1);break}d.push([n,n])}k=0;for(m=d.length;k<m;k++){var l=d[k];n=l[0].toLowerCase();l=l[1];if(!b||!c.isAttrEphemeral(a,
n,b.attrMap||{},b.attrRxs||{})){var p=s[n];if(p||""!==l)j=j+(" "+n+'="'+e(p?n:l).replace(/"/g,"&quot;")+'"')}}return j}function j(a){var b=a.nodeName,c=o[b];if(null!=c)return c;for(var d="/"+a.nodeName,a=a.nextSibling,c=false;null!=a;){if(d==a.nodeName){c=true;break}a=a.nextSibling}return o[b]=c}function m(a,b,c,e,g){for(;null!=b;)if(1===b.nodeType&&c&&"/"+a.nodeName==b.nodeName){b=b.nextSibling;break}else if(1===b.nodeType&&j(b))b=d(b,b.nextSibling,true,e,g);else{p(b,e,g);b=b.nextSibling}return b}
function d(a,b,c,d,e){var j=a.nodeName.toLowerCase();a.scopeName&&("HTML"!=a.scopeName&&-1===j.indexOf(":"))&&(j=a.scopeName.toLowerCase()+":"+j);if(!c&&null==b&&n[j])e.push("<"+j+k(a,d)+"/>");else{e.push("<"+j+k(a,d)+">");b=m(a,b,c,d,e);e.push("</"+j+">")}return b}function p(a,c,g){1===a.nodeType?d(a,a.firstChild,j(a),c,g):3===a.nodeType?g.push(e(a.nodeValue)):8===a.nodeType?g.push("<\!--"+a.nodeValue+"--\>"):b.warn("Unknown node type encountered during serialization, ignoring it: type="+a.nodeType+
" name="+a.nodeName+" value="+a.nodeValue)}var n={area:true,base:true,basefont:true,br:true,col:true,frame:true,hr:true,img:true,input:true,isindex:true,link:true,meta:true,param:true,embed:true},s={checked:true,compact:true,declare:true,defer:true,disabled:true,ismap:true,multiple:true,nohref:true,noresize:true,noshade:true,nowrap:true,readonly:true,selected:true},o={DIV:false,SPAN:false,UL:false,OL:false,LI:false,TABLE:false,TR:false,TD:false,TH:false,I:false,B:false,EM:false,STRONG:false,A:false,
P:false};return{contentsToXhtml:function(a,b){var c=[];m(a,a.firstChild,false,b,c);return c.join("")},nodeToXhtml:function(a,b){var c=[];p(a,b,c);return c.join("")}}});define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","aloha/ephemera","dom-to-xhtml/dom-to-xhtml"],function(l,f,a,g,c){return a.create("dom-to-xhtml",{init:function(){var a=this;l.Editable.setContentSerializer(function(e){return!a.settings.editables&&!a.settings.config?c.contentsToXhtml(e):a.settings.editables&&
"dom-to-xhtml"==a.settings.editables["#"+f(e).attr("id")]?c.contentsToXhtml(e,g.ephemera()):a.settings.config&&"dom-to-xhtml"==a.settings.config&&!a.settings.editables["#"+f(e).attr("id")]?c.contentsToXhtml(e,g.ephemera()):f(e).html()})}})});define("contenthandler/contenthandler-utils",["jquery"],function(l){return{wrapContent:function(f){return"string"===typeof f?l("<div>"+f+"</div>"):f instanceof l?l("<div>").append(f):null},isProppedParagraph:function(f){f=l.trim(f);if(!f)return!1;f=l("<div>"+
f+"</div>")[0];return f.firstChild===f.lastChild&&"p"===f.firstChild.nodeName.toLowerCase()?(f=f.firstChild.children)&&1===f.length&&"br"===f[0].nodeName.toLowerCase():!1}}});define("contenthandler/wordcontenthandler","jquery aloha aloha/contenthandlermanager contenthandler/contenthandler-utils util/dom util/dom2 util/arrays util/strings".split(" "),function(l,f,a,g,c,b,e,k){function j(a){switch(a[0].nodeName.toLowerCase()){case "table":return 0===a.find("tbody,tr").length;case "tbody":return 0===
a.find("tr").length;case "tr":return 0===a.find("td,th").length;default:return""===l.trim(a.text())}}function m(a){if(0===a.length||!s.test(a[0].outerHTML))return false;var a=a.find("*"),b,c;for(b=0;b<a.length;b++){if((c=a.eq(b).attr("style"))&&c.toLowerCase().indexOf("mso")>=0)return true;if((c=a.eq(b).attr("class"))&&c.toLowerCase().indexOf("mso")>=0)return true}return false}function d(a){var c=null;e.forEach(f.settings&&f.settings.contentHandler&&f.settings.contentHandler.word&&f.settings.contentHandler.word.preserveStyles||
q,function(d){var e=b.getStyle(a,d);if(!k.empty(e)){c||(c=a.ownerDocument.createElement("SPAN"));b.setStyle(c,d,e)}});return c}function p(a){a.find("p.MsoTitle").each(function(){f.Markup.transformDomObject(l(this),"h1")});a.find("p.MsoSubtitle").each(function(){f.Markup.transformDomObject(l(this),"h2")})}var n=l,s=/mso/,o=/^#(.*)/,q=["font-family","font-size","color","background-color"];return a.createHandler({handleContent:function(a){var b=g.wrapContent(a);if(!b)return a;m(b)&&this.transformWordContent(b);
return b.html()},isOrderedList:function(a){return a.css("fontFamily")=="Wingdings"||a.css("fontFamily")=="Symbol"?false:a.text().match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?true:false},transformListsFromWord:function(a){var b=this,c,d;d=a.find("p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span");d.each(function(){var a=n(this),b=a.css("font-family")||"",c=a.css("mso-list")||"",d=a.attr("style")||"";a.hasClass("MsoListParagraphCxSpFirst")||
a.hasClass("MsoListParagraph")?a.addClass("aloha-list-element"):b.indexOf("Symbol")>=0?a.closest("p").addClass("aloha-list-element"):b.indexOf("Wingdings")>=0?a.closest("p").addClass("aloha-list-element"):c!==""?a.closest("p").addClass("aloha-list-element"):d.indexOf("mso-list")>=0&&a.closest("p").addClass("aloha-list-element")});a.find("p span span span").each(function(){var a=n(this),b;if(n.trim(a.text()).replace(/&nbsp;/g,"").length===0){b=n.trim(a.parent().parent().text()).replace(/&nbsp;/g,"");
if(b.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)){a.closest("p").addClass("aloha-list-element");a.parent().parent().addClass("aloha-list-bullet")}}});d="p.aloha-list-element";c=":not("+d+", font)";d=a.find(d);d.length>0&&d.each(function(){var a=n(this),d,e,j,g,f,k,m,l;a.removeClass("aloha-list-element");a.find("font").each(function(){n(this).contents().unwrap()});l=[];m=parseFloat(a.css("marginLeft"));isNaN(m)&&(m=0);k=[];f=a.nextUntil(c);g=n(a.find("span.aloha-list-bullet"));
g.length===0&&(g=a.find("span").eq(0));j=b.isOrderedList(g);g.remove();e=n(j?"<ol></ol>":"<ul></ul>");k.push(e);d=n("<li></li>");e.append(d);a.contents().appendTo(d);a.replaceWith(e);f.each(function(){var a=n(this),c,f;if(!a.is("font")){a.find("font").each(function(){n(this).contents().unwrap()});c=parseFloat(a.css("marginLeft"));isNaN(c)&&(c=0);g=n(a.find("span.aloha-list-bullet"));g.length===0&&(g=a.find("span").eq(0));j=b.isOrderedList(g);g.remove();if(c>m){f=n(j?"<ol></ol>":"<ul></ul>");e.children(":last").append(f);
e=f;k.push(e);l.push(c);m=c}else if(c<m&&l.length>0){for(;l.length>0&&l[l.length-1]>c;){l.pop();k.pop()}e=k[k.length-1];m=c}d=n("<li></li>");e.append(d);a.contents().appendTo(d);a.remove()}})})},removeParagraphNumbering:function(a){a=a.find("h1,h2,h3,h4,h5,h6");a.length>0&&a.each(function(){var a=n(this),b=a.find("span"),a=a.find("a");b.each(function(){n.trim(n(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&n(this).remove()});a.each(function(){typeof n(this).attr("href")==="undefined"&&n(this).contents().unwrap()})})},
transformToc:function(a){a.find("[class*=MsoToc]").each(function(){var a=n(this),b=a.find("span"),a=a.find("a");b.each(function(){n(this).attr("style")&&n(this).attr("style").search("mso-hide")>-1&&n(this).remove();n(this).contents().unwrap()});a.each(function(){n(this).contents().unwrap()})})},transformWordContent:function(a){this.transformToc(a);this.removeParagraphNumbering(a);this.transformListsFromWord(a);p(a);var a=a.find("*"),c,e,g;for(g=0;g<a.length;g++){e=a.eq(g);c=e[0].nodeName.toLowerCase();
if("a"===c)(c=e.attr("href"))&&o.test(l.trim(c))&&e.contents().unwrap();else if("div"===c)e.contents().unwrap();else if("span"===c)(c=d(e[0]))?b.replaceShallow(e[0],c):b.removeShallow(e[0]);else"td"!==c&&j(e)&&e.contents().unwrap()}}})});define("contenthandler/genericcontenthandler",["jquery","aloha","aloha/contenthandlermanager","contenthandler/contenthandler-utils"],function(l,f,a,g){function c(a){a.find("table").removeAttr("cellpadding").removeAttr("cellspacing").removeAttr("border").removeAttr("border-top").removeAttr("border-bottom").removeAttr("border-left").removeAttr("border-right");
a.find("td").each(function(){var a;(a=l.trim(this.innerHTML))?(a=l("<div>"+a+"</div>")[0],a=a.firstChild===a.lastChild&&"p"===a.firstChild.nodeName.toLowerCase()?(a=a.firstChild.children)&&1===a.length&&"br"===a[0].nodeName.toLowerCase():!1):a=!1;a&&(this.innerHTML="&nbsp;");a=l(">p",this);1===a.length&&a.contents().unwrap()});a.find("td,tr").removeAttr("width").removeAttr("height").removeAttr("valign");a.find("colgroup").remove()}var b=["strong","em","s","u","strike"];return a.createHandler({handleContent:function(a){var b=
g.wrapContent(a);if(!b)return a;if(b.find(".aloha-block").length)return b.html();c(b);this.cleanLists(b);this.removeComments(b);this.unwrapTags(b);this.removeStyles(b);this.removeNamespacedElements(b);a=!0;f.settings.contentHandler&&(f.settings.contentHandler.handler&&f.settings.contentHandler.handler.generic&&"undefinded"!==typeof f.settings.contentHandler.handler.generic.transformFormattings&&!f.settings.contentHandler.handler.generic.transformFormattings)&&(a=!1);a&&this.transformFormattings(b);
return b.html()},cleanLists:function(a){a.find("ul,ol").find(">:not(li)").remove()},transformFormattings:function(a){var c=[],j;for(j=0;j<b.length;j++)(!f.settings.contentHandler||!f.settings.contentHandler.allows||!(f.settings.contentHandler.allows.elements&&-1!==l.inArray(b[j].toLowerCase(),f.settings.contentHandler.allows.elements)))&&c.push(b[j]);a.find(c.join(",")).each(function(){"STRONG"===this.nodeName?f.Markup.transformDomObject(l(this),"b"):"EM"===this.nodeName?f.Markup.transformDomObject(l(this),
"i"):"S"===this.nodeName||"STRIKE"==this.nodeName?f.Markup.transformDomObject(l(this),"del"):"U"===this.nodeName&&l(this).contents().unwrap()})},transformLinks:function(a){a.find("a").each(function(){"undefined"===typeof l(this).attr("href")&&l(this).contents().unwrap()})},removeComments:function(a){var b=this;a.contents().each(function(){8===this.nodeType?l(this).remove():b.removeComments(l(this))})},unwrapTags:function(a){a.find("span,font,div").not(".aloha-wai-lang").each(function(){"DIV"==this.nodeName?
"<br>"===this.innerHTML?l(this).contents().unwrap():l(f.Markup.transformDomObject(l(this),"p").append("<br>")).contents().unwrap():l(this).contents().unwrap()})},removeStyles:function(a){var b=this;a.children("style").filter(function(){return"false"!==this.contentEditable}).remove();a.children().filter(function(){return"false"!==this.contentEditable}).each(function(){l(this).removeAttr("style").removeClass();b.removeStyles(l(this))})},removeNamespacedElements:function(a){a.find("*").each(function(){var a=
this.prefix?this.prefix:this.scopeName?this.scopeName:void 0;if(a&&"HTML"!==a||0<=this.nodeName.indexOf(":")){var a=l(this),b=a.contents();b.length?b.unwrap():a.remove()}})}})});Da.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i;Da.RELATIVE="__relative__";Da.prototype.clean_node=function(l){function f(a,c){var g;for(g=0;g<c.length;g++)if(c[g]==a)return g;return-1}function a(){var a=[],c={},g,j;for(g=0;g<arguments.length;g++)if(arguments[g]&&arguments[g].length)for(j=0;j<arguments[g].length;j++)c[arguments[g][j]]||
(c[arguments[g][j]]=!0,a.push(arguments[g][j]));return a}function g(b){for(var c,k=0;k<this.filters.length;k++)if(!this.filters[k](b)){c=b.cloneNode(!0);this.current_element.appendChild(c);return}switch(b.nodeType){case 1:var j,m,d,l,n,s,o;j=[];k=b;l=!1;for(m=0;m<this.transformers.length;m++)if(d=this.transformers[m]({allowed_elements:this.allowed_elements,config:this.config,node:b,node_name:b.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!=d)if("object"==typeof d){if(d.whitelist_nodes&&
d.whitelist_nodes instanceof Array)for(l=0;l<d.whitelist_nodes.length;l++)-1==f(d.whitelist_nodes[l],this.whitelist_nodes)&&this.whitelist_nodes.push(d.whitelist_nodes[l]);l=d.whitelist?!0:!1;d.attr_whitelist&&(j=a(j,d.attr_whitelist));k=d.node?d.node:k}else throw Error("transformer output must be an object or null");b=this.jQuery;b=b.browser.msie&&"7.0"===b.browser.version;d=k.nodeName.toLowerCase();m=this.current_element;if(this.allowed_elements[d]||l){this.current_element=this.dom.createElement(k.nodeName);
m.appendChild(this.current_element);l=a(this.config.attributes[d],this.config.attributes.__ALL__,j);for(j=0;j<l.length;j++)if(c=l[j],n=k.attributes[c])if(s=!0,this.config.protocols[d]&&this.config.protocols[d][c]&&(s=this.config.protocols[d][c],s=(o=n.nodeValue.toLowerCase().match(Da.REGEX_PROTOCOL))?-1!=f(o[1],s):-1!=f(Da.RELATIVE,s)),s&&(!b||b&&"style"!==c))s=document.createAttribute(c),s.value=n.nodeValue,this.current_element.setAttributeNode(s);if(this.config.add_attributes[d])for(c in this.config.add_attributes[d])if(!b||
b&&"style"!==c)s=document.createAttribute(c),s.value=this.config.add_attributes[d][c],this.current_element.setAttributeNode(s)}else if(-1!=f(k,this.whitelist_nodes)){for(this.current_element=k.cloneNode(!0);0<this.current_element.childNodes.length;)this.current_element.removeChild(this.current_element.firstChild);m.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[d])for(j=0;j<k.childNodes.length;j++)g.call(this,k.childNodes[j]);this.current_element.normalize&&
this.current_element.normalize();this.current_element=m;break;case 3:c=b.cloneNode(!1);this.current_element.appendChild(c);break;case 5:c=b.cloneNode(!1);this.current_element.appendChild(c);break;case 8:this.config.allow_comments&&(c=b.cloneNode(!1),this.current_element.appendChild(c))}}var c=this.dom.createDocumentFragment();this.current_element=c;this.whitelist_nodes=[];for(i=0;i<l.childNodes.length;i++)g.call(this,l.childNodes[i]);c.normalize&&c.normalize();return c};define("vendor/sanitize",function(){});
define("contenthandler/sanitizecontenthandler","aloha/core jquery aloha/contenthandlermanager aloha/plugin aloha/console vendor/sanitize".split(" "),function(l,f,a){function g(a){var b=["restricted","basic","relaxed"],j=l.defaults.supports,j=l.settings.contentHandler.sanitize&&f.inArray(l.settings.contentHandler.sanitize,b)>-1?l.defaults.sanitize[l.settings.contentHandler.sanitize]:l.defaults.sanitize.relaxed;if(l.settings.contentHandler.allows)j=l.settings.contentHandler.allows;a&&(j=a);j.filters=
[function(a){return a.contentEditable!="false"}];c=new Da(j,f)}var c,b=["style","script"];if(!l.defaults.sanitize)l.defaults.sanitize={};l.defaults.sanitize.restricted={elements:["b","em","i","strong","u","del","p","span","div","br"],remove_contents:b};l.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","del","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"],abbr:["title"]},
protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}},remove_contents:b};l.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","del","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","span","hr","object","div"],
attributes:{a:["href","title","id","class","target","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class","data-caption","data-align","data-width","data-original-image"],ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis",
"colspan","rowspan","scope","width"],ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}},remove_contents:b};return a.createHandler({handleContent:function(a){var b,j;if(l.activeEditable&&l.settings.contentHandler&&l.settings.contentHandler.handler&&l.settings.contentHandler.handler.sanitize){if(l.settings.contentHandler.handler.sanitize)j=
l.settings.contentHandler.handler.sanitize;if(typeof j["#"+l.activeEditable.getId()]!=="undefined")b=j;else for(var m=l.activeEditable.obj.attr("class").split(" "),d=0;d<m.length;d++)typeof j["."+m[d]]!=="undefined"&&(b=j["."+m[d]])}(typeof c==="undefined"||typeof b!=="undefined")&&g(b);typeof a==="string"?a=f("<div>"+a+"</div>").get(0):a instanceof f&&(a=f("<div>").append(a).get(0));return f("<div>").append(c.clean_node(a)).html()}})});define("contenthandler/blockelementcontenthandler","jquery aloha/core aloha/contenthandlermanager contenthandler/contenthandler-utils util/functions util/html".split(" "),
function(l,f,a,g,c,b){function e(a,c){var d=b.findNodeRight(c.lastChild,s);d&&"br"===d.nodeName.toLowerCase()&&l(d).remove()}function k(a,b){var c=l(b);c.filter(p).remove();if(l.browser.msie){c.filter("br.aloha-end-br").remove();c.filter(d).each(e)}c.children(n).each(k)}function j(a,b){var c=l(b);c.filter(p).append("​");c.children(n).each(j)}function m(a,b){var c=l(b);c.filter(p).append("<br/>");c.children(n).each(m)}var d=b.BLOCKLEVEL_ELEMENTS.join(),p=b.BLOCKLEVEL_ELEMENTS.join(":empty,")+":empty",
n=":not(.aloha-block)",s=c.complement(b.isIgnorableWhitespace);return a.createHandler({handleContent:function(a,b){if(!b)return a;var c=g.wrapContent(a);if(!c)return a;switch(b.command){case "initEditable":c.children(n).each(k);l.browser.msie&&l.browser.version<=7&&c.children(n).each(j);break;case "getContents":c.children(n).each(m)}return c.html()}})});define("contenthandler/contenthandler-plugin","jquery aloha/plugin aloha/contenthandlermanager contenthandler/wordcontenthandler contenthandler/genericcontenthandler contenthandler/sanitizecontenthandler contenthandler/blockelementcontenthandler".split(" "),
function(l,f,a,g,c,b,e){var k={word:g,generic:c,sanitize:b,blockelement:e};return f.create("contenthandler",{init:function(){for(var b in k)k.hasOwnProperty(b)&&a.register(b,k[b])}})});define("characterpicker/nls/i18n",{root:{"button.addcharacter.tooltip":"pick special characters"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("characterpicker/characterpicker-plugin","aloha jquery aloha/plugin ui/ui ui/button ui/floating PubSub i18n!characterpicker/nls/i18n".split(" "),function(l,
f,a,g,c,b,e,k){function j(a){a.$element.click(function(a){a.stopPropagation()});f("body").click(function(b){a._overlayActive&&!(b.target===a.$element[0]||f(b.target).is(".aloha-icon-characterpicker")||f(b.target).find(".aloha-icon-characterpicker").length)&&a.hide()})}function m(a){u.keyup(function(b){27===b.keyCode&&a.$element.css("display")==="table"&&a.hide()})}function d(a,b,c){var d=function(a){return a.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()})};(a=a.currentStyle?a.currentStyle[d(c)]:
document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,null).getPropertyValue(c):a.style[d(c)])&&b.css(c,a)}function p(a,b){var c={13:function(c){a.hide();b(c.text())},37:function(a){var b=a.prev();if(b.length){b.addClass("focused");a.removeClass("focused")}},38:function(a){var b=a.parent().prev();b.length&&f(b.children()[a.index()]).addClass("focused").length&&a.removeClass("focused")},39:function(a){a.next().addClass("focused").length&&a.removeClass("focused")},
40:function(a){var b=a.parent().next();b.length&&f(b.children()[a.index()]).addClass("focused").length&&a.removeClass("focused")}};u.keydown(function(b){b.stopPropagation();if(c[b.keyCode]&&a.$element.css("display")==="table"){c[b.keyCode](a.$element.find(".focused"));return false}})}function n(a,b){var c=document.createElement("textarea");c.innerHTML=b;for(var c=f.grep(c.value.split(" "),function(a){return""!==a}),d=["<tr>"],e=0,j;j=c[e];){0!==e&&0===e%15&&d.push("</tr><tr>");d.push('<td unselectable="on">'+
j+"</td>");e++}d.push("</tr>");a.$tbody.empty().append(d.join(""));a.$element.delegate("td","mouseover",function(){a.$element.find(".focused").removeClass("focused");f(this).addClass("focused")}).delegate("td","mouseout",function(){f(this).removeClass("focused")}).delegate("td","click",function(){a.$element.hide();a.onSelect(f(this).text())})}function s(a){a=a.offset();if("fixed"===b.POSITION_STYLE){a.top=a.top-x.scrollTop();a.left=a.left-x.scrollLeft()}return a}function o(a){if(l.activeEditable){t.select();
l.execCommand("insertHTML",false,a);t.endContainer=t.startContainer;t.endOffset=++t.startOffset;t.select()}}function q(a){var b=this;b.$element=f('<table class="aloha-character-picker-overlay" unselectable="on" role="dialog"><tbody></tbody></table>');b.$element.mousedown(function(){return false});b.onSelect=a;b.$tbody=b.$element.find("tbody");b.$element.appendTo(f("body"));j(b);m(b);p(b,a);l.bind("aloha-editable-deactivated",function(){b.hide()})}function r(a,b){var c=a.getEditableConfig(b.obj);if(!c)return null;
var c=f.isArray(c)?c.join(" "):c,d=v[c];if(!d){d=new q(o);n(d,c);v[c]=d}return d}var u=f(document),x=f(window),t,v={};q.prototype={show:function(a){this.$element.css(s(a)).css("position",b.POSITION_STYLE).show().find(".focused").removeClass("focused");this.$element.find("td").eq(0).addClass("focused");this._overlayActive=true},hide:function(){this.$element.hide();this._overlayActive=false}};return a.create("characterpicker",{settings:{},config:"&#38; &#34; &#162; &#8364; &#163; &#165; &#169; &#174; &#8482; &#8240; &#181; &#183; &#8226; &#8230; &#8242; &#8243; &#167; &#182; &#223; &#8249; &#8250; &#171; &#187; &#8216; &#8217; &#8220; &#8221; &#8218; &#8222; &#60; &#62; &#8804; &#8805; &#8211; &#8212; &#175; &#8254; &#164; &#166; &#168; &#161; &#191; &#710; &#732; &#176; &#8722; &#177; &#247; &#8260; &#215; &#185; &#178; &#179; &#188; &#189; &#190; &#402; &#8747; &#8721; &#8734; &#8730; &#8764; &#8773; &#8776; &#8800; &#8801; &#8712; &#8713; &#8715; &#8719; &#8743; &#8744; &#172; &#8745; &#8746; &#8706; &#8704; &#8707; &#8709; &#8711; &#8727; &#8733; &#8736; &#180; &#184; &#170; &#186; &#8224; &#8225; &#192; &#193; &#194; &#195; &#196; &#197; &#198; &#199; &#200; &#201; &#202; &#203; &#204; &#205; &#206; &#207; &#208; &#209; &#210; &#211; &#212; &#213; &#214; &#216; &#338; &#352; &#217; &#218; &#219; &#220; &#221; &#376; &#222; &#224; &#225; &#226; &#227; &#228; &#229; &#230; &#231; &#232; &#233; &#234; &#235; &#236; &#237; &#238; &#239; &#240; &#241; &#242; &#243; &#244; &#245; &#246; &#248; &#339; &#353; &#249; &#250; &#251; &#252; &#253; &#254; &#255; &#913; &#914; &#915; &#916; &#917; &#918; &#919; &#920; &#921; &#922; &#923; &#924; &#925; &#926; &#927; &#928; &#929; &#931; &#932; &#933; &#934; &#935; &#936; &#937; &#945; &#946; &#947; &#948; &#949; &#950; &#951; &#952; &#953; &#954; &#955; &#956; &#957; &#958; &#959; &#960; &#961; &#962; &#963; &#964; &#965; &#966; &#967; &#968; &#969; &#8501; &#982; &#8476; &#977; &#978; &#8472; &#8465; &#8592; &#8593; &#8594; &#8595; &#8596; &#8629; &#8656; &#8657; &#8658; &#8659; &#8660; &#8756; &#8834; &#8835; &#8836; &#8838; &#8839; &#8853; &#8855; &#8869; &#8901; &#8968; &#8969; &#8970; &#8971; &#9001; &#9002; &#9674; &#9824; &#9827; &#9829; &#9830;",
_constructor:function(){this._super("characterpicker")},init:function(){function a(c){if(c<l.editables.length){r(b,l.editables[c]);setTimeout(function(){a(c+1)},100)}}var b=this;if(l.settings.plugins&&l.settings.plugins.characterpicker)b.settings=l.settings.plugins.characterpicker;var j=g.adopt("characterPicker",c,{tooltip:k.t("button.addcharacter.tooltip"),icon:"aloha-icon-characterpicker",scope:"Aloha.continuoustext",click:function(){if(b.overlay){t=l.Selection.rangeObject;var a=t.startContainer.parentNode,
c=b.overlay.$element;d(a,c,"font-family");d(a,c,"font-weight");d(a,c,"font-style");b.overlay.show(this.element)}}});setTimeout(function(){a(0)},100);l.bind("aloha-editable-activated",function(a,c){b.overlay=r(b,c.editable);b.overlay?j.show():j.hide()});e.sub("aloha.floating.changed",function(){b.overlay&&b.overlay.$element.css(s(j.element))})}})});define("commands/inserthtml","aloha/core jquery aloha/command aloha/selection util/dom aloha/contenthandlermanager aloha/console".split(" "),function(l,
f,a,g,c,b,e){a.register("inserthtml",{action:function(a,j){function g(a){var b=f(a);if(!c.insertIntoDOM(b,j,d,false)){b=b.contents();(c.isBlockLevelElement(a)||c.isListElement(a))&&g(f("<br/>").get(0));for(n=b.length-1;n>=0;--n)g(b[n])}}var d=f(c.getEditingHostOf(j.startContainer)),p=j.commonAncestorContainer,n,s=[],a=b.handleContent(a,{contenthandler:l.settings.contentHandler.insertHtml});if(typeof a==="string")a=f("<div>"+a+"</div>");else if(a instanceof f)a=f("<div>").append(a);else throw"INVALID_VALUE_ERR";
s=a.contents();c.removeRange(j);for(n=s.length-1;n>=0;--n)g(s[n]);s.length>0?j=c.setCursorAfter(s.get(s.length-1)):j.select();c.doCleanup({merge:true,removeempty:true},j,p);try{j.select()}catch(o){e.warn("Error:",o)}}})});define("commands/commands-plugin",["aloha/command","./inserthtml"],function(){});define("block/blockmanager","aloha jquery ui/scopes aloha/observable aloha/registry util/class util/strings util/maps".split(" "),function(l,f,a,g,c,b,e,k){var j=window.GENTICS,m=new (b.extend(g,{defaults:{"aloha-block-type":"DefaultBlock"},
blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:true,_constructor:function(){a.createScope("Aloha.Block");this.blockTypes=new c;this.blocks=new c;this._highlightedBlocks={}},registerEventHandlers:function(){var a=this;this._registerEventHandlersForDeactivatingAlohaBlock();this._registerEventHandlersForDeterminingCurrentlyActiveBlock();this._registerEventHandlersForBlockDeletion();this._registerEventHandlersForCutCopyPaste();this._registerEventHandlersForEditableActivated();
l.bind("aloha-selection-changed",function(b,c){c&&f(c.getCommonAncestorContainer()).parents(".aloha-block").length>0||a._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var a=this;f(document).bind("click",function(b){k.isEmpty(a._highlightedBlocks)||f(b.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length>0||a._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var a=this;this.bind("block-selection-change",
function(b){a._activeBlock=b.length>0?b[0]:null})},_registerEventHandlersForBlockDeletion:function(){var a=this;l.bind("aloha-command-will-execute",function(b,c){var e=c.commandId,j=l.getSelection().getRangeCount()===0||l.getSelection().getRangeCount()===1&&l.getSelection().getRangeAt(0).endContainer===l.getSelection().getRangeAt(0).startContainer&&l.getSelection().getRangeAt(0).endContainer===f("body")[0]||l.getSelection().getRangeCount()===1&&l.getSelection().getRangeAt(0).endContainer===l.getSelection().getRangeAt(0).startContainer&&
l.getSelection().getRangeAt(0).startOffset+1===l.getSelection().getRangeAt(0).endOffset;if(a._activeBlock&&(e==="delete"||e==="forwarddelete")&&j){c.preventDefault=true;a._activeBlock.destroy()}else if(!a._activeBlock&&(e==="delete"||e==="forwarddelete")&&l.getSelection().getRangeCount()===1&&l.getSelection().getRangeAt(0).collapsed===false){var g;g=function(a){for(var b,c=0,d=a.length;c<d;c++){b=a[c];if(b.domobj.nodeType===1){var e=f(b.domobj);b.selection==="full"&&e.is(".aloha-block")?e.remove():
g(b.children)}}};g(l.Selection.getSelectionTree())}});f(window.document).keydown(function(b){if(f(b.target).closest(".aloha-ui").length>0)return true;if(a._activeBlock&&(b.which===46||b.which===8)&&a._activeBlock._isInsideNestedEditable===false){if(f.browser.msie&&parseInt(f.browser.version,10)<=8&&a._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")){a._activeBlock.destroy();b.preventDefault();return false}if(a._activeBlock.shouldDestroy()){a._activeBlock.destroy();
b.preventDefault();return false}}})},_registerEventHandlersForCutCopyPaste:function(){var a=this,b=false,c=false,e=null;f(window.document).keydown(function(e){if(!l.activeEditable||!a._activeBlock||!f.contains(a._activeBlock.$element.get(0),l.activeEditable.obj.get(0))){if(a._activeBlock&&(e.ctrlKey||e.metaKey)&&e.which===67){b=true;a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");j.Utils.Dom.selectDomNode(a._activeBlock.$element[0])}if(a._activeBlock&&(e.ctrlKey||e.metaKey)&&
e.which===88){c=true;a._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");j.Utils.Dom.selectDomNode(a._activeBlock.$element[0])}}});f(window.document).keyup(function(j){if(!c&&b&&(j.which===67||j.which===18||j.which===91)){b=false;a._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block");e&&(e=null)}if(c&&(j.which===67||j.which===18||j.which===88))c=false})},_registerEventHandlersForEditableActivated:function(){var a=this;l.bind("aloha-editable-activated",function(b,
c){if(c.editable){var e=a.getBlock(c.editable.obj.closest(".aloha-block"));e&&e.activate()}})},initializeBlockLevelDragDrop:function(){var a=this;f.each(l.editables,function(b,c){c.obj.data("block-dragdrop",a._dragdropEnabled);a.createBlockLevelSortableForEditableOrBlockCollection(c.obj)});l.bind("aloha-editable-created",function(b,c){c.obj.data("block-dragdrop",a._dragdropEnabled);a.createBlockLevelSortableForEditableOrBlockCollection(c.obj)})},createBlockLevelSortableForEditableOrBlockCollection:function(a){if(!a.hasClass("aloha-block-blocklevel-sortable")){a.addClass("aloha-block-blocklevel-sortable").sortable({revert:100,
handle:".aloha-block-draghandle-blocklevel",connectWith:".aloha-block-blocklevel-sortable.aloha-block-dropzone",disabled:!this._dragdropEnabled,start:function(a,b){b.item.data("block-sort-allowed",b.item.parents(".aloha-block-dropzone").length>0)},change:function(a,b){b.item.data("block-sort-allowed",b.placeholder.parents(".aloha-block-dropzone").length>0)},stop:function(a,b){b.item.data("block-sort-allowed")||f(this).sortable("cancel");b.item.removeData("block-sort-allowed")}});a.get(0).ondragstart=
function(a,b){if(!b||!b.helper||!b.helper.is(".aloha-block"))return false}}},setDragDropState:function(a){this._dragdropEnabled=a},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(b,c){a.createScope("Aloha.Block."+b,"Aloha.Block");this.blockTypes.register(b,c)},_blockify:function(a,b){var c=f(a),e=l.require("block/block-plugin"),j=c[0].tagName.toLowerCase();if(f.inArray(j,e.settings.rootTags)===-1)l.Log.error("block/blockmanager","Blocks can only be created from ["+
e.settings.rootTags.join(", ")+"] element. You passed "+j+".");else{e=this.getConfig(c,b);if(this.blockTypes.has(e["aloha-block-type"])){c=new (this.blockTypes.get(e["aloha-block-type"]))(c,e);c.$element.addClass("aloha-block-"+e["aloha-block-type"]);this.blocks.register(c.getId(),c)}else l.Log.error("block/blockmanager","Block Type "+e["aloha-block-type"]+" not found!")}},_unblockify:function(a){(a=this.getBlock(a))&&a.unblock()},getConfig:function(a,b){var c=a.clone(true),j=c.data(),g={};c.removeData();
for(var k in j)j.hasOwnProperty(k)&&(g[e.camelCaseToDashes(k)]=j[k]);return f.extend({},this.defaults,b,g)},getBlock:function(a){if(typeof a==="object"){a=f(a);a.hasClass("aloha-block-inner")&&(a=a.parent());a=a.attr("id")}return this.blocks.get(a)},_unregisterBlock:function(a){this.blocks.unregister(typeof a==="object"?a.getId():a)},_deactivateHighlightedBlocks:function(){f.each(f.extend({},this._highlightedBlocks),function(a){(a=m.getBlock(a))&&a.deactivate()})},_getHighlightedBlocks:function(){var a=
{};f.each(this.blocks.getEntries(),function(b,c){c.isActive()&&(a[b]=c)});return a},_setHighlighted:function(a){this._highlightedBlocks[a.id]=true},_setUnhighlighted:function(a){delete this._highlightedBlocks[a.id]}}));l.Block=l.Block||{};return l.Block.BlockManager=m});define("block/editormanager",["aloha/registry"],function(l){return new (l.extend({createEditor:function(f){if(!this.has(f.type))throw'Editor for type "'+f.type+'" not found.';return new (this.get(f.type))(f)}}))});define("block/sidebarattributeeditor",
["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(l,f,a,g,c){return new (c.extend({_sidebar:null,init:function(){this._sidebar=a.right.show();f.bind("block-selection-change",this._onBlockSelectionChange,this)},_onBlockSelectionChange:function(a){var c=this;this._sidebar&&l.each(a,function(){var a=this.getSchema(),b=this,f=[];a&&c._sidebar.addPanel({title:b.getTitle(),expanded:!0,onInit:function(){var c=l("<form />");c.submit(function(){return!1});l.each(a,
function(a,e){var k=g.createEditor(e);k.bind("change",function(c){b.attr(a,c)});b.bind("change",function(){k.setValue(b.attr(a))});c.append(k.render());k.setValue(b.attr(a));f.push(k)});this.setContent(c)},deactivate:function(){l.each(f,function(a,b){b._deactivate()});this.isActive=!1;this.effectiveElement=null}})})}}))});define("block/block","aloha jquery block/blockmanager aloha/observable ui/scopes util/class PubSub".split(" "),function(l,f,a,g,c,b,e){function k(a){a=a.closest(".aloha-editable");
return a.length?!!a.data("block-dragdrop"):true}var j=window.GENTICS,g=b.extend(g,{title:null,id:null,$element:null,_currentlyRendering:false,_initialized:false,_isInsideNestedEditable:false,_constructor:function(a,b){var c=this;this.$element=a;if(a.attr("id"))this.id=a.attr("id");else{this.id=j.Utils.guid();a.attr("id",this.id)}a.contentEditable(false);a.addClass("aloha-block");if(this.isDraggable()){a.find("img").attr("draggable","false");a.find("a").attr("draggable","false")}f.each(b,function(a,
b){c._setAttribute(a,b)});this._onElementClickHandler=function(a){if(f(a.target).closest(".aloha-block").get(0)===c.$element.get(0)){c._fixScrollPositionBugsInIE();c.activate(a.target,a)}};this._connectThisBlockToDomElement(a,function(){e.pub("aloha.block.initialized",{block:c})});this._initialized=true},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(a){"dblclick"!==a.type&&!f(a.target).is(".aloha-editable")&&l.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(a,
b){var c=this,d=f(a);this._disconnectFromDomElement();this.$element=d;this.$element.bind("click",this._onElementClickHandler);this.$element.bind("mousedown",this._preventSelectionChangedEventHandler);this.$element.bind("focus",this._preventSelectionChangedEventHandler);this.$element.bind("dblclick",this._preventSelectionChangedEventHandler);this.init(this.$element,function(){window.setTimeout(function(){c._postProcessElementIfNeeded();b&&b()},5)})},_disconnectFromDomElement:function(){if(this.$element){this.$element.unbind("click",
this._onElementClickHandler);this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler);this.$element.unbind("focus",this._preventSelectionChangedEventHandler);this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler)}},_fixScrollPositionBugsInIE:function(){var a=f(window).scrollTop();window.setTimeout(function(){f(window).scrollTop()!==a&&f(window).scrollTop(a)},10)},init:function(a,b){b()},shouldDestroy:function(){var a=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");
return a.hasClass("aloha-block-collection")&&this.$element[0].tagName.toLowerCase()==="div"?true:a.hasClass("aloha-editable")},destroy:function(b){if(this.shouldDestroy()||b===true){var c=this,d=new j.Utils.RangeObject;d.startContainer=d.endContainer=this.$element.parent()[0];d.startOffset=d.endOffset=j.Utils.Dom.getIndexInParent(this.$element[0]);a.trigger("block-delete",this);this.free();var e=this.$element[0].tagName.toLowerCase()==="span";this.$element.fadeOut("fast",function(){c.$element.remove();
a.trigger("block-selection-change",[]);window.setTimeout(function(){e&&d.select()},5)})}},unblock:function(){this.deactivate();this._disconnectFromDomElement();this.$element.removeClass("aloha-block");this.$element.children(".aloha-block-handle").remove();this.free()},free:function(){a._unregisterBlock(this);this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return this.$element[0].tagName.toLowerCase()===
"div"&&this.$element.parents(".aloha-editable,.aloha-block,.aloha-block-collection").first().hasClass("aloha-block-collection")?true:this.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")},activate:function(b,d){var e=[];f.each(a._getHighlightedBlocks(),function(){this.deactivate()});this.$element.attr("data-block-skip-scope")!=="true"&&c.setScope("Aloha.Block."+this.attr("aloha-block-type"));this.$element.addClass("aloha-block-active");this._highlight();e.push(this);
this.$element.parents(".aloha-block").each(function(){var b=a.getBlock(this);if(b){b._highlight();e.push(b)}});if(f(b).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable,.aloha-table-cell_active").first().hasClass("aloha-block")){this._isInsideNestedEditable=false;l.getSelection().removeAllRanges()}else{this._isInsideNestedEditable=true;d&&l.Selection.updateSelection(d)}a.trigger("block-activate",e);a.trigger("block-selection-change",e)},deactivate:function(){var b=this,c=[this];this._unhighlight();
this.$element.parents(".aloha-block").each(function(){c.push(this);b._unhighlight()});this.$element.removeClass("aloha-block-active");a.trigger("block-deactivate",c);a.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},_highlight:function(){this.$element.addClass("aloha-block-highlighted");a._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted");a._setUnhighlighted(this)},_update:function(){var a=
this;if(!this._currentlyRendering&&this._initialized){this._currentlyRendering=true;this.update(this.$element,function(){a._postProcessElementIfNeeded()});this._currentlyRendering=false}},update:function(a,b){b()},_postProcessElementIfNeeded:function(){this.createEditablesIfNeeded();this._checkThatNestedBlocksAreStillConsistent();this._makeNestedBlockCollectionsSortable();this.renderBlockHandlesIfNeeded();if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="span"){this._setupDragDropForInlineElements();
this._disableUglyInternetExplorerDragHandles()}else if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="div"){this._setupDragDropForBlockElements();this._disableUglyInternetExplorerDragHandles()}this._hideDragHandlesIfDragDropDisabled();this._attachDropzoneHighlightEvents()},_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var b=a.getBlock(this);b&&b.$element[0]!==this&&b._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var b=
this;this.$element.find(".aloha-block-collection").each(function(){var c=f(this);c.closest(".aloha-block").get(0)===b.$element.get(0)&&a.createBlockLevelSortableForEditableOrBlockCollection(c)})},_disableUglyInternetExplorerDragHandles:function(){if(f.browser.msie){this.$element.get(0).onresizestart=function(){return false};this.$element.get(0).oncontrolselect=function(){return false};this.$element.get(0).onmovestart=function(){return false}}},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||
this.$element.find(".aloha-block-draghandle").each(function(){var a=f(this);k(a)||a.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var a=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var b=a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];f.each(b,function(a,b){var c=f(b);f(c).each(function(){f(this).data("block-dragdrop")&&f(this).addClass("aloha-block-dropzone")})});f(document).one("mouseup.aloha-block-dropzone",
function(){var b=a.$element.parents(".aloha-editable").first().data("block-dropzones")||[];f.each(b,function(a,b){f(b).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var a=this,b=null,c=false,d=null,e=null,j=function(){if(b){var j=f(b);if(j.is(".aloha-block-dropInlineElementIntoEmptyBlock")){j.children().remove();j.append(d)}else if(j.is(".aloha-block-droppable-right")){j.html(j.html()+" ");j.after(d)}else{j.prev("[data-i]").length>0&&j.prev("[data-i]").html(j.prev("[data-i]").html()+
" ");j.html(" "+j.html());j.before(d)}d.removeClass("ui-draggable").css({left:0,top:0});a._fixScrollPositionBugsInIE()}f(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock");e.droppable("destroy");e=null;c=true},g=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),revert:function(){return b===null||!c},revertDuration:250,stop:function(){f.browser.msie&&7===parseInt(f.browser.version,
10)&&j();f.each(g,function(){a._dd_traverseDomTreeAndRemoveSpans(this)});d=null;g=[]},start:function(){c=false;g=[];f(".aloha-editable").children("p:empty").html("&nbsp;");var k={tolerance:"pointer",addClasses:false,scope:"aloha-block-inlinedragdrop",over:function(c,e){f.inArray(this,g)===-1&&g.push(this);var j=1===f(this).contents().length&&1===f(this).children("br").length;d=e.draggable;if(f(this).is(":empty")||j||f(this).html()==="&nbsp;"){f(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock");
b=this}else{a._dd_traverseDomTreeAndWrapCharactersWithSpans(this);f("span[data-i]",this).droppable({tolerance:"pointer",addClasses:false,scope:"aloha-block-inlinedragdrop",over:function(){b&&f(b).removeClass("aloha-block-droppable");b=this;f(this).addClass("aloha-block-droppable")},out:function(){f(this).removeClass("aloha-block-droppable");b===this&&(b=null)}});f.ui.ddmanager.prepareOffsets(e.draggable.data("draggable"),c)}},out:function(){f(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},
drop:function(){f.browser.msie&&7===parseInt(f.browser.version,10)||j()}};e=f(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)");e.droppable(k);f(".aloha-table-cell-editable").droppable(k)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(a){for(var b,c=0,d=a.childNodes.length;c<d;c++){b=a.childNodes[c];if(b.nodeType===1)if(!~b.className.indexOf("aloha-block")&&b.attributes["data-i"]===void 0)this._dd_traverseDomTreeAndWrapCharactersWithSpans(b);else{if(b.attributes["data-i"])break}else if(b.nodeType===
3){b=this._dd_insertSpans(b);c=c+b;d=d+b}}},_dd_splitText:function(a){for(var a=a.split(/(?=\b)/),b=[],c=false,d=0,e=a.length;d<e;d++)if(/[^\t\n\r ]/.test(a[d]))if(c){b.push(" "+a[d]);c=false}else b.push(a[d]);else c=true;c&&(b[b.length-1]=b[b.length-1]+" ");return b},_dd_insertSpans:function(a){var b=a.nodeValue;if(!/[^\t\n\r ]/.test(b))return 0;for(var c=document.createDocumentFragment(),b=this._dd_splitText(b),d=b.length,e,j,g,k=0,m=0;m<d;m++){j=b[m];if(j.length!==0){g=Math.floor(j.length/2);e=
parseInt(f.browser.version,10);if(f.browser.msie&&(7===e||8===e))g=0;if(g>0){e=document.createElement("span");e.appendChild(document.createTextNode(j.substr(0,g)));e.setAttribute("data-i",m);c.appendChild(e);k++}e=document.createElement("span");j=j.substr(g);e.appendChild(document.createTextNode(j));e.setAttribute("data-i",m);e.setAttribute("class","aloha-block-droppable-right");c.appendChild(e);k++}}a.parentNode.replaceChild(c,a);return k-1},_dd_traverseDomTreeAndRemoveSpans:function(a){var b=[],
c;c=function(a){for(var d=false,e,j,g,f=0,k=a.childNodes.length;f<k;f++){g=a.childNodes[f];if(g.nodeType===1)if(g.attributes["data-i"]!==void 0){if(!d){d=true;e="";j=void 0}if(d){e=e+g.firstChild.nodeValue;j&&b.push(j);j=g}}else{if(d){d=false;j.parentNode.replaceChild(document.createTextNode(e),j)}~g.className.indexOf("aloha-block")||c(g)}}d&&j.parentNode.replaceChild(document.createTextNode(e),j)};c(a);for(var a=0,d=b.length;a<d;a++)b[a].parentNode.removeChild(b[a])},_dd_isDragdropEnabled:function(){return k(this.$element.parent())},
_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&this.$element.children(".aloha-block-draghandle").length===0&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle aloha-cleanme"></span>')},attr:function(a,b,c){var d=this,e=false;if(arguments.length>=
2){if(a.substr(0,12)==="aloha-block-"){l.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+a+")");return}this._getAttribute(a)!==b&&(e=true);this._setAttribute(a,b)}else if(typeof a==="object")f.each(a,function(a,b){if(a.substr(0,12)==="aloha-block-")l.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+a+")");
else{d._getAttribute(a)!==b&&(e=true);d._setAttribute(a,b)}});else return typeof a==="string"?this._getAttribute(a):this._getAttributes();if(e&&!c){this._update();this.trigger("change");l.activeEditable&&l.activeEditable.smartContentChange({type:"block-change"})}return null},_setAttribute:function(a,b){this.$element.attr("data-"+a.toLowerCase(),b)},_getAttribute:function(a){return this.$element.attr("data-"+a.toLowerCase())},_getAttributes:function(){var a={};f.each(this.$element[0].attributes,function(b,
c){if(c.name.substr(0,5)==="data-")a[c.name.substr(5).toLowerCase()]=c.value});return a}}),b=g.extend({update:function(a,b){b()}}),m=g.extend({title:"Debugging",init:function(a,b){this.update(a,b)},update:function(a,b){a.css({display:"block"});var c='<table class="debug-block">';f.each(this.attr(),function(a,b){c=c+("<tr><th>"+a+"</th><td>"+b+"</td></tr>")});c=c+"</table>";a.html(c);b()}}),d=g.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){}});
return{AbstractBlock:g,DefaultBlock:b,DebugBlock:m,EmptyBlock:d}});define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(l,f,a){return f.createHandler({handleContent:function(g){"string"===typeof g?g=l("<div>"+g+"</div>"):g instanceof l&&(g=l("<div>").append(g));0<g.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length&&(g.find(".aloha-block:not([id])").remove(),g.find(".aloha-block + span:empty").remove(),g.find("div:empty").remove(),
g.find("br.Apple-interchange-newline").remove(),g.find(".aloha-block").prev("br").remove(),g.find("div > br:only-child").parent().remove());g.find(".aloha-block").each(function(){var c=l(this),b={},e={};l.each(c[0].attributes,function(a,c){if(c.nodeName!=="id")c.nodeName.match(/^data-/)?e[c.nodeName.substr(5)]=c.nodeValue:b[c.nodeName]=c.nodeValue});var g=GENTICS.Utils.guid(),j=l("<"+this.tagName+"/>").attr(b).attr("id",g).removeClass("aloha-block-active").removeClass("aloha-block").html(c.html());
c.replaceWith(j);window.setTimeout(function(){a._blockify(l("#"+g),e)},50)});return g.html()}})});define("block/editor",["jquery","aloha/observable","util/class"],function(l,f,a){var f=a.extend(f,{schema:null,_constructor:function(a){this.schema=a},render:function(){},getValue:function(){},setValue:function(){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue());this.destroy()}}),a=f.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var a=
l('<div class="aloha-block-editor" />'),b=GENTICS.Utils.guid();a.append(this.renderLabel().attr("id",b));a.append(this.renderFormElement().attr("id",b));return a},renderLabel:function(){var a=l("<label />");a.html(this.schema.label);return a},renderFormElement:function(){var a=this;this._$formInputElement=l(this.formInputElementDefinition);this.afterRenderFormElement(this._$formInputElement);this._$formInputElement.change(function(){a.trigger("change",a.getValue())});return this._$formInputElement},
afterRenderFormElement:function(){},getValue:function(){return this._$formInputElement.val()},setValue:function(a){this._$formInputElement.val(a)},destroy:function(){this._$formInputElement.remove()}}),g=a.extend({formInputElementDefinition:'<input type="text" />'}),c=a.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(a){this.schema.range&&(this.schema.range.min&&a.attr("min",this.schema.range.min),this.schema.range.max&&a.attr("max",this.schema.range.max),
this.schema.range.step&&a.attr("step",this.schema.range.step))}}),b=a.extend({formInputElementDefinition:'<input type="url" />'}),e=a.extend({formInputElementDefinition:'<input type="email" />'}),k=a.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(a){l.each(this.schema.values,function(){a.append(l("<option />").attr("value",this.key).html(this.label))})}}),j=a.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(a){var b=this;a.html(this.schema.buttonLabel);
a.click(function(){b.schema.callback()})}});return{AbstractEditor:f,AbstractFormElementEditor:a,StringEditor:g,NumberEditor:c,UrlEditor:b,EmailEditor:e,SelectEditor:k,ButtonEditor:j}});define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("block/block-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager block/blockmanager block/sidebarattributeeditor block/block block/editormanager block/blockcontenthandler block/editor ui/ui ui/toggleButton i18n!block/nls/i18n i18n!aloha/nls/i18n jqueryui".split(" "),
function(l,f,a,g,c,b,e,k,j,m,d,p,n){var s=["div","span"],f=f.create("block",{config:[],settings:{},init:function(){var a=this;if(!this.settings.rootTags)this.settings.rootTags=s;c.registerBlockType("DebugBlock",e.DebugBlock);c.registerBlockType("DefaultBlock",e.DefaultBlock);c.registerBlockType("EmptyBlock",e.EmptyBlock);k.register("string",m.StringEditor);k.register("number",m.NumberEditor);k.register("url",m.UrlEditor);k.register("email",m.EmailEditor);k.register("select",m.SelectEditor);k.register("button",
m.ButtonEditor);g.register("block",j);c.setDragDropState(a.isDragDropEnabled());c.registerEventHandlers();c.initializeBlockLevelDragDrop();l.bind("aloha-plugins-loaded",function(){a._createBlocks();false!==a.settings.sidebarAttributeEditor&&b.init()});this.createButtons();l.bind("aloha-editable-created",function(b,c){a.setDropzones(c.obj)});l.bind("aloha-editable-activated",function(b,c){a.applyButtonConfig(c.editable)})},applyButtonConfig:function(a){if(this._isDragdropToggleEnabled(a)){this._toggleDragDropButton.show();
this._toggleDragDropButton.setState(this._getDragdropState(a))}else this._toggleDragDropButton.hide()},_isDragdropToggleEnabled:function(a){a=this.getEditableConfig(a.obj);return(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||a[0]==="toggleDragdrop"||a.toggleDragdrop==true||a.toggleDragdrop=="true"||a.toggleDragdrop==1||a.toggleDragdrop=="1")&&this.isDragDropEnabled()},_getDragdropState:function(a){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?
c.getDragDropState():a.obj.data("block-dragdrop")},_toggleDragdropState:function(a){if(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal){var b=!c.getDragDropState();c.setDragDropState(b);for(var d=0;d<l.editables.length;d++){a=l.editables[d];this._setDragDropStateForEditable(a.obj,b)}}else{b=!a.obj.data("block-dragdrop");this._setDragDropStateForEditable(a.obj,b)}},createButtons:function(){var a=this;this._toggleDragDropButton=d.adopt("toggleDragDrop",p,{tooltip:n.t("button.toggledragdrop.tooltip"),
icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",click:function(){a._toggleDragdropState(l.activeEditable)}})},setDropzones:function(a){var b=this.getEditableConfig(a);(b=b&&b.dropzones||this.settings.dropzones)?a.data("block-dropzones",b):a.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&typeof this.settings.dragdrop!=="undefined"?this.settings.dragdrop===true||this.settings.dragdrop==="true"||this.settings.dragdrop===1||this.settings.dragdrop===
"1":true},_createBlocks:function(){if(!this.settings.defaults)this.settings.defaults={};a.each(this.settings.defaults,function(b,c){a(b).alohaBlock(c)})},_setDragDropStateForEditable:function(b,c){b.data("block-dragdrop",c);b.hasClass("ui-sortable")&&b.sortable("option","disabled",!c);b.find(".aloha-block.ui-draggable").each(function(){a(this).draggable("option","disabled",!c)});b.find(".aloha-block-handle").each(function(){c?a(this).addClass("aloha-block-draghandle"):a(this).removeClass("aloha-block-draghandle")})}});
a.fn.alohaBlock=function(b){b=b||{};a(this).each(function(a,d){c._blockify(d,b)});return a(this)};a.fn.mahaloBlock=function(){a(this).each(function(a,b){c._unblockify(b)})};return f});define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify","button.aligntop.tooltip":"Align to the top","button.alignmiddle.tooltip":"Align to the middle","button.alignbottom.tooltip":"Align to the bottom"},
ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("align/align-plugin","aloha aloha/plugin ui/ui ui/toggleButton i18n!align/nls/i18n i18n!aloha/nls/i18n jquery PubSub".split(" "),function(l,f,a,g,c,b,e,k){var j=window.GENTICS;return f.create("align",{_constructor:function(){this._super("align")},config:{alignment:["right","left","center","justify","top","middle","bottom"]},alignment:"",verticalAlignment:"",lastAlignment:"",lastVerticalAlignment:"",init:function(){this.createButtons();
var a=this;l.bind("aloha-editable-activated",function(b,c){a.applyButtonConfig(c.editable.obj)});k.sub("aloha.selection.context-change",function(b){b=b.range;l.activeEditable&&a.buttonPressed(b)})},buttonPressed:function(a){this.horizontalButtonPressed(a);this.verticalButtonPressed(a)},horizontalButtonPressed:function(a){var b=this;this.lastAlignment=this.alignment;this.alignment="";a.findMarkup(function(){if(this.style.textAlign!==""){b.alignment=this.style.textAlign;return true}b.alignment=e(this).css("text-align")},
l.activeEditable.obj);if(this.alignment!=this.lastAlignment){this._alignRightButton.setState(false);this._alignLeftButton.setState(false);this._alignCenterButton.setState(false);this._alignJustifyButton.setState(false);switch(this.alignment){case "right":this._alignRightButton.setState(true);break;case "center":this._alignCenterButton.setState(true);break;case "justify":this._alignJustifyButton.setState(true);break;default:this._alignLeftButton.setState(true);this.alignment="left"}}},verticalButtonPressed:function(a){var b=
this;this.lastVerticalAlignment=this.verticalAlignment;this.verticalAlignment="";a.findMarkup(function(){if(this.style.verticalAlign!==""){b.verticalAlignment=this.style.verticalAlign;return true}b.verticalAlignment=e(this).css("vertical-align")},l.activeEditable.obj);if(this.verticalAlignment!=this.lastVerticalAlignment){this._alignTopButton.setState(false);this._alignMiddleButton.setState(false);this._alignBottomButton.setState(false);switch(this.verticalAlignment){case "top":this._alignTopButton.setState(true);
break;case "middle":this._alignMiddleButton.setState(true);break;case "bottom":this._alignBottomButton.setState(true);break;default:this._alignTopButton.setState(true);this.verticalAlignment="top"}}},applyButtonConfig:function(a){a=this.getEditableConfig(a);if(!a||!a.alignment||this.settings.alignment)if(a[0]&&a[0].alignment)a=a[0];else if(this.settings.alignment)a.alignment=this.settings.alignment;if(typeof a.alignment==="undefined")a=this.config;e.inArray("right",a.alignment)!=-1?this._alignRightButton.show(true):
this._alignRightButton.show(false);e.inArray("left",a.alignment)!=-1?this._alignLeftButton.show(true):this._alignLeftButton.show(false);e.inArray("center",a.alignment)!=-1?this._alignCenterButton.show(true):this._alignCenterButton.show(false);e.inArray("justify",a.alignment)!=-1?this._alignJustifyButton.show(true):this._alignJustifyButton.show(false);e.inArray("top",a.alignment)!=-1?this._alignTopButton.show(true):this._alignTopButton.show(false);e.inArray("middle",a.alignment)!=-1?this._alignMiddleButton.show(true):
this._alignMiddleButton.show(false);e.inArray("bottom",a.alignment)!=-1?this._alignBottomButton.show(true):this._alignBottomButton.show(false)},createButtons:function(){var b=this;this._alignLeftButton=a.adopt("alignLeft",g,{tooltip:c.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){b.align("left")}});this._alignCenterButton=a.adopt("alignCenter",g,{tooltip:c.t("button.aligncenter.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-center",
scope:"Aloha.continuoustext",click:function(){b.align("center")}});this._alignRightButton=a.adopt("alignRight",g,{tooltip:c.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){b.align("right")}});this._alignJustifyButton=a.adopt("alignJustify",g,{tooltip:c.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",click:function(){b.align("justify")}});
this._alignTopButton=a.adopt("alignTop",g,{tooltip:c.t("button.aligntop.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-top",scope:"table.cell",click:function(){b.verticalAlign("top")}});this._alignMiddleButton=a.adopt("alignMiddle",g,{tooltip:c.t("button.alignmiddle.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-middle",scope:"table.cell",click:function(){b.verticalAlign("middle")}});this._alignBottomButton=a.adopt("alignBottom",g,{tooltip:c.t("button.alignbottom.tooltip"),
icon:"aloha-icon aloha-icon-align aloha-icon-align-bottom",scope:"table.cell",click:function(){b.verticalAlign("bottom")}})},verticalAlign:function(a){var b=l.Selection.getRangeObject();this.lastVerticalAlignment=this.verticalAlignment;this.verticalAlignment=a;(a=this.getSelectedCells(b))&&this.toggleAlign(a,"vertical-align");if(this.verticalAlignment!=this.lastVerticalAlignment)switch(this.lastVerticalAlignment){case "top":this._alignTopButton.setState(false);break;case "middle":this._alignMiddleButton.setState(false);
break;case "bottom":this._alignBottomButton.setState(false)}b.select()},align:function(a){var b=l.Selection.getRangeObject();this.lastAlignment=this.alignment;this.alignment=a;var a=b.getCommonAncestorContainer(),c=this.getSelectedCells(b);if(c)this.toggleAlign(c);else if(j.Utils.Dom.isEditingHost(a)){var g=[];e.each(l.Selection.getRangeObject().getSelectionTree(),function(){this.selection!=="none"&&this.domobj.nodeType!==3&&g.push(this.domobj)});this.toggleAlign(g)}else this.toggleAlign(a);if(this.alignment!=
this.lastAlignment)switch(this.lastAlignment){case "right":this._alignRightButton.setState(false);break;case "left":this._alignLeftButton.setState(false);break;case "center":this._alignCenterButton.setState(false);break;case "justify":this._alignJustifyButton.setState(false)}b.select()},getSelectedCells:function(a){var b,a=a.findMarkup(function(){e(this).is("td,th")&&(b=this);return e(this).is("table.aloha-table")},l.activeEditable.obj),a=e(a).find(".aloha-cell-selected");return a.length?a:b},toggleAlign:function(a,
b){var b=b||"text-align",c=b==="vertical-align"?this.verticalAlignment:this.alignment,j=true;e(a).each(function(){if(e(this).css(b)!=c)return j=false});e(a).each(function(){e(this).css(b)==c&&j?e(this).css(b,""):e(this).css(b,c)})}})});define("abbr/nls/i18n",{root:{"floatingmenu.tab.abbr":"Abbreviation","button.addabbr.tooltip":"insert abbreviation","button.remabbr.tooltip":"remove abbreviation","button.abbr.tooltip":"format as abbreviation","newabbr.defaulttext":"Abbr"},ca:!0,de:!0,mk:!0,"pt-br":!0,
ru:!0,uk:!0,"zh-hans":!0});define("abbr/abbr-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton ui/button ui/scopes ui/port-helper-attribute-field i18n!abbr/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b,e,k,j){var m=window.GENTICS;return a.create("abbr",{config:["abbr"],init:function(){this.createButtons();this.subscribeEvents();this.bindInteractions()},createButtons:function(){var a=this;this._formatAbbrButton=g.adopt("formatAbbr",c,{tooltip:j.t("button.abbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",
scope:"Aloha.continuoustext",click:function(){a.formatAbbr()}});this._insertAbbrButton=g.adopt("insertAbbr",b,{tooltip:j.t("button.addabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){a.insertAbbr(false)}});e.createScope("abbr","Aloha.continuoustext");this.abbrField=k({width:320,name:"abbrText",scope:"abbr"});this.remAbbrButton=g.adopt("removeAbbr",b,{tooltip:j.t("button.remabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr-rem",scope:"abbr",click:function(){a.removeAbbr()}})},
bindInteractions:function(){var a=this;this.abbrField.addListener("blur",function(){this.getValue()==""&&a.removeAbbr()});for(var b=0;b<l.editables.length;b++)l.editables[b].obj.keydown(function(b){if(b.metaKey&&b.which==71){if(a.findAbbrMarkup()){a.abbrField.foreground();a.abbrField.focus()}else a.insertAbbr();b.stopPropagation();b.preventDefault();return false}})},subscribeEvents:function(){var a=this,b={};l.bind("aloha-editable-activated",function(){if(l.activeEditable&&l.activeEditable.obj){var c=
a.getEditableConfig(l.activeEditable.obj);b[l.activeEditable.getId()]=f.inArray("abbr",c)!==-1}});l.bind("aloha-editable-destroyed",function(){l.activeEditable&&l.activeEditable.obj&&delete b[l.activeEditable.getId()]});l.bind("aloha-selection-changed",function(c,j){if(l.activeEditable)if(b[l.activeEditable.getId()]){a._formatAbbrButton.show();a._insertAbbrButton.show();var g=a.findAbbrMarkup(j);if(g){a._insertAbbrButton.hide();a._formatAbbrButton.setState(true);e.setScope("abbr");a.abbrField.setTargetObject(g,
"title")}else{a._formatAbbrButton.setState(false);a.abbrField.setTargetObject(null)}}else{a._formatAbbrButton.hide();a._insertAbbrButton.hide()}})},findAbbrMarkup:function(a){typeof a=="undefined"&&(a=l.Selection.getRangeObject());return l.activeEditable?a.findMarkup(function(){return this.nodeName.toLowerCase()=="abbr"},l.activeEditable.obj):null},formatAbbr:function(){var a=l.Selection.getRangeObject();l.activeEditable&&(this.findAbbrMarkup(a)?this.removeAbbr():this.insertAbbr())},insertAbbr:function(a){var b=
l.Selection.getRangeObject();if(!this.findAbbrMarkup(b)){b.isCollapsed()&&a!=false&&m.Utils.Dom.extendToWord(b);if(b.isCollapsed()){var a=j.t("newabbr.defaulttext"),c=f('<abbr title="">'+a+"</abbr>");m.Utils.Dom.insertIntoDOM(c,b,f(l.activeEditable.obj));b.startContainer=b.endContainer=c.contents().get(0);b.startOffset=0;b.endOffset=a.length}else{c=f('<abbr title=""></abbr>');m.Utils.Dom.addMarkup(b,c,false)}b.select();this.abbrField.foreground();this.abbrField.focus()}},removeAbbr:function(){var a=
l.Selection.getRangeObject(),b=this.findAbbrMarkup();if(b){m.Utils.Dom.removeFromDOM(b,a,true);a.select()}},makeClean:function(){},toString:function(){return"abbr"}})});define("horizontalruler/nls/i18n",{root:{"button.addhr.tooltip":"Add a horizontal ruler"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("horizontalruler/horizontalruler-plugin","aloha jquery aloha/plugin ui/ui ui/button i18n!horizontalruler/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b){var e=window.GENTICS;
return a.create("horizontalruler",{_constructor:function(){this._super("horizontalruler")},config:["hr"],init:function(){var a=this;this._insertHorizontalRuleButton=g.adopt("insertHorizontalRule",c,{tooltip:b.t("button.addhr.tooltip"),iconOnly:true,icon:"aloha-icon-horizontalruler",scope:"Aloha.continuoustext",click:function(){a.insertHR()}});l.bind("aloha-editable-activated",function(){if(l.activeEditable){a.cfg=a.getEditableConfig(l.activeEditable.obj);f.inArray("hr",a.cfg)!=-1?a._insertHorizontalRuleButton.show(true):
a._insertHorizontalRuleButton.show(false)}})},insertHR:function(){var a=l.Selection.getRangeObject();if(l.activeEditable){var b=f("<hr>");e.Utils.Dom.insertIntoDOM(b,a,f(l.activeEditable.obj),true);a.select()}}})});define("paste/paste-plugin","jquery aloha/core aloha/plugin aloha/command contenthandler/contenthandler-utils aloha/console aloha/copypaste".split(" "),function(l,f,a,g,c,b,e){var k,j;function m(a,b){b.css({top:n.scrollTop(),left:n.scrollLeft()-200,width:200,overflow:"hidden"}).contents().remove();
var c=e.getEditableAt(a);c&&c.obj.blur();e.setSelectionAt({startContainer:b[0],endContainer:b[0],startOffset:0,endOffset:0});b.focus()}function d(a,d,g){a.metaKey=null;a.stopPropagation();window.setTimeout(function(){if(d){var m=q.html();s&&/^&nbsp;/.test(m)&&(m=m.substring(6));var n=e.getEditableAt(d);n&&n.obj.focus();e.setSelectionAt(d);window.scrollTo(k,j);n=d.startContainer;if(1===n.nodeType?"p"===n.nodeName.toLowerCase()&&c.isProppedParagraph(n.outerHTML):3===n.nodeType&&"p"===n.parentNode.nodeName.toLowerCase()&&
1===n.parentNode.childNodes.length&&o.test(window.escape(n.data))){3===d.startContainer.nodeType?d.startContainer.data="":d.startContainer.innerHTML=" ";d.startOffset=0;if(d.endContainer===d.startContainer)d.endOffset=0}f.queryCommandSupported("insertHTML")?f.execCommand("insertHTML",false,m):b.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".')}q.contents().remove();typeof g==="function"&&g();f.activeEditable.smartContentChange(a)},10)}function p(a){s?
a.bind("beforepaste",function(a){k=window.scrollX||document.documentElement.scrollLeft;j=window.scrollY||document.documentElement.scrollTop;r=e.getRange();m(r,q);a.stopPropagation()}):a.bind("paste",function(a){k=window.scrollX||document.documentElement.scrollLeft;j=window.scrollY||document.documentElement.scrollTop;var b=e.getRange();m(b,q);s&&document.selection.createRange().execCommand("paste");d(a,b)})}var n=l(window),s=!!l.browser.msie,o=/^(\s|%A0)$/,q=l('<div tabindex="-1" style="position:absolute; clip:rect(0px,0px,0px,0px); width:1px; height:1px;"></div>').contentEditable(true),
r=null;j=k=0;return a.create("paste",{settings:{},init:function(){l("body").append(q);var a=!this.settings.noclipboardaccess;f.bind("aloha-editable-created",function(b,c){p(c.obj,a)});s&&q.bind("paste",function(a){d(a,r,function(){r=null})})},register:function(){b.deprecated("Plugins.Paste","register() for pasteHandler is deprecated.  Use the ContentHandler Plugin instead.")}})});define("toc/nls/i18n",{root:{"button.addtoc.tooltip":"Table of contents"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});
define("toc/toc-plugin","aloha aloha/plugin jquery ui/ui ui/button i18n!toc/nls/i18n i18n!aloha/nls/i18n aloha/console".split(" "),function(l,f,a,g,c,b){function e(a,b){return k(a,function(a){return a===b})}function k(a,b){for(var c=0;c<a.length;c++)if(b(a[c]))return a[c];return null}function j(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));return c}function m(a,b){j(a,b)}function d(){return a(j(l.editables,function(a){return document.getElementById(a.getId())}))}function p(b){var c;typeof b==
"object"?c=a(b).text().replace(/[^a-zA-Z-]+/g,"-").replace(/^[^a-zA-Z]+/,""):b&&(c=b);for(var d=0;;d++){var e=c;d&&(e=e+("-"+d));var j=document.getElementById(e);if(!j||typeof b=="object"&&j===b)return e}}var n=window.GENTICS,s=null,o=[];return f.create("toc",{minEntries:0,updateInterval:5E3,config:["toc"],init:function(){var b=this;if(typeof this.settings.minEntries==="undefined")this.settings.minEntries=this.minEntries;if(typeof this.settings.updateInterval==="undefined")this.settings.updateInterval=
this.updateInterval;l.bind("aloha-editable-activated",function(){if(l.activeEditable){b.cfg=b.getEditableConfig(l.activeEditable.obj);a.inArray("toc",b.cfg)!=-1?b._insertTocButton.show(true):b._insertTocButton.show(false)}});this.initButtons();a(document).ready(function(){b.spawn()})},initButtons:function(){var a=this;this._insertTocButton=g.adopt("insertToc",c,{tooltip:b.t("button.addtoc.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){a.insertAtSelection(s)}})},
register:function(a){s=a},insertAtSelection:function(b){var b=b||d(),c=p("toc"),e=a("<ol class='toc_root'></ol>").attr("id",c).attr("contentEditable","false"),j=l.Selection.getRangeObject(),g=a(document.getElementById(l.activeEditable.getId()));n.Utils.Dom.insertIntoDOM(e,j,g);this.create(c).register(b).update().tickTock()},spawn:function(b,c){b=b||a("body");c=c||d();b.find("ol.toc_root").each(function(){var b=a(this).attr("id");if(!b){b=p("toc");a(this).attr("id",b)}that.create(b).register(c).tickTock()})},
create:function(b){o.push(this);return{id:b,$containers:a(),settings:this.settings,root:function(){return a(document.getElementById(this.id))},register:function(b){var c=this;c.$containers=c.$containers.add(b);c.$containers.filter(function(){return!a(this).data("toc."+c.id+".listening")}).each(function(){var b=a(this);b.data("toc."+c.id+".listening",true);b.bind("blur",function(){c.cleanupIds(b.get(0));c.update(b)})});return c},tickTock:function(a){var b=this;if(a=a||this.settings.updateInterval){window.setInterval(function(){b.register(d());
b.update()},a);return b}},cleanupIds:function(b){var c=[];this.headings(this.$containers).each(function(){var d=a(this).attr("id");(d&&-1!=a.inArray(d,c)||b&&(a.contains(b,this)||b===this))&&a(this).attr("id",p(this));c.push(d)});return this},update:function(){var a=this,b=this.outline(a.$containers),c=[a.root()];c[c.length-1].empty();(function v(b){var d=[];m(b,function(b){var e=a.linkSection(b[0],c,d);c.push(e);v(b.slice(1));c.pop();d.push(e)})})(b.slice(1));b=a.root().attr("data-TOC-minEntries")||
this.settings.minEntries;a.root().find("li").length>=b?a.root().show():a.root().hide();return this},linkSection:function(b,c,d){var e=b.eq(0).attr("id");if(!e){e=p(b.get(0));b.eq(0).attr("id",e)}var j=this.root(),g=e?j.find('a[href $= "#'+e+'"]'):a();g.length||(g=a("<li><a/></li>"));g.find("a").attr("href","#"+e).text(b.eq(0).text());if(d[d.length-1])d[d.length-1].after(g);else if(c[c.length-1].get(0)==j.get(0))j.append(g);else{b=a("<ol/>").append(g);c[c.length-1].append(b)}return g},outline:function(b){var c=
[a()],d=[c];this.headings(b).each(function(){var b=a(this),c=this.nodeName.toLowerCase(),j=["h6","h5","h4","h3","h2","h1"],c=a.inArray(c,j),j=j.slice(c).join(","),j=[b.nextUntil(j).andSelf()],c=k(d,function(c){c=c[0];return!c.length||k(c,function(c){return b.get(0)===c||a.contains(c,b.get(0))})});c.push(j);d.splice(0,e(d,c),j)});return c},headings:function(a){return a.find(":header").add(a.filter(":header"))}}}})});define("cite/nls/i18n",{root:{"cite.button.add.quote":"Format selection as quote",
"cite.button.add.blockquote":"Format selection as blockquote"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("cite/cite-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton format/format-plugin util/dom PubSub i18n!cite/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b,e,k,j){function m(a,b){return a.replace(/\{([a-z0-9\-\_]+)\}/ig,function(a,c){var d=b[c]||a;return typeof d==="function"?d():d})}function d(){var a=[],b=n;f.each(arguments,function(){a.push("."+(""===
this?b:b+"-"+this))});return f.trim(a.join(" "))}function p(){var a=[],b=n;f.each(arguments,function(){a.push(""===this?b:b+"-"+this)});return f.trim(a.join(" "))}var n="aloha-cite",s=(new Date).getTime(),o={quote:p("quote"),blockquote:p("blockquote"),"panel-label":p("panel-label"),"panel-field":p("panel-field"),"panel-btns":p("panel-btns"),"link-field":p("link-field"),"note-field":p("note-field"),references:p("references")};return a.create("cite",{citations:[],referenceContainer:null,settings:null,
sidebar:null,config:["quote","blockquote"],init:function(){var a=this;if(l.settings&&l.settings.plugins&&l.settings.plugins.cite){var e=f(l.settings.plugins.cite.referenceContainer);if(e.length)a.referenceContainer=e;if(typeof l.settings.plugins.cite!=="undefined")a.settings=l.settings.plugins.cite;if(typeof a.settings.sidebar==="undefined")a.settings.sidebar={};if(typeof a.settings.sidebar.open==="undefined")a.settings.sidebar.open=true;if(typeof a.settings.sidebar.open==="string"){a.settings.sidebar.open=
a.settings.sidebar.open.toLowerCase();a.settings.sidebar.open=a.settings.sidebar.open==="false"||a.settings.sidebar.open==="0"?false:true}}this._quoteButton=g.adopt("quote",c,{tooltip:j.t("cite.button.add.quote"),icon:p("button","inline-button"),scope:"Aloha.continuoustext",click:function(){a.addInlineQuote()}});b.multiSplitButton.pushItem({name:"blockquote",tooltip:j.t("cite.button.add.blockquote"),icon:p("button","block-button"),click:function(){a.addBlockQuote()}});var n=this;l.ready(function(){n.sidebar=
l.Sidebar.right.show();n.sidebar.addPanel({id:p("sidebar-panel"),title:"Citation",content:"",expanded:true,activeOn:"q, blockquote",onInit:function(){var a=this,b="";n.referenceContainer&&(b='<label class="{panel-label}" for="{note-field}-textarea">Note</label> <div class="{panel-field} {note-field}" style="margin: 5px;"><textarea id="{note-field}-textarea"></textarea></div>');this.setContent(typeof('<label class="{panel-label}" for="{link-field}-input">Link</label><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" id="{link-field}-input" /></div>'+
b)==="string"?m('<label class="{panel-label}" for="{link-field}-input">Link</label><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" id="{link-field}-input" /></div>'+b,o):'<label class="{panel-label}" for="{link-field}-input">Link</label><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" id="{link-field}-input" /></div>'+b).content.find("input, textarea").bind("keypress change",function(){n.addCiteDetails(a.content.attr("data-cite-id"),a.content.find(d("link-field input")).val(),
a.content.find(d("note-field textarea")).val())})},onActivate:function(b){var c=b.attr("data-cite-id");if(!c){var c=++s,e=""+p("wrapper");b.addClass(e);b.attr("data-cite-id",c)}e=a.getIndexOfCitation(c);-1===e&&(e=a.citations.push({uid:c,link:null,notes:null})-1);this.content.attr("data-cite-id",c);this.content.find(d("link-field input")).val(b.attr("cite"));this.content.find(d("note-field textarea")).val(a.citations[e].note)}})});l.bind("aloha-editable-activated",function(c,d){var e=a.getEditableConfig(d.editable.obj);
if(e){f.inArray("quote",e)!==-1?a._quoteButton.show(true):a._quoteButton.show(false);f.inArray("blockquote",e)!==-1?b.multiSplitButton.showItem("blockquote"):b.multiSplitButton.hideItem("blockquote")}});k.sub("aloha.selection.context-change",function(c){for(var d=c.range,c=f("button.aloha-cite-button"),e=false,j,d=d.markupEffectiveAtStart,g=d.length;g;){j=d[--g].nodeName;if(j==="Q"||j==="BLOCKQUOTE"){e=true;break}}c.filter(".aloha-cite-block-button").removeClass("aloha-cite-pressed");a._quoteButton.setState(false);
if(e){"Q"===j?a._quoteButton.setState(true):c.filter(".aloha-cite-block-button").addClass("aloha-cite-pressed");return false}j=[];l.activeEditable&&(j=a.getEditableConfig(l.activeEditable.obj));f.inArray("quote",j)!=-1?a._quoteButton.show(true):a._quoteButton.show(false);f.inArray("blockquote",j)!=-1?b.multiSplitButton.showItem("blockquote"):b.multiSplitButton.hideItem("blockquote")})},getIndexOfCitation:function(a){for(var b=this.citations,c=b.length,d=0,e,j;d<c;){e=d+c>>1;j=b[e].uid;if(j==a)return e;
j>a?c=e:j<a&&(d=e+1)}return-1},addBlockQuote:function(){var a=[p("wrapper"),p(++s)].join(" "),a=f(m('<blockquote class="{classes}" data-cite-id="{uid}"></blockquote>',{uid:s,classes:a}));l.activeEditable&&f(l.activeEditable.obj[0]).click();l.Selection.changeMarkupOnSelection(a);this.referenceContainer&&this.addCiteToReferences(s);this.sidebar&&(this.settings&&this.settings.sidebar&&this.settings.sidebar.open)&&this.sidebar.open()},addInlineQuote:function(){var a=[p("wrapper"),p(++s)].join(" "),b=
f(m('<q class="{classes}" data-cite-id="{uid}"></q>',{uid:s,classes:a})),a=l.Selection.rangeObject,c;l.activeEditable&&f(l.activeEditable.obj[0]).click();if(c=a.findMarkup(function(){return this.nodeName&&b.length&&typeof this.nodeName==="string"&&typeof b[0].nodeName==="string"?this.nodeName.toLowerCase()===b[0].nodeName.toLowerCase():false},l.activeEditable.obj))a.isCollapsed()?e.removeFromDOM(c,a,true):e.removeMarkup(a,b,l.activeEditable.obj);else{a.isCollapsed()&&e.extendToWord(a);e.addMarkup(a,
b)}a.select();this.referenceContainer&&this.addCiteToReferences(s);this.sidebar&&(this.settings&&this.settings.sidebar&&this.settings.sidebar.open)&&this.sidebar.open();return false},addCiteToReferences:function(a){var b=this.getIndexOfCitation(a);if(-1!==b){var c=f(".aloha-editable-active "+d(a)),e="cite-note-"+a,a="cite-ref-"+a;c.append(m('<sup id="{ref}" contenteditable="false"><a href="#{note}">[{count}]</a></sup>',{ref:a,note:e,count:b+1}));0===this.referenceContainer.find("ol.references").length&&
this.referenceContainer.append("<h2>References</h2>").append('<ol class="references"></ol>');this.referenceContainer.find("ol.references").append(m('<li id="{note}"><a href="#{ref}">^</a> &nbsp; <span></span></li>',{ref:a,note:e}))}},addCiteDetails:function(a,b,c){this.citations[this.getIndexOfCitation(a)]={uid:a,link:b,note:c};b&&f(d(a)).attr("cite",b);this.referenceContainer&&f("li#cite-note-"+a+" span").html(m(b?'<a class="external" target="_blank" href="{url}">{url}</a>':"",{url:b})+(c?". "+c:
""))},toString:function(){return"aloha-citiation-plugin"},makeClean:function(a){a.find("q, blockquote").each(function(){f.trim(f(this).attr("class"))===""&&f(this).removeAttr("class");if(!this.referenceContainer){f(this).removeClass("aloha-cite-"+f(this).attr("data-cite-id"));f(this).attr("data-cite-id")!=null&&f(this).removeAttr("data-cite-id")}f(this).removeClass("aloha-cite-wrapper")})}})});define("flag-icons/flag-icons-plugin",[],function(){return{path:Aloha.getPluginUrl("flag-icons")}});define("numerated-headers/nls/i18n",
{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset","headerids.button.set":"Set","button.numeratedHeaders.tooltip":"Toggle header numeration"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("numerated-headers/numerated-headers-plugin","aloha/core jquery aloha/plugin ui/ui ui/toggleButton i18n!numerated-headers/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b){var e={};l.bind("aloha-editable-destroyed",function(a,b){delete e[b.getId()]});return a.create("numerated-headers",
{config:{numeratedactive:true,headingselector:"h1, h2, h3, h4, h5, h6",trailingdot:false},init:function(){var a=this;this._formatNumeratedHeadersButton=g.adopt("formatNumeratedHeaders",c,{tooltip:b.t("button.numeratedHeaders.tooltip"),icon:"aloha-icon aloha-icon-numerated-headers",scope:"Aloha.continuoustext",click:function(){a._formatNumeratedHeadersButton.getState()?a.createNumeratedHeaders():a.removeNumerations()}});l.bind("aloha-smart-content-changed",function(){a.cleanNumerations();a.showNumbers()&&
a.createNumeratedHeaders()});l.bind("aloha-format-block",function(){a.cleanNumerations();a.showNumbers()&&a.createNumeratedHeaders()});l.bind("aloha-editable-activated",function(){if(a.isNumeratingOn()){a._formatNumeratedHeadersButton.show();a.initForEditable(l.activeEditable.obj)}else a._formatNumeratedHeadersButton.hide()})},initForEditable:function(a){var b=a.attr("aloha-numerated-headers");if(b!=="true"&&b!=="false"){b=true===this.getCurrentConfig().numeratedactive?"true":"false";a.attr("aloha-numerated-headers",
b)}if(b==="true"){this.createNumeratedHeaders();this._formatNumeratedHeadersButton.setState(true)}else this._formatNumeratedHeadersButton.setState(false)},getCurrentConfig:function(){var a=this.getEditableConfig(l.activeEditable.obj);a.numeratedactive=a.numeratedactive===true||a.numeratedactive==="true"||a.numeratedactive==="1"?true:false;if(typeof a.headingselector!=="string")a.headingselector="h1, h2, h3, h4, h5, h6";a.headingselector=f.trim(a.headingselector);a.trailingdot=a.trailingdot===true||
a.trailingdot==="true"||a.trailingdot==="1"?true:false;return a},isNumeratingOn:function(){return this.getCurrentConfig().headingselector!==""},showNumbers:function(){return l.activeEditable&&this.isNumeratingOn()&&l.activeEditable.obj.attr("aloha-numerated-headers")==="true"},cleanNumerations:function(){var a=this.getBaseElement();a&&this._saveRemoveAnnotations(f(a).find("span[role=annotation]"))},_saveRemoveAnnotations:function(a){var b=this,c=l.Selection.getRangeObject(),d=false;a.each(function(){if(c.startContainer===
this||f.inArray(this,f(c.startContainer).parents())>-1){c.startContainer=b._prevNode(this);c.startOffset=0;d=true}if(c.startContainer===this.parentNode&&c.startOffset>=f(this).index()&&c.startOffset>0){c.startOffset--;d=true}if(c.endContainer===this||f.inArray(this,f(c.endContainer).parents())>-1){c.endContainer=b._prevNode(this);c.endOffset=0;d=true}if(c.endContainer===this.parentNode&&c.endOffset>=f(this).index()&&c.endOffset>0){c.endOffset--;d=true}f(this).remove()});if(d===true){c.update();c.select()}},
_prependAnnotation:function(a,b){var c=l.Selection.getRangeObject(),d=false;if(c.startContainer===b){c.startOffset++;d=true}if(c.endContainer===b){c.endOffset++;d=true}f(b).prepend('<span role="annotation">'+a+"</span>");if(d===true){c.update();c.select()}},_prevNode:function(a){var b=a.previousSibling;if(!b)return a.parentNode;for(;b.lastChild;)b=b.lastChild;return b},removeNumerations:function(){f(l.activeEditable.obj).attr("aloha-numerated-headers","false");this.cleanNumerations()},getBaseElement:function(){return typeof this.baseobjectSelector!==
"undefined"?f(this.baseobjectSelector).length>0?f(this.baseobjectSelector):null:l.activeEditable?l.activeEditable.obj:null},hasNote:function(a){return!a||f(a).length<=0?false:f(a).find("span[role=annotation]").length>0},hasContent:function(a){if(!a||0===f(a).length)return false;a=f(a).clone().find("span[role=annotation]").remove().end();return f.trim(a.text()).length>0},createNumeratedHeaders:function(){var a=this.getBaseElement();if(a){var b=this.getCurrentConfig(),a=a.find(b.headingselector);l.activeEditable.obj.attr("aloha-numerated-headers",
"true");if(!(typeof a==="undefined"||a.length===0)){var c=7,d=this;a.each(function(){if(d.hasContent(this)){var a=parseInt(this.nodeName.substr(1),10);a<c&&(c=a)}});if(!(c>6)){var e=null,g=[],s=0,o;for(o=0;o<6-c+1;o++)g[o]=0;a.each(function(){if(d.hasContent(this)){var a=parseInt(this.nodeName.substr(1),10);if(e===null&&a!==c)d._saveRemoveAnnotations(f(this).find("span[role=annotation]"));else{if(e===null)g[s]++;else if(a>e)g[++s]++;else if(a===e)g[s]++;else if(a<e){var k=a-c,l;for(l=s;l>k;l--)g[l]=
0;s=k;g[s]++}e=a;a="";if(b.trailingdot===true){a="";for(k=0;k<g.length;k++)g[k]!==0&&(a=a+(g[k]+"."))}else{a=g[0];for(k=1;k<g.length;k++)g[k]!==0&&(a=a+("."+g[k]))}a=a+"&nbsp;";d.hasNote(this)?f(this).find("span[role=annotation]").html(a):d._prependAnnotation(a,this)}}else d.hasNote(this)&&d._saveRemoveAnnotations(f(this).find("span[role=annotation]"))})}}}}})});define("formatlesspaste/formatlesshandler",["aloha","jquery","aloha/contenthandlermanager"],function(l,f,a){function g(a,b){a.find(b.join(",")).each(function(){f(this).contents().unwrap()})}
return a.createHandler({enabled:!1,handleContent:function(a){var b;"string"===typeof a?b=f("<div>"+a+"</div>"):a instanceof f&&(b=f("<div>").append(a));if(!b.find(".aloha-block").length)return this.enabled&&g(b,this.strippedElements),b.html()}})});define("formatlesspaste/nls/i18n",{root:{"button.formatlessPaste.tooltip":"Toggle Formatless Pasting"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("formatlesspaste/formatlesspaste-plugin","aloha/core aloha/plugin jquery ui/ui ui/toggleButton formatlesspaste/formatlesshandler aloha/contenthandlermanager i18n!formatlesspaste/nls/i18n".split(" "),
function(l,f,a,g,c,b,e,k){function j(a){return!a?false:typeof a==="string"?"0"!==a&&"false"!==a.toLowerCase():true}function m(a){var b={};if(typeof a.formatlessPasteOption!=="undefined")b.formatlessPasteOption=j(a.formatlessPasteOption);if(typeof a.strippedElements!=="undefined")b.strippedElements=a.strippedElements;if(typeof a.button!=="undefined")b.button=j(a.button);return b}function d(b,c){a.extend(b,c)}function p(a){e.register("formatless",b);b.strippedElements=a.strippedElements;a._toggleFormatlessPasteButton=
g.adopt("toggleFormatlessPaste",c,{tooltip:k.t("button.formatlessPaste.tooltip"),icon:"aloha-icon aloha-icon-formatless-paste",scope:"Aloha.continuoustext",click:function(){b.enabled=!b.enabled}});a._toggleFormatlessPasteButton.show(a.button);if(true===a.formatlessPasteOption){a._toggleFormatlessPasteButton.setState(true);b.enabled=true}else if(false===a.formatlessPasteOption){a._toggleFormatlessPasteButton.setState(false);b.enabled=false}}function n(a,b){var c=b.getId();if(!c)return null;if(s[c])return s[c];
var d=a.getEditableConfig(b.obj);if(!d)return null;s[c]=m(d);return s[c]}var s={};l.bind("aloha-editable-destroyed",function(a,b){var c=b.getId();c&&s[c]&&delete s[c]});return f.create("formatlesspaste",{formatlessPasteOption:false,button:true,strippedElements:["a","abbr","b","bdi","bdo","cite","code","del","dfn","em","i","ins","kbd","mark","q","rp","rt","ruby","s","samp","small","strong","sub","sup","time","u","var"],init:function(){var a=this;d(a,m(a.settings.config||a.settings));p(a);l.bind("aloha-editable-activated",
function(c,d){var e=n(a,d.editable);if(e){var j=a._toggleFormatlessPasteButton;if(true===e.formatlessPasteOption){j.setState(true);b.enabled=true}else if(false===e.formatlessPasteOption){j.setState(false);b.enabled=false}j.show(false!==e.button)}})}})});(function(){var l=!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function a(){!l&&this.init&&this.init.apply(this,arguments)}var g=this.prototype;l=!0;var c=new this;l=!1;for(var b=0;b<arguments.length;b++){var e=
arguments[b],k;for(k in e)c[k]="function"==typeof e[k]&&"function"==typeof g[k]&&f.test(e[k])?function(a,b){return function(){var c=this._super;this._super=g[a];var e=b.apply(this,arguments);this._super=c;return e}}(k,e[k]):e[k]}a.prototype=c;a.constructor=a;a.extend=arguments.callee;return a}})();"function"===typeof define&&define("Class",[],function(){return Class});define("jstree",["jquery"],function(l){(function(){if(!l||!l.jstree){var f=!1,a=!1,g=!1;(function(c){c.vakata={};c.vakata.css={get_css:function(a,
b,c){var a=a.toLowerCase(),e=c.cssRules||c.rules,j=0;do{if(e.length&&j>e.length+5)break;if(e[j].selectorText&&e[j].selectorText.toLowerCase()==a)return!0===b?(c.removeRule&&c.removeRule(j),c.deleteRule&&c.deleteRule(j),!0):e[j]}while(e[++j]);return!1},add_css:function(a,b){if(c.jstree.css.get_css(a,!1,b))return!1;b.insertRule?b.insertRule(a+" { }",0):b.addRule(a,null,0);return c.vakata.css.get_css(a)},remove_css:function(a,b){return c.vakata.css.get_css(a,!0,b)},add_sheet:function(a){var b=!1,e=!0;
if(a.str)return a.title&&(b=c("style[id='"+a.title+"-stylesheet']")[0]),b?e=!1:(b=document.createElement("style"),b.setAttribute("type","text/css"),a.title&&b.setAttribute("id",a.title+"-stylesheet")),b.styleSheet?e?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str:(b.appendChild(document.createTextNode(a.str)),document.getElementsByTagName("head")[0].appendChild(b)),b.sheet||b.styleSheet;if(a.url)if(document.createStyleSheet)try{document.createStyleSheet(a.url)}catch(j){}else return b=
document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet}};var b=[],e=-1,k={},j={};c.fn.jstree=function(a){var d="string"==typeof a,e=Array.prototype.slice.call(arguments,1),j=this;if(d){if("_"==a.substring(0,1))return j;this.each(function(){var d=b[c.data(this,"jstree-instance-id")],d=d&&c.isFunction(d[a])?d[a].apply(d,e):d;if("undefined"!==typeof d&&(0===a.indexOf("is_")||!0!==d&&!1!==d))return j=
d,!1})}else this.each(function(){var d=c.data(this,"jstree-instance-id"),j=[],g=a?c.extend({},!0,a):{},f=c(this),n=!1,l=[],j=j.concat(e);f.data("jstree")&&j.push(f.data("jstree"));g=j.length?c.extend.apply(null,[!0,g].concat(j)):g;"undefined"!==typeof d&&b[d]&&b[d].destroy();d=parseInt(b.push({}),10)-1;c.data(this,"jstree-instance-id",d);g.plugins=c.isArray(g.plugins)?g.plugins:c.jstree.defaults.plugins.slice();g.plugins.unshift("core");g.plugins=g.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,
"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");n=c.extend(!0,{},c.jstree.defaults,g);n.plugins=g.plugins;c.each(k,function(a){-1===c.inArray(a,n.plugins)?(n[a]=null,delete n[a]):l.push(a)});n.plugins=l;b[d]=new c.jstree._instance(d,c(this).addClass("jstree jstree-"+d),n);c.each(b[d]._get_settings().plugins,function(a,c){b[d].data[c]={}});c.each(b[d]._get_settings().plugins,function(a,c){k[c]&&k[c].__init.apply(b[d])});setTimeout(function(){b[d].init()},0)});return j};c.jstree={defaults:{plugins:[]},
_focused:function(){return b[e]||null},_reference:function(a){if(b[a])return b[a];var d=c(a);!d.length&&"string"===typeof a&&(d=c("#"+a));return!d.length?null:b[d.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(a,b,e){this.data={core:{}};this.get_settings=function(){return c.extend(!0,{},e)};this._get_settings=function(){return e};this.get_index=function(){return a};this.get_container=function(){return b};this.get_container_ul=function(){return b.children("ul:eq(0)")};this._set_settings=
function(a){e=c.extend(!0,{},e,a)}},_fn:{},plugin:function(a,b){b=c.extend({},{__init:c.noop,__destroy:c.noop,_fn:{},defaults:!1},b);k[a]=b;c.jstree.defaults[a]=b.defaults;c.each(b._fn,function(b,d){d.plugin=a;d.old=c.jstree._fn[b];c.jstree._fn[b]=function(){var a,e=d,j=Array.prototype.slice.call(arguments);a=new c.Event("before.jstree");var g=!1;if(!(!0===this.data.core.locked&&"unlock"!==b&&"is_locked"!==b)){do{if(e&&e.plugin&&-1!==c.inArray(e.plugin,this._get_settings().plugins))break;e=e.old}while(e);
if(e){if(0===b.indexOf("_"))a=e.apply(this,j);else{a=this.get_container().triggerHandler(a,{func:b,inst:this,args:j,plugin:e.plugin});if(!1===a)return;"undefined"!==typeof a&&(j=a);a=e.apply(c.extend({},this,{__callback:function(a){this.get_container().triggerHandler(b+".jstree",{inst:this,args:j,rslt:a,rlbk:g})},__rollback:function(){return g=this.get_rollback()},__call_old:function(a){return e.old.apply(this,a?Array.prototype.slice.call(arguments,1):j)}}),j)}return a}}};c.jstree._fn[b].old=d.old;
c.jstree._fn[b].plugin=a})},rollback:function(a){a&&(c.isArray(a)||(a=[a]),c.each(a,function(a,c){b[c.i].set_rollback(c.h,c.d)}))}};c.jstree._fn=c.jstree._instance.prototype={};c(function(){var b=navigator.userAgent.toLowerCase(),d=(b.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],e=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(b)&&6==parseInt(d,10)){f=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(j){}e+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(b)&&
7==parseInt(d,10)&&(a=!0,e+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(b)&&(/mozilla/.test(b)&&1.9>parseFloat(d,10))&&(g=!0,e+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");c.vakata.css.add_sheet({str:e,title:"jstree"})});c.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=
this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+
this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",c.proxy(function(a){var b=c(a.target);b.is("ins")&&a.pageY-b.offset().top<this.data.core.li_height&&this.toggle_node(b)},this)).bind("mousedown.jstree",c.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var a;if(document.selection&&document.selection.empty)document.selection.empty();
else if(window.getSelection){a=window.getSelection();try{a.removeAllRanges(),a.collapse()}catch(b){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",c.proxy(function(a,b){var e=this._get_node(b.rslt.obj),j=this;-1===e&&(e=this.get_container_ul());e.length&&e.find("li").each(function(){var a=c(this);a.data("jstree")&&c.each(a.data("jstree"),function(b,d){j.data[b]&&c.isFunction(j["_"+b+"_notify"])&&j["_"+b+"_notify"].call(j,a,d)})})},this));this._get_settings().core.load_open&&
this.get_container().bind("load_node.jstree",c.proxy(function(a,b){var e=this._get_node(b.rslt.obj),j=this;-1===e&&(e=this.get_container_ul());e.length&&e.find("li.jstree-open:not(:has(ul))").each(function(){j.load_node(this,c.noop,c.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var a,d=this.get_index(),j=this._get_settings(),g=this;c.each(j.plugins,function(a,b){try{k[b].__destroy.apply(g)}catch(c){}});this.__callback();if(this.is_focused())for(a in b)if(b.hasOwnProperty(a)&&
a!=d){b[a].set_focus();break}d===e&&(e=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});c(document).unbind(".jstree-"+d).undelegate(".jstree-"+d);b[d]=null;delete b[d]},_core_notify:function(a,b){b.opened&&this.open_node(a,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity",
"0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:"))});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(a){var b=this,e=!0,j=[],g=[];a||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=c.map(c.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=c.map(c.makeArray(this.data.core.to_load),function(a){return"#"+
a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(c.each(this.data.core.to_load,function(a,b){if(b=="#")return true;c(b).length?j.push(b):g.push(b)}),j.length&&(this.data.core.to_load=g,c.each(j,function(a,c){if(!b._is_loaded(c)){b.load_node(c,function(){b.reload_nodes(true)},
function(){b.reload_nodes(true)});e=false}})));this.data.core.to_open.length&&c.each(this.data.core.to_open,function(a,c){b.open_node(c,false,true)});e&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){b.__callback({},b)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var a=this;this.data.core.to_open.length&&c.each(this.data.core.to_open,function(b,c){a.open_node(c,!1,!0)});this.__callback({})},refresh:function(a){var b=this;
this.save_opened();a||(a=-1);(a=this._get_node(a))||(a=-1);-1!==a?a.children("UL").remove():this.get_container_ul().empty();this.load_node(a,function(){b.__callback({obj:a});b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var a=c.jstree._focused();a&&a.unset_focus();this.get_container().addClass("jstree-focused");e=this.get_index();this.__callback()}},is_focused:function(){return e==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),
e=-1);this.__callback()},_get_node:function(a){var b=c(a,this.get_container());if(b.is(".jstree")||-1==a)return-1;b=b.closest("li",this.get_container());return b.length?b:!1},_get_next:function(a,b){a=this._get_node(a);return-1===a?this.get_container().find("> ul > li:first-child"):!a.length?!1:b?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0)},_get_prev:function(a,
b){a=this._get_node(a);if(-1===a)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(b)return 0<a.prevAll("li").length?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){for(a=a.prev("li").eq(0);a.hasClass("jstree-open");)a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},_get_parent:function(a){a=this._get_node(a);if(-1==a||!a.length)return!1;a=a.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},
_get_children:function(a){a=this._get_node(a);return-1===a?this.get_container().children("ul:eq(0)").children("li"):!a.length?!1:a.children("ul:eq(0)").children("li")},get_path:function(a,b){var c=[],e=this,a=this._get_node(a);if(-1===a||!a||!a.length)return!1;a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:e.get_text(this))});c.reverse();c.push(b?a.attr("id"):this.get_text(a));return c},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){return(a=
this._get_node(a))&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return(a=this._get_node(a))&&-1!==a&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||-1===a)return!1;a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(a,b,c){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return b&&
b.call(),!1;var e=c||f?0:this._get_settings().core.animation,j=this;this._is_loaded(a)?(this._get_settings().core.open_parents&&a.parentsUntil(".jstree",".jstree-closed").each(function(){j.open_node(this,!1,!0)}),e&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),e?a.children("ul").stop(!0,!0).slideDown(e,function(){this.style.display="";j.after_open(a)}):j.after_open(a),this.__callback({obj:a}),b&&b.call()):
(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){j.open_node(a,b,c)},b))},after_open:function(a){this.__callback({obj:a})},close_node:function(a,b){var a=this._get_node(a),c=b||f?0:this._get_settings().core.animation,e=this;if(!a.length||!a.hasClass("jstree-open"))return!1;c&&a.children("ul").attr("style","display:block !important");a.removeClass("jstree-open").addClass("jstree-closed");c?a.children("ul").stop(!0,!0).slideUp(c,function(){this.style.display="";e.after_close(a)}):
e.after_close(a);this.__callback({obj:a})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,b,c){a=a?this._get_node(a):-1;if(!a||-1===a)a=this.get_container_ul();c?a=a.find("li.jstree-closed"):(c=a,a=a.is(".jstree-closed")?a.find("li.jstree-closed").andSelf():a.find("li.jstree-closed"));var e=this;a.each(function(){var a=this;
e._is_loaded(this)?e.open_node(this,false,!b):e.open_node(this,function(){e.open_all(a,b,c)},!b)});0===c.find("li.jstree-closed").length&&this.__callback({obj:c})},close_all:function(a,b){var c=this,a=a?this._get_node(a):this.get_container();if(!a||-1===a)a=this.get_container_ul();a.find("li.jstree-open").andSelf().each(function(){c.close_node(this,!b)});this.__callback({obj:a})},clean_node:function(a){a=a&&-1!=a?c(a):this.get_container_ul();a=a.is("li")?a.find("li").andSelf():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");
a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a);this.data=b;this.__callback()},load_node:function(a){this.__callback({obj:a})},_is_loaded:function(){return!0},create_node:function(a,b,e,j,g){var a=this._get_node(a),b="undefined"===typeof b?"last":
b,f=c("<li />"),k=this._get_settings().core,l;if(-1!==a&&!a.length)return!1;if(!g&&!this._is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,e,j,!0)}),!1;this.__rollback();"string"===typeof e&&(e={data:e});e||(e={});e.attr&&f.attr(e.attr);e.metadata&&f.data(e.metadata);e.state&&f.addClass("jstree-"+e.state);e.data||(e.data=this._get_string("new_node"));c.isArray(e.data)||(l=e.data,e.data=[],e.data.push(l));c.each(e.data,function(a,b){l=c("<a />");c.isFunction(b)&&(b=b.call(this,
e));if(typeof b=="string")l.attr("href","#")[k.html_titles?"html":"text"](b);else{if(!b.attr)b.attr={};if(!b.attr.href)b.attr.href="#";l.attr(b.attr)[k.html_titles?"html":"text"](b.title);b.language&&l.addClass(b.language)}l.prepend("<ins class='jstree-icon'>&#160;</ins>");b.icon&&(b.icon.indexOf("/")===-1?l.children("ins").addClass(b.icon):l.children("ins").css("background","url('"+b.icon+"') center center no-repeat"));f.append(l)});f.prepend("<ins class='jstree-icon'>&#160;</ins>");-1===a&&(a=this.get_container(),
"before"===b&&(b="first"),"after"===b&&(b="last"));switch(b){case "before":a.before(f);l=this._get_parent(a);break;case "after":a.after(f);l=this._get_parent(a);break;case "inside":case "first":a.children("ul").length||a.append("<ul />");a.children("ul").prepend(f);l=a;break;case "last":a.children("ul").length||a.append("<ul />");a.children("ul").append(f);l=a;break;default:a.children("ul").length||a.append("<ul />"),b||(b=0),l=a.children("ul").children("li").eq(b),l.length?l.before(f):a.children("ul").append(f),
l=a}if(-1===l||l.get(0)===this.get_container().get(0))l=-1;this.clean_node(l);this.__callback({obj:f,parent:l});j&&j.call(this,f);return f},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var b=this._get_settings().core.html_titles,a=a.children("a:eq(0)");if(b)return a=a.clone(),a.children("INS").remove(),a.html();a=a.contents().filter(function(){return 3==this.nodeType})[0];return a.nodeValue},set_text:function(a,b){a=this._get_node(a);if(!a.length)return!1;a=a.children("a:eq(0)");
if(this._get_settings().core.html_titles){var c=a.children("INS").clone();a.html(b).prepend(c);this.__callback({obj:a,name:b});return!0}a=a.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:a,name:b});return a.nodeValue=b},rename_node:function(a,b){a=this._get_node(a);this.__rollback();a&&(a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments)))&&this.__callback({obj:a,name:b})},delete_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.__rollback();
var b=this._get_parent(a),e=c([]),j=this;a.each(function(){e=e.add(j._get_prev(this))});a=a.detach();-1!==b&&0===b.find("> ul > li").length&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(b);this.__callback({obj:a,prev:e,parent:b});return a},prepare_move:function(a,b,e,g,f){var k={};k.ot=c.jstree._reference(a)||this;k.o=k.ot._get_node(a);k.r=-1===b?-1:this._get_node(b);k.p="undefined"===typeof e||!1===e?"last":e;if(f||!j.o||!(j.o[0]===k.o[0]&&j.r[0]===k.r[0]&&j.p===
k.p)){k.ot=c.jstree._reference(k.o)||this;k.rt=c.jstree._reference(k.r)||this;if(-1===k.r||!k.r)switch(k.cr=-1,k.p){case "first":case "before":case "inside":k.cp=0;break;case "after":case "last":k.cp=k.rt.get_container().find(" > ul > li").length;break;default:k.cp=k.p}else{if(!/^(before|after)$/.test(k.p)&&!this._is_loaded(k.r))return this.load_node(k.r,function(){this.prepare_move(a,b,e,g,!0)});switch(k.p){case "before":k.cp=k.r.index();k.cr=k.rt._get_parent(k.r);break;case "after":k.cp=k.r.index()+
1;k.cr=k.rt._get_parent(k.r);break;case "inside":case "first":k.cp=0;k.cr=k.r;break;case "last":k.cp=k.r.find(" > ul > li").length;k.cr=k.r;break;default:k.cp=k.p,k.cr=k.r}}k.np=-1==k.cr?k.rt.get_container():k.cr;k.op=k.ot._get_parent(k.o);k.cop=k.o.index();-1===k.op&&(k.op=k.ot?k.ot.get_container():this.get_container());!/^(before|after)$/.test(k.p)&&(k.op&&k.np&&k.op[0]===k.np[0]&&k.o.index()<k.cp)&&k.cp++;k.or=k.np.find(" > ul > li:nth-child("+(k.cp+1)+")");j=k}this.__callback(j);g&&g.call(this,
j)},check_move:function(){var a=j,b=!0,c=-1===a.r?this.get_container():a.r;if(!a||(!a.o||a.or[0]===a.o[0])||a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index())return!1;a.o.each(function(){if(-1!==c.parentsUntil(".jstree","li").andSelf().index(this))return b=!1});return b},move_node:function(a,b,e,g,f,k){if(!f)return this.prepare_move(a,b,e,function(a){this.move_node(a,!1,!1,g,!0,k)});g&&(j.cy=!0);if(!k&&!this.check_move())return!1;this.__rollback();b=!1;g?(b=a.o.clone(!0),b.find("*[id]").andSelf().each(function(){if(this.id)this.id=
"copy_"+this.id})):b=a.o;a.or.length?a.or.before(b):(a.np.children("ul").length||c("<ul />").appendTo(a.np),a.np.children("ul:eq(0)").append(b));try{a.ot.clean_node(a.op),a.rt.clean_node(a.np),a.op.find("> ul > li").length||a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(l){}g&&(j.cy=!0,j.oc=b);this.__callback(j);return j},_get_move:function(){return j}}})})(l);(function(a){var b,e,g;a(function(){/msie/.test(navigator.userAgent.toLowerCase())?(e=
a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),g=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:0}).appendTo("body"),b=e.width()-g.width(),e.add(g).remove()):(e=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),b=100-e.width(),e.parent().remove())});a.jstree.plugin("ui",
{__init:function(){this.data.ui.selected=a();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",a.proxy(function(b){b.preventDefault();b.currentTarget.blur();a(b.currentTarget).hasClass("jstree-loading")||this.select_node(b.currentTarget,!0,b)},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.hover_node(b.target)},this)).delegate("a",
"mouseleave.jstree",a.proxy(function(b){a(b.currentTarget).hasClass("jstree-loading")||this.dehover_node(b.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(b,e){var d=this._get_settings().ui,g=this._get_node(e.rslt.obj),f=g&&g.length?g.children("ul").find("a.jstree-clicked"):
a(),k=this;!1!==d.selected_parent_close&&f.length&&f.each(function(){k.deselect_node(this);"select_parent"===d.selected_parent_close&&k.select_node(g)})},this)).bind("delete_node.jstree",a.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,e=this._get_node(b.rslt.obj),e=e&&e.length?e.find("a.jstree-clicked"):[],g=this;e.each(function(){g.deselect_node(this)});c&&e.length&&b.rslt.prev.each(function(){if(this.parentNode)return g.select_node(this),!1})},this)).bind("move_node.jstree",
a.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(b,e){if("undefined"===typeof b||null===b)return e?this.data.ui.selected:this.data.ui.last_selected;var d=a(b,this.get_container());if(d.is(".jstree")||
-1==b)return-1;d=d.closest("li",this.get_container());return d.length?d:!1},_ui_notify:function(a,b){b.selected&&this.select_node(a,!1)},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,e=this.data.ui.to_select,
e=a.map(a.makeArray(e),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});a.each(e,function(a,c){c&&"#"!==c&&b.select_node(c)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length)return!1;a.hasClass("jstree-hovered")||
this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered;if(!a||!a.length)return!1;this.data.ui.hovered[0]===a.children("a").removeClass("jstree-hovered").parent()[0]&&(this.data.ui.hovered=null);this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(-1==a||!a||!a.length)return!1;var e=this._get_settings().ui,g="on"==e.select_multiple_modifier||
!1!==e.select_multiple_modifier&&c&&c[e.select_multiple_modifier+"Key"],f=!1!==e.select_range_modifier&&c&&c[e.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],k=this.is_selected(a),l=!0,r=this;if(b){if(e.disable_selecting_children&&g&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;l=!1;switch(!0){case f:this.data.ui.last_selected.addClass("jstree-last-selected");
a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();-1==e.select_limit||a.length<e.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==r.data.ui.last_selected[0]&&r.deselect_node(this)}),k=!1,l=!0):l=!1;break;case k&&!g:this.deselect_all();k=!1;l=!0;break;case !k&&!g:if(-1==e.select_limit||0<e.select_limit)this.deselect_all(),l=!0;break;case k&&g:this.deselect_node(a);break;
case !k&&g:if(-1==e.select_limit||this.data.ui.selected.length+1<=e.select_limit)l=!0}}l&&!k&&(f||(this.data.ui.last_selected=a),a.children("a").addClass("jstree-clicked"),e.selected_parent_open&&a.parents(".jstree-closed").each(function(){r.open_node(this,false,true)}),this.data.ui.selected=this.data.ui.selected.add(a),this._fix_scroll(a.eq(0)),this.__callback({obj:a,e:c}))},_fix_scroll:function(a){var c=this.get_container()[0];if(c.scrollHeight>c.offsetHeight&&(a=this._get_node(a))&&!(-1===a||!a.length||
!a.is(":visible")))if(a=a.offset().top-this.get_container().offset().top,0>a&&(c.scrollTop=c.scrollTop+a-1),a+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?b:0)>c.offsetHeight)c.scrollTop+=a-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?b:0)},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&
(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return 0<=this.data.ui.selected.index(this._get_node(a))},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(b){b=b?a(b).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();
b.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a([]);this.data.ui.last_selected=!1;this.__callback({obj:b})}}});a.jstree.defaults.plugins.push("ui")})(l);(function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,c){if(this._get_settings().crrm.move.open_onmove){var g=this;c.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){g.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,
move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(b,e){var b=this._get_node(b),g=this._get_settings().core.rtl,j=this._get_settings().crrm.input_width_limit,f=b.children("ins").width(),d=b.find("> a:visible > ins").width()*b.find("> a:visible > ins").length,l=this.get_text(b),n=a("<div />",{css:{position:"absolute",top:"-200px",left:g?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),s=b.css("position","relative").append(a("<input />",
{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:g?"auto":f+d+4+"px",right:g?f+d+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),c=a.val();""===c&&(c=l);n.remove();a.remove();this.set_text(b,l);this.rename_node(b,c);e.call(this,b,c,l);b.css("position","")},this),keyup:function(a){a=a.keyCode||a.which;27==
a?(this.value=l,this.blur()):13==a?this.blur():s.width(Math.min(n.text("pW"+this.value).width(),j))},keypress:function(a){if(13==(a.keyCode||a.which))return!1}})).children(".jstree-rename-input");this.set_text(b,"");n.css({fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||
""});s.width(Math.min(n.text("pW"+s[0].value).width(),j))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var c=this.__callback;this._show_input(a,function(a,b,g){c.call(this,{obj:a,new_name:b,old_name:g})})},create:function(b,e,g,j,f){var d=this;(b=this._get_node(b))||(b=-1);this.__rollback();return this.create_node(b,e,g,function(b){var e=this._get_parent(b),g=a(b).index();j&&j.call(this,b);e.length&&e.hasClass("jstree-closed")&&this.open_node(e,!1,!0);f?d.__callback({obj:b,
name:this.get_text(b),parent:e,position:g}):this._show_input(b,function(a,b){d.__callback({obj:a,name:b,parent:e,position:g})})})},remove:function(a){var a=this._get_node(a,!0),c=this._get_parent(a),g=this._get_prev(a);this.__rollback();a=this.delete_node(a);!1!==a&&this.__callback({obj:a,prev:g,parent:c})},check_move:function(){return!this.__call_old()||!this._get_settings().crrm.move.check_move.call(this,this._get_move())?!1:!0},move_node:function(a,c,g,j,f,d){var l=this._get_settings().crrm.move;
if(!f)return"undefined"===typeof g&&(g=l.default_position),"inside"===g&&!l.default_position.match(/^(before|after)$/)&&(g=l.default_position),this.__call_old(!0,a,c,g,j,!1,d);if(!0===l.always_copy||"multitree"===l.always_copy&&a.rt.get_index()!==a.ot.get_index())j=!0;this.__call_old(!0,a,c,g,j,!0,d)},cut:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,!0);if(!a||!a.length)return!1;
this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;var c=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0);this.__callback({obj:a,nodes:c})}}})})(l);(function(a){var b=
[];a.jstree._themes=!1;a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(e,g){if(!e)return!1;
g||(g=a.jstree._themes+e+"/style.css");-1==a.inArray(g,b)&&(a.vakata.css.add_sheet({url:g}),b.push(g));this.data.themes.theme!=e&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=e);this.get_container().addClass("jstree-"+e);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0;this.get_container().children("ul").removeClass("jstree-no-dots")},
hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});
a(function(){!1===a.jstree._themes&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===a.jstree._themes&&(a.jstree._themes="themes/")});a.jstree.defaults.plugins.push("themes")})(l);(function(a){var b=[];a.jstree.plugin("hotkeys",{__init:function(){if("undefined"===typeof a.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";
a.each(this._get_settings().hotkeys,function(e,g){!1!==g&&-1==a.inArray(e,b)&&(a(document).bind("keydown",e,function(b){var g;var d=a.jstree._focused(),f;d&&d.data&&d.data.hotkeys&&d.data.hotkeys.enabled&&(f=d._get_settings().hotkeys[e])&&(g=f.call(d,b));return g}),b.push(e))});this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=
!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},
"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?
this.close_node(a):this.hover_node(this._get_prev(a)));return!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a)));return!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&
(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();return!1},"ctrl+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},
"shift+space":function(a){a.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})})(l);(function(a){a.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&
this.get_container().bind("after_close.jstree",function(a,c){c.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(a,c,g){var j=this;this.load_node_json(a,function(){j.__callback({obj:j._get_node(a)});c.call(this)},g)},_is_loaded:function(b){var e=this._get_settings().json_data,b=this._get_node(b);return-1==b||!b||!e.ajax&&!e.progressive_render&&!a.isFunction(e.data)||b.is(".jstree-open, .jstree-leaf")||
0<b.children("ul").children("li").length},refresh:function(b){var b=this._get_node(b),e=this._get_settings().json_data;b&&(-1!==b&&e.progressive_unload&&(a.isFunction(e.data)||e.ajax))&&b.removeData("jstree-children");return this.__call_old()},load_node_json:function(b,e,g){var j=this.get_settings().json_data,f,d=function(){};f=function(){};if((b=this._get_node(b))&&-1!==b&&(j.progressive_render||j.progressive_unload)&&!b.is(".jstree-open, .jstree-leaf")&&0===b.children("ul").children("li").length&&
b.data("jstree-children")){if(f=this._parse_json(b.data("jstree-children"),b))b.append(f),j.progressive_unload||b.removeData("jstree-children");this.clean_node(b);e&&e.call(this)}else{if(b&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case !j.data&&!j.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(j.data):j.data.call(this,b,a.proxy(function(a){if(a=this._parse_json(a,b)){if(b===-1||!b)this.get_container().children("ul").empty().append(a.children());
else{b.append(a).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);e&&e.call(this)}else{if(b===-1||!b)j.correct_state&&this.get_container().children("ul").empty();else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");j.correct_state&&this.correct_state(b)}g&&g.call(this)}},this));break;case !!j.data&&!j.ajax||!!j.data&&!!j.ajax&&(!b||-1===b):if(!b||-1==b)(f=this._parse_json(j.data,b))?(this.get_container().children("ul").empty().append(f.children()),
this.clean_node()):j.correct_state&&this.get_container().children("ul").empty();e&&e.call(this);break;case !j.data&&!!j.ajax||!!j.data&&!!j.ajax&&b&&-1!==b:d=function(a,c,d){var e=this.get_settings().json_data.ajax.error;e&&e.call(this,a,c,d);if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&j.correct_state&&this.correct_state(b)}else c==="success"&&j.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},
f=function(g,f,k){var m=this.get_settings().json_data.ajax.success;m&&(g=m.call(this,g,f,k)||g);if(g===""||g&&g.toString&&g.toString().replace(/^[\s\n]+$/,"")===""||!a.isArray(g)&&!a.isPlainObject(g))return d.call(this,k,f,"");if(g=this._parse_json(g,b)){if(b===-1||!b)this.get_container().children("ul").empty().append(g.children());else{b.append(g).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);e&&e.call(this)}else if(b===-1||!b){if(j.correct_state){this.get_container().children("ul").empty();
e&&e.call(this)}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(j.correct_state){this.correct_state(b);e&&e.call(this)}}},j.ajax.context=this,j.ajax.error=d,j.ajax.success=f,j.ajax.dataType||(j.ajax.dataType="json"),a.isFunction(j.ajax.url)&&(j.ajax.url=j.ajax.url.call(this,b)),a.isFunction(j.ajax.data)&&(j.ajax.data=j.ajax.data.call(this,b)),a.ajax(j.ajax)}}},_parse_json:function(b,e,g){var j=!1,f=this._get_settings(),d=f.json_data,l=f.core.html_titles,
n;if(!b)return j;d.progressive_unload&&(e&&-1!==e)&&e.data("jstree-children",j);if(a.isArray(b)){j=a();if(!b.length)return!1;f=0;for(d=b.length;f<d;f++)n=this._parse_json(b[f],e,!0),n.length&&(j=j.add(n))}else{"string"==typeof b&&(b={data:b});if(!b.data&&""!==b.data)return j;j=a("<li />");b.attr&&j.attr(b.attr);b.metadata&&j.data(b.metadata);b.state&&j.addClass("jstree-"+b.state);a.isArray(b.data)||(n=b.data,b.data=[],b.data.push(n));a.each(b.data,function(d,e){n=a("<a />");a.isFunction(e)&&(e=e.call(this,
b));if(typeof e=="string")n.attr("href","#")[l?"html":"text"](e);else{if(!e.attr)e.attr={};if(!e.attr.href)e.attr.href="#";n.attr(e.attr)[l?"html":"text"](e.title);e.language&&n.addClass(e.language)}n.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!e.icon&&b.icon)e.icon=b.icon;e.icon&&(e.icon.indexOf("/")===-1?n.children("ins").addClass(e.icon):n.children("ins").css("background","url('"+e.icon+"') center center no-repeat"));j.append(n)});j.prepend("<ins class='jstree-icon'>&#160;</ins>");b.children&&
(d.progressive_render&&"open"!==b.state?j.addClass("jstree-closed").data("jstree-children",b.children):(d.progressive_unload&&j.data("jstree-children",b.children),a.isArray(b.children)&&b.children.length&&(n=this._parse_json(b.children,e,!0),n.length&&(e=a("<ul />"),e.append(n),j.append(e)))))}g||(g=a("<ul />"),g.append(j),j=g);return j},get_json:function(b,e,g,j){var f=[],d=this._get_settings(),l=this,n,s,o,q,r,u,b=this._get_node(b);if(!b||-1===b)b=this.get_container().find("> ul > li");e=a.isArray(e)?
e:["id","class"];!j&&this.data.types&&e.push(d.types.type_attr);g=a.isArray(g)?g:[];b.each(function(){o=a(this);n={data:[]};e.length&&(n.attr={});a.each(e,function(a,b){(s=o.attr(b))&&(s.length&&s.replace(/jstree[^ ]*/ig,"").length)&&(n.attr[b]=(" "+s).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))});o.hasClass("jstree-open")&&(n.state="open");o.hasClass("jstree-closed")&&(n.state="closed");o.data()&&(n.metadata=o.data());q=o.children("a");q.each(function(){r=
a(this);if(g.length||a.inArray("languages",d.plugins)!==-1||r.children("ins").get(0).style.backgroundImage.length||r.children("ins").get(0).className&&r.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length){u=false;a.inArray("languages",d.plugins)!==-1&&(a.isArray(d.languages)&&d.languages.length)&&a.each(d.languages,function(a,b){if(r.hasClass(b)){u=b;return false}});s={attr:{},title:l.get_text(r,u)};a.each(g,function(a,b){s.attr[b]=(" "+(r.attr(b)||"")).replace(/ jstree[^ ]*/ig,
"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});a.inArray("languages",d.plugins)!==-1&&(a.isArray(d.languages)&&d.languages.length)&&a.each(d.languages,function(a,b){if(r.hasClass(b)){s.language=b;return true}});if(r.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length)s.icon=r.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"");if(r.children("ins").get(0).style.backgroundImage.length)s.icon=
r.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}else s=l.get_text(r);q.length>1?n.data.push(s):n.data=s});o=o.find("> ul > li");o.length&&(n.children=l.get_json(o,e,g,!0));f.push(n)});return f}}})})(l);(function(a){a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(b){var e=this._get_settings().languages,g=!1,j=".jstree-"+this.get_index()+" a";if(!a.isArray(e)||0===e.length)return!1;if(-1==a.inArray(b,e))if(e[b])b=
e[b];else return!1;if(b==this.data.languages.current_language)return!0;g=a.vakata.css.get_css(j+"."+this.data.languages.current_language,!1,this.data.languages.language_css);!1!==g&&(g.style.display="none");g=a.vakata.css.get_css(j+"."+b,!1,this.data.languages.language_css);!1!==g&&(g.style.display="");this.data.languages.current_language=b;this.__callback(b);return!0},get_lang:function(){return this.data.languages.current_language},_get_string:function(b,e){var g=this._get_settings().languages,j=
this._get_settings().core.strings;a.isArray(g)&&g.length&&(e=e&&-1!=a.inArray(e,g)?e:this.data.languages.current_language);return j[e]&&j[e][b]?j[e][b]:j[b]?j[b]:b},get_text:function(b,e){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var g=this._get_settings().languages,j=this._get_settings().core.html_titles;a.isArray(g)&&g.length?(e=e&&-1!=a.inArray(e,g)?e:this.data.languages.current_language,b=b.children("a."+e)):b=b.children("a:eq(0)");if(j)return b=b.clone(),b.children("INS").remove(),
b.html();b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue},set_text:function(b,e,g){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var j=this._get_settings().languages,f=this._get_settings().core.html_titles;a.isArray(j)&&j.length?(g=g&&-1!=a.inArray(g,j)?g:this.data.languages.current_language,b=b.children("a."+g)):b=b.children("a:eq(0)");if(f)return j=b.children("INS").clone(),b.html(e).prepend(j),this.__callback({obj:b,name:e,lang:g}),!0;b=
b.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:b,name:e,lang:g});return b.nodeValue=e},_load_css:function(){var b=this._get_settings().languages,e="/* languages css */",g=".jstree-"+this.get_index()+" a",j;if(a.isArray(b)&&b.length){this.data.languages.current_language=b[0];for(j=0;j<b.length;j++)e+=g+"."+b[j]+" {",b[j]!=this.data.languages.current_language&&(e+=" display:none; "),e+=" } ";this.data.languages.language_css=a.vakata.css.add_sheet({str:e,title:"jstree-languages"})}},
create_node:function(b,e,g,j){return this.__call_old(!0,b,e,g,function(b){var d=this._get_settings().languages,e=b.children("a"),g;if(a.isArray(d)&&d.length){for(g=0;g<d.length;g++)e.is("."+d[g])||b.append(e.eq(0).clone().removeClass(d.join(" ")).addClass(d[g]));e.not("."+d.join(", .")).remove()}j&&j.call(this,b)})}}})})(l);(function(a){a.jstree.plugin("cookies",{__init:function(){if("undefined"===typeof a.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var b=this._get_settings().cookies,
e;if(b.save_loaded&&(e=a.cookie(b.save_loaded))&&e.length)this.data.core.to_load=e.split(",");if(b.save_opened&&(e=a.cookie(b.save_opened))&&e.length)this.data.core.to_open=e.split(",");if(b.save_selected&&(e=a.cookie(b.save_selected))&&e.length&&this.data.ui)this.data.ui.to_select=e.split(",");this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",a.proxy(function(a){this._get_settings().cookies.auto_save&&
this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(b){if(!this.data.core.refreshing){var e=this._get_settings().cookies;if(b)switch(b){case "open_node":case "close_node":e.save_opened&&(this.save_opened(),a.cookie(e.save_opened,this.data.core.to_open.join(","),e.cookie_options));e.save_loaded&&(this.save_loaded(),
a.cookie(e.save_loaded,this.data.core.to_load.join(","),e.cookie_options));break;case "select_node":case "deselect_node":e.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(e.save_selected,this.data.ui.to_select.join(","),e.cookie_options))}else if(e.save_loaded&&(this.save_loaded(),a.cookie(e.save_loaded,this.data.core.to_load.join(","),e.cookie_options)),e.save_opened&&(this.save_opened(),a.cookie(e.save_opened,this.data.core.to_open.join(","),e.cookie_options)),e.save_selected&&this.data.ui)this.save_selected(),
a.cookie(e.save_selected,this.data.ui.to_select.join(","),e.cookie_options)}}}})})(l);(function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,c){var g=this._get_node(c.rslt.obj),g=-1===g?this.get_container().children("ul"):g.children("ul");this.sort(g)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,c){this.sort(c.rslt.obj.parent())},this)).bind("move_node.jstree",a.proxy(function(a,c){this.sort((-1==
c.rslt.np?this.get_container():c.rslt.np).children("ul"))},this))},defaults:function(a,c){return this.get_text(a)>this.get_text(c)?1:-1},_fn:{sort:function(b){var e=this._get_settings().sort,g=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(e,g)));b.find("> li > ul").each(function(){g.sort(a(this))});this.clean_node(b)}}})})(l);(function(a){var b=!1,e=!1,g=!1,j=!1,f=!1,d=!1,l=!1,n=!1,s=!1;a.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,
helper_top:10,user_data:{},drag_start:function(b,d,e){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{b.currentTarget.unselectable="on",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.MozUserSelect="none")}catch(j){}a.vakata.dnd.init_x=b.pageX;a.vakata.dnd.init_y=b.pageY;a.vakata.dnd.user_data=d;a.vakata.dnd.is_down=!0;a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(e);a(document).bind("mousemove",a.vakata.dnd.drag);a(document).bind("mouseup",
a.vakata.dnd.drag_stop);return!1},drag:function(b){if(a.vakata.dnd.is_down){if(!a.vakata.dnd.is_drag)if(5<Math.abs(b.pageX-a.vakata.dnd.init_x)||5<Math.abs(b.pageY-a.vakata.dnd.init_y))a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:b,data:a.vakata.dnd.user_data});else return;if("mousemove"===b.type){var e=a(document),j=e.scrollTop(),e=e.scrollLeft();if(20>b.pageY-j){if(d&&"down"===l&&(clearInterval(d),d=!1),!d)l="up",d=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-
a.vakata.dnd.scroll_spd)},150)}else d&&"up"===l&&(clearInterval(d),d=!1);if(20>a(window).height()-(b.pageY-j)){if(d&&"up"===l&&(clearInterval(d),d=!1),!d)l="down",d=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150)}else d&&"down"===l&&(clearInterval(d),d=!1);if(20>b.pageX-e){if(f&&"right"===n&&(clearInterval(f),f=!1),!f)n="left",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-a.vakata.dnd.scroll_spd)},150)}else f&&"left"===
n&&(clearInterval(f),f=!1);if(20>a(window).width()-(b.pageX-e)){if(f&&"left"===n&&(clearInterval(f),f=!1),!f)n="right",f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150)}else f&&"right"===n&&(clearInterval(f),f=!1)}a.vakata.dnd.helper.css({left:b.pageX+a.vakata.dnd.helper_left+"px",top:b.pageY+a.vakata.dnd.helper_top+"px"});a(document).triggerHandler("drag.vakata",{event:b,data:a.vakata.dnd.user_data})}},drag_stop:function(b){f&&clearInterval(f);
d&&clearInterval(d);a(document).unbind("mousemove",a.vakata.dnd.drag);a(document).unbind("mouseup",a.vakata.dnd.drag_stop);a(document).triggerHandler("drag_stop.vakata",{event:b,data:a.vakata.dnd.user_data});a.vakata.dnd.helper.remove();a.vakata.dnd.init_x=0;a.vakata.dnd.init_y=0;a.vakata.dnd.user_data={};a.vakata.dnd.is_down=!1;a.vakata.dnd.is_drag=!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",
title:"vakata"})});a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",a.proxy(function(d){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.themes&&(g.attr("class","jstree-"+this.data.themes.theme),j&&j.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),
d.currentTarget===d.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==d.target))d=a.jstree._reference(d.target),d.data.dnd.foreign?(d=d._get_settings().dnd.drag_check.call(this,{o:b,r:d.get_container(),is_root:!0}),(!0===d||!0===d.inside||!0===d.before||!0===d.after)&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(d.prepare_move(b,d.get_container(),"last"),d.check_move()&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok"))},this)).bind("mouseup.jstree",a.proxy(function(d){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&d.currentTarget===d.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==d.target){var e=a.jstree._reference(d.currentTarget);e.data.dnd.foreign?(d=e._get_settings().dnd.drag_check.call(this,{o:b,r:e.get_container(),is_root:!0}),(!0===d||!0===d.inside||!0===d.before||!0===d.after)&&e._get_settings().dnd.drag_finish.call(this,
{o:b,r:e.get_container(),is_root:!0})):e.move_node(b,e.get_container(),"last",d[e._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",a.proxy(function(b){if(b.relatedTarget&&b.relatedTarget.id&&"jstree-marker-line"===b.relatedTarget.id)return!1;a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),
a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var d=this.get_container()[0];b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},d),100)):b.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&
clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},d),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop=this.scrollTop+a.vakata.dnd.scroll_spd},d),100)):b.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop=
this.scrollTop-a.vakata.dnd.scroll_spd},d),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",a.proxy(function(){a.vakata.dnd.is_drag&&(a.vakata.dnd.user_data.jstree&&g&&j)&&(g.hide(),j.hide())},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(1===a.which)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(b.currentTarget)},this)).delegate("a",
"mousemove.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&((!e||!e.length||e.children("a")[0]!==b.currentTarget)&&this.dnd_enter(b.currentTarget),"undefined"===typeof this.data.dnd.off.top&&(this.data.dnd.off=a(b.target).offset()),this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&
a.vakata.dnd.user_data.jstree){if(b.relatedTarget&&b.relatedTarget.id&&"jstree-marker-line"===b.relatedTarget.id)return!1;g&&g.hide();j&&j.hide();this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(b)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(b)},this));a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);
this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;g&&g.css({top:"-2000px"});j&&j.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(b,d){if(d.data.jstree){var e=a(d.event.target);
e.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(e)}},this));var d=this._get_settings().dnd;d.drag_target&&a(document).delegate(d.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(d){b=d.target;a.vakata.dnd.drag_start(d,{jstree:!0,obj:d.target},"<ins class='jstree-icon'></ins>"+a(d.target).text());this.data.themes&&(g&&g.attr("class","jstree-"+this.data.themes.theme),j&&j.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+
this.data.themes.theme));a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var e=this.get_container();this.data.dnd.cof=e.offset();this.data.dnd.cw=parseInt(e.width(),10);this.data.dnd.ch=parseInt(e.height(),10);this.data.dnd.foreign=!0;d.preventDefault()},this));d.drop_target&&a(document).delegate(d.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(d){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:b,r:a(d.target),e:d})&&a.vakata.dnd.helper.children("ins").attr("class",
"jstree-ok")},this)).delegate(d.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(d.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(d){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:b,r:a(d.target),e:d})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,
drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(e&&e.length){this.data.dnd.off=e.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+e.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:b,r:e});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=
a.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(b,e,"before");this.data.dnd.before=this.check_move();this.prepare_move(b,e,"after");this.data.dnd.after=this.check_move();this._is_loaded(e)?(this.prepare_move(b,e,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var b=["before","inside","after"],d=!1,e=this._get_settings().core.rtl,b=this.data.dnd.w<
this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];a.each(b,a.proxy(function(b,e){if(this.data.dnd[e])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),d=e,!1},this));!1===d&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");b=e?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(d){case "before":g.css({left:b+
"px",top:this.data.dnd.off.top-6+"px"}).show();j&&j.css({left:b+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case "after":g.css({left:b+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();j&&j.css({left:b+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case "inside":g.css({left:b+(e?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();j&&j.hide();break;default:g.hide(),j&&j.hide()}return s=d}},dnd_open:function(){this.data.dnd.to2=
!1;this.open_node(e,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:b,r:e,p:s}):(this.dnd_prepare(),this.move_node(b,e,s,a[this._get_settings().dnd.copy_modifier+"Key"]));e=b=!1;g.hide();j&&j.hide()},dnd_enter:function(b){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var d=this._get_settings().dnd;this.data.dnd.prepared=!1;
e=this._get_node(b);d.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),d.check_timeout)):this.dnd_prepare();d.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e&&(e.length&&e.hasClass("jstree-closed"))&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),d.open_timeout))):e&&(e.length&&e.hasClass("jstree-closed"))&&this.dnd_open()},dnd_leave:function(b){this.data.dnd.after=!1;this.data.dnd.before=!1;
this.data.dnd.inside=!1;a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");g.hide();j&&j.hide();if(e&&e[0]===b.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2))clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1},start_drag:function(d,e){b=this._get_node(d);this.data.ui&&this.is_selected(b)&&(b=this._get_node(null,!0));var f=1<b.length?this._get_string("multiple_selection"):this.get_text(b),m=this.get_container();this._get_settings().core.html_titles||
(f=f.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"));a.vakata.dnd.drag_start(e,{jstree:!0,obj:b},"<ins class='jstree-icon'></ins>"+f);this.data.themes&&(g&&g.attr("class","jstree-"+this.data.themes.theme),j&&j.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=m.offset();this.data.dnd.cw=parseInt(m.width(),10);this.data.dnd.ch=parseInt(m.height(),10);this.data.dnd.active=!0}}});a(function(){a.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",
title:"jstree"});g=a("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(a){g.hide();j.hide();a.preventDefault();a.stopImmediatePropagation();return!1}).appendTo("body");j=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(e&&e.length)return e.children("a").trigger(a),a.preventDefault(),a.stopImmediatePropagation(),!1}).bind("mouseleave",function(b){var d=a(b.relatedTarget);if((d.is(".jstree")||0===d.closest(".jstree").length)&&
e&&e.length)return e.children("a").trigger(b),g.hide(),j.hide(),b.preventDefault(),b.stopImmediatePropagation(),!1}).appendTo("body");a(document).bind("drag_start.vakata",function(a,b){b.data.jstree&&(g.show(),j&&j.show())});a(document).bind("drag_stop.vakata",function(a,b){b.data.jstree&&(g.hide(),j&&j.hide())})})})(l);(function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=
this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,c){this._prepare_checkboxes(c.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault();this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):
this.check_node(a.target);if(this.data.ui&&this.data.checkbox.noui){this.save_selected();this.data.cookies&&this.save_cookie("select_node")}else{a.stopImmediatePropagation();return false}},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(1E4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},
_fn:{_checkbox_notify:function(a,c){c.checked&&this.check_node(a,!1)},_prepare_checkboxes:function(b){b=!b||-1==b?this.get_container().find("> ul > li"):this._get_node(b);if(!1!==b){var e,g=this,j,f=this._get_settings().checkbox.two_state,d=this._get_settings().checkbox.real_checkboxes,l=this._get_settings().checkbox.real_checkboxes_names;b.each(function(){j=a(this);e=j.is("li")&&(j.hasClass("jstree-checked")||d&&j.children(":checked").length)?"jstree-checked":"jstree-unchecked";j.find("li").andSelf().each(function(){var b=
a(this),j;b.children("a"+(g.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(f?"jstree-unchecked":e);d&&(b.children(":checkbox").length?b.children(":checkbox").addClass("jstree-real-checkbox"):(j=l.call(g,b),b.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+j[0]+"' name='"+j[0]+"' value='"+j[1]+"' />")),"jstree-checked"===e&&b.children(":checkbox").attr("checked",
"checked"));"jstree-checked"===e&&!f&&b.find("li").addClass("jstree-checked")})});f||(1===b.length&&b.is("li")&&this._repair_state(b),b.is("li")?b.each(function(){g._repair_state(this)}):b.find("> ul > li").each(function(){g._repair_state(this)}),b.find(".jstree-checked").parent().parent().each(function(){g._repair_state(this)}))}},change_state:function(b,e){var b=this._get_node(b),g=!1,j=this._get_settings().checkbox.real_checkboxes;if(!b||-1===b)return!1;e=!1===e||!0===e?e:b.hasClass("jstree-checked");
if(this._get_settings().checkbox.two_state)e?(b.removeClass("jstree-checked").addClass("jstree-unchecked"),j&&b.children(":checkbox").removeAttr("checked")):(b.removeClass("jstree-unchecked").addClass("jstree-checked"),j&&b.children(":checkbox").attr("checked","checked"));else{if(e){g=b.find("li").andSelf();if(!g.filter(".jstree-checked, .jstree-undetermined").length)return!1;g.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");j&&g.children(":checkbox").removeAttr("checked")}else{g=
b.find("li").andSelf();if(!g.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;g.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");j&&g.children(":checkbox").attr("checked","checked");this.data.ui&&(this.data.ui.last_selected=b);this.data.checkbox.last_selected=b}b.parentsUntil(".jstree","li").each(function(){var b=a(this);if(e){if(b.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),
j&&b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;b.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");j&&b.children(":checkbox").removeAttr("checked")}else{if(b.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),j&&b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),
!1;b.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");j&&b.children(":checkbox").attr("checked","checked")}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(b);return!0},check_node:function(a){if(this.change_state(a,!1)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var c=this;a.parents(".jstree-closed").each(function(){c.open_node(this,!1,!0)})}this.__callback({obj:a})}},uncheck_node:function(a){this.change_state(a,
!0)&&this.__callback({obj:this._get_node(a)})},check_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!1)});this.__callback()},uncheck_all:function(){var a=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){a.change_state(this,!0)});this.__callback()},is_checked:function(a){a=this._get_node(a);
return a.length?a.is(".jstree-checked"):!1},get_checked:function(a,c){a=!a||-1===a?this.get_container():this._get_node(a);return c||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,c){a=!a||-1===a?this.get_container():this._get_node(a);return c||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},
show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length){var c=this._get_settings().checkbox.real_checkboxes,g=a.find("> ul > .jstree-checked").length,j=a.find("> ul > .jstree-undetermined").length,f=a.find("> ul > li").length;0===f?a.hasClass("jstree-undetermined")&&this.change_state(a,!1):0===g&&0===
j?this.change_state(a,!0):g===f?this.change_state(a,!1):(a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),c&&a.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var b=this,e=this.data.ui.to_select,e=a.map(a.makeArray(e),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,
"\\.").replace(/\:/g,"\\:")});this.deselect_all();a.each(e,function(a,c){b.check_node(c)});this.__callback()}else this.__call_old()},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&a.data.core.to_load.push("#"+this.id)})}}});a(function(){a.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})})})(l);(function(a){a.vakata.xslt=function(b,e,g){var d="",f;
if(document.recalc)return f=document.createElement("xml"),d=document.createElement("xml"),f.innerHTML=b,d.innerHTML=e,a("body").append(f).append(d),setTimeout(function(b,d,e){return function(){e.call(null,b.transformNode(d.XMLDocument));setTimeout(function(b,d){return function(){a(b).remove();a(d).remove()}}(b,d),200)}}(f,d,g),100),!0;"undefined"!==typeof window.DOMParser&&("undefined"!==typeof window.XMLHttpRequest&&"undefined"===typeof window.XSLTProcessor)&&(b=(new DOMParser).parseFromString(b,
"text/xml"),e=(new DOMParser).parseFromString(e,"text/xml"));if("undefined"!==typeof window.DOMParser&&"undefined"!==typeof window.XMLHttpRequest&&"undefined"!==typeof window.XSLTProcessor){f=new XSLTProcessor;d=a.isFunction(f.transformDocument)?"undefined"!==typeof window.XMLSerializer:!0;if(!d)return!1;b=(new DOMParser).parseFromString(b,"text/xml");e=(new DOMParser).parseFromString(e,"text/xml");a.isFunction(f.transformDocument)?(d=document.implementation.createDocument("","",null),f.transformDocument(b,
e,d,null),g.call(null,(new XMLSerializer).serializeToString(d))):(f.importStylesheet(e),d=f.transformToFragment(b,document),g.call(null,a("<div />").append(d).html()));return!0}return!1};var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:copy-of select="./child::node()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',
flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:copy-of select="./child::node()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},
e=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(b){var e=this._get_settings().xml_data,b=this._get_node(b);return-1==b||
!b||!e.ajax&&!a.isFunction(e.data)||b.is(".jstree-open, .jstree-leaf")||0<b.children("ul").children("li").size()},load_node_xml:function(b,e,g){var d=this.get_settings().xml_data,f=function(){},l=function(){};if((b=this._get_node(b))&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case !d.data&&!d.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(d.data):d.data.call(this,b,a.proxy(function(g){this.parse_xml(g,a.proxy(function(g){if(g){g=
g.replace(/ ?xmlns="[^"]*"/ig,"");if(g.length>10){g=a(g);if(b===-1||!b)this.get_container().children("ul").empty().append(g.children());else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(g);b.removeData("jstree-is-loading")}d.clean_node&&this.clean_node(b);e&&e.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(d.correct_state){this.correct_state(b);e&&e.call(this)}}else if(d.correct_state){this.get_container().children("ul").empty();
e&&e.call(this)}}},this))},this));break;case !!d.data&&!d.ajax||!!d.data&&!!d.ajax&&(!b||-1===b):(!b||-1==b)&&this.parse_xml(d.data,a.proxy(function(g){if(g){g=g.replace(/ ?xmlns="[^"]*"/ig,"");if(g.length>10){g=a(g);this.get_container().children("ul").empty().append(g.children());d.clean_node&&this.clean_node(b);e&&e.call(this)}}else if(d.correct_state){this.get_container().children("ul").empty();e&&e.call(this)}},this));break;case !d.data&&!!d.ajax||!!d.data&&!!d.ajax&&b&&-1!==b:f=function(a,c,
e){var j=this.get_settings().xml_data.ajax.error;j&&j.call(this,a,c,e);if(b!==-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&d.correct_state&&this.correct_state(b)}else c==="success"&&d.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},l=function(g,m,l){var g=l.responseText,n=this.get_settings().xml_data.ajax.success;n&&(g=n.call(this,g,m,l)||g);if(g===""||g&&g.toString&&g.toString().replace(/^[\s\n]+$/,
"")==="")return f.call(this,l,m,"");this.parse_xml(g,a.proxy(function(g){if(g){g=g.replace(/ ?xmlns="[^"]*"/ig,"");if(g.length>10){g=a(g);if(b===-1||!b)this.get_container().children("ul").empty().append(g.children());else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(g);b.removeData("jstree-is-loading")}d.clean_node&&this.clean_node(b);e&&e.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(d.correct_state){this.correct_state(b);
e&&e.call(this)}}else if(d.correct_state){this.get_container().children("ul").empty();e&&e.call(this)}}},this))},d.ajax.context=this,d.ajax.error=f,d.ajax.success=l,d.ajax.dataType||(d.ajax.dataType="xml"),a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,b)),a.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,b)),a.ajax(d.ajax)}},parse_xml:function(e,g){var f=this._get_settings().xml_data;a.vakata.xslt(e,b[f.xsl],g)},get_xml:function(b,g,f,d,l){var n="",s=this._get_settings(),
o=this,q,r,u,x,t;b||(b="flat");l||(l=0);g=this._get_node(g);if(!g||-1===g)g=this.get_container().find("> ul > li");f=a.isArray(f)?f:["id","class"];!l&&(this.data.types&&-1===a.inArray(s.types.type_attr,f))&&f.push(s.types.type_attr);d=a.isArray(d)?d:[];l||(s.xml_data.get_include_preamble&&(n+='<?xml version="1.0" encoding="UTF-8"?>'),n+="<root>");g.each(function(){n=n+"<item";u=a(this);a.each(f,function(a,b){var c=u.attr(b);if(!s.xml_data.get_skip_empty||typeof c!=="undefined")n=n+(" "+b+'="'+e((" "+
(c||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"')});u.hasClass("jstree-open")&&(n=n+' state="open"');u.hasClass("jstree-closed")&&(n=n+' state="closed"');b==="flat"&&(n=n+(' parent_id="'+e(l)+'"'));n=n+">";n=n+"<content>";x=u.children("a");x.each(function(){q=a(this);t=false;n=n+"<name";a.inArray("languages",s.plugins)!==-1&&a.each(s.languages,function(a,b){if(q.hasClass(b)){n=n+(' lang="'+e(b)+'"');t=b;return false}});d.length&&a.each(d,function(a,
b){var c=q.attr(b);if(!s.xml_data.get_skip_empty||typeof c!=="undefined")n=n+(" "+b+'="'+e((" "+c||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"')});q.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(n=n+(' icon="'+e(q.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'));q.children("ins").get(0).style.backgroundImage.length&&(n=n+(' icon="'+
e(q.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'));n=n+">";n=n+("<![CDATA["+o.get_text(q,t)+"]]\>");n=n+"</name>"});n=n+"</content>";r=u[0].id||true;u=u.find("> ul > li");r=u.length?o.get_xml(b,u,f,d,r):"";b=="nest"&&(n=n+r);n=n+"</item>";b=="flat"&&(n=n+r)});l||(n+="</root>");return n}}})})(l);(function(a){a.expr[":"].jstree_contains=function(a,c,g){return 0<=(a.textContent||a.innerText||"").toLowerCase().indexOf(g[3].toLowerCase())};
a.expr[":"].jstree_title_contains=function(a,c,g){return 0<=(a.getAttribute("title")||"").toLowerCase().indexOf(g[3].toLowerCase())};a.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=a();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(b,e){a(this).children("ul").find("li").hide().removeClass("jstree-last");e.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",
function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(b,e){if(""===a.trim(b))this.clear_search();else{var g=this.get_settings().search,j=this,f=function(){};this.data.search.str=b;if(!e&&!1!==g.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;f=function(a,b,c){var e=this.get_settings().search.ajax.success;
e&&(a=e.call(this,a,b,c)||a);this.data.search.to_open=a;this._search_open()};g.ajax.context=this;g.ajax.error=function(){};g.ajax.success=f;a.isFunction(g.ajax.url)&&(g.ajax.url=g.ajax.url.call(this,b));a.isFunction(g.ajax.data)&&(g.ajax.data=g.ajax.data.call(this,b));g.ajax.data||(g.ajax.data={search_string:b});if(!g.ajax.dataType||/^json/.exec(g.ajax.dataType))g.ajax.dataType="json";a.ajax(g.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+
(this.data.languages?"."+this.get_lang():"")+":"+g.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){j.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:b})}},clear_search:function(){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=a()},_search_open:function(){var b=this,e=!0,g=[],j=[];this.data.search.to_open.length&&
(a.each(this.data.search.to_open,function(b,d){if("#"==d)return!0;a(d).length&&a(d).is(".jstree-closed")?g.push(d):j.push(d)}),g.length&&(this.data.search.to_open=j,a.each(g,function(a,c){b.open_node(c,function(){b._search_open(!0)})}),e=!1));e&&this.search(this.data.search.str,!0)}}})})(l);(function(a){a.vakata.context={hide_on_mouseleave:!1,cnt:a("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(b,e,g,j,f,d,l){a.vakata.context.rtl=!!l;if(b=a.vakata.context.parse(b)){a.vakata.context.vis=
!0;a.vakata.context.tgt=e;a.vakata.context.par=d||e||null;a.vakata.context.data=f||null;a.vakata.context.cnt.html(b).css({visibility:"hidden",display:"block",left:0,top:0});if(a.vakata.context.hide_on_mouseleave)a.vakata.context.cnt.one("mouseleave",function(){a.vakata.context.hide()});f=a.vakata.context.cnt.height();d=a.vakata.context.cnt.width();g+d>a(document).width()&&(g=a(document).width()-(d+5),a.vakata.context.cnt.find("li > ul").addClass("right"));j+f>a(document).height()&&(j-=f+e[0].offsetHeight,
a.vakata.context.cnt.find("li > ul").addClass("bottom"));a.vakata.context.cnt.css({left:g,top:j}).find("li:has(ul)").bind("mouseenter",function(){var b=a(document).width(),d=a(document).height(),e=a(this).children("ul").show();b!==a(document).width()&&e.toggleClass("right");d!==a(document).height()&&e.toggleClass("bottom")}).bind("mouseleave",function(){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show();a(document).triggerHandler("context_show.vakata")}},hide:function(){a.vakata.context.vis=
!1;a.vakata.context.cnt.attr("class","").css({visibility:"hidden"});a(document).triggerHandler("context_hide.vakata")},parse:function(b,e){if(!b)return!1;var g="",j=!1,f=!0;e||(a.vakata.context.func={});g+="<ul>";a.each(b,function(b,e){if(!e)return true;a.vakata.context.func[b]=e.action;!f&&e.separator_before&&(g=g+"<li class='vakata-separator vakata-separator-before'></li>");f=false;g=g+("<li class='"+(e._class||"")+(e._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ");e.icon&&e.icon.indexOf("/")===
-1&&(g=g+(" class='"+e.icon+"' "));e.icon&&e.icon.indexOf("/")!==-1&&(g=g+(" style='background:url("+e.icon+") center center no-repeat;' "));g=g+(">&#160;</ins><a href='#' rel='"+b+"'>");e.submenu&&(g=g+("<span style='float:"+(a.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"));g=g+(e.label+"</a>");if(e.submenu)(j=a.vakata.context.parse(e.submenu,true))&&(g=g+j);g=g+"</li>";if(e.separator_after){g=g+"<li class='vakata-separator vakata-separator-after'></li>";f=true}});g=g.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,
"");g+="</ul>";a(document).triggerHandler("context_parse.vakata");return 10<g.length?g:!1},exec:function(b){return a.isFunction(a.vakata.context.func[b])?(a.vakata.context.func[b].call(a.vakata.context.data,a.vakata.context.par),!0):!1}};a(function(){a.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",
title:"vakata"});a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");a(document).bind("mousedown",function(b){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],b.target)&&
a.vakata.context.hide()});"undefined"!==typeof a.hotkeys&&a(document).bind("keydown","up",function(b){if(a.vakata.context.vis){var e=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();e.length||(e=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());e.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","down",function(b){if(a.vakata.context.vis){var e=
a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();e.length||(e=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());e.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","right",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),
b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","left",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","esc",function(b){a.vakata.context.hide();b.preventDefault()}).bind("keydown","space",function(b){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click();b.preventDefault()})});a.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(b){b.preventDefault();a(b.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(b.currentTarget,b.pageX,b.pageY)},this)).delegate("a","click.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=
!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.is_selected(a)?this.remove():this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,
separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,e,g){var b=this._get_node(b),j=this.get_settings().contextmenu,f=b.children("a:visible:eq(0)"),d=!1,d=!1;j.select_node&&(this.data.ui&&!this.is_selected(b))&&(this.deselect_all(),this.select_node(b,
!0));if(j.show_at_node||"undefined"===typeof e||"undefined"===typeof g)d=f.offset(),e=d.left,g=d.top+this.data.core.li_height;d=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:j.items;a.isFunction(d)&&(d=d.call(this,b));this.data.contextmenu=!0;a.vakata.context.show(d,f,e,g,this,b,this._get_settings().core.rtl);this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(l);(function(a){a.jstree.plugin("types",{__init:function(){var b=
this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",a.proxy(function(){var e=b.type_attr,g="",j=this;a.each(b.types,function(b,d){a.each(d,function(a){/^(max_depth|max_children|icon|valid_children)$/.test(a)||j.data.types.attach_to.push(a)});if(!d.icon)return!0;if(d.icon.image||d.icon.position)g="default"==b?g+(".jstree-"+j.get_index()+" a > .jstree-icon { "):g+(".jstree-"+j.get_index()+" li["+e+'="'+b+'"] > a > .jstree-icon { '),d.icon.image&&(g+=" background-image:url("+
d.icon.image+"); "),g=d.icon.position?g+(" background-position:"+d.icon.position+"; "):g+" background-position:0 0; ",g+="} "});""!==g&&a.vakata.css.add_sheet({str:g,title:"jstree-types"})},this)).bind("before.jstree",a.proxy(function(b,g){var j,f;if((j=(j=this._get_settings().types.use_data?this._get_node(g.args[0]):!1)&&-1!==j&&j.length?j.data("jstree"):!1)&&j.types&&!1===j.types[g.func])return b.stopImmediatePropagation(),!1;if(-1!==a.inArray(g.func,this.data.types.attach_to)&&g.args[0]&&(g.args[0].tagName||
g.args[0].jquery))if(j=this._get_settings().types.types,f=this._get_type(g.args[0]),(j[f]&&"undefined"!==typeof j[f][g.func]||j["default"]&&"undefined"!==typeof j["default"][g.func])&&!1===this._check(g.func,g.args[0]))return b.stopImmediatePropagation(),!1},this));f&&this.get_container().bind("load_node.jstree set_type.jstree",a.proxy(function(b,g){var j=g&&g.rslt&&g.rslt.obj&&-1!==g.rslt.obj?this._get_node(g.rslt.obj).parent():this.get_container_ul(),f=!1,d=this._get_settings().types;a.each(d.types,
function(a,b){if(b.icon&&(b.icon.image||b.icon.position))f="default"===a?j.find("li > a > .jstree-icon"):j.find("li["+d.type_attr+"='"+a+"'] > a > .jstree-icon"),b.icon.image&&f.css("backgroundImage","url("+b.icon.image+")"),f.css("backgroundPosition",b.icon.position||"0 0")})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,c){c.type&&this._get_settings().types.use_data&&
this.set_type(c.type,a)},_get_type:function(a){a=this._get_node(a);return!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,c){var c=this._get_node(c),g=!c.length||!a?!1:c.attr(this._get_settings().types.type_attr,a);g&&this.__callback({obj:c,type:a});return g},_check:function(b,e,g){var e=this._get_node(e),j=!1,f=this._get_type(e),d=0,l=this,n=this._get_settings().types,s=!1;if(-1===e)if(n[b])j=n[b];else return;else{if(!1===f)return;(s=n.use_data?e.data("jstree"):
!1)&&s.types&&"undefined"!==typeof s.types[b]?j=s.types[b]:n.types[f]&&"undefined"!==typeof n.types[f][b]?j=n.types[f][b]:n.types["default"]&&"undefined"!==typeof n.types["default"][b]&&(j=n.types["default"][b])}a.isFunction(j)&&(j=j.call(this,e));"max_depth"===b&&(-1!==e&&!1!==g&&-2!==n.max_depth&&0!==j)&&e.children("a:eq(0)").parentsUntil(".jstree","li").each(function(a){if(-1!==n.max_depth&&0>=n.max_depth-(a+1))return j=0,!1;d=0===a?j:l._check(b,this,!1);if(-1!==d&&0>=d-(a+1))return j=0,!1;if(0<=
d&&(d-(a+1)<j||0>j))j=d-(a+1);if(0<=n.max_depth&&(n.max_depth-(a+1)<j||0>j))j=n.max_depth-(a+1)});return j},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),e=b.rt._get_settings().types,g=b.rt._check("max_children",b.cr),j=b.rt._check("max_depth",b.cr),f=b.rt._check("valid_children",b.cr),d=0,l=1;if("none"===f||a.isArray(f)&&(b.ot&&b.ot._get_type)&&(b.o.each(function(){if(-1===a.inArray(b.ot._get_type(this),f))return l=!1}),!1===l)||-2!==e.max_children&&-1!==g&&(d=-1===
b.cr?this.get_container().find("> ul > li").not(b.o).length:b.cr.find("> ul > li").not(b.o).length,d+b.o.length>g))return!1;if(-2!==e.max_depth&&-1!==j){l=0;if(0===j)return!1;if("undefined"===typeof b.o.d){for(e=b.o;0<e.length;)e=e.find("> ul > li"),l++;b.o.d=l}if(0>j-b.o.d)return!1}return!0},create_node:function(b,e,g,j,f,d){if(!d&&(f||this._is_loaded(b))){var l="string"==typeof e&&e.match(/^before|after$/i)&&-1!==b?this._get_parent(b):this._get_node(b),n=this._get_settings().types,s=this._check("max_children",
l),o=this._check("max_depth",l),q=this._check("valid_children",l);"string"===typeof g&&(g={data:g});g||(g={});if("none"===q)return!1;if(a.isArray(q))if(!g.attr||!g.attr[n.type_attr])g.attr||(g.attr={}),g.attr[n.type_attr]=q[0];else if(-1===a.inArray(g.attr[n.type_attr],q))return!1;if(-2!==n.max_children&&-1!==s&&(l=-1===l?this.get_container().find("> ul > li").length:l.find("> ul > li").length,l+1>s)||-2!==n.max_depth&&-1!==o&&0>o-1)return!1}return this.__call_old(!0,b,e,g,j,f,d)}}})})(l);(function(a){a.jstree.plugin("html_data",
{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,c,g){var j=this;this.load_node_html(a,function(){j.__callback({obj:j._get_node(a)});c.call(this)},g)},_is_loaded:function(b){b=this._get_node(b);return-1==b||!b||!this._get_settings().html_data.ajax&&
!a.isFunction(this._get_settings().html_data.data)||b.is(".jstree-open, .jstree-leaf")||0<b.children("ul").children("li").size()},load_node_html:function(b,e,g){var j,f=this.get_settings().html_data,d=function(){};j=function(){};if((b=this._get_node(b))&&-1!==b){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case a.isFunction(f.data):f.data.call(this,b,a.proxy(function(d){if(d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""){d=a(d);d.is("ul")||(d=a("<ul />").append(d));
if(b==-1||!b)this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||
this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);e&&e.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(f.correct_state){this.correct_state(b);e&&e.call(this)}}else if(f.correct_state){this.get_container().children("ul").empty();e&&e.call(this)}},
this));break;case !f.data&&!f.ajax:if(!b||-1==b)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();e&&e.call(this);break;case !!f.data&&!f.ajax||!!f.data&&!!f.ajax&&(!b||-1===b):if(!b||
-1==b)j=a(f.data),j.is("ul")||(j=a("<ul />").append(j)),this.get_container().children("ul").empty().append(j.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();e&&e.call(this);break;case !f.data&&!!f.ajax||!!f.data&&!!f.ajax&&b&&-1!==b:b=this._get_node(b),d=function(a,
c,d){var e=this.get_settings().html_data.ajax.error;e&&e.call(this,a,c,d);if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");c==="success"&&f.correct_state&&this.correct_state(b)}else c==="success"&&f.correct_state&&this.get_container().children("ul").empty();g&&g.call(this)},j=function(g,j,k){var l=this.get_settings().html_data.ajax.success;l&&(g=l.call(this,g,j,k)||g);if(g===""||g&&g.toString&&g.toString().replace(/^[\s\n]+$/,"")===
"")return d.call(this,k,j,"");if(g){g=a(g);g.is("ul")||(g=a("<ul />").append(g));if(b==-1||!b)this.get_container().children("ul").empty().append(g.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(g).children("ul").find("li, a").filter(function(){return!this.firstChild||
!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);e&&e.call(this)}else if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(f.correct_state){this.correct_state(b);e&&e.call(this)}}else if(f.correct_state){this.get_container().children("ul").empty();
e&&e.call(this)}},f.ajax.context=this,f.ajax.error=d,f.ajax.success=j,f.ajax.dataType||(f.ajax.dataType="html"),a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,b)),a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,b)),a.ajax(f.ajax)}}}});a.jstree.defaults.plugins.push("html_data")})(l);(function(a){a.jstree.plugin("themeroller",{__init:function(){var b=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a",
"mouseenter.jstree",function(e){a(e.currentTarget).hasClass("jstree-loading")||a(this).addClass(b.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(b.item_h)}).bind("init.jstree",a.proxy(function(a,b){b.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(b.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",
a.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,c){c.rslt.obj.children("ins.jstree-icon").removeClass(b.opened+" "+b.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,
"").indexOf("ui-icon-")}).removeClass(b.item_open+" "+b.item_clsd).addClass(b.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").addClass(b.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(){this.get_container().find("a."+b.item_a).removeClass(b.item_a).end().find("a.jstree-clicked").addClass(b.item_a)},this)).bind("dehover_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").removeClass(b.item_h)},this)).bind("hover_node.jstree",
a.proxy(function(a,c){this.get_container().find("a."+b.item_h).not(c.rslt.obj).removeClass(b.item_h);c.rslt.obj.children("a").addClass(b.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.o);this._themeroller(b.rslt.op)},this))},__destroy:function(){var b=this._get_settings().themeroller,e=["ui-icon"];a.each(b,function(a,b){b=b.split(" ");b.length&&(e=e.concat(b))});this.get_container().removeClass("ui-widget-content").find("."+e.join(", .")).removeClass(e.join(" "))},
_fn:{_themeroller:function(a){var c=this._get_settings().themeroller,a=!a||-1==a?this.get_container_ul():this._get_node(a).parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(c.opened).addClass("ui-icon "+c.closed).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_leaf+" "+
c.item_open).addClass(c.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(c.closed).addClass("ui-icon "+c.opened).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_leaf+" "+c.item_clsd).addClass(c.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(c.closed+
" ui-icon "+c.opened).end().children("a").addClass(c.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(c.item_clsd,"").replace(c.item_open,"").replace(c.item_leaf,"").indexOf("ui-icon-")}).removeClass(c.item_clsd+" "+c.item_open).addClass(c.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",
item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});a(function(){a.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",title:"jstree"})})})(l);(function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(b,e){var g=[],j=!0,f;"move_node"==e.func&&(!0===e.args[4]&&e.args[0].o&&e.args[0].o.length)&&(e.args[0].o.children("a").each(function(){g.push(a(this).text().replace(/^\s+/g,
""))}),j=this._check_unique(g,e.args[0].np.find("> ul > li").not(e.args[0].o),"move_node"));if("create_node"==e.func&&(e.args[4]||this._is_loaded(e.args[0]))){j=this._get_node(e.args[0]);if(e.args[1]&&("before"===e.args[1]||"after"===e.args[1]))if(j=this._get_parent(e.args[0]),!j||-1===j)j=this.get_container();"string"===typeof e.args[2]?g.push(e.args[2]):!e.args[2]||!e.args[2].data?g.push(this._get_string("new_node")):g.push(e.args[2].data);j=this._check_unique(g,j.find("> ul > li"),"create_node")}if("rename_node"==
e.func){g.push(e.args[1]);f=this._get_node(e.args[0]);j=this._get_parent(f);if(!j||-1===j)j=this.get_container();j=this._check_unique(g,j.find("> ul > li").not(f),"rename_node")}if(!j)return b.stopPropagation(),!1},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(b,e,g){var j=[];e.children("a").each(function(){j.push(a(this).text().replace(/^\s+/g,""))});if(!j.length||!b.length)return!0;j=j.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,
"").split(",");return j.length+b.length!=j.concat(b).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,b,e,g),!1):!0},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),e=[];return b.o&&b.o.length?(b.o.children("a").each(function(){e.push(a(this).text().replace(/^\s+/g,""))}),this._check_unique(e,b.np.find("> ul > li").not(b.o),"check_move")):!0}}})})(l);
(function(c){c.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",c.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",c.proxy(function(a,c){this._prepare_wholerow_span(c&&c.rslt&&c.rslt.obj?c.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",
c.proxy(function(a,c){this.data.to&&clearTimeout(this.data.to);this.data.to=setTimeout(function(a,b){return function(){a._prepare_wholerow_ul(b)}}(this,c&&c.rslt&&c.rslt.obj?c.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",c.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",c.proxy(function(a,e){e.rslt.obj.each(function(){e.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((c(this).offset().top-e.inst.get_container().offset().top+e.inst.get_container()[0].scrollTop)/e.inst.data.core.li_height,10)+")").children("a").attr("class",e.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",c.proxy(function(a,c){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===a.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+
parseInt((c.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",c.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(a){var e=c(a.currentTarget);"A"===a.target.tagName||"INS"===a.target.tagName&&e.closest("li").is(".jstree-open, .jstree-closed")||(e.closest("li").children("a:visible:eq(0)").click(),a.stopImmediatePropagation())}).delegate("li",
"mouseover.jstree",c.proxy(function(a){a.stopImmediatePropagation();if(c(a.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(a.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",c.proxy(function(a){c(a.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(a.currentTarget)},this));(a||f)&&c.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();
this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(a){a=!a||-1==a?this.get_container().find("> ul > li"):this._get_node(a);!1!==a&&a.each(function(){c(this).find("li").andSelf().each(function(){var a=c(this);if(a.children(".jstree-wholerow-span").length)return!0;a.prepend("<span class='jstree-wholerow-span' style='width:"+18*a.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var b=this.get_container().children("ul").eq(0),
c=b.html();b.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==c&&(this.data.wholerow.last_html=c,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(b.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(b.parent()[0].scrollWidth).css("top",-1*(b.height()+(a?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});c(function(){var b=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
g&&(b+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(a||f)b+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";c.vakata.css.add_sheet({str:b,title:"jstree"})})})(l);(function(a){var b=
["getChildren","getChildrenCount","getAttr","getName","getProps"],e=function(b,e){var g=!0,b=b||{},e=[].concat(e);a.each(e,function(d,e){if(!a.isFunction(b[e]))return g=!1});return g};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(g,j){var f=-1==g?this._get_settings().model.object:g.data("jstree_model");if(!e(f,b))return j.call(null,!1);this._get_settings().model.async?f.getChildren(a.proxy(function(a){this.model_done(a,
j)},this)):this.model_done(f.getChildren(),j)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(b,e){var g=[],d=this._get_settings(),f=this;a.isArray(b)||(b=[b]);a.each(b,function(b,e){var j=e.getProps()||{};j.attr=e.getAttr()||{};e.getChildrenCount()&&(j.state="closed");j.data=e.getName();a.isArray(j.data)||(j.data=[j.data]);f.data.types&&a.isFunction(e.getType)&&(j.attr[d.types.type_attr]=e.getType());j.attr.id&&d.model.id_prefix&&(j.attr.id=d.model.id_prefix+j.attr.id);j.metadata||
(j.metadata={});j.metadata.jstree_model=e;g.push(j)});e.call(null,g)}}})})(l)}})()});define("jqgrid",["jquery","jqgrid-locale-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jqueryui"],function(l){(function(a){a.jgrid=a.jgrid||{};a.extend(a.jgrid,{htmlDecode:function(a){return a&&("&nbsp;"==a||"&#160;"==a||1==a.length&&160==a.charCodeAt(0))?"":!a?a:(""+a).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(a){return!a?a:(""+a).replace(/&/g,
"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(g){var c=a.makeArray(arguments).slice(1);void 0===g&&(g="");return g.replace(/\{(\d+)\}/g,function(a,e){return c[e]})},getCellIndex:function(g){g=a(g);if(g.is("tr"))return-1;g=(!g.is("td")&&!g.is("th")?g.closest("td,th"):g)[0];return a.browser.msie?a.inArray(g,g.parentNode.cells):g.cellIndex},stripHtml:function(a){var a=a+"",c=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return a?(a=a.replace(c,""))&&"&nbsp;"!==a&&"&#160;"!==
a?a.replace(/\"/g,"'"):"":a},stringToDoc:function(a){var c;if("string"!==typeof a)return a;try{c=(new DOMParser).parseFromString(a,"text/xml")}catch(b){c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(a)}return c&&c.documentElement&&"parsererror"!=c.documentElement.tagName?c:null},parse:function(g){"while(1);"==g.substr(0,9)&&(g=g.substr(9));"/*"==g.substr(0,2)&&(g=g.substr(2,g.length-4));g||(g="{}");return!0===a.jgrid.useJSON&&"object"===typeof ja&&"function"===typeof ja.parse?ja.parse(g):
eval("("+g+")")},parseDate:function(g,c){var b={m:1,d:1,y:1970,h:0,i:0,s:0},e,f,j;e=/[\\\/:_;.,\t\T\s-]/;if(c&&null!==c&&void 0!==c){var c=a.trim(c),c=c.split(e),g=g.split(e),m=a.jgrid.formatter.date.monthNames,d=a.jgrid.formatter.date.AmPm,l=function(a,b){0===a?12==b&&(b=0):12!=b&&(b+=12);return b};e=0;for(f=g.length;e<f;e++)"M"==g[e]&&(j=a.inArray(c[e],m),-1!==j&&12>j&&(c[e]=j+1)),"F"==g[e]&&(j=a.inArray(c[e],m),-1!==j&&11<j&&(c[e]=j+1-12)),"a"==g[e]&&(j=a.inArray(c[e],d),-1!==j&&(2>j&&c[e]==d[j])&&
(c[e]=j,b.h=l(c[e],b.h))),"A"==g[e]&&(j=a.inArray(c[e],d),-1!==j&&(1<j&&c[e]==d[j])&&(c[e]=j-2,b.h=l(c[e],b.h))),void 0!==c[e]&&(b[g[e].toLowerCase()]=parseInt(c[e],10));b.m=parseInt(b.m,10)-1;e=b.y;70<=e&&99>=e?b.y=1900+b.y:0<=e&&69>=e&&(b.y=2E3+b.y)}return new Date(b.y,b.m,b.d,b.h,b.i,b.s,0)},jqID:function(a){return(a+"").replace(/([\.\:\[\]])/g,"\\$1")},guid:1,uidPref:"jqg",randId:function(g){return(g?g:a.jgrid.uidPref)+a.jgrid.guid++},getAccessor:function(a,c){var b,e,f=[],j;if("function"===typeof c)return c(a);
b=a[c];if(void 0===b)try{if("string"===typeof c&&(f=c.split(".")),j=f.length)for(b=a;b&&j--;)e=f.shift(),b=b[e]}catch(m){}return b},ajaxOptions:{},from:function(g){return new function(c,b){"string"==typeof c&&(c=a.data(c));var e=this,g=c,j=!0,f=!1,d=b,l=/[\$,%]/g,n=null,s=null,o=!1,q="",r=[],u=!0;if("object"==typeof c&&c.push)0<c.length&&(u="object"!=typeof c[0]?!1:!0);else throw"data provides is not an array";this._hasData=function(){return null===g?!1:0===g.length?!1:!0};this._getStr=function(a){var b=
[];f&&b.push("jQuery.trim(");b.push("String("+a+")");f&&b.push(")");j||b.push(".toLowerCase()");return b.join("")};this._strComp=function(a){return"string"==typeof a?".toString()":""};this._group=function(a,b){return{field:a.toString(),unique:b,items:[]}};this._toStr=function(b){f&&(b=a.trim(b));j||(b=b.toLowerCase());return b.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"')};this._funcLoop=function(b){var c=[];a.each(g,function(a,d){c.push(b(d))});return c};this._append=function(a){d=null===
d?"":d+(""===q?" && ":q);o&&(d+="!");d+="("+a+")";o=!1;q=""};this._setCommand=function(a,b){n=a;s=b};this._resetNegate=function(){o=!1};this._repeatCommand=function(a,b){return null===n?e:null!==a&&null!==b?n(a,b):null===s||!u?n(a):n(s,a)};this._equals=function(a,b){return 0===e._compare(a,b,1)};this._compare=function(a,b,c){void 0===c&&(c=1);void 0===a&&(a=null);void 0===b&&(b=null);if(null===a&&null===b)return 0;if(null===a&&null!==b)return 1;if(null!==a&&null===b)return-1;!j&&("number"!==typeof a&&
"number"!==typeof b)&&(a=(""+a).toLowerCase(),b=(""+b).toLowerCase());return a<b?-c:a>b?c:0};this._performSort=function(){0!==r.length&&(g=e._doSort(g,0))};this._doSort=function(a,b){var c=r[b].by,d=r[b].dir,g=r[b].type,j=r[b].datefmt;if(b==r.length-1)return e._getOrder(a,c,d,g,j);b++;c=e._getGroup(a,c,d,g,j);d=[];for(g=0;g<c.length;g++)for(var j=e._doSort(c[g].items,b),f=0;f<j.length;f++)d.push(j[f]);return d};this._getOrder=function(b,c,d,g,j){var f=[],k=[],m="a"==d?1:-1,n,o;void 0===g&&(g="text");
o="float"==g||"number"==g||"currency"==g||"numeric"==g?function(a){a=parseFloat((""+a).replace(l,""));return isNaN(a)?0:a}:"int"==g||"integer"==g?function(a){return a?parseFloat((""+a).replace(l,"")):0}:"date"==g||"datetime"==g?function(b){return a.jgrid.parseDate(j,b).getTime()}:a.isFunction(g)?g:function(b){b||(b="");return a.trim((""+b).toUpperCase())};a.each(b,function(b,d){n=""!==c?a.jgrid.getAccessor(d,c):d;void 0===n&&(n="");n=o(n,d);k.push({vSort:n,index:b})});k.sort(function(a,b){a=a.vSort;
b=b.vSort;return e._compare(a,b,m)});for(var g=0,s=b.length;g<s;)d=k[g].index,f.push(b[d]),g++;return f};this._getGroup=function(b,c,d,g,j){var f=[],k=null,m=null,l;a.each(e._getOrder(b,c,d,g,j),function(b,d){l=a.jgrid.getAccessor(d,c);void 0===l&&(l="");e._equals(m,l)||(m=l,null!==k&&f.push(k),k=e._group(c,l));k.items.push(d)});null!==k&&f.push(k);return f};this.ignoreCase=function(){j=!1;return e};this.useCase=function(){j=!0;return e};this.trim=function(){f=!0;return e};this.noTrim=function(){f=
!1;return e};this.execute=function(){var b=d,c=[];if(null===b)return e;a.each(g,function(){eval(b)&&c.push(this)});g=c;return e};this.data=function(){return g};this.select=function(b){e._performSort();if(!e._hasData())return[];e.execute();if(a.isFunction(b)){var c=[];a.each(g,function(a,d){c.push(b(d))});return c}return g};this.hasMatch=function(){if(!e._hasData())return!1;e.execute();return 0<g.length};this.andNot=function(a,b,c){o=!o;return e.and(a,b,c)};this.orNot=function(a,b,c){o=!o;return e.or(a,
b,c)};this.not=function(a,b,c){return e.andNot(a,b,c)};this.and=function(a,b,c){q=" && ";return void 0===a?e:e._repeatCommand(a,b,c)};this.or=function(a,b,c){q=" || ";return void 0===a?e:e._repeatCommand(a,b,c)};this.isNot=function(a){o=!o;return e.is(a)};this.is=function(a){e._append("this."+a);e._resetNegate();return e};this._compareValues=function(b,c,d,g,j){var f;f=u?"jQuery.jgrid.getAccessor(this,'"+c+"')":"this";void 0===d&&(d=null);var k=d,m=void 0===j.stype?"text":j.stype;if(null!==d)switch(m){case "int":case "integer":k=
isNaN(Number(k))||""===k?"0":k;f="parseInt("+f+",10)";k="parseInt("+k+",10)";break;case "float":case "number":case "numeric":k=(""+k).replace(l,"");k=isNaN(Number(k))||""===k?"0":k;f="parseFloat("+f+")";k="parseFloat("+k+")";break;case "date":case "datetime":k=""+a.jgrid.parseDate(j.newfmt||"Y-m-d",k).getTime();f='jQuery.jgrid.parseDate("'+j.srcfmt+'",'+f+").getTime()";break;default:f=e._getStr(f),k=e._getStr('"'+e._toStr(k)+'"')}e._append(f+" "+g+" "+k);e._setCommand(b,c);e._resetNegate();return e};
this.equals=function(a,b,c){return e._compareValues(e.equals,a,b,"==",c)};this.notEquals=function(a,b,c){return e._compareValues(e.equals,a,b,"!==",c)};this.isNull=function(a,b,c){return e._compareValues(e.equals,a,null,"===",c)};this.greater=function(a,b,c){return e._compareValues(e.greater,a,b,">",c)};this.less=function(a,b,c){return e._compareValues(e.less,a,b,"<",c)};this.greaterOrEquals=function(a,b,c){return e._compareValues(e.greaterOrEquals,a,b,">=",c)};this.lessOrEquals=function(a,b,c){return e._compareValues(e.lessOrEquals,
a,b,"<=",c)};this.startsWith=function(b,c){var d=void 0===c||null===c?b:c,d=f?a.trim(d.toString()).length:d.toString().length;u?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".substr(0,"+d+") == "+e._getStr('"'+e._toStr(c)+'"')):(d=f?a.trim(c.toString()).length:c.toString().length,e._append(e._getStr("this")+".substr(0,"+d+") == "+e._getStr('"'+e._toStr(b)+'"')));e._setCommand(e.startsWith,b);e._resetNegate();return e};this.endsWith=function(b,c){var d=void 0===c||null===c?b:c,d=f?
a.trim(d.toString()).length:d.toString().length;u?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".substr("+e._getStr("jQuery.jgrid.getAccessor(this,'"+b+"')")+".length-"+d+","+d+') == "'+e._toStr(c)+'"'):e._append(e._getStr("this")+".substr("+e._getStr("this")+'.length-"'+e._toStr(b)+'".length,"'+e._toStr(b)+'".length) == "'+e._toStr(b)+'"');e._setCommand(e.endsWith,b);e._resetNegate();return e};this.contains=function(a,b){u?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+a+
"')")+'.indexOf("'+e._toStr(b)+'",0) > -1'):e._append(e._getStr("this")+'.indexOf("'+e._toStr(a)+'",0) > -1');e._setCommand(e.contains,a);e._resetNegate();return e};this.groupBy=function(a,b,c,d){return!e._hasData()?null:e._getGroup(g,a,b,c,d)};this.orderBy=function(b,c,d,g){c=void 0===c||null===c?"a":a.trim(c.toString().toLowerCase());if(null===d||void 0===d)d="text";if(null===g||void 0===g)g="Y-m-d";if("desc"==c||"descending"==c)c="d";if("asc"==c||"ascending"==c)c="a";r.push({by:b,dir:c,type:d,
datefmt:g});return e};return e}(g,null)},extend:function(g){a.extend(a.fn.jqGrid,g);this.no_legacy_api||a.fn.extend(g)}});a.fn.jqGrid=function(g){if("string"==typeof g){var c=a.jgrid.getAccessor(a.fn.jqGrid,g);if(!c)throw"jqGrid - No such method: "+g;var b=a.makeArray(arguments).slice(1);return c.apply(this,b)}return this.each(function(){if(!this.grid){var b=a.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],
sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,
editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,
deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],
groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],groupDataSorted:!1,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:!1,cmTemplate:{}},a.jgrid.defaults,g||{}),c={headers:[],cols:[],footers:[],dragStart:function(c,d,g){this.resizing={idx:c,startX:d.clientX,sOL:g[0]};this.hDiv.style.cursor="col-resize";this.curGbox=a("#rs_m"+a.jgrid.jqID(b.id),"#gbox_"+a.jgrid.jqID(b.id));this.curGbox.css({display:"block",
left:g[0],top:g[1],height:g[2]});a.isFunction(b.resizeStart)&&b.resizeStart.call(this,d,c);document.onselectstart=function(){return!1}},dragMove:function(a){if(this.resizing){var c=a.clientX-this.resizing.startX,a=this.headers[this.resizing.idx],d="ltr"===b.direction?a.width+c:a.width-c,g;33<d&&(this.curGbox.css({left:this.resizing.sOL+c}),!0===b.forceFit?(g=this.headers[this.resizing.idx+b.nv],c="ltr"===b.direction?g.width-c:g.width+c,33<c&&(a.newWidth=d,g.newWidth=c)):(this.newWidth="ltr"===b.direction?
b.tblwidth+c:b.tblwidth-c,a.newWidth=d))}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var c=this.resizing.idx,d=this.headers[c].newWidth||this.headers[c].width,d=parseInt(d,10);this.resizing=!1;a("#rs_m"+a.jgrid.jqID(b.id)).css("display","none");b.colModel[c].width=d;this.headers[c].width=d;this.headers[c].el.style.width=d+"px";this.cols[c].style.width=d+"px";0<this.footers.length&&(this.footers[c].style.width=d+"px");!0===b.forceFit?(d=this.headers[c+b.nv].newWidth||this.headers[c+
b.nv].width,this.headers[c+b.nv].width=d,this.headers[c+b.nv].el.style.width=d+"px",this.cols[c+b.nv].style.width=d+"px",0<this.footers.length&&(this.footers[c+b.nv].style.width=d+"px"),b.colModel[c+b.nv].width=d):(b.tblwidth=this.newWidth||b.tblwidth,a("table:first",this.bDiv).css("width",b.tblwidth+"px"),a("table:first",this.hDiv).css("width",b.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,b.footerrow&&(a("table:first",this.sDiv).css("width",b.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));
a.isFunction(b.resizeStop)&&b.resizeStop.call(this,d,c)}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){c.timer&&clearTimeout(c.timer);c.timer=null;var d=a(c.bDiv).height();if(d){var g=a("table:first",c.bDiv),j,f;if(g[0].rows.length)try{f=(j=g[0].rows[1])?a(j).outerHeight()||c.prevRowHeight:c.prevRowHeight}catch(m){f=c.prevRowHeight}if(f){c.prevRowHeight=f;var l=b.rowNum;j=c.scrollTop=c.bDiv.scrollTop;var n=Math.round(g.position().top)-j,p=n+g.height();f*=
l;var o,s,q;if(p<d&&0>=n&&(void 0===b.lastpage||parseInt((p+j+f-1)/f,10)<=b.lastpage))s=parseInt((d-p+f-1)/f,10),0<=p||2>s||!0===b.scroll?(o=Math.round((p+j)/f)+1,n=-1):n=1;0<n&&(o=parseInt(j/f,10)+1,s=parseInt((j+d)/f,10)+2-o,q=!0);if(s&&!(b.lastpage&&o>b.lastpage||1==b.lastpage||o===b.page&&o===b.lastpage))c.hDiv.loading?c.timer=setTimeout(c.populateVisible,b.scrollTimeout):(b.page=o,q&&(c.selectionPreserver(g[0]),c.emptyRows(c.bDiv,!1,!1)),c.populate(s))}}},scrollGrid:function(a){if(b.scroll){var d=
c.bDiv.scrollTop;void 0===c.scrollTop&&(c.scrollTop=0);d!=c.scrollTop&&(c.scrollTop=d,c.timer&&clearTimeout(c.timer),c.timer=setTimeout(c.populateVisible,b.scrollTimeout))}c.hDiv.scrollLeft=c.bDiv.scrollLeft;b.footerrow&&(c.sDiv.scrollLeft=c.bDiv.scrollLeft);a.stopPropagation()},selectionPreserver:function(b){var c=b.p,d=c.selrow,e=c.selarrrow?a.makeArray(c.selarrrow):null,g=b.grid.bDiv.scrollLeft,j=c.gridComplete;c.gridComplete=function(){c.selrow=null;c.selarrrow=[];if(c.multiselect&&e&&0<e.length)for(var f=
0;f<e.length;f++)e[f]!=d&&a(b).jqGrid("setSelection",e[f],!1);d&&a(b).jqGrid("setSelection",d,!1);b.grid.bDiv.scrollLeft=g;c.gridComplete=j;c.gridComplete&&j()}}};if("TABLE"!=this.tagName)alert("Element is not a table");else{a(this).empty().attr("tabindex","1");this.p=b;var j,f,d;if(0===this.p.colNames.length)for(j=0;j<this.p.colModel.length;j++)this.p.colNames[j]=this.p.colModel[j].label||this.p.colModel[j].name;if(this.p.colNames.length!==this.p.colModel.length)alert(a.jgrid.errors.model);else{var l=
a("<div class='ui-jqgrid-view'></div>"),n,s=a.browser.msie?!0:!1,o=a.browser.webkit||a.browser.safari?!0:!1;d=this;d.p.direction=a.trim(d.p.direction.toLowerCase());-1==a.inArray(d.p.direction,["ltr","rtl"])&&(d.p.direction="ltr");f=d.p.direction;a(l).insertBefore(this);a(this).appendTo(l).removeClass("scroll");var q=a("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");a(q).insertBefore(l).attr({id:"gbox_"+this.id,dir:f});a(l).appendTo(q).attr("id","gview_"+this.id);n=s&&6>=
a.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"";a("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(n).insertBefore(l);a("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(l);a(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+
this.id});var r=function(a,b){a=parseInt(a,10);return isNaN(a)?b?b:0:a},u=function(b,e,g,j,f,m){var l=d.p.colModel[b],n=l.align,p='style="',o=l.classes,s=l.name,q=[];n&&(p=p+("text-align:"+n+";"));l.hidden===true&&(p=p+"display:none;");if(e===0)p=p+("width: "+c.headers[b].width+"px;");else if(l.cellattr&&a.isFunction(l.cellattr)&&(b=l.cellattr.call(d,f,g,j,l,m))&&typeof b==="string"){b=b.replace(/style/i,"style").replace(/title/i,"title");if(b.indexOf("title")>-1)l.title=false;b.indexOf("class")>
-1&&(o=void 0);q=b.split("style");if(q.length===2){q[1]=a.trim(q[1].replace("=",""));if(q[1].indexOf("'")===0||q[1].indexOf('"')===0)q[1]=q[1].substring(1);p=p+q[1].replace(/'/gi,'"')}else p=p+'"'}if(!q.length){q[0]="";p=p+'"'}p=p+((o!==void 0?' class="'+o+'"':"")+(l.title&&g?' title="'+a.jgrid.stripHtml(g)+'"':""));p=p+(' aria-describedby="'+d.p.id+"_"+s+'"');return p+q[0]},x=function(b){return b===void 0||b===null||b===""?"&#160;":d.p.autoencode?a.jgrid.htmlEncode(b):b+""},t=function(b,c,e,g,j){var f=
d.p.colModel[e];if(typeof f.formatter!=="undefined"){b={rowId:b,colModel:f,gid:d.p.id,pos:e};c=a.isFunction(f.formatter)?f.formatter.call(d,c,b,g,j):a.fmatter?a.fn.fmatter(f.formatter,c,b,g,j):x(c)}else c=x(c);return c},v=function(a,b,c,d,e){b=t(a,b,c,e,"add");return'<td role="gridcell" '+u(c,d,b,e,a,true)+">"+b+"</td>"},B=function(a,b,c){var e='<input role="checkbox" type="checkbox" id="jqg_'+d.p.id+"_"+a+'" class="cbox" name="jqg_'+d.p.id+"_"+a+'"/>';return'<td role="gridcell" '+u(b,c,"",null,a,
true)+">"+e+"</td>"},C=function(a,b,c,d){c=(parseInt(c,10)-1)*parseInt(d,10)+1+b;return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+u(a,b,c,null,b,true)+">"+c+"</td>"},z=function(a){var b,c=[],e=0,g;for(g=0;g<d.p.colModel.length;g++){b=d.p.colModel[g];if(b.name!=="cb"&&b.name!=="subgrid"&&b.name!=="rn"){c[e]=a=="local"?b.name:a=="xml"?b.xmlmap||b.name:b.jsonmap||b.name;e++}}return c},A=function(b){var c=d.p.remapColumns;if(!c||!c.length)c=a.map(d.p.colModel,function(a,b){return b});
b&&(c=a.map(c,function(a){return a<b?null:a-b}));return c},E=function(b,c,e){if(d.p.deepempty)a("#"+a.jgrid.jqID(d.p.id)+" tbody:first tr:gt(0)").remove();else{var g=a("#"+a.jgrid.jqID(d.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(d.p.id)+" tbody:first").empty().append(g)}if(c&&d.p.scroll){a(">div:first",b).css({height:"auto"}).children("div:first").css({height:0,display:"none"});b.scrollTop=0}if(e===true&&d.p.treeGrid===true){d.p.data=[];d.p._index={}}},K=function(){var b=d.p.data.length,
c,e,g;c=d.p.rownumbers===true?1:0;e=d.p.multiselect===true?1:0;g=d.p.subGrid===true?1:0;c=d.p.keyIndex===false||d.p.loadonce===true?d.p.localReader.id:d.p.colModel[d.p.keyIndex+e+g+c].name;for(e=0;e<b;e++){g=a.jgrid.getAccessor(d.p.data[e],c);d.p._index[g]=e}},U=function(b,c,e,g,j){var f=new Date,k=d.p.datatype!="local"&&d.p.loadonce||d.p.datatype=="xmlstring",m=d.p.datatype=="local"?"local":"xml";if(k){d.p.data=[];d.p._index={};d.p.localReader.id="_id_"}d.p.reccount=0;if(a.isXMLDoc(b)){if(d.p.treeANode===
-1&&!d.p.scroll){E(c,false,true);e=1}else e=e>1?e:1;var l,n,p=0,o,s=0,q=0,r=0,t,u=[],x,y={},K,D,F=[],W=d.p.altRows===true?" "+d.p.altclass:"";d.p.xmlReader.repeatitems||(u=z(m));t=d.p.keyIndex===false?d.p.xmlReader.id:d.p.keyIndex;if(u.length>0&&!isNaN(t)){d.p.remapColumns&&d.p.remapColumns.length&&(t=a.inArray(t,d.p.remapColumns));t=u[t]}m=(t+"").indexOf("[")===-1?u.length?function(b,c){return a(t,b).text()||c}:function(b,c){return a(d.p.xmlReader.cell,b).eq(t).text()||c}:function(a,b){return a.getAttribute(t.replace(/[\[\]]/g,
""))||b};d.p.userData={};a(d.p.xmlReader.page,b).each(function(){d.p.page=this.textContent||this.text||0});a(d.p.xmlReader.total,b).each(function(){d.p.lastpage=this.textContent||this.text;if(d.p.lastpage===void 0)d.p.lastpage=1});a(d.p.xmlReader.records,b).each(function(){d.p.records=this.textContent||this.text||0});a(d.p.xmlReader.userdata,b).each(function(){d.p.userData[this.getAttribute("name")]=this.textContent||this.text});(b=a(d.p.xmlReader.root+" "+d.p.xmlReader.row,b))||(b=[]);var I=b.length,
L=0,G={},H;if(b&&I){H=parseInt(d.p.rowNum,10);var P=d.p.scroll?a.jgrid.randId():1;j&&(H=H*(j+1));var j=a.isFunction(d.p.afterInsertRow),U="";for(d.p.grouping&&d.p.groupingView.groupCollapse===true&&(U=' style="display:none;"');L<I;){K=b[L];D=m(K,P+L);l=e===0?0:e+1;l=(l+L)%2==1?W:"";F.push("<tr"+U+' id="'+D+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+d.p.direction+""+l+'">');if(d.p.rownumbers===true){F.push(C(0,L,d.p.page,d.p.rowNum));r=1}if(d.p.multiselect===true){F.push(B(D,
r,L));s=1}if(d.p.subGrid===true){F.push(a(d).jqGrid("addSubGridCell",s+r,L+e));q=1}if(d.p.xmlReader.repeatitems){x||(x=A(s+q+r));var fa=a(d.p.xmlReader.cell,K);a.each(x,function(a){var b=fa[this];if(!b)return false;o=b.textContent||b.text;y[d.p.colModel[a+s+q+r].name]=o;F.push(v(D,o,a+s+q+r,L+e,K))})}else for(l=0;l<u.length;l++){o=a(u[l],K).text();y[d.p.colModel[l+s+q+r].name]=o;F.push(v(D,o,l+s+q+r,L+e,K))}F.push("</tr>");if(d.p.grouping){l=d.p.groupingView.groupField.length;for(var S=[],O=0;O<l;O++)S.push(y[d.p.groupingView.groupField[O]]);
G=a(d).jqGrid("groupingPrepare",F,S,G,y);F=[]}if(k||d.p.treeGrid===true){y._id_=D;d.p.data.push(y);d.p._index[D]=d.p.data.length-1}if(d.p.gridview===false){a("tbody:first",c).append(F.join(""));j&&d.p.afterInsertRow.call(d,D,y,K);F=[]}y={};p++;L++;if(p==H)break}}if(d.p.gridview===true){n=d.p.treeANode>-1?d.p.treeANode:0;if(d.p.grouping){a(d).jqGrid("groupingRender",G,d.p.colModel.length);G=null}else d.p.treeGrid===true&&n>0?a(d.rows[n]).after(F.join("")):a("tbody:first",c).append(F.join(""))}if(d.p.subGrid===
true)try{a(d).jqGrid("addSubGrid",s+r)}catch(Q){}d.p.totaltime=new Date-f;if(p>0&&d.p.records===0)d.p.records=I;F=null;if(d.p.treeGrid===true)try{a(d).jqGrid("setTreeNode",n+1,p+n+1)}catch(ha){}if(!d.p.treeGrid&&!d.p.scroll)d.grid.bDiv.scrollTop=0;d.p.reccount=p;d.p.treeANode=-1;d.p.userDataOnFooter&&a(d).jqGrid("footerData","set",d.p.userData,true);if(k){d.p.records=I;d.p.lastpage=Math.ceil(I/H)}g||d.updatepager(false,true);if(k)for(;p<I;){K=b[p];D=m(K,p);if(d.p.xmlReader.repeatitems){x||(x=A(s+
q+r));var N=a(d.p.xmlReader.cell,K);a.each(x,function(a){var b=N[this];if(!b)return false;o=b.textContent||b.text;y[d.p.colModel[a+s+q+r].name]=o})}else for(l=0;l<u.length;l++){o=a(u[l],K).text();y[d.p.colModel[l+s+q+r].name]=o}y._id_=D;d.p.data.push(y);d.p._index[D]=d.p.data.length-1;y={};p++}}},y=function(b,c,e,g,j){var f=new Date;if(b){if(d.p.treeANode===-1&&!d.p.scroll){E(c,false,true);e=1}else e=e>1?e:1;var k,m=d.p.datatype!="local"&&d.p.loadonce||d.p.datatype=="jsonstring";if(m){d.p.data=[];
d.p._index={};d.p.localReader.id="_id_"}d.p.reccount=0;if(d.p.datatype=="local"){c=d.p.localReader;k="local"}else{c=d.p.jsonReader;k="json"}var l=0,n,p,o=[],s,q=0,r=0,t=0,u,x,y={},K,F,D=[],W=d.p.altRows===true?" "+d.p.altclass:"";d.p.page=a.jgrid.getAccessor(b,c.page)||0;u=a.jgrid.getAccessor(b,c.total);d.p.lastpage=u===void 0?1:u;d.p.records=a.jgrid.getAccessor(b,c.records)||0;d.p.userData=a.jgrid.getAccessor(b,c.userdata)||{};c.repeatitems||(s=o=z(k));k=d.p.keyIndex===false?c.id:d.p.keyIndex;if(o.length>
0&&!isNaN(k)){d.p.remapColumns&&d.p.remapColumns.length&&(k=a.inArray(k,d.p.remapColumns));k=o[k]}(x=a.jgrid.getAccessor(b,c.root))||(x=[]);u=x.length;var b=0,I=parseInt(d.p.rowNum,10),L=d.p.scroll?a.jgrid.randId():1;j&&(I=I*(j+1));var G=a.isFunction(d.p.afterInsertRow),H={},P="";for(d.p.grouping&&d.p.groupingView.groupCollapse===true&&(P=' style="display:none;"');b<u;){j=x[b];F=a.jgrid.getAccessor(j,k);if(F===void 0){F=L+b;o.length===0&&c.cell&&(F=a.jgrid.getAccessor(j,c.cell)[k]||F)}n=e===1?0:e;
n=(n+b)%2==1?W:"";D.push("<tr"+P+' id="'+F+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+d.p.direction+""+n+'">');if(d.p.rownumbers===true){D.push(C(0,b,d.p.page,d.p.rowNum));t=1}if(d.p.multiselect){D.push(B(F,t,b));q=1}if(d.p.subGrid){D.push(a(d).jqGrid("addSubGridCell",q+t,b+e));r=1}if(c.repeatitems){c.cell&&(j=a.jgrid.getAccessor(j,c.cell));s||(s=A(q+r+t))}for(p=0;p<s.length;p++){n=a.jgrid.getAccessor(j,s[p]);D.push(v(F,n,p+q+r+t,b+e,j));y[d.p.colModel[p+q+r+t].name]=n}D.push("</tr>");
if(d.p.grouping){n=d.p.groupingView.groupField.length;p=[];for(var U=0;U<n;U++)p.push(y[d.p.groupingView.groupField[U]]);H=a(d).jqGrid("groupingPrepare",D,p,H,y);D=[]}if(m||d.p.treeGrid===true){y._id_=F;d.p.data.push(y);d.p._index[F]=d.p.data.length-1}if(d.p.gridview===false){a("#"+a.jgrid.jqID(d.p.id)+" tbody:first").append(D.join(""));G&&d.p.afterInsertRow.call(d,F,y,j);D=[]}y={};l++;b++;if(l==I)break}if(d.p.gridview===true){K=d.p.treeANode>-1?d.p.treeANode:0;d.p.grouping?a(d).jqGrid("groupingRender",
H,d.p.colModel.length):d.p.treeGrid===true&&K>0?a(d.rows[K]).after(D.join("")):a("#"+a.jgrid.jqID(d.p.id)+" tbody:first").append(D.join(""))}if(d.p.subGrid===true)try{a(d).jqGrid("addSubGrid",q+t)}catch(fa){}d.p.totaltime=new Date-f;if(l>0&&d.p.records===0)d.p.records=u;if(d.p.treeGrid===true)try{a(d).jqGrid("setTreeNode",K+1,l+K+1)}catch(S){}if(!d.p.treeGrid&&!d.p.scroll)d.grid.bDiv.scrollTop=0;d.p.reccount=l;d.p.treeANode=-1;d.p.userDataOnFooter&&a(d).jqGrid("footerData","set",d.p.userData,true);
if(m){d.p.records=u;d.p.lastpage=Math.ceil(u/I)}g||d.updatepager(false,true);if(m)for(;l<u&&x[l];){j=x[l];F=a.jgrid.getAccessor(j,k);if(F===void 0){F=L+l;o.length===0&&c.cell&&(F=a.jgrid.getAccessor(j,c.cell)[k]||F)}if(j){if(c.repeatitems){c.cell&&(j=a.jgrid.getAccessor(j,c.cell));s||(s=A(q+r+t))}for(p=0;p<s.length;p++){n=a.jgrid.getAccessor(j,s[p]);y[d.p.colModel[p+q+r+t].name]=n}y._id_=F;d.p.data.push(y);d.p._index[F]=d.p.data.length-1;y={}}l++}}},S=function(){function b(c){var d=0,e,j,f;if(c.groups!==
void 0)for(e=0;e<c.groups.length;e++){try{b(c.groups[e])}catch(k){alert(k)}d++}if(c.rules!==void 0){if(d>0){var m=o.select();o=a.jgrid.from(m)}try{for(e=0;e<c.rules.length;e++){f=c.rules[e];j=c.groupOp.toString().toUpperCase();if(p[f.op]&&f.field){d>0&&(j&&j==="OR")&&(o=o.or());o=p[f.op](o,j)(f.field,f.data,g[f.field])}d++}}catch(l){alert(l)}}}var c,e=false,g={},j=[],f=[],k,m,l;if(a.isArray(d.p.data)){var n=d.p.grouping?d.p.groupingView:false;a.each(d.p.colModel,function(){m=this.sorttype||"text";
if(m=="date"||m=="datetime"){if(this.formatter&&typeof this.formatter==="string"&&this.formatter=="date"){k=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:a.jgrid.formatter.date.srcformat;l=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:a.jgrid.formatter.date.newformat}else k=l=this.datefmt||"Y-m-d";g[this.name]={stype:m,srcfmt:k,newfmt:l}}else g[this.name]={stype:m,srcfmt:"",newfmt:""};if(d.p.grouping&&this.name==n.groupField[0]){var b=
this.name;if(typeof this.index!="undefined")b=this.index;j[0]=g[b];f.push(b)}if(!e&&(this.index==d.p.sortname||this.name==d.p.sortname)){c=this.name;e=true}});if(d.p.treeGrid)a(d).jqGrid("SortTree",c,d.p.sortorder,g[c].stype,g[c].srcfmt);else{var p={eq:function(a){return a.equals},ne:function(a){return a.notEquals},lt:function(a){return a.less},le:function(a){return a.lessOrEquals},gt:function(a){return a.greater},ge:function(a){return a.greaterOrEquals},cn:function(a){return a.contains},nc:function(a,
b){return b==="OR"?a.orNot().contains:a.andNot().contains},bw:function(a){return a.startsWith},bn:function(a,b){return b==="OR"?a.orNot().startsWith:a.andNot().startsWith},en:function(a,b){return b==="OR"?a.orNot().endsWith:a.andNot().endsWith},ew:function(a){return a.endsWith},ni:function(a,b){return b==="OR"?a.orNot().equals:a.andNot().equals},"in":function(a){return a.equals},nu:function(a){return a.isNull},nn:function(a,b){return b==="OR"?a.orNot().isNull:a.andNot().isNull}},o=a.jgrid.from(d.p.data);
d.p.ignoreCase&&(o=o.ignoreCase());if(d.p.search===true){var s=d.p.postData.filters;if(s){typeof s=="string"&&(s=a.jgrid.parse(s));b(s)}else try{o=p[d.p.postData.searchOper](o)(d.p.postData.searchField,d.p.postData.searchString,g[d.p.postData.searchField])}catch(q){}}if(d.p.grouping){o.orderBy(f,n.groupOrder[0],j[0].stype,j[0].srcfmt);n.groupDataSorted=true}c&&(d.p.sortorder&&e)&&(d.p.sortorder.toUpperCase()=="DESC"?o.orderBy(d.p.sortname,"d",g[c].stype,g[c].srcfmt):o.orderBy(d.p.sortname,"a",g[c].stype,
g[c].srcfmt));var s=o.select(),r=parseInt(d.p.rowNum,10),t=s.length,u=parseInt(d.p.page,10),v=Math.ceil(t/r),x={},s=s.slice((u-1)*r,u*r),g=o=null;x[d.p.localReader.total]=v;x[d.p.localReader.page]=u;x[d.p.localReader.records]=t;x[d.p.localReader.root]=s;s=null;return x}}},D=function(){d.grid.hDiv.loading=true;if(!d.p.hiddengrid)switch(d.p.loadui){case "enable":a("#load_"+a.jgrid.jqID(d.p.id)).show();break;case "block":a("#lui_"+a.jgrid.jqID(d.p.id)).show();a("#load_"+a.jgrid.jqID(d.p.id)).show()}},
Y=function(){d.grid.hDiv.loading=false;switch(d.p.loadui){case "enable":a("#load_"+a.jgrid.jqID(d.p.id)).hide();break;case "block":a("#lui_"+a.jgrid.jqID(d.p.id)).hide();a("#load_"+a.jgrid.jqID(d.p.id)).hide()}},X=function(b){if(!d.grid.hDiv.loading){var c=d.p.scroll&&b===false,e={},g,j=d.p.prmNames;if(d.p.page<=0)d.p.page=1;if(j.search!==null)e[j.search]=d.p.search;j.nd!==null&&(e[j.nd]=(new Date).getTime());if(j.rows!==null)e[j.rows]=d.p.rowNum;if(j.page!==null)e[j.page]=d.p.page;if(j.sort!==null)e[j.sort]=
d.p.sortname;if(j.order!==null)e[j.order]=d.p.sortorder;if(d.p.rowTotal!==null&&j.totalrows!==null)e[j.totalrows]=d.p.rowTotal;var f=d.p.loadComplete,k=a.isFunction(f);k||(f=null);var m=0,b=b||1;if(b>1)if(j.npage!==null){e[j.npage]=b;m=b-1;b=1}else f=function(a){d.p.page++;d.grid.hDiv.loading=false;k&&d.p.loadComplete.call(d,a);X(b-1)};else j.npage!==null&&delete d.p.postData[j.npage];if(d.p.grouping){a(d).jqGrid("groupingSetup");d.p.groupingView.groupDataSorted===true&&(e[j.sort]=d.p.groupingView.groupField[0]+
" "+d.p.groupingView.groupOrder[0]+", "+e[j.sort])}a.extend(d.p.postData,e);var l=!d.p.scroll?1:d.rows.length-1;if(a.isFunction(d.p.datatype))d.p.datatype.call(d,d.p.postData,"load_"+d.p.id);else{a.isFunction(d.p.beforeRequest)&&d.p.beforeRequest.call(d);g=d.p.datatype.toLowerCase();switch(g){case "json":case "jsonp":case "xml":case "script":a.ajax(a.extend({url:d.p.url,type:d.p.mtype,dataType:g,data:a.isFunction(d.p.serializeGridData)?d.p.serializeGridData.call(d,d.p.postData):d.p.postData,success:function(a){g===
"xml"?U(a,d.grid.bDiv,l,b>1,m):y(a,d.grid.bDiv,l,b>1,m);f&&f.call(d,a);c&&d.grid.populateVisible();if(d.p.loadonce||d.p.treeGrid)d.p.datatype="local";Y()},error:function(b,c,e){a.isFunction(d.p.loadError)&&d.p.loadError.call(d,b,c,e);Y()},beforeSend:function(b){D();a.isFunction(d.p.loadBeforeSend)&&d.p.loadBeforeSend.call(d,b)}},a.jgrid.ajaxOptions,d.p.ajaxGridOptions));break;case "xmlstring":D();e=a.jgrid.stringToDoc(d.p.datastr);U(e,d.grid.bDiv);k&&d.p.loadComplete.call(d,e);d.p.datatype="local";
d.p.datastr=null;Y();break;case "jsonstring":D();e=typeof d.p.datastr=="string"?a.jgrid.parse(d.p.datastr):d.p.datastr;y(e,d.grid.bDiv);k&&d.p.loadComplete.call(d,e);d.p.datatype="local";d.p.datastr=null;Y();break;case "local":case "clientside":D();d.p.datatype="local";e=S();y(e,d.grid.bDiv,l,b>1,m);f&&f.call(d,e);c&&d.grid.populateVisible();Y()}}}};n=function(b,c){var e="",g="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",j="",k,l,n,
p,o=function(b){var c;a.isFunction(d.p.onPaging)&&(c=d.p.onPaging.call(d,b));d.p.selrow=null;if(d.p.multiselect){d.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(d.p.id),d.grid.hDiv).attr("checked",false)}d.p.savedRow=[];return c=="stop"?false:true},b=b.substr(1);k="pg_"+b;l=b+"_left";n=b+"_center";p=b+"_right";a("#"+a.jgrid.jqID(b)).append("<div id='"+k+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+
l+"' align='left'></td><td id='"+n+"' align='center' style='white-space:pre;'></td><td id='"+p+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(d.p.rowList.length>0){j="<td dir='"+f+"'>";j=j+"<select class='ui-pg-selbox' role='listbox'>";for(l=0;l<d.p.rowList.length;l++)j=j+('<option role="option" value="'+d.p.rowList[l]+'"'+(d.p.rowNum==d.p.rowList[l]?' selected="selected"':"")+">"+d.p.rowList[l]+"</option>");j=j+"</select></td>"}f=="rtl"&&(g=g+j);d.p.pginput===true&&(e="<td dir='"+
f+"'>"+a.jgrid.format(d.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>");if(d.p.pgbuttons===true){l=["first"+c,"prev"+c,"next"+c,"last"+c];f=="rtl"&&l.reverse();g=g+("<td id='"+l[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>");g=g+("<td id='"+l[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>");g=g+(e!==""?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+
e+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"")+("<td id='"+l[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>");g=g+("<td id='"+l[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>")}else e!==""&&(g=g+e);f=="ltr"&&(g=g+j);g=g+"</tr></tbody></table>";d.p.viewrecords===true&&a("td#"+b+"_"+d.p.recordpos,"#"+k).append("<div dir='"+f+"' style='text-align:"+
d.p.recordpos+"' class='ui-paging-info'></div>");a("td#"+b+"_"+d.p.pagerpos,"#"+k).append(g);j=a(".ui-jqgrid").css("font-size")||"11px";a(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+j+";visibility:hidden;' ></div>");g=a(g).clone().appendTo("#testpg").width();a("#testpg").remove();if(g>0){e!==""&&(g=g+50);a("td#"+b+"_"+d.p.pagerpos,"#"+k).width(g)}d.p._nvtd=[];d.p._nvtd[0]=g?Math.floor((d.p.width-g)/2):Math.floor(d.p.width/3);d.p._nvtd[1]=
0;g=null;a(".ui-pg-selbox","#"+k).bind("change",function(){d.p.page=Math.round(d.p.rowNum*(d.p.page-1)/this.value-0.5)+1;d.p.rowNum=this.value;c?a(".ui-pg-selbox",d.p.pager).val(this.value):d.p.toppager&&a(".ui-pg-selbox",d.p.toppager).val(this.value);if(!o("records"))return false;X();return false});if(d.p.pgbuttons===true){a(".ui-pg-button","#"+k).hover(function(){if(a(this).hasClass("ui-state-disabled"))this.style.cursor="default";else{a(this).addClass("ui-state-hover");this.style.cursor="pointer"}},
function(){if(!a(this).hasClass("ui-state-disabled")){a(this).removeClass("ui-state-hover");this.style.cursor="default"}});a("#first"+c+", #prev"+c+", #next"+c+", #last"+c,"#"+b).click(function(){var a=r(d.p.page,1),b=r(d.p.lastpage,1),e=false,g=true,j=true,f=true,k=true;if(b===0||b===1)k=f=j=g=false;else if(b>1&&a>=1)a===1?j=g=false:a>1&&a<b||a===b&&(k=f=false);else if(b>1&&a===0){k=f=false;a=b-1}if(this.id==="first"+c&&g){d.p.page=1;e=true}if(this.id==="prev"+c&&j){d.p.page=a-1;e=true}if(this.id===
"next"+c&&f){d.p.page=a+1;e=true}if(this.id==="last"+c&&k){d.p.page=b;e=true}if(e){if(!o(this.id))return false;X()}return false})}d.p.pginput===true&&a("input.ui-pg-input","#"+k).keypress(function(b){if((b.charCode?b.charCode:b.keyCode?b.keyCode:0)==13){d.p.page=a(this).val()>0?a(this).val():d.p.page;if(!o("user"))return false;X();return false}return this})};var V=function(b,c,e,g){if(d.p.colModel[c].sortable&&!(d.p.savedRow.length>0)){if(!e){if(d.p.lastsort==c)if(d.p.sortorder=="asc")d.p.sortorder=
"desc";else{if(d.p.sortorder=="desc")d.p.sortorder="asc"}else d.p.sortorder=d.p.colModel[c].firstsortorder||"asc";d.p.page=1}if(g){if(d.p.lastsort==c&&d.p.sortorder==g&&!e)return;d.p.sortorder=g}e=a("thead:first",d.grid.hDiv).get(0);a("tr th:eq("+d.p.lastsort+") span.ui-grid-ico-sort",e).addClass("ui-state-disabled");a("tr th:eq("+d.p.lastsort+")",e).attr("aria-selected","false");a("tr th:eq("+c+") span.ui-icon-"+d.p.sortorder,e).removeClass("ui-state-disabled");a("tr th:eq("+c+")",e).attr("aria-selected",
"true");if(!d.p.viewsortcols[0]&&d.p.lastsort!=c){a("tr th:eq("+d.p.lastsort+") span.s-ico",e).hide();a("tr th:eq("+c+") span.s-ico",e).show()}b=b.substring(5);d.p.sortname=d.p.colModel[c].index||b;e=d.p.sortorder;if(a.isFunction(d.p.onSortCol)&&d.p.onSortCol.call(d,b,c,e)=="stop")d.p.lastsort=c;else{if(d.p.datatype=="local")d.p.deselectAfterSort&&a(d).jqGrid("resetSelection");else{d.p.selrow=null;d.p.multiselect&&a("#cb_"+a.jgrid.jqID(d.p.id),d.grid.hDiv).attr("checked",false);d.p.selarrrow=[];d.p.savedRow=
[]}if(d.p.scroll){e=d.grid.bDiv.scrollLeft;E(d.grid.bDiv,true,false);d.grid.hDiv.scrollLeft=e}d.p.subGrid&&d.p.datatype=="local"&&a("td.sgexpanded","#"+a.jgrid.jqID(d.p.id)).each(function(){a(this).trigger("click")});X();d.p.lastsort=c;if(d.p.sortname!=b&&c)d.p.lastsort=c}}},G=function(b){var c,e={},g=o?0:d.p.cellLayout;for(c=e[0]=e[1]=e[2]=0;c<=b;c++)d.p.colModel[c].hidden===false&&(e[0]=e[0]+(d.p.colModel[c].width+g));d.p.direction=="rtl"&&(e[0]=d.p.width-e[0]);e[0]=e[0]-d.grid.bDiv.scrollLeft;
a(d.grid.cDiv).is(":visible")&&(e[1]=e[1]+(a(d.grid.cDiv).height()+parseInt(a(d.grid.cDiv).css("padding-top"),10)+parseInt(a(d.grid.cDiv).css("padding-bottom"),10)));if(d.p.toolbar[0]===true&&(d.p.toolbar[1]=="top"||d.p.toolbar[1]=="both"))e[1]=e[1]+(a(d.grid.uDiv).height()+parseInt(a(d.grid.uDiv).css("border-top-width"),10)+parseInt(a(d.grid.uDiv).css("border-bottom-width"),10));d.p.toppager&&(e[1]=e[1]+(a(d.grid.topDiv).height()+parseInt(a(d.grid.topDiv).css("border-bottom-width"),10)));e[2]=e[2]+
(a(d.grid.bDiv).height()+a(d.grid.hDiv).height());return e};this.p.id=this.id;-1==a.inArray(d.p.multikey,["shiftKey","altKey","ctrlKey"])&&(d.p.multikey=!1);d.p.keyIndex=!1;for(j=0;j<d.p.colModel.length;j++)d.p.colModel[j]=a.extend(!0,{},d.p.cmTemplate,d.p.colModel[j].template||{},d.p.colModel[j]),!1===d.p.keyIndex&&!0===d.p.colModel[j].key&&(d.p.keyIndex=j);d.p.sortorder=d.p.sortorder.toLowerCase();!0===d.p.grouping&&(d.p.scroll=!1,d.p.rownumbers=!1,d.p.subGrid=!1,d.p.treeGrid=!1,d.p.gridview=!0);
if(!0===this.p.treeGrid){try{a(this).jqGrid("setTreeGrid")}catch(Q){}"local"!=d.p.datatype&&(d.p.localReader={id:"_id_"})}if(this.p.subGrid)try{a(d).jqGrid("setSubGrid")}catch(H){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:o?d.p.multiselectWidth+d.p.cellLayout:d.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),
this.p.colModel.unshift({name:"rn",width:d.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));d.p.xmlReader=a.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},d.p.xmlReader);d.p.jsonReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",
subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},d.p.jsonReader);d.p.localReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},d.p.localReader);d.p.scroll&&(d.p.pgbuttons=!1,d.p.pginput=!1,d.p.rowList=[]);d.p.data.length&&K();var O="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",$,W,fa,ha,L,I,P,F;W=F="";if(!0===d.p.shrinkToFit&&!0===d.p.forceFit)for(j=d.p.colModel.length-
1;0<=j;j--)if(!d.p.colModel[j].hidden){d.p.colModel[j].resizable=!1;break}"horizontal"==d.p.viewsortcols[1]&&(F=" ui-i-asc",W=" ui-i-desc");$=s?"class='ui-th-div-ie'":"";F="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+F+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+f+"'></span>"+("<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+W+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+f+"'></span></span>");for(j=0;j<this.p.colNames.length;j++)W=
d.p.headertitles?' title="'+a.jgrid.stripHtml(d.p.colNames[j])+'"':"",O+="<th id='"+d.p.id+"_"+d.p.colModel[j].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+f+"'"+W+">",W=d.p.colModel[j].index||d.p.colModel[j].name,O+="<div id='jqgh_"+d.p.colModel[j].name+"' "+$+">"+d.p.colNames[j],d.p.colModel[j].width=d.p.colModel[j].width?parseInt(d.p.colModel[j].width,10):150,"boolean"!==typeof d.p.colModel[j].title&&(d.p.colModel[j].title=!0),W==d.p.sortname&&(d.p.lastsort=j),O+=F+
"</div></th>";F=null;a(this).append(O+"</tr></thead>");a("thead tr:first th",this).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(this.p.multiselect){var Ka=[],Ba;a("#cb_"+a.jgrid.jqID(d.p.id),this).bind("click",function(){d.p.selarrrow=[];if(this.checked){a(d.rows).each(function(b){if(b>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("jqgroup")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(d.p.id)+"_"+a.jgrid.jqID(this.id)).attr("checked",
"checked");a(this).addClass("ui-state-highlight").attr("aria-selected","true");d.p.selarrrow.push(this.id);d.p.selrow=this.id}});Ba=true;Ka=[]}else{a(d.rows).each(function(b){if(b>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(d.p.id)+"_"+a.jgrid.jqID(this.id)).removeAttr("checked");a(this).removeClass("ui-state-highlight").attr("aria-selected","false");Ka.push(this.id)}});d.p.selrow=null;Ba=false}a.isFunction(d.p.onSelectAll)&&d.p.onSelectAll.call(d,
Ba?d.p.selarrrow:Ka,Ba)})}!0===d.p.autowidth&&(O=a(q).innerWidth(),d.p.width=0<O?O:"nw");(function(){var b=0,e=o?0:d.p.cellLayout,g=0,j,f=d.p.scrollOffset,m,l=false,n,p=0,s=0,q;a.each(d.p.colModel,function(){if(typeof this.hidden==="undefined")this.hidden=false;this.widthOrg=m=r(this.width,0);if(this.hidden===false){b=b+(m+e);this.fixed?p=p+(m+e):g++;s++}});isNaN(d.p.width)?d.p.width=c.width=b:c.width=d.p.width;d.p.tblwidth=b;if(d.p.shrinkToFit===false&&d.p.forceFit===true)d.p.forceFit=false;if(d.p.shrinkToFit===
true&&g>0){n=c.width-e*g-p;if(!isNaN(d.p.height)){n=n-f;l=true}b=0;a.each(d.p.colModel,function(a){if(this.hidden===false&&!this.fixed){this.width=m=Math.round(n*this.width/(d.p.tblwidth-e*g-p));b=b+m;j=a}});q=0;l?c.width-p-(b+e*g)!==f&&(q=c.width-p-(b+e*g)-f):!l&&Math.abs(c.width-p-(b+e*g))!==1&&(q=c.width-p-(b+e*g));d.p.colModel[j].width=d.p.colModel[j].width+q;d.p.tblwidth=b+q+e*g+p;if(d.p.tblwidth>d.p.width){d.p.colModel[j].width=d.p.colModel[j].width-(d.p.tblwidth-parseInt(d.p.width,10));d.p.tblwidth=
d.p.width}}})();a(q).css("width",c.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+d.p.id+"'>&#160;</div>");a(l).css("width",c.width+"px");var O=a("thead:first",d).get(0),ca="";d.p.footerrow&&(ca+="<table role='grid' style='width:"+d.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+f+"'>");var l=a("tr:first",O),ta="<tr class='jqgfirstrow' role='row' style='height:auto'>";d.p.disableClick=
!1;a("th",l).each(function(b){fa=d.p.colModel[b].width;if(typeof d.p.colModel[b].resizable==="undefined")d.p.colModel[b].resizable=true;if(d.p.colModel[b].resizable){ha=document.createElement("span");a(ha).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+f);a.browser.opera||a(ha).css("cursor","col-resize");a(this).addClass(d.p.resizeclass)}else ha="";a(this).css("width",fa+"px").prepend(ha);var e="";if(d.p.colModel[b].hidden){a(this).css("display","none");e="display:none;"}ta=ta+("<td role='gridcell' style='height:0px;width:"+
fa+"px;"+e+"'></td>");c.headers[b]={width:fa,el:this};L=d.p.colModel[b].sortable;if(typeof L!=="boolean")L=d.p.colModel[b].sortable=true;e=d.p.colModel[b].name;e=="cb"||e=="subgrid"||e=="rn"||d.p.viewsortcols[2]&&a("div",this).addClass("ui-jqgrid-sortable");if(L)if(d.p.viewsortcols[0]){a("div span.s-ico",this).show();b==d.p.lastsort&&a("div span.ui-icon-"+d.p.sortorder,this).removeClass("ui-state-disabled")}else if(b==d.p.lastsort){a("div span.s-ico",this).show();a("div span.ui-icon-"+d.p.sortorder,
this).removeClass("ui-state-disabled")}d.p.footerrow&&(ca=ca+("<td role='gridcell' "+u(b,0,"",null,"",false)+">&#160;</td>"))}).mousedown(function(b){if(a(b.target).closest("th>span.ui-jqgrid-resize").length==1){var e=a.jgrid.getCellIndex(this);if(d.p.forceFit===true){var g=d.p,j=e,f;for(f=e+1;f<d.p.colModel.length;f++)if(d.p.colModel[f].hidden!==true){j=f;break}g.nv=j-e}c.dragStart(e,b,G(e));return false}}).click(function(b){if(d.p.disableClick)return d.p.disableClick=false;var c="th>div.ui-jqgrid-sortable",
e,g;d.p.viewsortcols[2]||(c="th>div>span>span.ui-grid-ico-sort");b=a(b.target).closest(c);if(b.length==1){c=a.jgrid.getCellIndex(this);if(!d.p.viewsortcols[2]){e=true;g=b.attr("sort")}V(a("div",this)[0].id,c,e,g);return false}});if(d.p.sortable&&a.fn.sortable)try{a(d).jqGrid("sortableColumns",l)}catch(Ea){}d.p.footerrow&&(ca+="</tr></tbody></table>");ta+="</tr>";this.appendChild(document.createElement("tbody"));a(this).addClass("ui-jqgrid-btable").append(ta);var ta=null,l=a("<table class='ui-jqgrid-htable' style='width:"+
d.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(O),ka=d.p.caption&&!0===d.p.hiddengrid?!0:!1;j=a("<div class='ui-jqgrid-hbox"+("rtl"==f?"-rtl":"")+"'></div>");O=null;c.hDiv=document.createElement("div");a(c.hDiv).css({width:c.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(j);a(j).append(l);l=null;ka&&a(c.hDiv).hide();d.p.pager&&("string"==typeof d.p.pager?"#"!=d.p.pager.substr(0,1)&&(d.p.pager="#"+d.p.pager):
d.p.pager="#"+a(d.p.pager).attr("id"),a(d.p.pager).css({width:c.width+"px"}).appendTo(q).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom"),ka&&a(d.p.pager).hide(),n(d.p.pager,""));!1===d.p.cellEdit&&!0===d.p.hoverrows&&a(d).bind("mouseover",function(b){P=a(b.target).closest("tr.jqgrow");a(P).attr("class")!=="subgrid"&&a(P).addClass("ui-state-hover");return false}).bind("mouseout",function(b){P=a(b.target).closest("tr.jqgrow");a(P).removeClass("ui-state-hover");return false});var Aa,Fa;
a(d).before(c.hDiv).click(function(b){I=b.target;P=a(I,d.rows).closest("tr.jqgrow");if(a(P).length===0||P[0].className.indexOf("ui-state-disabled")>-1)return this;var c=a(I).hasClass("cbox"),e=true;a.isFunction(d.p.beforeSelectRow)&&(e=d.p.beforeSelectRow.call(d,P[0].id,b));if(!(I.tagName=="A"||(I.tagName=="INPUT"||I.tagName=="TEXTAREA"||I.tagName=="OPTION"||I.tagName=="SELECT")&&!c)&&e===true){if(d.p.cellEdit===true)if(d.p.multiselect&&c)a(d).jqGrid("setSelection",P[0].id,true);else{Aa=P[0].rowIndex;
Fa=a.jgrid.getCellIndex(I);try{a(d).jqGrid("editCell",Aa,Fa,true)}catch(g){}}else if(d.p.multikey)if(b[d.p.multikey])a(d).jqGrid("setSelection",P[0].id,true);else{if(d.p.multiselect&&c){c=a("[id^=jqg_"+a.jgrid.jqID(d.p.id)+"_]").attr("checked");a("[id^=jqg_"+a.jgrid.jqID(d.p.id)+"_]").attr("checked",!c)}}else{if(d.p.multiselect&&d.p.multiboxonly&&!c){a(d.p.selarrrow).each(function(b,c){var e=d.rows.namedItem(c);a(e).removeClass("ui-state-highlight");a("#jqg_"+a.jgrid.jqID(d.p.id)+"_"+a.jgrid.jqID(c)).attr("checked",
false)});d.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(d.p.id),d.grid.hDiv).attr("checked",false)}a(d).jqGrid("setSelection",P[0].id,true)}if(a.isFunction(d.p.onCellSelect)){Aa=P[0].id;Fa=a.jgrid.getCellIndex(I);d.p.onCellSelect.call(d,Aa,Fa,a(I).html(),b)}b.stopPropagation()}else return this}).bind("reloadGrid",function(b,c){if(d.p.treeGrid===true)d.p.datatype=d.p.treedatatype;c&&c.current&&d.grid.selectionPreserver(d);if(d.p.datatype=="local"){a(d).jqGrid("resetSelection");d.p.data.length&&K()}else if(!d.p.treeGrid){d.p.selrow=
null;if(d.p.multiselect){d.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(d.p.id),d.grid.hDiv).attr("checked",false)}d.p.savedRow=[]}d.p.scroll&&E(d.grid.bDiv,true,false);if(c&&c.page){var e=c.page;if(e>d.p.lastpage)e=d.p.lastpage;e<1&&(e=1);d.p.page=e;d.grid.bDiv.scrollTop=d.grid.prevRowHeight?(e-1)*d.grid.prevRowHeight*d.p.rowNum:0}if(d.grid.prevRowHeight&&d.p.scroll){delete d.p.lastpage;d.grid.populateVisible()}else d.grid.populate();return false});a.isFunction(this.p.ondblClickRow)&&a(this).dblclick(function(b){I=
b.target;P=a(I,d.rows).closest("tr.jqgrow");if(a(P).length===0)return false;Aa=P[0].rowIndex;Fa=a.jgrid.getCellIndex(I);d.p.ondblClickRow.call(d,a(P).attr("id"),Aa,Fa,b);return false});a.isFunction(this.p.onRightClickRow)&&a(this).bind("contextmenu",function(b){I=b.target;P=a(I,d.rows).closest("tr.jqgrow");if(a(P).length===0)return false;d.p.multiselect||a(d).jqGrid("setSelection",P[0].id,true);Aa=P[0].rowIndex;Fa=a.jgrid.getCellIndex(I);d.p.onRightClickRow.call(d,a(P).attr("id"),Aa,Fa,b);return false});
c.bDiv=document.createElement("div");s&&"auto"===(""+d.p.height).toLowerCase()&&(d.p.height="100%");a(c.bDiv).append(a('<div style="position:relative;'+(s&&8>a.browser.version?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:d.p.height+(isNaN(d.p.height)?"":"px"),width:c.width+"px"}).scroll(c.scrollGrid);a("table:first",c.bDiv).css({width:d.p.tblwidth+"px"});s?(2==a("tbody",this).size()&&a("tbody:gt(0)",this).remove(),d.p.multikey&&a(c.bDiv).bind("selectstart",
function(){return false})):d.p.multikey&&a(c.bDiv).bind("mousedown",function(){return false});ka&&a(c.bDiv).hide();c.cDiv=document.createElement("div");var ea=!0===d.p.hidegrid?a("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){ea.addClass("ui-state-hover")},function(){ea.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"==f?"left":"right","0px"):"";a(c.cDiv).append(ea).append("<span class='ui-jqgrid-title"+
("rtl"==f?"-rtl":"")+"'>"+d.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");a(c.cDiv).insertBefore(c.hDiv);d.p.toolbar[0]&&(c.uDiv=document.createElement("div"),"top"==d.p.toolbar[1]?a(c.uDiv).insertBefore(c.hDiv):"bottom"==d.p.toolbar[1]&&a(c.uDiv).insertAfter(c.hDiv),"both"==d.p.toolbar[1]?(c.ubDiv=document.createElement("div"),a(c.uDiv).insertBefore(c.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),a(c.ubDiv).insertAfter(c.hDiv).addClass("ui-userdata ui-state-default").attr("id",
"tb_"+this.id),ka&&a(c.ubDiv).hide()):a(c.uDiv).width(c.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),ka&&a(c.uDiv).hide());d.p.toppager&&(d.p.toppager=a.jgrid.jqID(d.p.id)+"_toppager",c.topDiv=a("<div id='"+d.p.toppager+"'></div>")[0],d.p.toppager="#"+d.p.toppager,a(c.topDiv).insertBefore(c.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(c.width),n(d.p.toppager,"_t"));d.p.footerrow&&(c.sDiv=a("<div class='ui-jqgrid-sdiv'></div>")[0],j=a("<div class='ui-jqgrid-hbox"+
("rtl"==f?"-rtl":"")+"'></div>"),a(c.sDiv).append(j).insertAfter(c.hDiv).width(c.width),a(j).append(ca),c.footers=a(".ui-jqgrid-ftable",c.sDiv)[0].rows[0].cells,d.p.rownumbers&&(c.footers[0].className="ui-state-default jqgrid-rownum"),ka&&a(c.sDiv).hide());j=null;if(d.p.caption){var ma=d.p.datatype;!0===d.p.hidegrid&&(a(".ui-jqgrid-titlebar-close",c.cDiv).click(function(b){var e=a.isFunction(d.p.onHeaderClick),g=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",j,f=this;if(d.p.toolbar[0]===
true){d.p.toolbar[1]=="both"&&(g=g+(", #"+a(c.ubDiv).attr("id")));g=g+(", #"+a(c.uDiv).attr("id"))}j=a(g,"#gview_"+a.jgrid.jqID(d.p.id)).length;d.p.gridstate=="visible"?a(g,"#gbox_"+a.jgrid.jqID(d.p.id)).slideUp("fast",function(){j--;if(j===0){a("span",f).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");d.p.gridstate="hidden";a("#gbox_"+a.jgrid.jqID(d.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(d.p.id)).hide();e&&(ka||d.p.onHeaderClick.call(d,
d.p.gridstate,b))}}):d.p.gridstate=="hidden"&&a(g,"#gbox_"+a.jgrid.jqID(d.p.id)).slideDown("fast",function(){j--;if(j===0){a("span",f).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(ka){d.p.datatype=ma;X();ka=false}d.p.gridstate="visible";a("#gbox_"+a.jgrid.jqID(d.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(d.p.id)).show();e&&(ka||d.p.onHeaderClick.call(d,d.p.gridstate,b))}});return false}),ka&&(d.p.datatype="local",a(".ui-jqgrid-titlebar-close",
c.cDiv).trigger("click")))}else a(c.cDiv).hide();a(c.hDiv).after(c.bDiv).mousemove(function(a){if(c.resizing){c.dragMove(a);return false}});a(".ui-jqgrid-labels",c.hDiv).bind("selectstart",function(){return false});a(document).mouseup(function(){if(c.resizing){c.dragEnd();return false}return true});d.formatCol=u;d.sortData=V;d.updatepager=function(b,c){var e,g,j,f,k,m,l,n="";j=parseInt(d.p.page,10)-1;j<0&&(j=0);j=j*parseInt(d.p.rowNum,10);k=j+d.p.reccount;if(d.p.scroll){e=a("tbody:first > tr:gt(0)",
d.grid.bDiv);j=k-e.length;d.p.reccount=e.length;if(g=e.outerHeight()||d.grid.prevRowHeight){e=j*g;g=g*parseInt(d.p.records,10);a(">div:first",d.grid.bDiv).css({height:g}).children("div:first").css({height:e,display:e?"":"none"})}d.grid.bDiv.scrollLeft=d.grid.hDiv.scrollLeft}n=d.p.pager?d.p.pager:"";if(n=n+(d.p.toppager?n?","+d.p.toppager:d.p.toppager:"")){l=a.jgrid.formatter.integer||{};e=r(d.p.page);g=r(d.p.lastpage);a(".selbox",n).attr("disabled",false);if(d.p.pginput===true){a(".ui-pg-input",n).val(d.p.page);
a("#sp_1",n).html(a.fmatter?a.fmatter.util.NumberFormat(d.p.lastpage,l):d.p.lastpage)}if(d.p.viewrecords)if(d.p.reccount===0)a(".ui-paging-info",n).html(d.p.emptyrecords);else{f=j+1;m=d.p.records;if(a.fmatter){f=a.fmatter.util.NumberFormat(f,l);k=a.fmatter.util.NumberFormat(k,l);m=a.fmatter.util.NumberFormat(m,l)}a(".ui-paging-info",n).html(a.jgrid.format(d.p.recordtext,f,k,m))}if(d.p.pgbuttons===true){e<=0&&(e=g=0);if(e==1||e===0){a("#first, #prev",d.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");
d.p.toppager&&a("#first_t, #prev_t",d.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#first, #prev",d.p.pager).removeClass("ui-state-disabled");d.p.toppager&&a("#first_t, #prev_t",d.p.toppager).removeClass("ui-state-disabled")}if(e==g||e===0){a("#next, #last",d.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");d.p.toppager&&a("#next_t, #last_t",d.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#next, #last",d.p.pager).removeClass("ui-state-disabled");
d.p.toppager&&a("#next_t, #last_t",d.p.toppager).removeClass("ui-state-disabled")}}}b===true&&d.p.rownumbers===true&&a("td.jqgrid-rownum",d.rows).each(function(b){a(this).html(j+1+b)});c&&d.p.jqgdnd&&a(d).jqGrid("gridDnD","updateDnD");a.isFunction(d.p.gridComplete)&&d.p.gridComplete.call(d)};d.refreshIndex=K;d.formatter=function(a,b,c,d,e){return t(a,b,c,d,e)};a.extend(c,{populate:X,emptyRows:E});this.grid=c;d.addXmlData=function(a){U(a,d.grid.bDiv)};d.addJSONData=function(a){y(a,d.grid.bDiv)};this.grid.cols=
this.rows[0].cells;X();d.p.hiddengrid=!1;a(window).unload(function(){d=null})}}}})};a.jgrid.extend({getGridParam:function(a){var c=this[0];if(c&&c.grid)return a?"undefined"!=typeof c.p[a]?c.p[a]:null:c.p},setGridParam:function(g){return this.each(function(){this.grid&&"object"===typeof g&&a.extend(!0,this.p,g)})},getDataIDs:function(){var g=[],c=0,b,e=0;this.each(function(){if((b=this.rows.length)&&0<b)for(;c<b;)a(this.rows[c]).hasClass("jqgrow")&&(g[e]=this.rows[c].id,e++),c++});return g},setSelection:function(g,
c){return this.each(function(){var b,e,f;if(void 0!==g&&(c=!1===c?!1:!0,(e=this.rows.namedItem(g+""))&&!(-1<e.className.indexOf("ui-state-disabled")))){if(!0===this.p.scrollrows&&(b=this.rows.namedItem(g).rowIndex,0<=b)){f=a(this.grid.bDiv)[0].clientHeight;var j=a(this.grid.bDiv)[0].scrollTop,m=this.rows[b].offsetTop;b=this.rows[b].clientHeight;m+b>=f+j?a(this.grid.bDiv)[0].scrollTop=m-(f+j)+b+j:m<f+j&&m<j&&(a(this.grid.bDiv)[0].scrollTop=m)}this.p.multiselect?(this.p.selrow=e.id,f=a.inArray(this.p.selrow,
this.p.selarrrow),-1===f?("ui-subgrid"!==e.className&&a(e).addClass("ui-state-highlight").attr("aria-selected","true"),b=!0,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",b),this.p.selarrrow.push(this.p.selrow)):("ui-subgrid"!==e.className&&a(e).removeClass("ui-state-highlight").attr("aria-selected","false"),b=!1,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",b),this.p.selarrrow.splice(f,1),f=this.p.selarrrow[0],this.p.selrow=void 0===
f?null:f),this.p.onSelectRow&&c&&this.p.onSelectRow.call(this,e.id,b)):"ui-subgrid"!==e.className&&(this.p.selrow!=e.id?(a(this.rows.namedItem(this.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),a(e).addClass("ui-state-highlight").attr({"aria-selected":!0,tabindex:"0"}),b=!0):b=!1,this.p.selrow=e.id,this.p.onSelectRow&&c&&this.p.onSelectRow.call(this,e.id,b))}})},resetSelection:function(g){return this.each(function(){var c=this,b,e;"undefined"!==typeof g?
(e=g===c.p.selrow?c.p.selrow:g,a("#"+a.jgrid.jqID(c.p.id)+" tbody:first tr#"+a.jgrid.jqID(e)).removeClass("ui-state-highlight").attr("aria-selected","false"),c.p.multiselect&&(a("#jqg_"+a.jgrid.jqID(c.p.id)+"_"+a.jgrid.jqID(e)).attr("checked",!1),a("#cb_"+a.jgrid.jqID(c.p.id)).attr("checked",!1)),e=null):c.p.multiselect?(a(c.p.selarrrow).each(function(e,g){b=c.rows.namedItem(g);a(b).removeClass("ui-state-highlight").attr("aria-selected","false");a("#jqg_"+a.jgrid.jqID(c.p.id)+"_"+a.jgrid.jqID(g)).attr("checked",
!1)}),a("#cb_"+a.jgrid.jqID(c.p.id)).attr("checked",!1),c.p.selarrrow=[]):c.p.selrow&&(a("#"+a.jgrid.jqID(c.p.id)+" tbody:first tr#"+a.jgrid.jqID(c.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),c.p.selrow=null);c.p.savedRow=[]})},getRowData:function(g){var c={},b,e=!1,f,j=0;this.each(function(){var m=this,d,l;if("undefined"==typeof g)e=!0,b=[],f=m.rows.length;else{l=m.rows.namedItem(g);if(!l)return c;f=2}for(;j<f;)e&&(l=m.rows[j]),a(l).hasClass("jqgrow")&&(a("td",l).each(function(b){d=
m.p.colModel[b].name;if("cb"!==d&&"subgrid"!==d&&"rn"!==d)if(!0===m.p.treeGrid&&d==m.p.ExpandColumn)c[d]=a.jgrid.htmlDecode(a("span:first",this).html());else try{c[d]=a.unformat(this,{rowId:l.id,colModel:m.p.colModel[b]},b)}catch(e){c[d]=a.jgrid.htmlDecode(a(this).html())}}),e&&(b.push(c),c={})),j++});return b?b:c},delRowData:function(g){var c=!1,b,e;this.each(function(){if(b=this.rows.namedItem(g)){if(a(b).remove(),this.p.records--,this.p.reccount--,this.updatepager(!0,!1),c=!0,this.p.multiselect&&
(e=a.inArray(g,this.p.selarrrow),-1!=e&&this.p.selarrrow.splice(e,1)),g==this.p.selrow)this.p.selrow=null}else return!1;if("local"==this.p.datatype){var f=this.p._index[g];"undefined"!=typeof f&&(this.p.data.splice(f,1),this.refreshIndex())}if(!0===this.p.altRows&&c){var j=this.p.altclass;a(this.rows).each(function(b){1==b%2?a(this).addClass(j):a(this).removeClass(j)})}});return c},setRowData:function(g,c,b){var e,f=!0,j;this.each(function(){if(!this.grid)return!1;var m=this,d,l,n=typeof b,s={};l=
m.rows.namedItem(g);if(!l)return!1;if(c)try{if(a(this.p.colModel).each(function(b){e=this.name;void 0!==c[e]&&(s[e]=this.formatter&&"string"===typeof this.formatter&&"date"==this.formatter?a.unformat.date(c[e],this):c[e],d=m.formatter(g,c[e],b,c,"edit"),j=this.title?{title:a.jgrid.stripHtml(d)}:{},!0===m.p.treeGrid&&e==m.p.ExpandColumn?a("td:eq("+b+") > span:first",l).html(d).attr(j):a("td:eq("+b+")",l).html(d).attr(j))}),"local"==m.p.datatype){var o=m.p._index[g];if(m.p.treeGrid)for(var q in m.p.treeReader)s.hasOwnProperty(m.p.treeReader[q])&&
delete s[m.p.treeReader[q]];"undefined"!=typeof o&&(m.p.data[o]=a.extend(!0,m.p.data[o],s));s=null}}catch(r){f=!1}f&&("string"===n?a(l).addClass(b):"object"===n&&a(l).css(b))});return f},addRowData:function(g,c,b,e){b||(b="last");var f=!1,j,m,d,l,n,s,o,q,r="",u,x,t,v,B;c&&(a.isArray(c)?(u=!0,b="last",x=g):(c=[c],u=!1),this.each(function(){var C=c.length;n=this.p.rownumbers===true?1:0;d=this.p.multiselect===true?1:0;l=this.p.subGrid===true?1:0;if(!u)if(typeof g!="undefined")g=g+"";else{g=a.jgrid.randId();
if(this.p.keyIndex!==false){x=this.p.colModel[this.p.keyIndex+d+l+n].name;typeof c[0][x]!="undefined"&&(g=c[0][x])}}t=this.p.altclass;for(var z=0,A="",E={},K=a.isFunction(this.p.afterInsertRow)?true:false;z<C;){v=c[z];m="";if(u){try{g=v[x]}catch(U){g=a.jgrid.randId()}A=this.p.altRows===true?(this.rows.length-1)%2===0?t:"":""}if(n){r=this.formatCol(0,1,"",null,g,true);m=m+('<td role="gridcell" aria-describedby="'+this.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+r+">0</td>")}if(d){q='<input role="checkbox" type="checkbox" id="jqg_'+
this.p.id+"_"+g+'" class="cbox"/>';r=this.formatCol(n,1,"",null,g,true);m=m+('<td role="gridcell" aria-describedby="'+this.p.id+'_cb" '+r+">"+q+"</td>")}l&&(m=m+a(this).jqGrid("addSubGridCell",d+n,1));for(o=d+l+n;o<this.p.colModel.length;o++){B=this.p.colModel[o];j=B.name;E[j]=B.formatter&&typeof B.formatter==="string"&&B.formatter=="date"?a.unformat.date(v[j],B):v[j];q=this.formatter(g,a.jgrid.getAccessor(v,j),o,v,"edit");r=this.formatCol(o,1,q,g,v,true);m=m+('<td role="gridcell" aria-describedby="'+
this.p.id+"_"+j+'" '+r+">"+q+"</td>")}m='<tr id="'+g+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+this.p.direction+" "+A+'">'+m+"</tr>";if(this.p.subGrid===true){m=a(m)[0];a(this).jqGrid("addSubGrid",m,d+n)}if(this.rows.length===0)a("table:first",this.grid.bDiv).append(m);else switch(b){case "last":a(this.rows[this.rows.length-1]).after(m);break;case "first":a(this.rows[0]).after(m);break;case "after":if(s=this.rows.namedItem(e))a(this.rows[s.rowIndex+1]).hasClass("ui-subgrid")?
a(this.rows[s.rowIndex+1]).after(m):a(s).after(m);break;case "before":if(s=this.rows.namedItem(e)){a(s).before(m);s=s.rowIndex}}this.p.records++;this.p.reccount++;K&&this.p.afterInsertRow.call(this,g,v,v);z++;if(this.p.datatype=="local"){E[this.p.localReader.id]=g;this.p._index[g]=this.p.data.length;this.p.data.push(E);E={}}}this.p.altRows===true&&!u&&(b=="last"?(this.rows.length-1)%2==1&&a(this.rows[this.rows.length-1]).addClass(t):a(this.rows).each(function(b){b%2==1?a(this).addClass(t):a(this).removeClass(t)}));
this.updatepager(true,true);f=true}));return f},footerData:function(g,c,b){function e(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var f,j=!1,m={},d;"undefined"==typeof g&&(g="get");"boolean"!=typeof b&&(b=!0);g=g.toLowerCase();this.each(function(){var l=this,n;if(!l.grid||!l.p.footerrow||"set"==g&&e(c))return!1;j=!0;a(this.p.colModel).each(function(e){f=this.name;"set"==g?void 0!==c[f]&&(n=b?l.formatter("",c[f],e,c,"edit"):c[f],d=this.title?{title:a.jgrid.stripHtml(n)}:{},a("tr.footrow td:eq("+
e+")",l.grid.sDiv).html(n).attr(d),j=!0):"get"==g&&(m[f]=a("tr.footrow td:eq("+e+")",l.grid.sDiv).html())})});return"get"==g?m:j},showHideCol:function(g,c){return this.each(function(){var b=this,e=!1,f=a.browser.webkit||a.browser.safari?0:b.p.cellLayout,j;if(b.grid){"string"===typeof g&&(g=[g]);c="none"!=c?"":"none";var m=""===c?!0:!1;a(this.p.colModel).each(function(d){-1!==a.inArray(this.name,g)&&this.hidden===m&&(a("tr",b.grid.hDiv).each(function(){a(this).children("th:eq("+d+")").css("display",
c)}),a(b.rows).each(function(){a(this).children("td:eq("+d+")").css("display",c)}),b.p.footerrow&&a(b.grid.sDiv).children("td:eq("+d+")").css("display",c),j=this.widthOrg?this.widthOrg:parseInt(this.width,10),b.p.tblwidth="none"===c?b.p.tblwidth-(j+f):b.p.tblwidth+(j+f),this.hidden=!m,e=!0)});!0===e&&b.grid.width!==b.p.tblwidth&&a(b).jqGrid("setGridWidth",!0===b.p.shrinkToFit?b.grid.width:b.p.tblwidth,!0)}})},hideCol:function(g){return this.each(function(){a(this).jqGrid("showHideCol",g,"none")})},
showCol:function(g){return this.each(function(){a(this).jqGrid("showHideCol",g,"")})},remapColumns:function(g,c,b){function e(b){var c;c=b.length?a.makeArray(b):a.extend({},b);a.each(g,function(a){b[a]=c[this]})}function f(b,c){a(">tr"+(c||""),b).each(function(){var b=this,c=a.makeArray(b.cells);a.each(g,function(){var a=c[this];a&&b.appendChild(a)})})}var j=this.get(0);e(j.p.colModel);e(j.p.colNames);e(j.grid.headers);f(a("thead:first",j.grid.hDiv),b&&":not(.ui-jqgrid-labels)");c&&f(a("#"+a.jgrid.jqID(j.p.id)+
" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");j.p.footerrow&&f(a("tbody:first",j.grid.sDiv));j.p.remapColumns&&(j.p.remapColumns.length?e(j.p.remapColumns):j.p.remapColumns=a.makeArray(g));j.p.lastsort=a.inArray(j.p.lastsort,g);j.p.treeGrid&&(j.p.expColInd=a.inArray(j.p.expColInd,g))},setGridWidth:function(g,c){return this.each(function(){if(this.grid){var b=this,e,f=0,j=a.browser.webkit||a.browser.safari?0:b.p.cellLayout,m,d=0,l=!1,n=b.p.scrollOffset,s,o=0,q=0,r;"boolean"!=typeof c&&(c=b.p.shrinkToFit);
if(!isNaN(g)&&(g=parseInt(g,10),b.grid.width=b.p.width=g,a("#gbox_"+a.jgrid.jqID(b.p.id)).css("width",g+"px"),a("#gview_"+a.jgrid.jqID(b.p.id)).css("width",g+"px"),a(b.grid.bDiv).css("width",g+"px"),a(b.grid.hDiv).css("width",g+"px"),b.p.pager&&a(b.p.pager).css("width",g+"px"),b.p.toppager&&a(b.p.toppager).css("width",g+"px"),!0===b.p.toolbar[0]&&(a(b.grid.uDiv).css("width",g+"px"),"both"==b.p.toolbar[1]&&a(b.grid.ubDiv).css("width",g+"px")),b.p.footerrow&&a(b.grid.sDiv).css("width",g+"px"),!1===
c&&!0===b.p.forceFit&&(b.p.forceFit=!1),!0===c))if(a.each(b.p.colModel,function(){if(this.hidden===false){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);f=f+(e+j);this.fixed?o=o+(e+j):d++;q++}}),0!==d){b.p.tblwidth=f;s=g-j*d-o;if(!isNaN(b.p.height)&&(a(b.grid.bDiv)[0].clientHeight<a(b.grid.bDiv)[0].scrollHeight||1===b.rows.length))l=!0,s-=n;var f=0,u=0<b.grid.cols.length;a.each(b.p.colModel,function(a){if(this.hidden===false&&!this.fixed){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);
e=Math.round(s*e/(b.p.tblwidth-j*d-o));if(!(e<0)){this.width=e;f=f+e;b.grid.headers[a].width=e;b.grid.headers[a].el.style.width=e+"px";if(b.p.footerrow)b.grid.footers[a].style.width=e+"px";if(u)b.grid.cols[a].style.width=e+"px";m=a}}});r=0;l?g-o-(f+j*d)!==n&&(r=g-o-(f+j*d)-n):1!==Math.abs(g-o-(f+j*d))&&(r=g-o-(f+j*d));b.p.colModel[m].width+=r;b.p.tblwidth=f+r+j*d+o;b.p.tblwidth>g?(l=b.p.tblwidth-parseInt(g,10),b.p.tblwidth=g,e=b.p.colModel[m].width-=l):e=b.p.colModel[m].width;b.grid.headers[m].width=
e;b.grid.headers[m].el.style.width=e+"px";u&&(b.grid.cols[m].style.width=e+"px");a("table:first",b.grid.bDiv).css("width",b.p.tblwidth+"px");a("table:first",b.grid.hDiv).css("width",b.p.tblwidth+"px");b.grid.hDiv.scrollLeft=b.grid.bDiv.scrollLeft;b.p.footerrow&&(b.grid.footers[m].style.width=e+"px",a("table:first",b.grid.sDiv).css("width",b.p.tblwidth+"px"))}}})},setGridHeight:function(g){return this.each(function(){this.grid&&(a(this.grid.bDiv).css({height:g+(isNaN(g)?"":"px")}),this.p.height=g,
this.p.scroll&&this.grid.populateVisible())})},setCaption:function(g){return this.each(function(){this.p.caption=g;a("span.ui-jqgrid-title",this.grid.cDiv).html(g);a(this.grid.cDiv).show()})},setLabel:function(g,c,b,e){return this.each(function(){var f=-1;if(this.grid&&(isNaN(g)?a(this.p.colModel).each(function(a){if(this.name==g)return f=a,!1}):f=parseInt(g,10),0<=f)){var j=a("tr.ui-jqgrid-labels th:eq("+f+")",this.grid.hDiv);if(c){var m=a(".s-ico",j);a("[id^=jqgh_]",j).empty().html(c).append(m);
this.p.colNames[f]=c}b&&("string"===typeof b?a(j).addClass(b):a(j).css(b));"object"===typeof e&&a(j).attr(e)}})},setCell:function(g,c,b,e,f,j){return this.each(function(){var m=-1,d,l;if(this.grid&&(isNaN(c)?a(this.p.colModel).each(function(a){if(this.name==c)return m=a,!1}):m=parseInt(c,10),0<=m&&(d=this.rows.namedItem(g)))){var n=a("td:eq("+m+")",d);if(""!==b||!0===j)d=this.formatter(g,b,m,d,"edit"),l=this.p.colModel[m].title?{title:a.jgrid.stripHtml(d)}:{},this.p.treeGrid&&0<a(".tree-wrap",a(n)).length?
a("span",a(n)).html(d).attr(l):a(n).html(d).attr(l),"local"==this.p.datatype&&(d=this.p.colModel[m],b=d.formatter&&"string"===typeof d.formatter&&"date"==d.formatter?a.unformat.date(b,d):b,l=this.p._index[g],"undefined"!=typeof l&&(this.p.data[l][d.name]=b));"string"===typeof e?a(n).addClass(e):e&&a(n).css(e);"object"===typeof f&&a(n).attr(f)}})},getCell:function(g,c){var b=!1;this.each(function(){var e=-1;if(this.grid&&(isNaN(c)?a(this.p.colModel).each(function(a){if(this.name===c)return e=a,!1}):
e=parseInt(c,10),0<=e)){var f=this.rows.namedItem(g);if(f)try{b=a.unformat(a("td:eq("+e+")",f),{rowId:f.id,colModel:this.p.colModel[e]},e)}catch(j){b=a.jgrid.htmlDecode(a("td:eq("+e+")",f).html())}}});return b},getCol:function(g,c,b){var e=[],f,j=0,m=0,d=0,l,c="boolean"!=typeof c?!1:c;"undefined"==typeof b&&(b=!1);this.each(function(){var n=-1;if(this.grid&&(isNaN(g)?a(this.p.colModel).each(function(a){if(this.name===g)return n=a,!1}):n=parseInt(g,10),0<=n)){var s=this.rows.length,o=0;if(s&&0<s){for(;o<
s;){if(a(this.rows[o]).hasClass("jqgrow")){try{f=a.unformat(a(this.rows[o].cells[n]),{rowId:this.rows[o].id,colModel:this.p.colModel[n]},n)}catch(q){f=a.jgrid.htmlDecode(this.rows[o].cells[n].innerHTML)}b?(l=parseFloat(f),j+=l,m=Math.min(m,l),d=Math.max(m,l)):c?e.push({id:this.rows[o].id,value:f}):e.push(f)}o++}if(b)switch(b.toLowerCase()){case "sum":e=j;break;case "avg":e=j/s;break;case "count":e=s;break;case "min":e=m;break;case "max":e=d}}}});return e},clearGridData:function(g){return this.each(function(){if(this.grid){"boolean"!=
typeof g&&(g=!1);if(this.p.deepempty)a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var c=a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(this.p.id)+" tbody:first").empty().append(c)}this.p.footerrow&&g&&a(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page=1;this.p.lastpage=0;this.p.reccount=0;this.p.data=[];this.p_index={};this.updatepager(!0,!1)}})},getInd:function(a,
c){var b=!1,e;this.each(function(){if(e=this.rows.namedItem(a))b=!0===c?e:e.rowIndex});return b},bindKeys:function(g){var c=a.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},g||{});return this.each(function(){var b=this;a("body").is("[role]")||a("body").attr("role","application");b.p.scrollrows=c.scrollingRows;a(b).keydown(function(e){var g=a(b).find("tr[tabindex=0]")[0],j,f,d,l=b.p.treeReader.expanded_field;if(g){d=b.p._index[g.id];if(37===e.keyCode||38===e.keyCode||
39===e.keyCode||40===e.keyCode){if(38===e.keyCode){f=g.previousSibling;j="";if(f)if(a(f).is(":hidden"))for(;f;){if(f=f.previousSibling,!a(f).is(":hidden")&&a(f).hasClass("jqgrow")){j=f.id;break}}else j=f.id;a(b).jqGrid("setSelection",j)}if(40===e.keyCode){f=g.nextSibling;j="";if(f)if(a(f).is(":hidden"))for(;f;){if(f=f.nextSibling,!a(f).is(":hidden")&&a(f).hasClass("jqgrow")){j=f.id;break}}else j=f.id;a(b).jqGrid("setSelection",j)}37===e.keyCode&&(b.p.treeGrid&&b.p.data[d][l]&&a(g).find("div.treeclick").trigger("click"),
a.isFunction(c.onLeftKey)&&c.onLeftKey.call(b,b.p.selrow));39===e.keyCode&&(b.p.treeGrid&&!b.p.data[d][l]&&a(g).find("div.treeclick").trigger("click"),a.isFunction(c.onRightKey)&&c.onRightKey.call(b,b.p.selrow));return!1}if(13===e.keyCode)return a.isFunction(c.onEnter)&&c.onEnter.call(b,b.p.selrow),!1;if(32===e.keyCode)return a.isFunction(c.onSpace)&&c.onSpace.call(b,b.p.selrow),!1}})})},unbindKeys:function(){return this.each(function(){a(this).unbind("keydown")})},getLocalRow:function(a){var c=!1,
b;this.each(function(){"undefined"!==typeof a&&(b=this.p._index[a],0<=b&&(c=this.p.data[b]))});return c}})})(l);(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(a){return"boolean"===typeof a},isObject:function(g){return g&&("object"===typeof g||a.isFunction(g))||!1},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a&&isFinite(a)},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isValue:function(a){return this.isObject(a)||
this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(g){if(!this.isString(g)&&this.isValue(g))return!1;if(!this.isValue(g))return!0;g=a.trim(g).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return""===g}});a.fn.fmatter=function(g,c,b,e,f){var j=c,b=a.extend({},a.jgrid.formatter,b);a.fn.fmatter[g]&&(j=a.fn.fmatter[g](c,b,e,f));return j};a.fmatter.util={NumberFormat:function(g,c){a.fmatter.isNumber(g)||(g*=1);if(a.fmatter.isNumber(g)){var b=0>g,e=g+"",f=c.decimalSeparator?c.decimalSeparator:
".",j;if(a.fmatter.isNumber(c.decimalPlaces)){var m=c.decimalPlaces,e=Math.pow(10,m),e=Math.round(g*e)/e+"";j=e.lastIndexOf(".");if(0<m){0>j?(e+=f,j=e.length-1):"."!==f&&(e=e.replace(".",f));for(;e.length-1-j<m;)e+="0"}}if(c.thousandsSeparator){m=c.thousandsSeparator;j=e.lastIndexOf(f);j=-1<j?j:e.length;for(var f=e.substring(j),d=-1,l=j;0<l;l--){d++;if(0===d%3&&l!==j&&(!b||1<l))f=m+f;f=e.charAt(l-1)+f}e=f}e=c.prefix?c.prefix+e:e;return c.suffix?e+c.suffix:e}return g},DateFormat:function(g,c,b,e){var f=
/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,j="string"===typeof c?c.match(f):null,f=function(a,b){a=""+a;for(b=parseInt(b,10)||2;a.length<b;)a="0"+a;return a},m={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},d=0,l,n=["i18n"];n.i18n={dayNames:e.dayNames,monthNames:e.monthNames};g in e.masks&&(g=e.masks[g]);if(c.constructor===Number)"u"==(""+g).toLowerCase()&&(c*=1E3),d=new Date(c);else if(c.constructor===Date)d=c;else if(null!==j)d=new Date(parseInt(j[1],10)),j[3]&&(g=60*Number(j[5])+Number(j[6]),
g*="-"==j[4]?1:-1,g-=d.getTimezoneOffset(),d.setTime(Number(Number(d)+6E4*g)));else{c=(""+c).split(/[\\\/:_;.,\t\T\s-]/);g=g.split(/[\\\/:_;.,\t\T\s-]/);j=0;for(l=g.length;j<l;j++)"M"==g[j]&&(d=a.inArray(c[j],n.i18n.monthNames),-1!==d&&12>d&&(c[j]=d+1)),"F"==g[j]&&(d=a.inArray(c[j],n.i18n.monthNames),-1!==d&&11<d&&(c[j]=d+1-12)),c[j]&&(m[g[j].toLowerCase()]=parseInt(c[j],10));m.f&&(m.m=m.f);if(0===m.m&&0===m.y&&0===m.d)return"&#160;";m.m=parseInt(m.m,10)-1;d=m.y;70<=d&&99>=d?m.y=1900+m.y:0<=d&&69>=
d&&(m.y=2E3+m.y);d=new Date(m.y,m.m,m.d,m.h,m.i,m.s,m.u)}b in e.masks?b=e.masks[b]:b||(b="Y-m-d");g=d.getHours();c=d.getMinutes();m=d.getDate();j=d.getMonth()+1;l=d.getTimezoneOffset();var s=d.getSeconds(),o=d.getMilliseconds(),q=d.getDay(),r=d.getFullYear(),u=(q+6)%7+1,x=(new Date(r,j-1,m)-new Date(r,0,1))/864E5,t={d:f(m),D:n.i18n.dayNames[q],j:m,l:n.i18n.dayNames[q+7],N:u,S:e.S(m),w:q,z:x,W:5>u?Math.floor((x+u-1)/7)+1:Math.floor((x+u-1)/7)||(4>((new Date(r-1,0,1)).getDay()+6)%7?53:52),F:n.i18n.monthNames[j-
1+12],m:f(j),M:n.i18n.monthNames[j-1],n:j,t:"?",L:"?",o:"?",Y:r,y:(""+r).substring(2),a:12>g?e.AmPm[0]:e.AmPm[1],A:12>g?e.AmPm[2]:e.AmPm[3],B:"?",g:g%12||12,G:g,h:f(g%12||12),H:f(g),i:f(c),s:f(s),u:o,e:"?",I:"?",O:(0<l?"-":"+")+f(100*Math.floor(Math.abs(l)/60)+Math.abs(l)%60,4),P:"?",T:((""+d).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(d/
1E3)};return b.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(a){return a in t?t[a]:a.substring(1)})}};a.fn.fmatter.defaultFormat=function(g,c){return a.fmatter.isValue(g)&&""!==g?g:c.defaultValue?c.defaultValue:"&#160;"};a.fn.fmatter.email=function(g,c){return a.fmatter.isEmpty(g)?a.fn.fmatter.defaultFormat(g,c):'<a href="mailto:'+g+'">'+g+"</a>"};a.fn.fmatter.checkbox=function(g,c){var b=a.extend({},c.checkbox),e;a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,
c.colModel.formatoptions));e=!0===b.disabled?'disabled="disabled"':"";if(a.fmatter.isEmpty(g)||a.fmatter.isUndefined(g))g=a.fn.fmatter.defaultFormat(g,b);g=(g+"").toLowerCase();return'<input type="checkbox" '+(0>g.search(/(false|0|no|off)/i)?" checked='checked' ":"")+' value="'+g+'" offval="no" '+e+"/>"};a.fn.fmatter.link=function(g,c){var b={target:c.target},e="";a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));b.target&&(e="target="+b.target);return a.fmatter.isEmpty(g)?
a.fn.fmatter.defaultFormat(g,c):"<a "+e+' href="'+g+'">'+g+"</a>"};a.fn.fmatter.showlink=function(g,c){var b={baseLinkUrl:c.baseLinkUrl,showAction:c.showAction,addParam:c.addParam||"",target:c.target,idName:c.idName},e="";a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));b.target&&(e="target="+b.target);b=b.baseLinkUrl+b.showAction+"?"+b.idName+"="+c.rowId+b.addParam;return a.fmatter.isString(g)||a.fmatter.isNumber(g)?"<a "+e+' href="'+b+'">'+g+"</a>":a.fn.fmatter.defaultFormat(g,
c)};a.fn.fmatter.integer=function(g,c){var b=a.extend({},c.integer);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(g)?b.defaultValue:a.fmatter.util.NumberFormat(g,b)};a.fn.fmatter.number=function(g,c){var b=a.extend({},c.number);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(g)?b.defaultValue:a.fmatter.util.NumberFormat(g,b)};a.fn.fmatter.currency=function(g,
c){var b=a.extend({},c.currency);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return a.fmatter.isEmpty(g)?b.defaultValue:a.fmatter.util.NumberFormat(g,b)};a.fn.fmatter.date=function(g,c,b,e){b=a.extend({},c.date);a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend({},b,c.colModel.formatoptions));return!b.reformatAfterEdit&&"edit"==e?a.fn.fmatter.defaultFormat(g,c):a.fmatter.isEmpty(g)?a.fn.fmatter.defaultFormat(g,c):a.fmatter.util.DateFormat(b.srcformat,
g,b.newformat,b)};a.fn.fmatter.select=function(g,c){var g=g+"",b=!1,e=[];a.fmatter.isUndefined(c.colModel.formatoptions)?a.fmatter.isUndefined(c.colModel.editoptions)||(b=c.colModel.editoptions.value):b=c.colModel.formatoptions.value;if(b){var f=!0===c.colModel.editoptions.multiple?!0:!1,j=[],m;f&&(j=g.split(","),j=a.map(j,function(b){return a.trim(b)}));if(a.fmatter.isString(b))for(var d=b.split(";"),p=0,n=0;n<d.length;n++)if(m=d[n].split(":"),2<m.length&&(m[1]=l.map(m,function(a,b){if(b>0)return a}).join(":")),
f)-1<l.inArray(m[0],j)&&(e[p]=m[1],p++);else{if(a.trim(m[0])==a.trim(g)){e[0]=m[1];break}}else a.fmatter.isObject(b)&&(f?e=l.map(j,function(a){return b[a]}):e[0]=b[g]||"")}g=e.join(", ");return""===g?a.fn.fmatter.defaultFormat(g,c):g};a.fn.fmatter.rowactions=function(g,c,b,e){var f={keys:!1,editbutton:!0,delbutton:!0,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},e=a("#"+c)[0].p.colModel[e];a.fmatter.isUndefined(e.formatoptions)||
(f=a.extend(f,e.formatoptions));var e=function(b){f.afterSave&&f.afterSave(b);a("tr#"+g+" div.ui-inline-edit, tr#"+g+" div.ui-inline-del","#"+c).show();a("tr#"+g+" div.ui-inline-save, tr#"+g+" div.ui-inline-cancel","#"+c).hide()},j=function(b){f.afterRestore&&f.afterRestore(b);a("tr#"+g+" div.ui-inline-edit, tr#"+g+" div.ui-inline-del","#"+c).show();a("tr#"+g+" div.ui-inline-save, tr#"+g+" div.ui-inline-cancel","#"+c).hide()};switch(b){case "edit":a("#"+c).jqGrid("editRow",g,f.keys,f.onEdit,f.onSuccess,
f.url,f.extraparam,e,f.onError,j);a("tr#"+g+" div.ui-inline-edit, tr#"+g+" div.ui-inline-del","#"+c).hide();a("tr#"+g+" div.ui-inline-save, tr#"+g+" div.ui-inline-cancel","#"+c).show();break;case "save":a("#"+c).jqGrid("saveRow",g,f.onSuccess,f.url,f.extraparam,e,f.onError,j)&&(a("tr#"+g+" div.ui-inline-edit, tr#"+g+" div.ui-inline-del","#"+c).show(),a("tr#"+g+" div.ui-inline-save, tr#"+g+" div.ui-inline-cancel","#"+c).hide());break;case "cancel":a("#"+c).jqGrid("restoreRow",g,j);a("tr#"+g+" div.ui-inline-edit, tr#"+
g+" div.ui-inline-del","#"+c).show();a("tr#"+g+" div.ui-inline-save, tr#"+g+" div.ui-inline-cancel","#"+c).hide();break;case "del":a("#"+c).jqGrid("delGridRow",g,f.delOptions)}};a.fn.fmatter.actions=function(g,c){var b={keys:!1,editbutton:!0,delbutton:!0};a.fmatter.isUndefined(c.colModel.formatoptions)||(b=a.extend(b,c.colModel.formatoptions));var e=c.rowId,f="",j;if("undefined"==typeof e||a.fmatter.isEmpty(e))return"";b.editbutton&&(j="onclick=$.fn.fmatter.rowactions('"+e+"','"+c.gid+"','edit',"+
c.pos+");",f=f+"<div style='margin-left:8px;'><div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+j+"><span class='ui-icon ui-icon-pencil'></span></div>");b.delbutton&&(j="onclick=$.fn.fmatter.rowactions('"+e+"','"+c.gid+"','del',"+c.pos+");",f=f+"<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+j+"><span class='ui-icon ui-icon-trash'></span></div>");j="onclick=$.fn.fmatter.rowactions('"+
e+"','"+c.gid+"','save',"+c.pos+");";f=f+"<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+j+"></span></div>";j="onclick=$.fn.fmatter.rowactions('"+e+"','"+c.gid+"','cancel',"+c.pos+");";return f+"<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+j+"></span></div></div>"};a.unformat=function(g,c,b,
e){var f,j=c.colModel.formatter,m=c.colModel.formatoptions||{},d=/([\.\*\_\'\(\)\{\}\+\?\\])/g,l=c.colModel.unformat||a.fn.fmatter[j]&&a.fn.fmatter[j].unformat;if("undefined"!==typeof l&&a.isFunction(l))f=l(a(g).text(),c,g);else if(!a.fmatter.isUndefined(j)&&a.fmatter.isString(j))switch(f=a.jgrid.formatter||{},j){case "integer":m=a.extend({},f.integer,m);c=m.thousandsSeparator.replace(d,"\\$1");f=a(g).text().replace(RegExp(c,"g"),"");break;case "number":m=a.extend({},f.number,m);c=m.thousandsSeparator.replace(d,
"\\$1");f=a(g).text().replace(RegExp(c,"g"),"").replace(m.decimalSeparator,".");break;case "currency":m=a.extend({},f.currency,m);c=m.thousandsSeparator.replace(d,"\\$1");f=a(g).text().replace(RegExp(c,"g"),"").replace(m.decimalSeparator,".").replace(m.prefix,"").replace(m.suffix,"");break;case "checkbox":m=c.colModel.editoptions?c.colModel.editoptions.value.split(":"):["Yes","No"];f=a("input",g).attr("checked")?m[0]:m[1];break;case "select":f=a.unformat.select(g,c,b,e);break;case "actions":return"";
default:f=a(g).text()}return f?f:!0===e?a(g).text():a.jgrid.htmlDecode(a(g).html())};a.unformat.select=function(g,c,b,e){b=[];g=a(g).text();if(!0===e)return g;c=a.extend({},c.colModel.editoptions);if(c.value){var f=c.value,c=!0===c.multiple?!0:!1,e=[],j;c&&(e=g.split(","),e=a.map(e,function(b){return a.trim(b)}));if(a.fmatter.isString(f))for(var m=f.split(";"),d=0,p=0;p<m.length;p++)if(j=m[p].split(":"),2<j.length&&(j[1]=l.map(j,function(a,b){if(b>0)return a}).join(":")),c)-1<l.inArray(j[1],e)&&(b[d]=
j[0],d++);else{if(a.trim(j[1])==a.trim(g)){b[0]=j[0];break}}else if(a.fmatter.isObject(f)||a.isArray(f))c||(e[0]=g),b=l.map(e,function(b){var c;a.each(f,function(a,d){if(d==b){c=a;return false}});if(typeof c!="undefined")return c});return b.join(", ")}return g||""};a.unformat.date=function(g,c){var b=a.jgrid.formatter.date||{};a.fmatter.isUndefined(c.formatoptions)||(b=a.extend({},b,c.formatoptions));return a.fmatter.isEmpty(g)?a.fn.fmatter.defaultFormat(g,c):a.fmatter.util.DateFormat(b.newformat,
g,b.srcformat,b)}})(l);(function(a){a.jgrid.extend({getColProp:function(a){var c={},b=this[0];if(!b.grid)return!1;for(var b=b.p.colModel,e=0;e<b.length;e++)if(b[e].name==a){c=b[e];break}return c},setColProp:function(g,c){return this.each(function(){if(this.grid&&c)for(var b=this.p.colModel,e=0;e<b.length;e++)if(b[e].name==g){a.extend(this.p.colModel[e],c);break}})},sortGrid:function(a,c,b){return this.each(function(){var e=-1;if(this.grid){a||(a=this.p.sortname);for(var f=0;f<this.p.colModel.length;f++)if(this.p.colModel[f].index==
a||this.p.colModel[f].name==a){e=f;break}-1!=e&&(f=this.p.colModel[e].sortable,"boolean"!==typeof f&&(f=!0),"boolean"!==typeof c&&(c=!1),f&&this.sortData("jqgh_"+a,e,c,b))}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&a(this.p.pager).remove();var g=this.id;try{a("#gbox_"+g).remove()}catch(c){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var g={id:a(this).attr("id"),cl:a(this).attr("class")};this.p.pager&&a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");
var c=document.createElement("table");a(c).attr({id:g.id});c.className=g.cl;g=this.id;a(c).removeClass("ui-jqgrid-btable");1===a(this.p.pager).parents("#gbox_"+g).length?(a(c).insertBefore("#gbox_"+g).show(),a(this.p.pager).insertBefore("#gbox_"+g)):a(c).insertBefore("#gbox_"+g).show();a("#gbox_"+g).remove()}})},setGridState:function(g){return this.each(function(){this.grid&&("hidden"==g?(a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+this.p.id).slideUp("fast"),this.p.pager&&a(this.p.pager).slideUp("fast"),
this.p.toppager&&a(this.p.toppager).slideUp("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&a(this.grid.ubDiv).slideUp("fast"),a(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideUp("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"==g&&(a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+this.p.id).slideDown("fast"),this.p.pager&&
a(this.p.pager).slideDown("fast"),this.p.toppager&&a(this.p.toppager).slideDown("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&a(this.grid.ubDiv).slideDown("fast"),a(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideDown("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(g){g=a.extend({autosearch:!0,
searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},g||{});return this.each(function(){function c(b,c){var e=a(b);e[0]&&l.each(c,function(){void 0!==this.data?e.bind(this.type,this.data,this.fn):e.bind(this.type,this.fn)})}var b=this;if(!this.ftoolbar){var e=function(){var c={},d=0,e,f,j={},k;a.each(b.p.colModel,function(){f=this.index||this.name;switch(this.stype){case "select":k=this.searchoptions&&this.searchoptions.sopt?
this.searchoptions.sopt[0]:"eq";if(e=a("#gs_"+a.jgrid.jqID(f),b.grid.hDiv).val())c[f]=e,j[f]=k,d++;else try{delete b.p.postData[f]}catch(l){}break;case "text":if(k=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:g.defaultSearch,e=a("#gs_"+a.jgrid.jqID(f),b.grid.hDiv).val())c[f]=e,j[f]=k,d++;else try{delete b.p.postData[f]}catch(q){}}});var l=0<d?!0:!1;if(!0===g.stringResult||"local"==b.p.datatype){var r='{"groupOp":"'+g.groupOp+'","rules":[',u=0;a.each(c,function(a,b){0<u&&
(r+=",");r+='{"field":"'+a+'",';r+='"op":"'+j[a]+'",';r+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';u++});r+="]}";a.extend(b.p.postData,{filters:r});a.each(["searchField","searchString","searchOper"],function(a,c){b.p.postData.hasOwnProperty(c)&&delete b.p.postData[c]})}else a.extend(b.p.postData,c);var x;b.p.searchurl&&(x=b.p.url,a(b).jqGrid("setGridParam",{url:b.p.searchurl}));var t=!1;a.isFunction(g.beforeSearch)&&(t=g.beforeSearch.call(b));t||a(b).jqGrid("setGridParam",
{search:l}).trigger("reloadGrid",[{page:1}]);x&&a(b).jqGrid("setGridParam",{url:x});a.isFunction(g.afterSearch)&&g.afterSearch()},f=a("<tr class='ui-search-toolbar' role='rowheader'></tr>"),j;a.each(b.p.colModel,function(){var m=this,d,l,n,s;l=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+b.p.direction+"'></th>");d=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");!0===this.hidden&&a(l).css("display","none");this.search=!1===this.search?
!1:!0;"undefined"==typeof this.stype&&(this.stype="text");n=a.extend({},this.searchoptions||{});if(this.search)switch(this.stype){case "select":if(s=this.surl||n.dataUrl)a.ajax(a.extend({url:s,dataType:"html",complete:function(b){n.buildSelect!==void 0?(b=n.buildSelect(b))&&a(d).append(b):a(d).append(b.responseText);n.defaultValue&&a("select",d).val(n.defaultValue);a("select",d).attr({name:m.index||m.name,id:"gs_"+m.name});n.attr&&a("select",d).attr(n.attr);a("select",d).css({width:"100%"});n.dataInit!==
void 0&&n.dataInit(a("select",d)[0]);n.dataEvents!==void 0&&c(a("select",d)[0],n.dataEvents);g.autosearch===true&&a("select",d).change(function(){e();return false});b=null}},a.jgrid.ajaxOptions,b.p.ajaxSelectOptions||{}));else{var o;m.searchoptions&&m.searchoptions.value?o=m.searchoptions.value:m.editoptions&&m.editoptions.value&&(o=m.editoptions.value);if(o){s=document.createElement("select");s.style.width="100%";a(s).attr({name:m.index||m.name,id:"gs_"+m.name});var q,r;if("string"===typeof o){o=
o.split(";");for(var u=0;u<o.length;u++)q=o[u].split(":"),r=document.createElement("option"),r.value=q[0],r.innerHTML=q[1],s.appendChild(r)}else if("object"===typeof o)for(q in o)o.hasOwnProperty(q)&&(r=document.createElement("option"),r.value=q,r.innerHTML=o[q],s.appendChild(r));n.defaultValue&&a(s).val(n.defaultValue);n.attr&&a(s).attr(n.attr);void 0!==n.dataInit&&n.dataInit(s);void 0!==n.dataEvents&&c(s,n.dataEvents);a(d).append(s);!0===g.autosearch&&a(s).change(function(){e();return false})}}break;
case "text":s=n.defaultValue?n.defaultValue:"",a(d).append("<input type='text' style='width:95%;padding:0px;' name='"+(m.index||m.name)+"' id='gs_"+m.name+"' value='"+s+"'/>"),n.attr&&a("input",d).attr(n.attr),void 0!==n.dataInit&&n.dataInit(a("input",d)[0]),void 0!==n.dataEvents&&c(a("input",d)[0],n.dataEvents),!0===g.autosearch&&(g.searchOnEnter?a("input",d).keypress(function(a){if((a.charCode?a.charCode:a.keyCode?a.keyCode:0)==13){e();return false}return this}):a("input",d).keydown(function(a){switch(a.which){case 13:return false;
case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:j&&clearTimeout(j);j=setTimeout(function(){e()},500)}}))}a(l).append(d);a(f).append(l)});a("table thead",b.grid.hDiv).append(f);this.ftoolbar=!0;this.triggerToolbar=e;this.clearToolbar=function(c){var d={},e,f=0,j,c="boolean"!=typeof c?!0:c;a.each(b.p.colModel,function(){e=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";j=this.index||this.name;switch(this.stype){case "select":var c;a("#gs_"+
a.jgrid.jqID(j)+" option",b.grid.hDiv).each(function(b){0===b&&(this.selected=!0);if(a(this).text()==e)return this.selected=!0,c=a(this).val(),!1});if(c)d[j]=c,f++;else try{delete b.p.postData[j]}catch(g){}break;case "text":if(a("#gs_"+a.jgrid.jqID(j),b.grid.hDiv).val(e),e)d[j]=e,f++;else try{delete b.p.postData[j]}catch(k){}}});var k=0<f?!0:!1;if(!0===g.stringResult||"local"==b.p.datatype){var l='{"groupOp":"'+g.groupOp+'","rules":[',r=0;a.each(d,function(a,b){0<r&&(l+=",");l+='{"field":"'+a+'",';
l+='"op":"eq",';l+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';r++});l+="]}";a.extend(b.p.postData,{filters:l});a.each(["searchField","searchString","searchOper"],function(a,c){b.p.postData.hasOwnProperty(c)&&delete b.p.postData[c]})}else a.extend(b.p.postData,d);var u;b.p.searchurl&&(u=b.p.url,a(b).jqGrid("setGridParam",{url:b.p.searchurl}));var x=!1;a.isFunction(g.beforeClear)&&(x=g.beforeClear.call(b));x||c&&a(b).jqGrid("setGridParam",{search:k}).trigger("reloadGrid",[{page:1}]);
u&&a(b).jqGrid("setGridParam",{url:u});a.isFunction(g.afterClear)&&g.afterClear()};this.toggleToolbar=function(){var c=a("tr.ui-search-toolbar",b.grid.hDiv);"none"==c.css("display")?c.show():c.hide()}}})}})})(l);(function(a){a.extend(a.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},hideModal:function(g,c){c=a.extend({jqm:!0,gb:""},c||{});if(c.onClose){var b=c.onClose(g);if("boolean"==typeof b&&!b)return}if(a.fn.jqm&&!0===c.jqm)a(g).attr("aria-hidden",
"true").jqmHide();else{if(""!==c.gb)try{a(".jqgrid-overlay:first",c.gb).hide()}catch(e){}a(g).hide().attr("aria-hidden","true")}},findPos:function(a){var c=0,b=0;if(a.offsetParent){do c+=a.offsetLeft,b+=a.offsetTop;while(a=a.offsetParent)}return[c,b]},createModal:function(g,c,b,e,f,j,m){var d=document.createElement("div"),l,n=this,m=a.extend({},m||{});l="rtl"==a(b.gbox).attr("dir")?!0:!1;d.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";d.id=g.themodal;var s=document.createElement("div");
s.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";s.id=g.modalhead;a(s).append("<span class='ui-jqdialog-title'>"+b.caption+"</span>");var o=a("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){o.addClass("ui-state-hover")},function(){o.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");a(s).append(o);l?(d.dir="rtl",a(".ui-jqdialog-title",s).css("float","right"),a(".ui-jqdialog-titlebar-close",
s).css("left","0.3em")):(d.dir="ltr",a(".ui-jqdialog-title",s).css("float","left"),a(".ui-jqdialog-titlebar-close",s).css("right","0.3em"));var q=document.createElement("div");a(q).addClass("ui-jqdialog-content ui-widget-content").attr("id",g.modalcontent);a(q).append(c);d.appendChild(q);a(d).prepend(s);!0===j?a("body").append(d):"string"==typeof j?a(j).append(d):a(d).insertBefore(e);a(d).css(m);"undefined"===typeof b.jqModal&&(b.jqModal=!0);c={};if(a.fn.jqm&&!0===b.jqModal)0===b.left&&(0===b.top&&
b.overlay)&&(m=[],m=this.findPos(f),b.left=m[0]+4,b.top=m[1]+4),c.top=b.top+"px",c.left=b.left;else if(0!==b.left||0!==b.top)c.left=b.left,c.top=b.top+"px";a("a.ui-jqdialog-titlebar-close",s).click(function(){var c=a("#"+g.themodal).data("onClose")||b.onClose,d=a("#"+g.themodal).data("gbox")||b.gbox;n.hideModal("#"+g.themodal,{gb:d,jqm:b.jqModal,onClose:c});return false});if(0===b.width||!b.width)b.width=300;if(0===b.height||!b.height)b.height=200;b.zIndex||(e=a(e).parents("*[role=dialog]").filter(":first").css("z-index"),
b.zIndex=e?parseInt(e,10)+1:950);e=0;l&&(c.left&&!j)&&(e=a(b.gbox).width()-(!isNaN(b.width)?parseInt(b.width,10):0)-8,c.left=parseInt(c.left,10)+parseInt(e,10));c.left&&(c.left+="px");a(d).css(a.extend({width:isNaN(b.width)?"auto":b.width+"px",height:isNaN(b.height)?"auto":b.height+"px",zIndex:b.zIndex,overflow:"hidden"},c)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":g.modalhead,"aria-hidden":"true"});"undefined"==typeof b.drag&&(b.drag=!0);"undefined"==typeof b.resize&&(b.resize=!0);if(b.drag)if(a(s).css("cursor",
"move"),a.fn.jqDrag)a(d).jqDrag(s);else try{a(d).draggable({handle:a("#"+s.id)})}catch(r){}if(b.resize)if(a.fn.jqResize)a(d).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>"),a("#"+g.themodal).jqResize(".jqResize",g.scrollelm?"#"+g.scrollelm:!1);else try{a(d).resizable({handles:"se, sw",alsoResize:g.scrollelm?"#"+g.scrollelm:!1})}catch(u){}!0===b.closeOnEscape&&a(d).keydown(function(c){if(c.which==27){c=a("#"+
g.themodal).data("onClose")||b.onClose;n.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:c})}})},viewModal:function(g,c){c=a.extend({toTop:!0,overlay:10,modal:!1,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:!0,jqM:!0},c||{});if(a.fn.jqm&&!0===c.jqm)c.jqM?a(g).attr("aria-hidden","false").jqm(c).jqmShow():a(g).attr("aria-hidden","false").jqmShow();else{""!==c.gbox&&(a(".jqgrid-overlay:first",c.gbox).show(),a(g).data("gbox",c.gbox));a(g).show().attr("aria-hidden","false");try{a(":input:visible",
g)[0].focus()}catch(b){}}},info_dialog:function(g,c,b,e){var f={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,caption:"<b>"+g+"</b>",left:250,top:170,zIndex:1E3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};a.extend(f,e||{});var j=f.jqModal,m=this;a.fn.jqm&&!j&&(j=!1);g="";if(0<f.buttons.length)for(e=0;e<f.buttons.length;e++)"undefined"==typeof f.buttons[e].id&&(f.buttons[e].id="info_button_"+e),g+="<a href='javascript:void(0)' id='"+f.buttons[e].id+
"' class='fm-button ui-state-default ui-corner-all'>"+f.buttons[e].text+"</a>";e=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px";c="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+e+";"+("text-align:"+f.align+";")+"'>"+c+"</div>");c+=b?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+
b+"</a>"+g+"</div>":""!==g?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+g+"</div>":"";c+="</div>";try{"false"==a("#info_dialog").attr("aria-hidden")&&this.hideModal("#info_dialog",{jqm:j}),a("#info_dialog").remove()}catch(d){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},c,f,"","",!0);g&&a.each(f.buttons,
function(b){a("#"+this.id,"#info_id").bind("click",function(){f.buttons[b].onClick.call(a("#info_dialog"));return!1})});a("#closedialog","#info_id").click(function(){m.hideModal("#info_dialog",{jqm:j});return!1});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a.isFunction(f.beforeOpen)&&f.beforeOpen();this.viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove();a.o&&a.o.remove()},modal:f.modal,jqm:j});
a.isFunction(f.afterOpen)&&f.afterOpen();try{a("#info_dialog").focus()}catch(l){}},createEl:function(g,c,b,e,f){function j(b,c){a.isFunction(c.dataInit)&&c.dataInit(b);c.dataEvents&&a.each(c.dataEvents,function(){void 0!==this.data?a(b).bind(this.type,this.data,this.fn):a(b).bind(this.type,this.fn)});return c}function m(b,c){var d="dataInit dataEvents dataUrl buildSelect sopt searchhidden defaultValue attr".split(" ");a.each(c,function(c,e){-1===a.inArray(c,d)&&a(b).attr(c,e)});c.hasOwnProperty("id")||
a(b).attr("id",a.jgrid.randId())}var d="";switch(g){case "textarea":d=document.createElement("textarea");e?c.cols||a(d).css({width:"98%"}):c.cols||(c.cols=20);c.rows||(c.rows=2);if("&nbsp;"==b||"&#160;"==b||1==b.length&&160==b.charCodeAt(0))b="";d.value=b;m(d,c);c=j(d,c);a(d).attr({role:"textbox",multiline:"true"});break;case "checkbox":d=document.createElement("input");d.type="checkbox";c.value?(g=c.value.split(":"),b===g[0]&&(d.checked=!0,d.defaultChecked=!0),d.value=g[0],a(d).attr("offval",g[1])):
(g=b.toLowerCase(),0>g.search(/(false|0|no|off|undefined)/i)&&""!==g?(d.checked=!0,d.defaultChecked=!0,d.value=b):d.value="on",a(d).attr("offval","off"));m(d,c);c=j(d,c);a(d).attr("role","checkbox");break;case "select":d=document.createElement("select");d.setAttribute("role","select");e=[];!0===c.multiple?(g=!0,d.multiple="multiple",a(d).attr("aria-multiselectable","true")):g=!1;if("undefined"!=typeof c.dataUrl)a.ajax(a.extend({url:c.dataUrl,type:"GET",dataType:"html",context:{elem:d,options:c,vl:b},
success:function(b){var c=[],d=this.elem,e=this.vl,g=a.extend({},this.options),f=g.multiple===true;typeof g.buildSelect!="undefined"&&(b=g.buildSelect(b));if(b=a(b).html()){a(d).append(b);m(d,g);g=j(d,g);if(typeof g.size==="undefined")g.size=f?3:1;if(f){c=e.split(",");c=a.map(c,function(b){return a.trim(b)})}else c[0]=a.trim(e);setTimeout(function(){a("option",d).each(function(){a(this).attr("role","option");if(a.inArray(a.trim(a(this).text()),c)>-1||a.inArray(a.trim(a(this).val()),c)>-1)this.selected=
"selected"})},0)}}},f||{}));else if(c.value){var l;g?(e=b.split(","),e=a.map(e,function(b){return a.trim(b)}),"undefined"===typeof c.size&&(c.size=3)):c.size=1;"function"===typeof c.value&&(c.value=c.value());var n,s;if("string"===typeof c.value){n=c.value.split(";");for(l=0;l<n.length;l++){s=n[l].split(":");2<s.length&&(s[1]=a.map(s,function(a,b){if(b>0)return a}).join(":"));f=document.createElement("option");f.setAttribute("role","option");f.value=s[0];f.innerHTML=s[1];if(!g&&(a.trim(s[0])==a.trim(b)||
a.trim(s[1])==a.trim(b)))f.selected="selected";if(g&&(-1<a.inArray(a.trim(s[1]),e)||-1<a.inArray(a.trim(s[0]),e)))f.selected="selected";d.appendChild(f)}}else if("object"===typeof c.value)for(l in n=c.value,n)if(n.hasOwnProperty(l)){f=document.createElement("option");f.setAttribute("role","option");f.value=l;f.innerHTML=n[l];if(!g&&(a.trim(l)==a.trim(b)||a.trim(n[l])==a.trim(b)))f.selected="selected";if(g&&(-1<a.inArray(a.trim(n[l]),e)||-1<a.inArray(a.trim(l),e)))f.selected="selected";d.appendChild(f)}m(d,
c);c=j(d,c)}break;case "text":case "password":case "button":l="button"==g?"button":"textbox";d=document.createElement("input");d.type=g;d.value=b;m(d,c);c=j(d,c);"button"!=g&&(e?c.size||a(d).css({width:"98%"}):c.size||(c.size=20));a(d).attr("role",l);break;case "image":case "file":d=document.createElement("input");d.type=g;m(d,c);c=j(d,c);break;case "custom":d=document.createElement("span");try{if(a.isFunction(c.custom_element))if(n=c.custom_element.call(this,b,c))n=a(n).addClass("customelement").attr({id:c.id,
name:c.name}),a(d).empty().append(n);else throw"e2";else throw"e1";}catch(o){"e1"==o&&this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"==o?this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):this.info_dialog(a.jgrid.errors.errcap,"string"===typeof o?o:o.message,a.jgrid.edit.bClose)}}return d},checkDate:function(a,c){var b={},e,a=a.toLowerCase();e=-1!=a.indexOf("/")?
"/":-1!=a.indexOf("-")?"-":-1!=a.indexOf(".")?".":"/";a=a.split(e);c=c.split(e);if(3!=c.length)return!1;e=-1;for(var f,j=-1,m=-1,d=0;d<a.length;d++)f=isNaN(c[d])?0:parseInt(c[d],10),b[a[d]]=f,f=a[d],-1!=f.indexOf("y")&&(e=d),-1!=f.indexOf("m")&&(m=d),-1!=f.indexOf("d")&&(j=d);f="y"==a[e]||"yyyy"==a[e]?4:"yy"==a[e]?2:-1;var d=function(a){for(var b=1;b<=a;b++){this[b]=31;if(4==b||6==b||9==b||11==b)this[b]=30;2==b&&(this[b]=29)}return this}(12),l;if(-1===e)return!1;l=b[a[e]].toString();2==f&&1==l.length&&
(f=1);if(l.length!=f||0===b[a[e]]&&"00"!=c[e]||-1===m)return!1;l=b[a[m]].toString();if(1>l.length||(1>b[a[m]]||12<b[a[m]])||-1===j)return!1;l=b[a[j]].toString();return 1>l.length||1>b[a[j]]||31<b[a[j]]||2==b[a[m]]&&b[a[j]]>(0===b[a[e]]%4&&(0!==b[a[e]]%100||0===b[a[e]]%400)?29:28)||b[a[j]]>d[b[a[m]]]?!1:!0},isEmpty:function(a){return a.match(/^\s+$/)||""===a?!0:!1},checkTime:function(a){var c=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!this.isEmpty(a))if(a=a.match(c)){if(a[3]){if(1>a[1]||12<a[1])return!1}else if(23<
a[1])return!1;if(59<a[2])return!1}else return!1;return!0},checkValues:function(g,c,b,e,f){var j,m;if("undefined"===typeof e)if("string"==typeof c){e=0;for(f=b.p.colModel.length;e<f;e++)if(b.p.colModel[e].name==c){j=b.p.colModel[e].editrules;c=e;try{m=b.p.colModel[e].formoptions.label}catch(d){}break}}else 0<=c&&(j=b.p.colModel[c].editrules);else j=e,m=void 0===f?"_":f;if(j){m||(m=b.p.colNames[c]);if(!0===j.required&&this.isEmpty(g))return[!1,m+": "+a.jgrid.edit.msg.required,""];e=!1===j.required?
!1:!0;if(!0===j.number&&!(!1===e&&this.isEmpty(g))&&isNaN(g))return[!1,m+": "+a.jgrid.edit.msg.number,""];if("undefined"!=typeof j.minValue&&!isNaN(j.minValue)&&parseFloat(g)<parseFloat(j.minValue))return[!1,m+": "+a.jgrid.edit.msg.minValue+" "+j.minValue,""];if("undefined"!=typeof j.maxValue&&!isNaN(j.maxValue)&&parseFloat(g)>parseFloat(j.maxValue))return[!1,m+": "+a.jgrid.edit.msg.maxValue+" "+j.maxValue,""];if(!0===j.email&&!(!1===e&&this.isEmpty(g))&&(f=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
!f.test(g)))return[!1,m+": "+a.jgrid.edit.msg.email,""];if(!0===j.integer&&!(!1===e&&this.isEmpty(g))&&(isNaN(g)||0!==g%1||-1!=g.indexOf(".")))return[!1,m+": "+a.jgrid.edit.msg.integer,""];if(!0===j.date&&!(!1===e&&this.isEmpty(g))&&(c=b.p.colModel[c].formatoptions&&b.p.colModel[c].formatoptions.newformat?b.p.colModel[c].formatoptions.newformat:b.p.colModel[c].datefmt||"Y-m-d",!this.checkDate(c,g)))return[!1,m+": "+a.jgrid.edit.msg.date+" - "+c,""];if(!0===j.time&&!(!1===e&&this.isEmpty(g))&&!this.checkTime(g))return[!1,
m+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(!0===j.url&&!(!1===e&&this.isEmpty(g))&&(f=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,!f.test(g)))return[!1,m+": "+a.jgrid.edit.msg.url,""];if(!0===j.custom&&!(!1===e&&this.isEmpty(g)))return a.isFunction(j.custom_func)?(g=j.custom_func.call(b,g,m),a.isArray(g)?g:[!1,a.jgrid.edit.msg.customarray,""]):[!1,a.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})})(l);(function(a){var g=
null;a.jgrid.extend({searchGrid:function(c){c=a.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!1,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,
onReset:null,toTop:!0,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null},a.jgrid.search,c||{});return this.each(function(){function b(){a.isFunction(c.beforeShowSearch)&&(j=c.beforeShowSearch(a("#"+g)),"undefined"===typeof j&&(j=!0));j&&(a.jgrid.viewModal("#"+m.themodal,{gbox:"#gbox_"+g,jqm:c.jqModal,modal:c.modal,overlay:c.overlay,toTop:c.toTop}),a.isFunction(c.afterShowSearch)&&c.afterShowSearch(a("#"+g)))}var e=this;if(e.grid){var g="fbox_"+
e.p.id,j=!0,m={themodal:"searchmod"+g,modalhead:"searchhd"+g,modalcontent:"searchcnt"+g,scrollelm:g},d=e.p.postData[c.sFilter];"string"===typeof d&&(d=a.jgrid.parse(d));!0===c.recreateFilter&&a("#"+m.themodal).remove();if(null!==a("#"+m.themodal).html())b();else{var l=a("<span><div id='"+g+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+e.p.id);if(a.isFunction(c.onInitializeSearch))c.onInitializeSearch(a("#"+g));var n=a.extend([],e.p.colModel),s="<a href='javascript:void(0)' id='"+
g+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+c.Find+"</a>",o="<a href='javascript:void(0)' id='"+g+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+c.Reset+"</a>",q="",r="",u,x=!1;c.showQuery&&(q="<a href='javascript:void(0)' id='"+g+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>");
c.columns.length?n=c.columns:a.each(n,function(a,b){b.label||(b.label=e.p.colNames[a]);if(!x){var c="undefined"===typeof b.search?!0:b.search,d=!0===b.hidden;if(b.searchoptions&&!0===b.searchoptions.searchhidden&&c||c&&!d)x=!0,u=b.index||b.name}});if(!d&&u||!1===c.multipleSearch)d={groupOp:"AND",rules:[{field:u,op:"eq",data:""}]};x=!1;c.tmplNames&&c.tmplNames.length&&(x=!0,r=c.tmplLabel,r+="<select class='ui-template'>",r+="<option value='default'>Default</option>",a.each(c.tmplNames,function(a,b){r+=
"<option value='"+a+"'>"+b+"</option>"}),r+="</select>");s="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+g+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+o+r+"</td><td class='EditButton'>"+q+s+"</td></tr></tbody></table>";a("#"+g).jqFilter({columns:n,filter:c.loadDefaults?d:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,_gridsopt:a.jgrid.search.odata,
onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString())}});l.append(s);x&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",l).bind("change",function(){var b=a(this).val();b=="default"?a("#"+g).jqFilter("addFilter",d):a("#"+g).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return false});!1===c.multipleSearch&&(a(".add-rule","#"+g).hide(),a(".delete-rule","#"+g).hide());if(a.isFunction(c.onInitializeSearch))c.onInitializeSearch(a("#"+g));c.layer?a.jgrid.createModal(m,
l,c,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0],"#"+c.layer,{position:"relative"}):a.jgrid.createModal(m,l,c,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0]);q&&a("#"+g+"_query").bind("click",function(){a(".queryresult",l).toggle();return false});void 0===c.stringResult&&(c.stringResult=c.multipleSearch);a("#"+g+"_search").bind("click",function(){var b=a("#"+g),d={},j,l=b.jqFilter("filterData");if(c.errorcheck){b[0].hideError();c.showQuery||b.jqFilter("toSQLString");if(b[0].p.error){b[0].showError();return false}}if(c.stringResult){try{j=
f.toJson(l,"","",false)}catch(n){try{j=ja.stringify(l)}catch(o){}}if(typeof j==="string"){d[c.sFilter]=j;a.each([c.sField,c.sValue,c.sOper],function(){d[this]=""})}}else if(c.multipleSearch){d[c.sFilter]=l;a.each([c.sField,c.sValue,c.sOper],function(){d[this]=""})}else{d[c.sField]=l.rules[0].field;d[c.sValue]=l.rules[0].data;d[c.sOper]=l.rules[0].op;d[c.sFilter]=""}e.p.search=true;a.extend(e.p.postData,d);if(a.isFunction(c.onSearch))c.onSearch();a(e).trigger("reloadGrid",[{page:1}]);c.closeAfterSearch&&
a.jgrid.hideModal("#"+m.themodal,{gb:"#gbox_"+e.p.id,jqm:c.jqModal,onClose:c.onClose});return false});a("#"+g+"_reset").bind("click",function(){var b={},d=a("#"+g);e.p.search=false;c.multipleSearch===false?b[c.sField]=b[c.sValue]=b[c.sOper]="":b[c.sFilter]="";d[0].resetFilter();x&&a(".ui-template",l).val("default");a.extend(e.p.postData,b);if(a.isFunction(c.onReset))c.onReset();a(e).trigger("reloadGrid",[{page:1}]);return false});b();a(".fm-button:not(.ui-state-disabled)",l).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(c,b){g=b=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,
closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},a.jgrid.edit,b||{});return this.each(function(){function e(){a(".FormElement","#"+t).each(function(){var b=a(".customelement",this);if(b.length){var c=a(b[0]).attr("name");a.each(r.p.colModel,function(){if(this.name===c&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{if(y[c]=
this.editoptions.custom_value(a("#"+a.jgrid.jqID(c),"#"+t),"get"),void 0===y[c])throw"e1";}catch(b){"e1"===b?a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,l.jgrid.edit.bClose):a.jgrid.info_dialog(l.jgrid.errors.errcap,b.message,l.jgrid.edit.bClose)}return!0}})}else{switch(a(this).get(0).type){case "checkbox":a(this).attr("checked")?y[this.name]=a(this).val():(b=a(this).attr("offval"),y[this.name]=b);break;case "select-one":y[this.name]=a("option:selected",
this).val();S[this.name]=a("option:selected",this).text();break;case "select-multiple":y[this.name]=a(this).val();y[this.name]=y[this.name]?y[this.name].join(","):"";var d=[];a("option:selected",this).each(function(b,c){d[b]=a(c).text()});S[this.name]=d.join(",");break;case "password":case "text":case "textarea":case "button":y[this.name]=a(this).val()}r.p.autoencode&&(y[this.name]=a.jgrid.htmlEncode(y[this.name]))}});return!0}function f(b,c,d,e){var j,k,m=0,l,n,o,p=[],s=!1,q="",t;for(t=1;t<=e;t++)q+=
"<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!=b&&(s=a(c).jqGrid("getInd",b));a(c.p.colModel).each(function(f){j=this.name;n=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden)?"style='display:none'":"";if("cb"!==j&&"subgrid"!==j&&!0===this.editable&&"rn"!==j){if(!1===s)l="";else if(j==c.p.ExpandColumn&&!0===c.p.treeGrid)l=a("td:eq("+f+")",c.rows[s]).text();else try{l=a.unformat(a("td:eq("+f+")",c.rows[s]),{rowId:b,colModel:this},f)}catch(t){l=a("td:eq("+
f+")",c.rows[s]).text()}var u=a.extend({},this.editoptions||{},{id:j,name:j}),v=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),x=parseInt(v.rowpos,10)||m+1,A=parseInt(2*(parseInt(v.colpos,10)||1),10);"_empty"==b&&u.defaultValue&&(l=a.isFunction(u.defaultValue)?u.defaultValue():u.defaultValue);this.edittype||(this.edittype="text");r.p.autoencode&&(l=a.jgrid.htmlDecode(l));o=a.jgrid.createEl(this.edittype,u,l,!1,a.extend({},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||
{}));""===l&&"checkbox"==this.edittype&&(l=a(o).attr("offval"));""===l&&"select"==this.edittype&&(l=a("option:eq(0)",o).text());if(g.checkOnSubmit||g.checkOnUpdate)g._savedData[j]=l;a(o).addClass("FormElement");("text"==this.edittype||"textarea"==this.edittype)&&a(o).addClass("ui-widget-content ui-corner-all");k=a(d).find("tr[rowpos="+x+"]");v.rowabove&&(u=a("<tr><td class='contentinfo' colspan='"+2*e+"'>"+v.rowcontent+"</td></tr>"),a(d).append(u),u[0].rp=x);0===k.length&&(k=a("<tr "+n+" rowpos='"+
x+"'></tr>").addClass("FormData").attr("id","tr_"+j),a(k).append(q),a(d).append(k),k[0].rp=x);a("td:eq("+(A-2)+")",k[0]).html("undefined"===typeof v.label?c.p.colNames[f]:v.label);a("td:eq("+(A-1)+")",k[0]).append(v.elmprefix).append(o).append(v.elmsuffix);p[m]=f;m++}});if(0<m&&(t=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*e-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+c.p.id+"_id' value='"+b+"'/></td></tr>"),t[0].rp=
m+999,a(d).append(t),g.checkOnSubmit||g.checkOnUpdate))g._savedData[c.p.id+"_id"]=b;return p}function j(b,c,d){var e,f=0,j,k,m,n,o;if(g.checkOnSubmit||g.checkOnUpdate)g._savedData={},g._savedData[c.p.id+"_id"]=b;var p=c.p.colModel;if("_empty"==b)a(p).each(function(){e=this.name;m=a.extend({},this.editoptions||{});if((k=a("#"+a.jgrid.jqID(e),"#"+d))&&null!==k[0])if(n="",m.defaultValue?(n=a.isFunction(m.defaultValue)?m.defaultValue():m.defaultValue,"checkbox"==k[0].type?(o=n.toLowerCase(),0>o.search(/(false|0|no|off|undefined)/i)&&
""!==o?(k[0].checked=!0,k[0].defaultChecked=!0,k[0].value=n):k.attr({checked:"",defaultChecked:""})):k.val(n)):"checkbox"==k[0].type?(k[0].checked=!1,k[0].defaultChecked=!1,n=a(k).attr("offval")):k[0].type&&"select"==k[0].type.substr(0,6)?k[0].selectedIndex=0:k.val(n),!0===g.checkOnSubmit||g.checkOnUpdate)g._savedData[e]=n}),a("#id_g","#"+d).val(b);else{var s=a(c).jqGrid("getInd",b,!0);s&&(a("td",s).each(function(k){e=p[k].name;if("cb"!==e&&"subgrid"!==e&&"rn"!==e&&!0===p[k].editable){if(e==c.p.ExpandColumn&&
!0===c.p.treeGrid)j=a(this).text();else try{j=a.unformat(a(this),{rowId:b,colModel:p[k]},k)}catch(m){j=a(this).text()}r.p.autoencode&&(j=a.jgrid.htmlDecode(j));if(!0===g.checkOnSubmit||g.checkOnUpdate)g._savedData[e]=j;e=a.jgrid.jqID(e);switch(p[k].edittype){case "password":case "text":case "button":case "image":a("#"+e,"#"+d).val(j);break;case "textarea":if("&nbsp;"==j||"&#160;"==j||1==j.length&&160==j.charCodeAt(0))j="";a("#"+e,"#"+d).val(j);break;case "select":var n=j.split(","),n=a.map(n,function(b){return a.trim(b)});
a("#"+e+" option","#"+d).each(function(){this.selected=!p[k].editoptions.multiple&&(n[0]==a.trim(a(this).text())||n[0]==a.trim(a(this).val()))?!0:p[k].editoptions.multiple?-1<a.inArray(a.trim(a(this).text()),n)||-1<a.inArray(a.trim(a(this).val()),n)?!0:!1:!1});break;case "checkbox":j+="";p[k].editoptions&&p[k].editoptions.value?p[k].editoptions.value.split(":")[0]==j?(a("#"+e,"#"+d).attr("checked",!0),a("#"+e,"#"+d).attr("defaultChecked",!0)):(a("#"+e,"#"+d).attr("checked",!1),a("#"+e,"#"+d).attr("defaultChecked",
"")):(j=j.toLowerCase(),0>j.search(/(false|0|no|off|undefined)/i)&&""!==j?(a("#"+e,"#"+d).attr("checked",!0),a("#"+e,"#"+d).attr("defaultChecked",!0)):(a("#"+e,"#"+d).attr("checked",!1),a("#"+e,"#"+d).attr("defaultChecked","")));break;case "custom":try{if(p[k].editoptions&&a.isFunction(p[k].editoptions.custom_value))p[k].editoptions.custom_value(a("#"+e,"#"+d),"set",j);else throw"e1";}catch(o){"e1"==o?a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,
l.jgrid.edit.bClose):a.jgrid.info_dialog(l.jgrid.errors.errcap,o.message,l.jgrid.edit.bClose)}}f++}}),0<f&&a("#id_g","#"+t).val(b))}}function m(){var c,d=[!0,"",""],e={},f=r.p.prmNames,k,m,l,n;if(a.isFunction(g.beforeCheckValues)){var o=g.beforeCheckValues(y,a("#"+x),"_empty"==y[r.p.id+"_id"]?f.addoper:f.editoper);o&&"object"===typeof o&&(y=o)}for(l in y)if(y.hasOwnProperty(l)&&(d=a.jgrid.checkValues(y[l],l,r),!1===d[0]))break;d[0]&&(a.isFunction(g.onclickSubmit)&&(e=g.onclickSubmit(g,y)||{}),a.isFunction(g.beforeSubmit)&&
(d=g.beforeSubmit(y,a("#"+x))));if(d[0]&&!g.processing){g.processing=!0;a("#sData","#"+t+"_2").addClass("ui-state-active");m=f.oper;k=f.id;y[m]="_empty"==a.trim(y[r.p.id+"_id"])?f.addoper:f.editoper;y[m]!=f.addoper?y[k]=y[r.p.id+"_id"]:void 0===y[k]&&(y[k]=y[r.p.id+"_id"]);delete y[r.p.id+"_id"];y=a.extend(y,g.editData,e);if(!0===r.p.treeGrid)for(i in y[m]==f.addoper&&(n=a(r).jqGrid("getGridParam","selrow"),y["adjacency"==r.p.treeGridModel?r.p.treeReader.parent_id_field:"parent_id"]=n),r.p.treeReader)e=
r.p.treeReader[i],y.hasOwnProperty(e)&&(y[m]==f.addoper&&"parent_id_field"===i||delete y[e]);e=a.extend({url:g.url?g.url:a(r).jqGrid("getGridParam","editurl"),type:g.mtype,data:a.isFunction(g.serializeEditData)?g.serializeEditData(y):y,complete:function(e,l){if(l!="success"){d[0]=false;d[1]=a.isFunction(g.errorTextFormat)?g.errorTextFormat(e):l+" Status: '"+e.statusText+"'. Error code: "+e.status}else a.isFunction(g.afterSubmit)&&(d=g.afterSubmit(e,y));if(d[0]===false){a("#FormError>td","#"+t).html(d[1]);
a("#FormError","#"+t).show()}else{a.each(r.p.colModel,function(){if(S[this.name]&&this.formatter&&this.formatter=="select")try{delete S[this.name]}catch(a){}});y=a.extend(y,S);r.p.autoencode&&a.each(y,function(b,c){y[b]=a.jgrid.htmlDecode(c)});g.reloadAfterSubmit=g.reloadAfterSubmit&&r.p.datatype!="local";if(y[m]==f.addoper){d[2]||(d[2]=a.jgrid.randId());y[k]=d[2];if(g.closeAfterAdd){if(g.reloadAfterSubmit)a(r).trigger("reloadGrid");else if(r.p.treeGrid===true)a(r).jqGrid("addChildNode",d[2],n,y);
else{a(r).jqGrid("addRowData",d[2],y,b.addedrow);a(r).jqGrid("setSelection",d[2])}a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose})}else if(g.clearAfterAdd){g.reloadAfterSubmit?a(r).trigger("reloadGrid"):r.p.treeGrid===true?a(r).jqGrid("addChildNode",d[2],n,y):a(r).jqGrid("addRowData",d[2],y,b.addedrow);j("_empty",r,x)}else g.reloadAfterSubmit?a(r).trigger("reloadGrid"):r.p.treeGrid===true?a(r).jqGrid("addChildNode",d[2],n,y):a(r).jqGrid("addRowData",d[2],y,b.addedrow)}else{if(g.reloadAfterSubmit){a(r).trigger("reloadGrid");
g.closeAfterEdit||setTimeout(function(){a(r).jqGrid("setSelection",y[k])},1E3)}else r.p.treeGrid===true?a(r).jqGrid("setTreeRow",y[k],y):a(r).jqGrid("setRowData",y[k],y);g.closeAfterEdit&&a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose})}if(a.isFunction(g.afterComplete)){c=e;setTimeout(function(){g.afterComplete(c,y,a("#"+x));c=null},500)}if(g.checkOnSubmit||g.checkOnUpdate){a("#"+x).data("disabled",false);if(g._savedData[r.p.id+"_id"]!="_empty")for(var o in g._savedData)y[o]&&
(g._savedData[o]=y[o])}}g.processing=false;a("#sData","#"+t+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+x)[0].focus()}catch(p){}}},a.jgrid.ajaxOptions,g.ajaxEditOptions);!e.url&&!g.useDataProxy&&(a.isFunction(r.p.dataProxy)?g.useDataProxy=!0:(d[0]=!1,d[1]+=" "+a.jgrid.errors.nourl));d[0]&&(g.useDataProxy?r.p.dataProxy.call(r,e,"set_"+r.p.id):a.ajax(e))}!1===d[0]&&(a("#FormError>td","#"+t).html(d[1]),a("#FormError","#"+t).show())}function d(a,b){var c=!1,d;for(d in a)if(a[d]!=b[d]){c=
!0;break}return c}function p(){a.each(r.p.colModel,function(a,b){b.editoptions&&!0===b.editoptions.NullIfEmpty&&y.hasOwnProperty(b.name)&&""==y[b.name]&&(y[b.name]="null")})}function n(){var b=!0;a("#FormError","#"+t).hide();g.checkOnUpdate&&(y={},S={},e(),D=a.extend({},y,S),d(D,g._savedData)?(a("#"+x).data("disabled",!0),a(".confirm","#"+v.themodal).show(),b=!1):p());return b}function s(){if("_empty"!==c&&"undefined"!==typeof r.p.savedRow&&0<r.p.savedRow.length&&a.isFunction(a.fn.jqGrid.restoreRow))for(var b=
0;b<r.p.savedRow.length;b++)if(r.p.savedRow[b].id==c){a(r).jqGrid("restoreRow",c);break}}function o(b,c){0===b?a("#pData","#"+t+"_2").addClass("ui-state-disabled"):a("#pData","#"+t+"_2").removeClass("ui-state-disabled");b==c?a("#nData","#"+t+"_2").addClass("ui-state-disabled"):a("#nData","#"+t+"_2").removeClass("ui-state-disabled")}function q(){var b=a(r).jqGrid("getDataIDs"),c=a("#id_g","#"+t).val();return[a.inArray(c,b),b]}var r=this;if(r.grid&&c){var u=r.p.id,x="FrmGrid_"+u,t="TblGrid_"+u,v={themodal:"editmod"+
u,modalhead:"edithd"+u,modalcontent:"editcnt"+u,scrollelm:x},B=a.isFunction(g.beforeShowForm)?g.beforeShowForm:!1,C=a.isFunction(g.afterShowForm)?g.afterShowForm:!1,z=a.isFunction(g.beforeInitData)?g.beforeInitData:!1,A=a.isFunction(g.onInitializeForm)?g.onInitializeForm:!1,E=!0,K=1,U=0,y,S,D;"new"===c?(c="_empty",b.caption=g.addCaption):b.caption=g.editCaption;!0===b.recreateForm&&null!==a("#"+v.themodal).html()&&a("#"+v.themodal).remove();var Y=!0;b.checkOnUpdate&&(b.jqModal&&!b.modal)&&(Y=!1);
if(null!==a("#"+v.themodal).html()){z&&(E=z(a("#"+x)),"undefined"==typeof E&&(E=!0));if(!1===E)return;s();a(".ui-jqdialog-title","#"+v.modalhead).html(b.caption);a("#FormError","#"+t).hide();g.topinfo?(a(".topinfo","#"+t+"_2").html(g.topinfo),a(".tinfo","#"+t+"_2").show()):a(".tinfo","#"+t+"_2").hide();g.bottominfo?(a(".bottominfo","#"+t+"_2").html(g.bottominfo),a(".binfo","#"+t+"_2").show()):a(".binfo","#"+t+"_2").hide();j(c,r,x);"_empty"==c||!g.viewPagerButtons?a("#pData, #nData","#"+t+"_2").hide():
a("#pData, #nData","#"+t+"_2").show();!0===g.processing&&(g.processing=!1,a("#sData","#"+t+"_2").removeClass("ui-state-active"));!0===a("#"+x).data("disabled")&&(a(".confirm","#"+v.themodal).hide(),a("#"+x).data("disabled",!1));B&&B(a("#"+x));a("#"+v.themodal).data("onClose",g.onClose);a.jgrid.viewModal("#"+v.themodal,{gbox:"#gbox_"+u,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal});Y||a(".jqmOverlay").click(function(){if(!n())return false;a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,
onClose:g.onClose});return false});C&&C(a("#"+x))}else{var X=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",X=a("<form name='FormPost' id='"+x+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+X+";'></form>").data("disabled",!1),V=a("<table id='"+t+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");z&&(E=z(a("#"+x)),"undefined"==typeof E&&(E=!0));if(!1===E)return;s();a(r.p.colModel).each(function(){var a=
this.formoptions;K=Math.max(K,a?a.colpos||0:0);U=Math.max(U,a?a.rowpos||0:0)});a(X).append(V);z=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+2*K+"'></td></tr>");z[0].rp=0;a(V).append(z);z=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*K+"'>"+g.topinfo+"</td></tr>");z[0].rp=0;a(V).append(z);var E=(z="rtl"==r.p.direction?!0:!1)?"nData":"pData",G=z?"pData":"nData";f(c,r,V,K);var E="<a href='javascript:void(0)' id='"+E+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",
G="<a href='javascript:void(0)' id='"+G+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",Q="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>",H="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>",E="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+t+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+
(z?G+E:E+G)+"</td><td class='EditButton'>"+Q+H+"</td></tr>"+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+g.bottominfo+"</td></tr>"),E=E+"</tbody></table>";if(0<U){var O=[];a.each(a(V)[0].rows,function(a,b){O[a]=b});O.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(O,function(b,c){a("tbody",V).append(c)})}b.gbox="#gbox_"+u;var $=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,$=!0);X=a("<span></span>").append(X).append(E);a.jgrid.createModal(v,X,b,"#gview_"+
r.p.id,a("#gbox_"+r.p.id)[0]);z&&(a("#pData, #nData","#"+t+"_2").css("float","right"),a(".EditButton","#"+t+"_2").css("text-align","left"));g.topinfo&&a(".tinfo","#"+t+"_2").show();g.bottominfo&&a(".binfo","#"+t+"_2").show();E=X=null;a("#"+v.themodal).keydown(function(c){var d=c.target;if(a("#"+x).data("disabled")===true)return false;if(g.savekey[0]===true&&c.which==g.savekey[1]&&d.tagName!="TEXTAREA"){a("#sData","#"+t+"_2").trigger("click");return false}if(c.which===27){if(!n())return false;$&&a.jgrid.hideModal(this,
{gb:b.gbox,jqm:b.jqModal,onClose:g.onClose});return false}if(g.navkeys[0]===true){if(a("#id_g","#"+t).val()=="_empty")return true;if(c.which==g.navkeys[1]){a("#pData","#"+t+"_2").trigger("click");return false}if(c.which==g.navkeys[2]){a("#nData","#"+t+"_2").trigger("click");return false}}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span","#"+v.themodal).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close","#"+v.themodal).unbind("click").click(function(){if(!n())return false;a.jgrid.hideModal("#"+
v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose});return false}));b.saveicon=a.extend([!0,"left","ui-icon-disk"],b.saveicon);b.closeicon=a.extend([!0,"left","ui-icon-close"],b.closeicon);!0===b.saveicon[0]&&a("#sData","#"+t+"_2").addClass("right"==b.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");!0===b.closeicon[0]&&a("#cData","#"+t+"_2").addClass("right"==b.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+
b.closeicon[2]+"'></span>");if(g.checkOnSubmit||g.checkOnUpdate)Q="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bYes+"</a>",G="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bNo+"</a>",H="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bExit+"</a>",X=b.zIndex||999,X++,a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+
X+";display:none;'>&#160;"+(a.browser.msie&&6==a.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(X+1)+"'>"+b.saveData+"<br/><br/>"+Q+G+H+"</div>").insertAfter("#"+x),a("#sNew","#"+v.themodal).click(function(){m();a("#"+x).data("disabled",false);a(".confirm","#"+v.themodal).hide();return false}),a("#nNew","#"+v.themodal).click(function(){a(".confirm",
"#"+v.themodal).hide();a("#"+x).data("disabled",false);setTimeout(function(){a(":input","#"+x)[0].focus()},0);return false}),a("#cNew","#"+v.themodal).click(function(){a(".confirm","#"+v.themodal).hide();a("#"+x).data("disabled",false);a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose});return false});A&&A(a("#"+x));"_empty"==c||!g.viewPagerButtons?a("#pData,#nData","#"+t+"_2").hide():a("#pData,#nData","#"+t+"_2").show();B&&B(a("#"+x));a("#"+v.themodal).data("onClose",
g.onClose);a.jgrid.viewModal("#"+v.themodal,{gbox:"#gbox_"+u,jqm:b.jqModal,overlay:b.overlay,modal:b.modal});Y||a(".jqmOverlay").click(function(){if(!n())return false;a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose});return false});C&&C(a("#"+x));a(".fm-button","#"+v.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+t+"_2").click(function(){y={};S={};a("#FormError","#"+t).hide();e();p();
if(y[r.p.id+"_id"]=="_empty")m();else if(b.checkOnSubmit===true){D=a.extend({},y,S);if(d(D,g._savedData)){a("#"+x).data("disabled",true);a(".confirm","#"+v.themodal).show()}else m()}else m();return false});a("#cData","#"+t+"_2").click(function(){if(!n())return false;a.jgrid.hideModal("#"+v.themodal,{gb:"#gbox_"+u,jqm:b.jqModal,onClose:g.onClose});return false});a("#nData","#"+t+"_2").click(function(){if(!n())return false;a("#FormError","#"+t).hide();var c=q();c[0]=parseInt(c[0],10);if(c[0]!=-1&&c[1][c[0]+
1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("next",a("#"+x),c[1][c[0]]);j(c[1][c[0]+1],r,x);a(r).jqGrid("setSelection",c[1][c[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+x),c[1][c[0]+1]);o(c[0]+1,c[1].length-1)}return false});a("#pData","#"+t+"_2").click(function(){if(!n())return false;a("#FormError","#"+t).hide();var c=q();if(c[0]!=-1&&c[1][c[0]-1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("prev",a("#"+x),c[1][c[0]]);j(c[1][c[0]-1],
r,x);a(r).jqGrid("setSelection",c[1][c[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+x),c[1][c[0]-1]);o(c[0]-1,c[1].length-1)}return false})}B=q();o(B[0],B[1].length-1)}})},viewGridRow:function(c,b){b=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0},a.jgrid.view,b||
{});return this.each(function(){function e(){(!0===b.closeOnEscape||!0===b.navkeys[0])&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+q.modalhead).focus()},0)}function g(c,d,e,f){for(var j,k,m,l=0,n,o,p=[],s=!1,q="<td class='CaptionTD form-view-label ui-widget-content' width='"+b.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",r="",t=["integer","number","currency"],u=0,v=0,x,A,B,z=1;z<=f;z++)r+=1==z?q:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";
a(d.p.colModel).each(function(){k=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1;!k&&"right"===this.align&&(this.formatter&&-1!==a.inArray(this.formatter,t)?u=Math.max(u,parseInt(this.width,10)):v=Math.max(v,parseInt(this.width,10)))});x=0!==u?u:0!==v?v:0;s=a(d).jqGrid("getInd",c);a(d.p.colModel).each(function(b){j=this.name;A=!1;o=(k=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";B="boolean"!=typeof this.viewable?!0:this.viewable;
if("cb"!==j&&"subgrid"!==j&&"rn"!==j&&B){n=!1===s?"":j==d.p.ExpandColumn&&!0===d.p.treeGrid?a("td:eq("+b+")",d.rows[s]).text():a("td:eq("+b+")",d.rows[s]).html();A="right"===this.align&&0!==x?!0:!1;a.extend({},this.editoptions||{},{id:j,name:j});var c=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),g=parseInt(c.rowpos,10)||l+1,q=parseInt(2*(parseInt(c.colpos,10)||1),10);if(c.rowabove){var t=a("<tr><td class='contentinfo' colspan='"+2*f+"'>"+c.rowcontent+"</td></tr>");a(e).append(t);
t[0].rp=g}m=a(e).find("tr[rowpos="+g+"]");0===m.length&&(m=a("<tr "+o+" rowpos='"+g+"'></tr>").addClass("FormData").attr("id","trv_"+j),a(m).append(r),a(e).append(m),m[0].rp=g);a("td:eq("+(q-2)+")",m[0]).html("<b>"+("undefined"===typeof c.label?d.p.colNames[b]:c.label)+"</b>");a("td:eq("+(q-1)+")",m[0]).append("<span>"+n+"</span>").attr("id","v_"+j);A&&a("td:eq("+(q-1)+") span",m[0]).css({"text-align":"right",width:x+"px"});p[l]=b;l++}});0<l&&(c=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+
(2*f-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+c+"'/></td></tr>"),c[0].rp=l+99,a(e).append(c));return p}function f(b,c){var d,e,g=0,j,k;if(k=a(c).jqGrid("getInd",b,!0))a("td",k).each(function(b){d=c.p.colModel[b].name;e=c.p.colModel[b].editrules&&!0===c.p.colModel[b].editrules.edithidden?!1:!0===c.p.colModel[b].hidden?!0:!1;"cb"!==d&&("subgrid"!==d&&"rn"!==d)&&(j=d==c.p.ExpandColumn&&!0===c.p.treeGrid?a(this).text():a(this).html(),a.extend({},c.p.colModel[b].editoptions||
{}),d=a.jgrid.jqID("v_"+d),a("#"+d+" span","#"+o).html(j),e&&a("#"+d,"#"+o).parents("tr:first").hide(),g++)}),0<g&&a("#id_g","#"+o).val(b)}function m(b,c){0===b?a("#pData","#"+o+"_2").addClass("ui-state-disabled"):a("#pData","#"+o+"_2").removeClass("ui-state-disabled");b==c?a("#nData","#"+o+"_2").addClass("ui-state-disabled"):a("#nData","#"+o+"_2").removeClass("ui-state-disabled")}function d(){var b=a(l).jqGrid("getDataIDs"),c=a("#id_g","#"+o).val();return[a.inArray(c,b),b]}var l=this;if(l.grid&&
c){b.imgpath||(b.imgpath=l.p.imgpath);var n=l.p.id,s="ViewGrid_"+n,o="ViewTbl_"+n,q={themodal:"viewmod"+n,modalhead:"viewhd"+n,modalcontent:"viewcnt"+n,scrollelm:s},r=a.isFunction(b.beforeInitData)?b.beforeInitData:!1,u=!0,x=1,t=0;if(null!==a("#"+q.themodal).html()){r&&(u=r(a("#"+s)),"undefined"==typeof u&&(u=!0));if(!1===u)return;a(".ui-jqdialog-title","#"+q.modalhead).html(b.caption);a("#FormError","#"+o).hide();f(c,l);a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+s));a.jgrid.viewModal("#"+
q.themodal,{gbox:"#gbox_"+n,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal});e()}else{var v=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",v=a("<form name='FormPost' id='"+s+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+v+";'></form>"),B=a("<table id='"+o+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");r&&(u=r(a("#"+s)),"undefined"==typeof u&&(u=!0));if(!1===u)return;a(l.p.colModel).each(function(){var a=
this.formoptions;x=Math.max(x,a?a.colpos||0:0);t=Math.max(t,a?a.rowpos||0:0)});a(v).append(B);g(c,l,B,x);var r="rtl"==l.p.direction?!0:!1,u="<a href='javascript:void(0)' id='"+(r?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",C="<a href='javascript:void(0)' id='"+(r?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",z="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+
b.bClose+"</a>";if(0<t){var A=[];a.each(a(B)[0].rows,function(a,b){A[a]=b});A.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(A,function(b,c){a("tbody",B).append(c)})}b.gbox="#gbox_"+n;var E=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,E=!0);v=a("<span></span>").append(v).append("<table border='0' class='EditTable' id='"+o+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+b.labelswidth+"'>"+(r?C+u:u+C)+"</td><td class='EditButton'>"+z+"</td></tr></tbody></table>");a.jgrid.createModal(q,
v,b,"#gview_"+l.p.id,a("#gview_"+l.p.id)[0]);r&&(a("#pData, #nData","#"+o+"_2").css("float","right"),a(".EditButton","#"+o+"_2").css("text-align","left"));b.viewPagerButtons||a("#pData, #nData","#"+o+"_2").hide();v=null;a("#"+q.themodal).keydown(function(c){if(c.which===27){E&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(c.which===b.navkeys[1]){a("#pData","#"+o+"_2").trigger("click");return false}if(c.which===b.navkeys[2]){a("#nData",
"#"+o+"_2").trigger("click");return false}}});b.closeicon=a.extend([!0,"left","ui-icon-close"],b.closeicon);!0===b.closeicon[0]&&a("#cData","#"+o+"_2").addClass("right"==b.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+s));a.jgrid.viewModal("#"+q.themodal,{gbox:"#gbox_"+n,jqm:b.jqModal,modal:b.modal});a(".fm-button:not(.ui-state-disabled)","#"+o+"_2").hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});e();a("#cData","#"+o+"_2").click(function(){a.jgrid.hideModal("#"+q.themodal,{gb:"#gbox_"+n,jqm:b.jqModal,onClose:b.onClose});return false});a("#nData","#"+o+"_2").click(function(){a("#FormError","#"+o).hide();var c=d();c[0]=parseInt(c[0],10);if(c[0]!=-1&&c[1][c[0]+1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("next",a("#"+s),c[1][c[0]]);f(c[1][c[0]+1],l);a(l).jqGrid("setSelection",c[1][c[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",
a("#"+s),c[1][c[0]+1]);m(c[0]+1,c[1].length-1)}e();return false});a("#pData","#"+o+"_2").click(function(){a("#FormError","#"+o).hide();var c=d();if(c[0]!=-1&&c[1][c[0]-1]){if(a.isFunction(b.onclickPgButtons))b.onclickPgButtons("prev",a("#"+s),c[1][c[0]]);f(c[1][c[0]-1],l);a(l).jqGrid("setSelection",c[1][c[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+s),c[1][c[0]-1]);m(c[0]-1,c[1].length-1)}e();return false})}v=d();m(v[0],v[1].length-1)}})},delGridRow:function(c,b){g=
b=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},a.jgrid.del,b||{});return this.each(function(){var e=this;if(e.grid&&c){var f="function"===typeof b.beforeShowForm?
!0:!1,j="function"===typeof b.afterShowForm?!0:!1,m=a.isFunction(b.beforeInitData)?b.beforeInitData:!1,d=e.p.id,p={},n=!0,s="DelTbl_"+d,o,q,r,u,x={themodal:"delmod"+d,modalhead:"delhd"+d,modalcontent:"delcnt"+d,scrollelm:s};l.isArray(c)&&(c=c.join());if(null!==a("#"+x.themodal).html()){m&&(n=m(a("#"+s)),"undefined"==typeof n&&(n=!0));if(!1===n)return;a("#DelData>td","#"+s).text(c);a("#DelError","#"+s).hide();!0===g.processing&&(g.processing=!1,a("#dData","#"+s).removeClass("ui-state-active"));f&&
b.beforeShowForm(a("#"+s));a.jgrid.viewModal("#"+x.themodal,{gbox:"#gbox_"+d,jqm:b.jqModal,jqM:!1,overlay:b.overlay,modal:b.modal})}else{var t=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",t="<div id='"+s+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+t+";'><table class='DelTable'><tbody><tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>"+("<tr id='DelData' style='display:none'><td >"+c+"</td></tr>"),t=t+('<tr><td class="delmsg" style="white-space:pre;">'+
b.msg+"</td></tr><tr><td >&#160;</td></tr>"),t=t+"</tbody></table></div>"+("<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+s+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>")+
"</td></tr></tbody></table>");b.gbox="#gbox_"+d;a.jgrid.createModal(x,t,b,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]);m&&(n=m(a("#"+s)),"undefined"==typeof n&&(n=!0));if(!1===n)return;a(".fm-button","#"+s+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});b.delicon=a.extend([!0,"left","ui-icon-scissors"],b.delicon);b.cancelicon=a.extend([!0,"left","ui-icon-cancel"],b.cancelicon);!0===b.delicon[0]&&a("#dData","#"+s+"_2").addClass("right"==b.delicon[1]?
"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.delicon[2]+"'></span>");!0===b.cancelicon[0]&&a("#eData","#"+s+"_2").addClass("right"==b.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.cancelicon[2]+"'></span>");a("#dData","#"+s+"_2").click(function(){var c=[true,""];p={};var f=a("#DelData>td","#"+s).text();typeof b.onclickSubmit==="function"&&(p=b.onclickSubmit(g,f)||{});typeof b.beforeSubmit==="function"&&(c=b.beforeSubmit(f));
if(c[0]&&!g.processing){g.processing=true;a(this).addClass("ui-state-active");r=e.p.prmNames;o=a.extend({},g.delData,p);u=r.oper;o[u]=r.deloper;q=r.id;o[q]=f;var j=a.extend({url:g.url?g.url:a(e).jqGrid("getGridParam","editurl"),type:b.mtype,data:a.isFunction(b.serializeDelData)?b.serializeDelData(o):o,complete:function(j,k){if(k!="success"){c[0]=false;c[1]=a.isFunction(g.errorTextFormat)?g.errorTextFormat(j):k+" Status: '"+j.statusText+"'. Error code: "+j.status}else typeof g.afterSubmit==="function"&&
(c=g.afterSubmit(j,o));if(c[0]===false){a("#DelError>td","#"+s).html(c[1]);a("#DelError","#"+s).show()}else{if(g.reloadAfterSubmit&&e.p.datatype!="local")a(e).trigger("reloadGrid");else{var m=[],m=f.split(",");if(e.p.treeGrid===true)try{a(e).jqGrid("delTreeNode",m[0])}catch(l){}else for(var n=0;n<m.length;n++)a(e).jqGrid("delRowData",m[n]);e.p.selrow=null;e.p.selarrrow=[]}a.isFunction(g.afterComplete)&&setTimeout(function(){g.afterComplete(j,f)},500)}g.processing=false;a("#dData","#"+s+"_2").removeClass("ui-state-active");
c[0]&&a.jgrid.hideModal("#"+x.themodal,{gb:"#gbox_"+d,jqm:b.jqModal,onClose:g.onClose})}},a.jgrid.ajaxOptions,b.ajaxDelOptions);if(!j.url&&!g.useDataProxy)if(a.isFunction(e.p.dataProxy))g.useDataProxy=true;else{c[0]=false;c[1]=c[1]+(" "+a.jgrid.errors.nourl)}c[0]&&(g.useDataProxy?e.p.dataProxy.call(e,j,"del_"+e.p.id):a.ajax(j))}if(c[0]===false){a("#DelError>td","#"+s).html(c[1]);a("#DelError","#"+s).show()}return false});a("#eData","#"+s+"_2").click(function(){a.jgrid.hideModal("#"+x.themodal,{gb:"#gbox_"+
d,jqm:b.jqModal,onClose:g.onClose});return false});f&&b.beforeShowForm(a("#"+s));a.jgrid.viewModal("#"+x.themodal,{gbox:"#gbox_"+d,jqm:b.jqModal,overlay:b.overlay,modal:b.modal})}j&&b.afterShowForm(a("#"+s));!0===b.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+x.modalhead).focus()},0)}})},navGrid:function(c,b,e,g,f,m,d){b=a.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,
refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},a.jgrid.nav,b||{});return this.each(function(){if(!this.nav){var l={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},n=this,s,o,q;if(n.grid&&"string"==typeof c){null===a("#"+l.themodal).html()&&("undefined"!=typeof window.innerWidth?(s=window.innerWidth,o=window.innerHeight):"undefined"!=typeof document.documentElement&&
"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(s=document.documentElement.clientWidth,o=document.documentElement.clientHeight):(s=1024,o=768),a.jgrid.createModal(l,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+n.p.id,jqModal:!0,drag:!0,resize:!0,caption:b.alertcap,top:o/2-25,left:s/2-100,width:200,height:"auto",closeOnEscape:b.closeOnEscape},"","",!0));s=1;b.cloneToTop&&n.p.toppager&&
(s=2);for(o=0;o<s;o++){var r=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),u,x;0===o?(u=c,x=n.p.id,u==n.p.toppager&&(x+="_top",s=1)):(u=n.p.toppager,x=n.p.id+"_top");"rtl"==n.p.direction&&a(r).attr("dir","rtl").css("float","right");b.add&&(g=g||{},q=a("<td class='ui-pg-button ui-corner-all'></td>"),a(q).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>"),
a("tr",r).append(q),a(q,r).attr({title:b.addtitle||"",id:g.id||"add_"+x}).click(function(){a(this).hasClass("ui-state-disabled")||(typeof b.addfunc=="function"?b.addfunc():a(n).jqGrid("editGridRow","new",g));return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),q=null);b.edit&&(q=a("<td class='ui-pg-button ui-corner-all'></td>"),e=e||{},a(q).append("<div class='ui-pg-div'><span class='ui-icon "+
b.editicon+"'></span>"+b.edittext+"</div>"),a("tr",r).append(q),a(q,r).attr({title:b.edittitle||"",id:e.id||"edit_"+x}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var c=n.p.selrow;if(c)typeof b.editfunc=="function"?b.editfunc(c):a(n).jqGrid("editGridRow",c,e);else{a.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),
q=null);b.view&&(q=a("<td class='ui-pg-button ui-corner-all'></td>"),d=d||{},a(q).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+"</div>"),a("tr",r).append(q),a(q,r).attr({title:b.viewtitle||"",id:d.id||"view_"+x}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=n.p.selrow;if(b)a(n).jqGrid("viewGridRow",b,d);else{a.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),q=null);b.del&&(q=a("<td class='ui-pg-button ui-corner-all'></td>"),f=f||{},a(q).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>"),a("tr",r).append(q),a(q,r).attr({title:b.deltitle||"",id:f.id||"del_"+x}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var c;if(n.p.multiselect){c=n.p.selarrrow;c.length===0&&(c=null)}else c=n.p.selrow;if(c)"function"==typeof b.delfunc?
b.delfunc(c):a(n).jqGrid("delGridRow",c,f);else{a.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),q=null);(b.add||b.edit||b.del||b.view)&&a("tr",r).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");b.search&&(q=a("<td class='ui-pg-button ui-corner-all'></td>"),
m=m||{},a(q).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+"'></span>"+b.searchtext+"</div>"),a("tr",r).append(q),a(q,r).attr({title:b.searchtitle||"",id:m.id||"search_"+x}).click(function(){a(this).hasClass("ui-state-disabled")||a(n).jqGrid("searchGrid",m);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),m.showOnLoad&&!0===m.showOnLoad&&a(q,r).click(),q=null);b.refresh&&
(q=a("<td class='ui-pg-button ui-corner-all'></td>"),a(q).append("<div class='ui-pg-div'><span class='ui-icon "+b.refreshicon+"'></span>"+b.refreshtext+"</div>"),a("tr",r).append(q),a(q,r).attr({title:b.refreshtitle||"",id:"refresh_"+x}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(b.beforeRefresh)&&b.beforeRefresh();n.p.search=false;try{var c=n.p.id;n.p.postData.filters="";a("#fbox_"+c).jqFilter("resetFilter");a.isFunction(n.clearToolbar)&&n.clearToolbar(false)}catch(d){}switch(b.refreshstate){case "firstpage":a(n).trigger("reloadGrid",
[{page:1}]);break;case "current":a(n).trigger("reloadGrid",[{current:true}])}a.isFunction(b.afterRefresh)&&b.afterRefresh()}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),q=null);q=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+q+";visibility:hidden;' ></div>");q=a(r).clone().appendTo("#testpg2").width();
a("#testpg2").remove();a(u+"_"+b.position,u).append(r);n.p._nvtd&&(q>n.p._nvtd[0]&&(a(u+"_"+b.position,u).width(q),n.p._nvtd[0]=q),n.p._nvtd[1]=q);r=q=q=null;this.nav=!0}}}})},navButtonAdd:function(c,b){b=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},b||{});return this.each(function(){if(this.grid){0!==c.indexOf("#")&&(c="#"+c);var e=a(".navtable",c)[0],g=this;if(e&&!(b.id&&null!==a("#"+b.id,e).html())){var f=a("<td></td>");
"NONE"==b.buttonicon.toString().toUpperCase()?a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+b.caption+"</div>"):a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+b.buttonicon+"'></span>"+b.caption+"</div>");b.id&&a(f).attr("id",b.id);"first"==b.position?0===e.rows[0].cells.length?a("tr",e).append(f):a("tr td:eq(0)",e).before(f):a("tr",e).append(f);a(f,e).attr("title",b.title||"").click(function(c){a(this).hasClass("ui-state-disabled")||
a.isFunction(b.onClickButton)&&b.onClickButton.call(g,c);return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(c,b){b=a.extend({sepclass:"ui-separator",sepcontent:""},b||{});return this.each(function(){if(this.grid){0!==c.indexOf("#")&&(c="#"+c);var e=a(".navtable",c)[0];if(e){var g="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+b.sepclass+
"'></span>"+b.sepcontent+"</td>";a("tr",e).append(g)}}})},GridToForm:function(c,b){return this.each(function(){if(this.grid){var e=a(this).jqGrid("getRowData",c);if(e)for(var g in e)a("[name="+a.jgrid.jqID(g)+"]",b).is("input:radio")||a("[name="+a.jgrid.jqID(g)+"]",b).is("input:checkbox")?a("[name="+a.jgrid.jqID(g)+"]",b).each(function(){a(this).val()==e[g]?a(this).attr("checked","checked"):a(this).attr("checked","")}):a("[name="+a.jgrid.jqID(g)+"]",b).val(e[g])}})},FormToGrid:function(c,b,e,g){return this.each(function(){if(this.grid){e||
(e="set");g||(g="first");var f=a(b).serializeArray(),m={};a.each(f,function(a,b){m[b.name]=b.value});"add"==e?a(this).jqGrid("addRowData",c,m,g):"set"==e&&a(this).jqGrid("setRowData",c,m)}})}})})(l);(function(a){a.fn.jqFilter=function(g){if("string"===typeof g){var c=a.fn.jqFilter[g];if(!c)throw"jqFilter - No such method: "+g;var b=a.makeArray(arguments).slice(1);return c.apply(this,b)}var e=a.extend(!0,{filter:null,columns:[],onChange:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,
sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",
operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:"eq ne lt le gt ge nu nn in ni".split(" "),stropts:"eq ne bw bn ew en cn nc nu nn in ni".split(" "),_gridsopt:[],groupOps:["AND",
"OR"],groupButton:!0},g||{});return this.each(function(){if(!this.filter){this.p=e;if(null===this.p.filter||void 0===this.p.filter)this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]};var b,c=this.p.columns.length,g,d=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length)for(b=0;b<this.p._gridsopt.length;b++)this.p.ops[b].description=this.p._gridsopt[b];this.p.initFilter=a.extend(!0,{},this.p.filter);if(c){for(b=0;b<c;b++)if(g=this.p.columns[b],g.stype?g.inputtype=g.stype:
g.inputtype||(g.inputtype="text"),g.sorttype?g.searchtype=g.sorttype:g.searchtype||(g.searchtype="string"),void 0===g.hidden&&(g.hidden=!1),g.label||(g.label=g.name),g.index&&(g.name=g.index),g.hasOwnProperty("searchoptions")||(g.searchoptions={}),!g.hasOwnProperty("searchrules"))g.searchrules={};this.p.showQuery&&a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>");var f=
function(b,c){var d=[!0,""];if(a.isFunction(c.searchrules))d=c.searchrules(b,c);else if(a.jgrid&&a.jgrid.checkValues)try{d=a.jgrid.checkValues(b,-1,null,c.searchrules,c.label)}catch(g){}d&&(d.length&&!1===d[0])&&(e.error=!d[0],e.errmsg=d[1])};this.onchange=function(){this.p.error=!1;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){a("table.group:first",this).remove();var b=this.createTableForGroup(e.filter,null);a(this).append(b)};
this.createTableForGroup=function(b,c){var d=this,g,f=a("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>");null===c&&a(f).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>");var j=a("<tr></tr>");a(f).append(j);var k=a("<th colspan='5' align='left'></th>");j.append(k);var m=a("<select class='opsel'></select>");k.append(m);var j="",l;for(g=0;g<e.groupOps.length;g++)l=b.groupOp===d.p.groupOps[g]?
" selected='selected'":"",j+="<option value='"+d.p.groupOps[g]+"'"+l+">"+d.p.groupOps[g]+"</option>";m.append(j).bind("change",function(){b.groupOp=a(m).val();d.onchange()});j="<span></span>";this.p.groupButton&&(j=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),j.bind("click",function(){void 0===b.groups&&(b.groups=[]);b.groups.push({groupOp:e.groupOps[0],rules:[],groups:[]});d.reDraw();d.onchange();return!1}));k.append(j);var j=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),
p;j.bind("click",function(){if(b.rules===void 0)b.rules=[];for(g=0;g<d.p.columns.length;g++){var a=typeof d.p.columns[g].search==="undefined"?true:d.p.columns[g].search,c=d.p.columns[g].hidden===true;if(d.p.columns[g].searchoptions.searchhidden===true&&a||a&&!c){p=d.p.columns[g];break}}b.rules.push({field:p.name,op:(p.searchoptions.sopt?p.searchoptions.sopt:d.p.sopt?d.p.sopt:p.searchtype==="string"?d.p.stropts:d.p.numopts)[0],data:""});d.reDraw();return false});k.append(j);null!==c&&(j=a("<input type='button' value='-' title='Delete group' class='delete-group'/>"),
k.append(j),j.bind("click",function(){for(g=0;g<c.groups.length;g++)if(c.groups[g]===b){c.groups.splice(g,1);break}d.reDraw();d.onchange();return false}));if(void 0!==b.groups)for(g=0;g<b.groups.length;g++)k=a("<tr></tr>"),f.append(k),j=a("<td class='first'></td>"),k.append(j),j=a("<td colspan='4'></td>"),j.append(this.createTableForGroup(b.groups[g],b)),k.append(j);void 0===b.groupOp&&(b.groupOp=d.p.groupOps[0]);if(void 0!==b.rules)for(g=0;g<b.rules.length;g++)f.append(this.createTableRowForRule(b.rules[g],
b));return f};this.createTableRowForRule=function(b,c){var g=this,f=a("<tr></tr>"),j,k,m,l,p="",B;f.append("<td class='first'></td>");var C=a("<td class='columns'></td>");f.append(C);var z=a("<select></select>");C.append(z);z.bind("change",function(){b.field=a(z).val();m=a(this).parents("tr:first");for(j=0;j<g.p.columns.length;j++)if(g.p.columns[j].name===b.field){l=g.p.columns[j];break}if(l){l.searchoptions.id=a.jgrid.randId();d&&"text"===l.inputtype&&!l.searchoptions.size&&(l.searchoptions.size=
10);var c=a.jgrid.createEl(l.inputtype,l.searchoptions,"",!0,g.p.ajaxSelectOptions,!0);a(c).addClass("input-elm");k=l.searchoptions.sopt?l.searchoptions.sopt:g.p.sopt?g.p.sopt:"string"===l.searchtype?g.p.stropts:g.p.numopts;var e="",f="";for(j=0;j<g.p.ops.length;j++)-1!==a.inArray(g.p.ops[j].name,k)&&(f=b.op===g.p.ops[j].name?" selected=selected":"",e+="<option value='"+g.p.ops[j].name+"'"+f+">"+g.p.ops[j].description+"</option>");a(".selectopts",m).empty().append(e);a(".data",m).empty().append(c);
a(".input-elm",m).bind("change",function(){b.data=a(this).val();if(a.isArray(b.data))b.data=b.data.join(",");g.onchange()});setTimeout(function(){b.data=a(c).val();g.onchange()},0)}});for(j=C=0;j<g.p.columns.length;j++){B="undefined"===typeof g.p.columns[j].search?!0:g.p.columns[j].search;var A=!0===g.p.columns[j].hidden;if(!0===g.p.columns[j].searchoptions.searchhidden&&B||B&&!A)B="",b.field===g.p.columns[j].name&&(B=" selected='selected'",C=j),p+="<option value='"+g.p.columns[j].name+"'"+B+">"+
g.p.columns[j].label+"</option>"}z.append(p);p=a("<td class='operators'></td>");f.append(p);l=e.columns[C];l.searchoptions.id=a.jgrid.randId();d&&"text"===l.inputtype&&!l.searchoptions.size&&(l.searchoptions.size=10);var C=a.jgrid.createEl(l.inputtype,l.searchoptions,b.data,!0,g.p.ajaxSelectOptions,!0),E=a("<select class='selectopts'></select>");p.append(E);E.bind("change",function(){b.op=a(E).val();m=a(this).parents("tr:first");var c=a(".input-elm",m)[0];if(b.op==="nu"||b.op==="nn"){b.data="";c.value=
"";c.setAttribute("readonly","true");c.setAttribute("disabled","true")}else{c.removeAttribute("readonly");c.removeAttribute("disabled")}g.onchange()});k=l.searchoptions.sopt?l.searchoptions.sopt:g.p.sopt?g.p.sopt:"string"===l.searchtype?e.stropts:g.p.numopts;p="";for(j=0;j<g.p.ops.length;j++)-1!==a.inArray(g.p.ops[j].name,k)&&(B=b.op===g.p.ops[j].name?" selected='selected'":"",p+="<option value='"+g.p.ops[j].name+"'"+B+">"+g.p.ops[j].description+"</option>");E.append(p);p=a("<td class='data'></td>");
f.append(p);p.append(C);a(C).addClass("input-elm").bind("change",function(){b.data=a(this).val();if(a.isArray(b.data))b.data=b.data.join(",");g.onchange()});p=a("<td></td>");f.append(p);C=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");p.append(C);C.bind("click",function(){for(j=0;j<c.rules.length;j++)if(c.rules[j]===b){c.rules.splice(j,1);break}g.reDraw();g.onchange();return false});return f};this.getStringForGroup=function(a){var b="(",c;if(void 0!==a.groups)for(c=
0;c<a.groups.length;c++){1<b.length&&(b+=" "+a.groupOp+" ");try{b+=this.getStringForGroup(a.groups[c])}catch(d){alert(d)}}if(void 0!==a.rules)try{for(c=0;c<a.rules.length;c++)1<b.length&&(b+=" "+a.groupOp+" "),b+=this.getStringForRule(a.rules[c])}catch(e){alert(e)}b+=")";return"()"===b?"":b};this.getStringForRule=function(b){var c="",d="",g,j;for(g=0;g<this.p.ops.length;g++)if(this.p.ops[g].name===b.op){c=this.p.ops[g].operator;d=this.p.ops[g].name;break}for(g=0;g<this.p.columns.length;g++)if(this.p.columns[g].name===
b.field){j=this.p.columns[g];break}g=b.data;if("bw"===d||"bn"===d)g+="%";if("ew"===d||"en"===d)g="%"+g;if("cn"===d||"nc"===d)g="%"+g+"%";if("in"===d||"ni"===d)g=" ("+g+")";e.errorcheck&&f(b.data,j);return-1!==a.inArray(j.searchtype,["int","integer","float","number","currency"])||"nn"===d||"nu"===d?b.field+" "+c+" "+g:b.field+" "+c+' "'+g+'"'};this.resetFilter=function(){this.p.filter=a.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");
a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(e.filter)};this.toString=function(){function a(c){var d="(",e;if(void 0!==c.groups)for(e=0;e<c.groups.length;e++)1<d.length&&(d+="OR"===c.groupOp?" || ":" && "),d+=a(c.groups[e]);if(void 0!==c.rules)for(e=0;e<c.rules.length;e++){1<d.length&&(d+="OR"===c.groupOp?" || ":" && ");var g=c.rules[e];if(b.p.errorcheck){for(var j=
void 0,k=void 0,j=0;j<b.p.columns.length;j++)if(b.p.columns[j].name===g.field){k=b.p.columns[j];break}k&&f(g.data,k)}d+=g.op+"(item."+g.field+",'"+g.data+"')"}d+=")";return"()"===d?"":d}var b=this;return a(this.p.filter)};this.reDraw();if(this.p.showQuery)this.onchange();this.filter=!0}}})};a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){return void 0!==
a&&this.p.hasOwnProperty(a)?this.p[a]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(a){"string"===typeof a&&(a=l.jgrid.parse(a));this.each(function(){this.p.filter=a;this.reDraw();this.onchange()})}})})(l);(function(a){a.jgrid.extend({editRow:function(g,c,b,e,f,j,m,d,l){var n={keys:c||!1,oneditfunc:b||null,successfunc:e||null,url:f||null,extraparam:j||{},aftersavefunc:m||null,errorfunc:d||null,afterrestorefunc:l||null,restoreAfterErorr:!0},s=a.makeArray(arguments).slice(1),
o;o=s[0]&&"object"==typeof s[0]&&!a.isFunction(s[0])?a.extend(n,s[0]):n;return this.each(function(){var b=this,c,d,e=0,f=null,j={},k,m;if(b.grid&&(k=a(b).jqGrid("getInd",g,!0),!1!==k&&"0"==(a(k).attr("editable")||"0")&&!a(k).hasClass("not-editable-row")))m=b.p.colModel,a("td",k).each(function(k){c=m[k].name;var l=!0===b.p.treeGrid&&c==b.p.ExpandColumn;if(l)d=a("span:first",this).html();else try{d=a.unformat(this,{rowId:g,colModel:m[k]},k)}catch(n){d=a(this).html()}if("cb"!=c&&("subgrid"!=c&&"rn"!=
c)&&(b.p.autoencode&&(d=a.jgrid.htmlDecode(d)),j[c]=d,!0===m[k].editable)){null===f&&(f=k);l?a("span:first",this).html(""):a(this).html("");var o=a.extend({},m[k].editoptions||{},{id:g+"_"+c,name:c});m[k].edittype||(m[k].edittype="text");o=a.jgrid.createEl(m[k].edittype,o,d,!0,a.extend({},a.jgrid.ajaxOptions,b.p.ajaxSelectOptions||{}));a(o).addClass("editable");l?a("span:first",this).append(o):a(this).append(o);"select"==m[k].edittype&&!0===m[k].editoptions.multiple&&a.browser.msie&&a(o).width(a(o).width());
e++}}),0<e&&(j.id=g,b.p.savedRow.push(j),a(k).attr("editable","1"),a("td:eq("+f+") input",k).focus(),!0===o.keys&&a(k).bind("keydown",function(c){27===c.keyCode&&a(b).jqGrid("restoreRow",g,l);if(13===c.keyCode){if("TEXTAREA"==c.target.tagName)return!0;a(b).jqGrid("saveRow",g,o);return!1}c.stopPropagation()}),a.isFunction(o.oneditfunc)&&o.oneditfunc.call(b,g))})},saveRow:function(g,c,b,e,f,j,m){var d={successfunc:c||null,url:b||null,extraparam:e||{},aftersavefunc:f||null,errorfunc:j||null,afterrestorefunc:m||
null,restoreAfterErorr:!0},p=a.makeArray(arguments).slice(1),n;n=p[0]&&"object"==typeof p[0]&&!a.isFunction(p[0])?a.extend(d,p[0]):d;var s=!1,o=this[0],q,r={},u={},x={},t,v,B;if(!o.grid)return s;B=a(o).jqGrid("getInd",g,!0);if(!1===B)return s;d=a(B).attr("editable");n.url=n.url?n.url:o.p.editurl;if("1"===d){var C;a("td",B).each(function(b){C=o.p.colModel[b];q=C.name;if("cb"!=q&&"subgrid"!=q&&!0===C.editable&&"rn"!=q&&!a(this).hasClass("not-editable-cell")){switch(C.edittype){case "checkbox":var c=
["Yes","No"];C.editoptions&&(c=C.editoptions.value.split(":"));r[q]=a("input",this).attr("checked")?c[0]:c[1];break;case "text":case "password":case "textarea":case "button":r[q]=a("input, textarea",this).val();break;case "select":if(C.editoptions.multiple){var c=a("select",this),d=[];r[q]=a(c).val();r[q]=r[q]?r[q].join(","):"";a("select > option:selected",this).each(function(b,c){d[b]=a(c).text()});u[q]=d.join(",")}else r[q]=a("select>option:selected",this).val(),u[q]=a("select>option:selected",
this).text();C.formatter&&"select"==C.formatter&&(u={});break;case "custom":try{if(C.editoptions&&a.isFunction(C.editoptions.custom_value)){if(r[q]=C.editoptions.custom_value.call(o,a(".customelement",this),"get"),void 0===r[q])throw"e2";}else throw"e1";}catch(e){"e1"==e&&a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,l.jgrid.edit.bClose),"e2"==e?a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,l.jgrid.edit.bClose):
a.jgrid.info_dialog(l.jgrid.errors.errcap,e.message,l.jgrid.edit.bClose)}}v=a.jgrid.checkValues(r[q],b,o);if(!1===v[0])return v[1]=r[q]+" "+v[1],!1;o.p.autoencode&&(r[q]=a.jgrid.htmlEncode(r[q]));"clientArray"!==n.url&&C.editoptions&&!0===C.editoptions.NullIfEmpty&&""==r[q]&&(x[q]="null")}});if(!1===v[0]){try{var z=a.jgrid.findPos(a("#"+a.jgrid.jqID(g),o.grid.bDiv)[0]);a.jgrid.info_dialog(a.jgrid.errors.errcap,v[1],a.jgrid.edit.bClose,{left:z[0],top:z[1]})}catch(A){alert(v[1])}return s}r&&(d=o.p.prmNames,
p=d.oper,z=d.id,r[p]=d.editoper,r[z]=g,"undefined"==typeof o.p.inlineData&&(o.p.inlineData={}),r=a.extend({},r,o.p.inlineData,n.extraparam));if("clientArray"==n.url){r=a.extend({},r,u);o.p.autoencode&&a.each(r,function(b,c){r[b]=a.jgrid.htmlDecode(c)});z=a(o).jqGrid("setRowData",g,r);a(B).attr("editable","0");for(d=0;d<o.p.savedRow.length;d++)if(o.p.savedRow[d].id==g){t=d;break}0<=t&&o.p.savedRow.splice(t,1);a.isFunction(n.aftersavefunc)&&n.aftersavefunc.call(o,g,z);s=!0}else a("#lui_"+o.p.id).show(),
x=a.extend({},r,x),a.ajax(a.extend({url:n.url,data:a.isFunction(o.p.serializeRowData)?o.p.serializeRowData.call(o,x):x,type:"POST",async:!1,complete:function(b,c){a("#lui_"+o.p.id).hide();if(c==="success")if((a.isFunction(n.succesfunc)?n.succesfunc.call(o,b):true)===true){o.p.autoencode&&a.each(r,function(b,c){r[b]=a.jgrid.htmlDecode(c)});r=a.extend({},r,u);a(o).jqGrid("setRowData",g,r);a(B).attr("editable","0");for(var d=0;d<o.p.savedRow.length;d++)if(o.p.savedRow[d].id==g){t=d;break}t>=0&&o.p.savedRow.splice(t,
1);a.isFunction(n.aftersavefunc)&&n.aftersavefunc.call(o,g,b);s=true}else{a.isFunction(n.errorfunc)&&n.errorfunc.call(o,g,b,c);n.restoreAfterError===true&&a(o).jqGrid("restoreRow",g,n.afterrestorefunc)}},error:function(b,c){a("#lui_"+o.p.id).hide();if(a.isFunction(n.errorfunc))n.errorfunc.call(o,g,b,c);else try{l.jgrid.info_dialog(l.jgrid.errors.errcap,'<div class="ui-state-error">'+b.responseText+"</div>",l.jgrid.edit.bClose,{buttonalign:"right"})}catch(d){alert(b.responseText)}n.restoreAfterError===
true&&a(o).jqGrid("restoreRow",g,n.afterrestorefunc)}},a.jgrid.ajaxOptions,o.p.ajaxRowOptions||{}));a(B).unbind("keydown")}return s},restoreRow:function(g,c){return this.each(function(){var b=this,e,f,j={};if(b.grid&&(f=a(b).jqGrid("getInd",g,!0),!1!==f)){for(var m=0;m<b.p.savedRow.length;m++)if(b.p.savedRow[m].id==g){e=m;break}if(0<=e){if(a.isFunction(a.fn.datepicker))try{a("input.hasDatepicker","#"+a.jgrid.jqID(f.id)).datepicker("hide")}catch(d){}a.each(b.p.colModel,function(){!0===this.editable&&
(this.name in b.p.savedRow[e]&&!a(this).hasClass("not-editable-cell"))&&(j[this.name]=b.p.savedRow[e][this.name])});a(b).jqGrid("setRowData",g,j);a(f).attr("editable","0").unbind("keydown");b.p.savedRow.splice(e,1)}a.isFunction(c)&&c.call(b,g)}})}})})(l);(function(a){a.jgrid.extend({editCell:function(g,c,b){return this.each(function(){var e=this,f,j,m;if(e.grid&&!0===e.p.cellEdit){c=parseInt(c,10);e.p.selrow=e.rows[g].id;e.p.knv||a(e).jqGrid("GridNav");if(0<e.p.savedRow.length){if(!0===b&&g==e.p.iRow&&
c==e.p.iCol)return;a(e).jqGrid("saveCell",e.p.savedRow[0].id,e.p.savedRow[0].ic)}else window.setTimeout(function(){a("#"+e.p.knv).attr("tabindex","-1").focus()},0);f=e.p.colModel[c].name;if(!("subgrid"==f||"cb"==f||"rn"==f)){m=a("td:eq("+c+")",e.rows[g]);if(!0===e.p.colModel[c].editable&&!0===b&&!m.hasClass("not-editable-cell")){0<=parseInt(e.p.iCol,10)&&0<=parseInt(e.p.iRow,10)&&(a("td:eq("+e.p.iCol+")",e.rows[e.p.iRow]).removeClass("edit-cell ui-state-highlight"),a(e.rows[e.p.iRow]).removeClass("selected-row ui-state-hover"));
a(m).addClass("edit-cell ui-state-highlight");a(e.rows[g]).addClass("selected-row ui-state-hover");try{j=a.unformat(m,{rowId:e.rows[g].id,colModel:e.p.colModel[c]},c)}catch(d){j=a(m).html()}e.p.autoencode&&(j=a.jgrid.htmlDecode(j));e.p.colModel[c].edittype||(e.p.colModel[c].edittype="text");e.p.savedRow.push({id:g,ic:c,name:f,v:j});if(a.isFunction(e.p.formatCell)){var l=e.p.formatCell.call(e,e.rows[g].id,f,j,g,c);void 0!==l&&(j=l)}var l=a.extend({},e.p.colModel[c].editoptions||{},{id:g+"_"+f,name:f}),
n=a.jgrid.createEl(e.p.colModel[c].edittype,l,j,!0,a.extend({},a.jgrid.ajaxOptions,e.p.ajaxSelectOptions||{}));a.isFunction(e.p.beforeEditCell)&&e.p.beforeEditCell.call(e,e.rows[g].id,f,j,g,c);a(m).html("").append(n).attr("tabindex","0");window.setTimeout(function(){a(n).focus()},0);a("input, select, textarea",m).bind("keydown",function(b){b.keyCode===27&&(a("input.hasDatepicker",m).length>0?a(".ui-datepicker").is(":hidden")?a(e).jqGrid("restoreCell",g,c):a("input.hasDatepicker",m).datepicker("hide"):
a(e).jqGrid("restoreCell",g,c));b.keyCode===13&&a(e).jqGrid("saveCell",g,c);if(b.keyCode==9){if(e.grid.hDiv.loading)return false;b.shiftKey?a(e).jqGrid("prevCell",g,c):a(e).jqGrid("nextCell",g,c)}b.stopPropagation()});a.isFunction(e.p.afterEditCell)&&e.p.afterEditCell.call(e,e.rows[g].id,f,j,g,c)}else if(0<=parseInt(e.p.iCol,10)&&0<=parseInt(e.p.iRow,10)&&(a("td:eq("+e.p.iCol+")",e.rows[e.p.iRow]).removeClass("edit-cell ui-state-highlight"),a(e.rows[e.p.iRow]).removeClass("selected-row ui-state-hover")),
m.addClass("edit-cell ui-state-highlight"),a(e.rows[g]).addClass("selected-row ui-state-hover"),a.isFunction(e.p.onSelectCell))j=m.html().replace(/\&#160\;/ig,""),e.p.onSelectCell.call(e,e.rows[g].id,f,j,g,c);e.p.iCol=c;e.p.iRow=g}}})},saveCell:function(g,c){return this.each(function(){var b=this,e;if(b.grid&&!0===b.p.cellEdit){e=1<=b.p.savedRow.length?0:null;if(null!==e){var f=a("td:eq("+c+")",b.rows[g]),j,m,d=b.p.colModel[c],p=d.name,n=a.jgrid.jqID(p);switch(d.edittype){case "select":if(d.editoptions.multiple){var n=
a("#"+g+"_"+n,b.rows[g]),s=[];(j=a(n).val())?j.join(","):j="";a("option:selected",n).each(function(b,c){s[b]=a(c).text()});m=s.join(",")}else j=a("#"+g+"_"+n+">option:selected",b.rows[g]).val(),m=a("#"+g+"_"+n+">option:selected",b.rows[g]).text();d.formatter&&(m=j);break;case "checkbox":var o=["Yes","No"];d.editoptions&&(o=d.editoptions.value.split(":"));m=j=a("#"+g+"_"+n,b.rows[g]).attr("checked")?o[0]:o[1];break;case "password":case "text":case "textarea":case "button":m=j=a("#"+g+"_"+n,b.rows[g]).val();
break;case "custom":try{if(d.editoptions&&a.isFunction(d.editoptions.custom_value)){j=d.editoptions.custom_value.call(b,a(".customelement",f),"get");if(void 0===j)throw"e2";m=j}else throw"e1";}catch(q){"e1"==q&&a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,l.jgrid.edit.bClose),"e2"==q?a.jgrid.info_dialog(l.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,l.jgrid.edit.bClose):a.jgrid.info_dialog(l.jgrid.errors.errcap,q.message,
l.jgrid.edit.bClose)}}if(m!=b.p.savedRow[e].v){if(a.isFunction(b.p.beforeSaveCell)&&(e=b.p.beforeSaveCell.call(b,b.rows[g].id,p,j,g,c)))m=j=e;var r=a.jgrid.checkValues(j,c,b);if(!0===r[0]){e={};a.isFunction(b.p.beforeSubmitCell)&&((e=b.p.beforeSubmitCell.call(b,b.rows[g].id,p,j,g,c))||(e={}));0<a("input.hasDatepicker",f).length&&a("input.hasDatepicker",f).datepicker("hide");if("remote"==b.p.cellsubmit)if(b.p.cellurl){var u={};b.p.autoencode&&(j=a.jgrid.htmlEncode(j));u[p]=j;o=b.p.prmNames;d=o.id;
n=o.oper;u[d]=b.rows[g].id;u[n]=o.editoper;u=a.extend(e,u);a("#lui_"+b.p.id).show();b.grid.hDiv.loading=!0;a.ajax(a.extend({url:b.p.cellurl,data:a.isFunction(b.p.serializeCellData)?b.p.serializeCellData.call(b,u):u,type:"POST",complete:function(d,e){a("#lui_"+b.p.id).hide();b.grid.hDiv.loading=!1;if("success"==e)if(a.isFunction(b.p.afterSubmitCell)){var l=b.p.afterSubmitCell.call(b,d,u.id,p,j,g,c);!0===l[0]?(a(f).empty(),a(b).jqGrid("setCell",b.rows[g].id,c,m,!1,!1,!0),a(f).addClass("dirty-cell"),
a(b.rows[g]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[g].id,p,j,g,c),b.p.savedRow.splice(0,1)):(a.jgrid.info_dialog(a.jgrid.errors.errcap,l[1],a.jgrid.edit.bClose),a(b).jqGrid("restoreCell",g,c))}else a(f).empty(),a(b).jqGrid("setCell",b.rows[g].id,c,m,!1,!1,!0),a(f).addClass("dirty-cell"),a(b.rows[g]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[g].id,p,j,g,c),b.p.savedRow.splice(0,1)},error:function(d,e){a("#lui_"+
b.p.id).hide();b.grid.hDiv.loading=!1;a.isFunction(b.p.errorCell)?b.p.errorCell.call(b,d,e):a.jgrid.info_dialog(a.jgrid.errors.errcap,d.status+" : "+d.statusText+"<br/>"+e,a.jgrid.edit.bClose);a(b).jqGrid("restoreCell",g,c)}},a.jgrid.ajaxOptions,b.p.ajaxCellOptions||{}))}else try{a.jgrid.info_dialog(a.jgrid.errors.errcap,a.jgrid.errors.nourl,a.jgrid.edit.bClose),a(b).jqGrid("restoreCell",g,c)}catch(x){}"clientArray"==b.p.cellsubmit&&(a(f).empty(),a(b).jqGrid("setCell",b.rows[g].id,c,m,!1,!1,!0),a(f).addClass("dirty-cell"),
a(b.rows[g]).addClass("edited"),a.isFunction(b.p.afterSaveCell)&&b.p.afterSaveCell.call(b,b.rows[g].id,p,j,g,c),b.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){a.jgrid.info_dialog(a.jgrid.errors.errcap,j+" "+r[1],a.jgrid.edit.bClose)},100),a(b).jqGrid("restoreCell",g,c)}catch(t){}}else a(b).jqGrid("restoreCell",g,c)}a.browser.opera?a("#"+b.p.knv).attr("tabindex","-1").focus():window.setTimeout(function(){a("#"+b.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(g,c){return this.each(function(){var b=
this,e;if(b.grid&&!0===b.p.cellEdit){e=1<=b.p.savedRow.length?0:null;if(null!==e){var f=a("td:eq("+c+")",b.rows[g]);if(a.isFunction(a.fn.datepicker))try{a("input.hasDatepicker",f).datepicker("hide")}catch(j){}a(f).empty().attr("tabindex","-1");a(b).jqGrid("setCell",b.rows[g].id,c,b.p.savedRow[e].v,!1,!1,!0);a.isFunction(b.p.afterRestoreCell)&&b.p.afterRestoreCell.call(b,b.rows[g].id,b.p.savedRow[e].v,g,c);b.p.savedRow.splice(0,1)}window.setTimeout(function(){a("#"+b.p.knv).attr("tabindex","-1").focus()},
0)}})},nextCell:function(g,c){return this.each(function(){var b=!1;if(this.grid&&!0===this.p.cellEdit){for(var e=c+1;e<this.p.colModel.length;e++)if(!0===this.p.colModel[e].editable){b=e;break}!1!==b?a(this).jqGrid("editCell",g,b,!0):0<this.p.savedRow.length&&a(this).jqGrid("saveCell",g,c)}})},prevCell:function(g,c){return this.each(function(){var b=!1;if(this.grid&&!0===this.p.cellEdit){for(var e=c-1;0<=e;e--)if(!0===this.p.colModel[e].editable){b=e;break}!1!==b?a(this).jqGrid("editCell",g,b,!0):
0<this.p.savedRow.length&&a(this).jqGrid("saveCell",g,c)}})},GridNav:function(){return this.each(function(){function g(c,d,e){if("v"==e.substr(0,1)){var g=a(b.grid.bDiv)[0].clientHeight,f=a(b.grid.bDiv)[0].scrollTop,j=b.rows[c].offsetTop+b.rows[c].clientHeight,k=b.rows[c].offsetTop;"vd"==e&&j>=g&&(a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop+b.rows[c].clientHeight);"vu"==e&&k<f&&(a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop-b.rows[c].clientHeight)}"h"==e&&(e=a(b.grid.bDiv)[0].clientWidth,
g=a(b.grid.bDiv)[0].scrollLeft,f=b.rows[c].cells[d].offsetLeft,b.rows[c].cells[d].offsetLeft+b.rows[c].cells[d].clientWidth>=e+parseInt(g,10)?a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft+b.rows[c].cells[d].clientWidth:f<g&&(a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft-b.rows[c].cells[d].clientWidth))}function c(a,c){var e,g;if("lft"==c){e=a+1;for(g=a;0<=g;g--)if(!0!==b.p.colModel[g].hidden){e=g;break}}if("rgt"==c){e=a-1;for(g=a;g<b.p.colModel.length;g++)if(!0!==b.p.colModel[g].hidden){e=
g;break}}return e}var b=this;if(b.grid&&!0===b.p.cellEdit){b.p.knv=b.p.id+"_kn";var e=a("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+b.p.knv+"'></span></span>"),f,j;a(e).insertBefore(b.grid.cDiv);a("#"+b.p.knv).focus().keydown(function(e){j=e.keyCode;"rtl"==b.p.direction&&(37==j?j=39:39==j&&(j=37));switch(j){case 38:0<b.p.iRow-1&&(g(b.p.iRow-1,b.p.iCol,"vu"),a(b).jqGrid("editCell",b.p.iRow-1,b.p.iCol,
!1));break;case 40:b.p.iRow+1<=b.rows.length-1&&(g(b.p.iRow+1,b.p.iCol,"vd"),a(b).jqGrid("editCell",b.p.iRow+1,b.p.iCol,!1));break;case 37:0<=b.p.iCol-1&&(f=c(b.p.iCol-1,"lft"),g(b.p.iRow,f,"h"),a(b).jqGrid("editCell",b.p.iRow,f,!1));break;case 39:b.p.iCol+1<=b.p.colModel.length-1&&(f=c(b.p.iCol+1,"rgt"),g(b.p.iRow,f,"h"),a(b).jqGrid("editCell",b.p.iRow,f,!1));break;case 13:0<=parseInt(b.p.iCol,10)&&0<=parseInt(b.p.iRow,10)&&a(b).jqGrid("editCell",b.p.iRow,b.p.iCol,!0)}return!1})}})},getChangedCells:function(g){var c=
[];g||(g="all");this.each(function(){var b=this,e;!b.grid||!0!==b.p.cellEdit||a(b.rows).each(function(f){var j={};a(this).hasClass("edited")&&(a("td",this).each(function(c){e=b.p.colModel[c].name;if("cb"!==e&&"subgrid"!==e)if("dirty"==g){if(a(this).hasClass("dirty-cell"))try{j[e]=a.unformat(this,{rowId:b.rows[f].id,colModel:b.p.colModel[c]},c)}catch(d){j[e]=a.jgrid.htmlDecode(a(this).html())}}else try{j[e]=a.unformat(this,{rowId:b.rows[f].id,colModel:b.p.colModel[c]},c)}catch(l){j[e]=a.jgrid.htmlDecode(a(this).html())}}),
j.id=this.id,c.push(j))})});return c}})})(l);(function(a){a.fn.jqm=function(b){var d={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:f,ajaxText:"",target:f,modal:f,toTop:f,onShow:f,onHide:f,onLoad:f};return this.each(function(){if(this._jqm)return c[this._jqm].c=a.extend({},c[this._jqm].c,b);g++;this._jqm=g;c[g]={c:a.extend(d,a.jqm.params,b),a:f,w:a(this).addClass("jqmID"+g),s:g};d.trigger&&a(this).jqmAddTrigger(d.trigger)})};a.fn.jqmAddClose=function(a){return n(this,
a,"jqmHide")};a.fn.jqmAddTrigger=function(a){return n(this,a,"jqmShow")};a.fn.jqmShow=function(b){return this.each(function(){a.jqm.open(this._jqm,b)})};a.fn.jqmHide=function(b){return this.each(function(){a.jqm.close(this._jqm,b)})};a.jqm={hash:{},open:function(g,m){var l=c[g],n=l.c,p="."+n.closeClass,x=parseInt(l.w.css("z-index")),x=0<x?x:3E3,t=a("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":x-1,opacity:n.overlay/100});if(l.a)return f;l.t=m;l.a=!0;l.w.css("z-index",
x);n.modal?(b[0]||setTimeout(function(){d("bind")},1),b.push(g)):0<n.overlay?n.closeoverlay&&l.w.jqmAddClose(t):t=f;l.o=t?t.addClass(n.overlayClass).prependTo("body"):f;if(e&&(a("html,body").css({height:"100%",width:"100%"}),t)){var t=t.css({position:"absolute"})[0],v;for(v in{Top:1,Left:1})t.style.setExpression(v.toLowerCase(),"(_=(document.documentElement.scroll"+v+" || document.body.scroll"+v+"))+'px'")}n.ajax?(x=n.target||l.w,t=n.ajax,x="string"==typeof x?a(x,l.w):a(x),t="@"==t.substr(0,1)?a(m).attr(t.substring(1)):
t,x.html(n.ajaxText).load(t,function(){n.onLoad&&n.onLoad.call(this,l);p&&l.w.jqmAddClose(a(p,l.w));j(l)})):p&&l.w.jqmAddClose(a(p,l.w));n.toTop&&l.o&&l.w.before('<span id="jqmP'+l.w[0]._jqm+'"></span>').insertAfter(l.o);n.onShow?n.onShow(l):l.w.show();j(l);return f},close:function(e){e=c[e];if(!e.a)return f;e.a=f;b[0]&&(b.pop(),b[0]||d("unbind"));e.c.toTop&&e.o&&a("#jqmP"+e.w[0]._jqm).after(e.w).remove();if(e.c.onHide)e.c.onHide(e);else e.w.hide(),e.o&&e.o.remove();return f},params:{}};var g=0,c=
a.jqm.hash,b=[],e=a.browser.msie&&"6.0"==a.browser.version,f=!1,j=function(b){var c=a('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});e&&(b.o?b.o.html('<p style="width:100%;height:100%"/>').prepend(c):a("iframe.jqm",b.w)[0]||b.w.prepend(c));m(b)},m=function(b){try{a(":input:visible",b.w)[0].focus()}catch(c){}},d=function(b){a(document)[b]("keypress",l)[b]("keydown",l)[b]("mousedown",l)},l=function(d){var e=c[b[b.length-1]];(d=!a(d.target).parents(".jqmID"+
e.s)[0])&&m(e);return!d},n=function(b,d,e){return b.each(function(){var b=this._jqm;a(d).each(function(){this[e]||(this[e]=[],a(this).click(function(){for(var a in{jqmShow:1,jqmHide:1})for(var b in this[a])if(c[this[a][b]])c[this[a][b]].w[a](this);return f}));this[e].push(b)})})}})(l);(function(a){a.fn.jqDrag=function(a){return f(this,a,"d")};a.fn.jqResize=function(a,b){return f(this,a,"r",b)};a.jqDnR={dnr:{},e:0,drag:function(a){"d"==c.k?b.css({left:c.X+a.pageX-c.pX,top:c.Y+a.pageY-c.pY}):(b.css({width:Math.max(a.pageX-
c.pX+c.W,0),height:Math.max(a.pageY-c.pY+c.H,0)}),M1&&e.css({width:Math.max(a.pageX-M1.pX+M1.W,0),height:Math.max(a.pageY-M1.pY+M1.H,0)}));return!1},stop:function(){a(document).unbind("mousemove",g.drag).unbind("mouseup",g.stop)}};var g=a.jqDnR,c=g.dnr,b=g.e,e,f=function(g,d,f,k){return g.each(function(){d=d?a(d,g):g;d.bind("mousedown",{e:g,k:f},function(d){var g=d.data,f={};b=g.e;e=k?a(k):!1;if("relative"!=b.css("position"))try{b.position(f)}catch(m){}c={X:f.left||j("left")||0,Y:f.top||j("top")||
0,W:j("width")||b[0].scrollWidth||0,H:j("height")||b[0].scrollHeight||0,pX:d.pageX,pY:d.pageY,k:g.k};M1=e&&"d"!=g.k?{X:f.left||f1("left")||0,Y:f.top||f1("top")||0,W:e[0].offsetWidth||f1("width")||0,H:e[0].offsetHeight||f1("height")||0,pX:d.pageX,pY:d.pageY,k:g.k}:!1;if(a("input.hasDatepicker",b[0])[0])try{a("input.hasDatepicker",b[0]).datepicker("hide")}catch(l){}a(document).mousemove(a.jqDnR.drag).mouseup(a.jqDnR.stop);return!1})})},j=function(a){return parseInt(b.css(a))||!1};f1=function(a){return parseInt(e.css(a))||
!1}})(l);(function(a){a.jgrid.extend({setSubGrid:function(){return this.each(function(){var g;this.p.subGridOptions=a.extend({plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,reloadOnExpand:!0},this.p.subGridOptions||{});this.p.colNames.unshift("");this.p.colModel.unshift({name:"subgrid",width:a.browser.safari?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0});
g=this.p.subGridModel;if(g[0]){g[0].align=a.extend([],g[0].align||[]);for(var c=0;c<g[0].name.length;c++)g[0].align[c]=g[0].align[c]||"left"}})},addSubGridCell:function(a,c){var b="",e,f;this.each(function(){b=this.formatCol(a,c);f=this.p.id;e=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+f+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+b+"><a href='javascript:void(0);'><span class='ui-icon "+e+"'></span></a></td>"},addSubGrid:function(g){return this.each(function(){var c=
this;if(c.grid){var b=function(b,d,e){d=a("<td align='"+c.p.subGridModel[0].align[e]+"'></td>").html(d);a(b).append(d)},e=function(d,e){var g,f,j,k=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),m=a("<tr></tr>");for(f=0;f<c.p.subGridModel[0].name.length;f++)g=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+c.p.direction+"'></th>"),a(g).html(c.p.subGridModel[0].name[f]),a(g).width(c.p.subGridModel[0].width[f]),a(m).append(g);a(k).append(m);d&&(j=c.p.xmlReader.subgrid,
a(j.root+" "+j.row,d).each(function(){m=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===j.repeatitems)a(j.cell,this).each(function(c){b(m,a(this).text()||"&#160;",c)});else{var d=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;if(d)for(f=0;f<d.length;f++)b(m,a(d[f],this).text()||"&#160;",f)}a(k).append(m)}));g=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+g+e).append(k);c.grid.hDiv.loading=!1;a("#load_"+c.p.id).hide();return!1},f=function(d,e){var g,f,j,k,m,l=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),
n=a("<tr></tr>");for(f=0;f<c.p.subGridModel[0].name.length;f++)g=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+c.p.direction+"'></th>"),a(g).html(c.p.subGridModel[0].name[f]),a(g).width(c.p.subGridModel[0].width[f]),a(n).append(g);a(l).append(n);if(d&&(k=c.p.jsonReader.subgrid,g=d[k.root],"undefined"!==typeof g))for(f=0;f<g.length;f++){j=g[f];n=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===k.repeatitems){k.cell&&(j=j[k.cell]);for(m=0;m<j.length;m++)b(n,j[m]||"&#160;",
m)}else{var o=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;if(o.length)for(m=0;m<o.length;m++)b(n,j[o[m]]||"&#160;",m)}a(l).append(n)}f=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+f+e).append(l);c.grid.hDiv.loading=!1;a("#load_"+c.p.id).hide();return!1},j=function(b){var d,g,j,m;d=a(b).attr("id");g={nd_:(new Date).getTime()};g[c.p.prmNames.subgridid]=d;if(!c.p.subGridModel[0])return!1;if(c.p.subGridModel[0].params)for(m=0;m<c.p.subGridModel[0].params.length;m++)for(j=0;j<c.p.colModel.length;j++)c.p.colModel[j].name==
c.p.subGridModel[0].params[m]&&(g[c.p.colModel[j].name]=a("td:eq("+j+")",b).text().replace(/\&#160\;/ig,""));if(!c.grid.hDiv.loading)switch(c.grid.hDiv.loading=!0,a("#load_"+c.p.id).show(),c.p.subgridtype||(c.p.subgridtype=c.p.datatype),a.isFunction(c.p.subgridtype)?c.p.subgridtype.call(c,g):c.p.subgridtype=c.p.subgridtype.toLowerCase(),c.p.subgridtype){case "xml":case "json":a.ajax(a.extend({type:c.p.mtype,url:c.p.subGridUrl,dataType:c.p.subgridtype,data:a.isFunction(c.p.serializeSubGridData)?c.p.serializeSubGridData.call(c,
g):g,complete:function(b){c.p.subgridtype=="xml"?e(b.responseXML,d):f(a.jgrid.parse(b.responseText),d)}},a.jgrid.ajaxOptions,c.p.ajaxSubgridOptions||{}))}return!1},m,d,l,n=0,s,o;a.each(c.p.colModel,function(){(!0===this.hidden||"rn"==this.name||"cb"==this.name)&&n++});a(c.rows).each(function(b){var e=this;a(e).hasClass("jqgrow")&&(a(this.cells[g]).bind("click",function(){o=e.nextSibling;if(a(this).hasClass("sgcollapsed")){d=c.p.id;m=e.id;if(!0===c.p.subGridOptions.reloadOnExpand||!1===c.p.subGridOptions.reloadOnExpand&&
!a(o).hasClass("ui-subgrid")){l=1<=g?"<td colspan='"+g+"'>&#160;</td>":"";s=!0;a.isFunction(c.p.subGridBeforeExpand)&&(s=c.p.subGridBeforeExpand.call(c,d+"_"+m,m));if(!1===s)return!1;a(e).after("<tr role='row' class='ui-subgrid'>"+l+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+c.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(c.p.colNames.length-1-n,10)+"' class='ui-widget-content subgrid-data'><div id="+d+"_"+m+" class='tablediv'></div></td></tr>");a.isFunction(c.p.subGridRowExpanded)?
c.p.subGridRowExpanded.call(c,d+"_"+m,m):j(e)}else a(o).show();a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+c.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");c.p.subGridOptions.selectOnExpand&&a(c).jqGrid("setSelection",m)}else if(a(this).hasClass("sgexpanded")){s=!0;a.isFunction(c.p.subGridRowColapsed)&&(m=e.id,s=c.p.subGridRowColapsed.call(c,d+"_"+m,m));if(!1===s)return!1;!0===c.p.subGridOptions.reloadOnExpand?a(o).remove(".ui-subgrid"):
a(o).hasClass("ui-subgrid")&&a(o).hide();a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+c.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return!1}),!0===c.p.subGridOptions.expandOnLoad&&setTimeout(function(){a(e.cells[g]).trigger("click")},b*c.p.subGridOptions.delayOnLoad))});c.subGridXml=function(a,b){e(a,b)};c.subGridJson=function(a,b){f(a,b)}}})},expandSubGridRow:function(g){return this.each(function(){if((this.grid||g)&&!0===this.p.subGrid){var c=
a(this).jqGrid("getInd",g,!0);c&&(c=a("td.sgcollapsed",c)[0])&&a(c).trigger("click")}})},collapseSubGridRow:function(g){return this.each(function(){if((this.grid||g)&&!0===this.p.subGrid){var c=a(this).jqGrid("getInd",g,!0);c&&(c=a("td.sgexpanded",c)[0])&&a(c).trigger("click")}})},toggleSubGridRow:function(g){return this.each(function(){if((this.grid||g)&&!0===this.p.subGrid){var c=a(this).jqGrid("getInd",g,!0);if(c){var b=a("td.sgcollapsed",c)[0];b?a(b).trigger("click"):(b=a("td.sgexpanded",c)[0])&&
a(b).trigger("click")}}})}})})(l);(function(a){a.jgrid.extend({groupingSetup:function(){return this.each(function(){var g=this.p.groupingView;if(null!==g&&("object"===typeof g||a.isFunction(g)))if(g.groupField.length){"undefined"==typeof g.visibiltyOnNextGrouping&&(g.visibiltyOnNextGrouping=[]);for(var c=0;c<g.groupField.length;c++)if(g.groupOrder[c]||(g.groupOrder[c]="asc"),g.groupText[c]||(g.groupText[c]="{0}"),"boolean"!=typeof g.groupColumnShow[c]&&(g.groupColumnShow[c]=!0),"boolean"!=typeof g.groupSummary[c]&&
(g.groupSummary[c]=!1),!0===g.groupColumnShow[c]?(g.visibiltyOnNextGrouping[c]=!0,a(this).jqGrid("showCol",g.groupField[c])):(g.visibiltyOnNextGrouping[c]=a("#"+this.p.id+"_"+g.groupField[c]).is(":visible"),a(this).jqGrid("hideCol",g.groupField[c])),g.sortitems[c]=[],g.sortnames[c]=[],g.summaryval[c]=[],g.groupSummary[c]){g.summary[c]=[];for(var b=this.p.colModel,e=0,f=b.length;e<f;e++)b[e].summaryType&&g.summary[c].push({nm:b[e].name,st:b[e].summaryType,v:""})}this.p.scroll=!1;this.p.rownumbers=
!1;this.p.subGrid=!1;this.p.treeGrid=!1;this.p.gridview=!0}else this.p.grouping=!1;else this.p.grouping=!1})},groupingPrepare:function(g,c,b,e){this.each(function(){c[0]+="";var f=c[0].toString().split(" ").join(""),j=this.p.groupingView,m=this;b.hasOwnProperty(f)?b[f].push(g):(b[f]=[],b[f].push(g),j.sortitems[0].push(f),j.sortnames[0].push(a.trim(c[0].toString())),j.summaryval[0][f]=a.extend(!0,[],j.summary[0]));j.groupSummary[0]&&a.each(j.summaryval[0][f],function(){this.v=a.isFunction(this.st)?
this.st.call(m,this.v,this.nm,e):a(m).jqGrid("groupingCalculations."+this.st,this.v,this.nm,e)})});return b},groupingToggle:function(g){this.each(function(){var c=this.p.groupingView,b=g.lastIndexOf("_"),e=g.substring(0,b+1),b=parseInt(g.substring(b+1),10)+1,f=c.minusicon,j=c.plusicon,m=a("#"+g)[0].nextSibling,d=a("#"+g+" span.tree-wrap-"+this.p.direction),l=!1;if(d.hasClass(f)){if(c.showSummaryOnHide&&c.groupSummary[0]){if(m)for(;m&&!a(m).hasClass("jqfoot");)a(m).hide(),m=m.nextSibling}else if(m)for(;m&&
a(m).attr("id")!=e+(""+b);)a(m).hide(),m=m.nextSibling;d.removeClass(f).addClass(j);l=!0}else{if(m)for(;m&&a(m).attr("id")!=e+(""+b);)a(m).show(),m=m.nextSibling;d.removeClass(j).addClass(f);l=!1}a.isFunction(this.p.onClickGroup)&&this.p.onClickGroup.call(this,g,l)});return!1},groupingRender:function(g,c){return this.each(function(){var b=this,e=b.p.groupingView,f="",j="",m,d="",l,n,s;e.groupDataSorted||(e.sortitems[0].sort(),e.sortnames[0].sort(),"desc"==e.groupOrder[0].toLowerCase()&&(e.sortitems[0].reverse(),
e.sortnames[0].reverse()));d=e.groupCollapse?e.plusicon:e.minusicon;d+=" tree-wrap-"+b.p.direction;for(s=0;s<c;){if(b.p.colModel[s].name==e.groupField[0]){n=s;break}s++}a.each(e.sortitems[0],function(o,s){m=b.p.id+"ghead_"+o;j="<span style='cursor:pointer;' class='ui-icon "+d+"' onclick=\"jQuery('#"+b.p.id+"').jqGrid('groupingToggle','"+m+"');return false;\"></span>";try{l=b.formatter(m,e.sortnames[0][o],n,e.sortitems[0])}catch(r){l=e.sortnames[0][o]}f=f+('<tr id="'+m+'" role="row" class= "ui-widget-content jqgroup ui-row-'+
b.p.direction+'"><td colspan="'+c+'">'+j+a.jgrid.format(e.groupText[0],l,g[s].length)+"</td></tr>");for(var u=0;u<g[s].length;u++)f=f+g[s][u].join("");if(e.groupSummary[0]){u="";e.groupCollapse&&!e.showSummaryOnHide&&(u=' style="display:none;"');f=f+("<tr"+u+' role="row" class="ui-widget-content jqfoot ui-row-'+b.p.direction+'">');for(var u=e.summaryval[0][s],x=b.p.colModel,t,v=g[s].length,B=0;B<c;B++){var C="<td "+b.formatCol(B,1,"")+">&#160;</td>",z="{0}";a.each(u,function(){if(this.nm==x[B].name){if(x[B].summaryTpl)z=
x[B].summaryTpl;if(this.st=="avg"&&this.v&&v>0)this.v=this.v/v;try{t=b.formatter("",this.v,B,this)}catch(c){t=this.v}C="<td "+b.formatCol(B,1,"")+">"+a.jgrid.format(z,t)+"</td>";return false}});f=f+C}f=f+"</tr>"}});a("#"+b.p.id+" tbody:first").append(f);f=null})},groupingGroupBy:function(g,c){return this.each(function(){"string"==typeof g&&(g=[g]);var b=this.p.groupingView;this.p.grouping=!0;for(var e=0;e<b.groupField.length;e++)!b.groupColumnShow[e]&&b.visibiltyOnNextGrouping[e]&&a(this).jqGrid("showCol",
b.groupField[e]);for(e=0;e<g.length;e++)b.visibiltyOnNextGrouping[e]=a("#"+this.p.id+"_"+g[e]).is(":visible");this.p.groupingView=a.extend(this.p.groupingView,c||{});b.groupField=g;a(this).trigger("reloadGrid")})},groupingRemove:function(g){return this.each(function(){"undefined"==typeof g&&(g=!0);this.p.grouping=!1;if(!0===g){for(var c=this.p.groupingView,b=0;b<c.groupField.length;b++)!c.groupColumnShow[b]&&c.visibiltyOnNextGrouping[b]&&a(this).jqGrid("showCol",c.groupField);a("tr.jqgroup, tr.jqfoot",
"#"+this.p.id+" tbody:first").remove();a("tr.jqgrow:hidden","#"+this.p.id+" tbody:first").show()}else a(this).trigger("reloadGrid")})},groupingCalculations:{sum:function(a,c,b){return parseFloat(a||0)+parseFloat(b[c]||0)},min:function(a,c,b){return""===a?parseFloat(b[c]||0):Math.min(parseFloat(a),parseFloat(b[c]||0))},max:function(a,c,b){return""===a?parseFloat(b[c]||0):Math.max(parseFloat(a),parseFloat(b[c]||0))},count:function(a,c,b){""===a&&(a=0);return b.hasOwnProperty(c)?a+1:0},avg:function(a,
c,b){return parseFloat(a||0)+parseFloat(b[c]||0)}}})})(l);(function(a){a.jgrid.extend({setTreeNode:function(g,c){return this.each(function(){var b=this;if(b.grid&&b.p.treeGrid)for(var e=b.p.expColInd,f=b.p.treeReader.expanded_field,j=b.p.treeReader.leaf_field,m=b.p.treeReader.level_field,d=b.p.treeReader.icon_field,l=b.p.treeReader.loaded,n,s,o,q;g<c;)q=b.p.data[b.p._index[b.rows[g].id]],"nested"==b.p.treeGridModel&&!q[j]&&(n=parseInt(q[b.p.treeReader.left_field],10),s=parseInt(q[b.p.treeReader.right_field],
10),q[j]=s===n+1?"true":"false",b.rows[g].cells[b.p._treeleafpos].innerHTML=q[j]),n=parseInt(q[m],10),0===b.p.tree_root_level?(o=n+1,s=n):(o=n,s=n-1),o="<div class='tree-wrap tree-wrap-"+b.p.direction+"' style='width:"+18*o+"px;'>",o+="<div style='"+("rtl"==b.p.direction?"right:":"left:")+18*s+"px;' class='ui-icon ",void 0!==q[l]&&(q[l]="true"==q[l]||!0===q[l]?!0:!1),"true"==q[j]||!0===q[j]?(o+=(void 0!==q[d]&&""!==q[d]?q[d]:b.p.treeIcons.leaf)+" tree-leaf treeclick'",q[j]=!0,s="leaf"):(q[j]=!1,s=
""),q[f]=("true"==q[f]||!0===q[f]?!0:!1)&&q[l],o+=!0===q[f]?b.p.treeIcons.minus+" tree-minus treeclick'":b.p.treeIcons.plus+" tree-plus treeclick'",o+="</div></div>",a(b.rows[g].cells[e]).wrapInner("<span class='cell-wrapper"+s+"'></span>").prepend(o),n!==parseInt(b.p.tree_root_level,10)&&((q=(q=a(b).jqGrid("getNodeParent",q))&&q.hasOwnProperty(f)?q[f]:!0)||a(b.rows[g]).css("display","none")),a(b.rows[g].cells[e]).find("div.treeclick").bind("click",function(c){c=a(c.target||c.srcElement,b.rows).closest("tr.jqgrow")[0].id;
c=b.p._index[c];if(!b.p.data[c][j])if(b.p.data[c][f]){a(b).jqGrid("collapseRow",b.p.data[c]);a(b).jqGrid("collapseNode",b.p.data[c])}else{a(b).jqGrid("expandRow",b.p.data[c]);a(b).jqGrid("expandNode",b.p.data[c])}return false}),!0===b.p.ExpandColClick&&a(b.rows[g].cells[e]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(c){var c=a(c.target||c.srcElement,b.rows).closest("tr.jqgrow")[0].id,d=b.p._index[c];if(!b.p.data[d][j])if(b.p.data[d][f]){a(b).jqGrid("collapseRow",b.p.data[d]);
a(b).jqGrid("collapseNode",b.p.data[d])}else{a(b).jqGrid("expandRow",b.p.data[d]);a(b).jqGrid("expandNode",b.p.data[d])}a(b).jqGrid("setSelection",c);return false}),g++})},setTreeGrid:function(){return this.each(function(){var g=this,c=0,b=!1,e,f,j=[];if(g.p.treeGrid){g.p.treedatatype||a.extend(g.p,{treedatatype:g.p.datatype});g.p.subGrid=!1;g.p.altRows=!1;g.p.pgbuttons=!1;g.p.pginput=!1;g.p.gridview=!0;g.p.multiselect=!1;g.p.rowList=[];g.p.expColInd=0;g.p.treeIcons=a.extend({plus:"ui-icon-triangle-1-"+
("rtl"==g.p.direction?"w":"e"),minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},g.p.treeIcons||{});"nested"==g.p.treeGridModel?g.p.treeReader=a.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},g.p.treeReader):"adjacency"==g.p.treeGridModel&&(g.p.treeReader=a.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},g.p.treeReader));
for(f in g.p.colModel)if(g.p.colModel.hasOwnProperty(f)){e=g.p.colModel[f].name;e==g.p.ExpandColumn&&!b&&(b=!0,g.p.expColInd=c);c++;for(var m in g.p.treeReader)g.p.treeReader[m]==e&&j.push(e)}a.each(g.p.treeReader,function(b,e){if(e&&a.inArray(e,j)===-1){if(b==="leaf_field")g.p._treeleafpos=c;c++;g.p.colNames.push(e);g.p.colModel.push({name:e,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})}})},expandRow:function(g){this.each(function(){var c=this;if(c.grid&&
c.p.treeGrid){var b=a(c).jqGrid("getNodeChildren",g),e=c.p.treeReader.expanded_field;a(b).each(function(){var b=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+b,c.grid.bDiv).css("display","");this[e]&&a(c).jqGrid("expandRow",this)})}})},collapseRow:function(g){this.each(function(){var c=this;if(c.grid&&c.p.treeGrid){var b=a(c).jqGrid("getNodeChildren",g),e=c.p.treeReader.expanded_field;a(b).each(function(){var b=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+b,c.grid.bDiv).css("display","none");
this[e]&&a(c).jqGrid("collapseRow",this)})}})},getRootNodes:function(){var g=[];this.each(function(){var c=this;if(c.grid&&c.p.treeGrid)switch(c.p.treeGridModel){case "nested":var b=c.p.treeReader.level_field;a(c.p.data).each(function(){parseInt(this[b],10)===parseInt(c.p.tree_root_level,10)&&g.push(this)});break;case "adjacency":var e=c.p.treeReader.parent_id_field;a(c.p.data).each(function(){(null===this[e]||"null"==(""+this[e]).toLowerCase())&&g.push(this)})}});return g},getNodeDepth:function(g){var c=
null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":c=parseInt(g[this.p.treeReader.level_field],10)-parseInt(this.p.tree_root_level,10);break;case "adjacency":c=a(this).jqGrid("getNodeAncestors",g).length}});return c},getNodeParent:function(g){var c=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var b=this.p.treeReader.left_field,e=this.p.treeReader.right_field,f=this.p.treeReader.level_field,j=parseInt(g[b],
10),m=parseInt(g[e],10),d=parseInt(g[f],10);a(this.p.data).each(function(){if(parseInt(this[f],10)===d-1&&parseInt(this[b],10)<j&&parseInt(this[e],10)>m)return c=this,!1});break;case "adjacency":var l=this.p.treeReader.parent_id_field,n=this.p.localReader.id;a(this.p.data).each(function(){if(this[n]==g[l])return c=this,!1})}});return c},getNodeChildren:function(g){var c=[];this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var b=this.p.treeReader.left_field,
e=this.p.treeReader.right_field,f=this.p.treeReader.level_field,j=parseInt(g[b],10),m=parseInt(g[e],10),d=parseInt(g[f],10);a(this.p.data).each(function(){parseInt(this[f],10)===d+1&&parseInt(this[b],10)>j&&parseInt(this[e],10)<m&&c.push(this)});break;case "adjacency":var l=this.p.treeReader.parent_id_field,n=this.p.localReader.id;a(this.p.data).each(function(){this[l]==g[n]&&c.push(this)})}});return c},getFullTreeNode:function(f){var c=[];this.each(function(){var b;if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var e=
this.p.treeReader.left_field,k=this.p.treeReader.right_field,j=this.p.treeReader.level_field,m=parseInt(f[e],10),d=parseInt(f[k],10),l=parseInt(f[j],10);a(this.p.data).each(function(){parseInt(this[j],10)>=l&&parseInt(this[e],10)>=m&&parseInt(this[e],10)<=d&&c.push(this)});break;case "adjacency":if(f){c.push(f);var n=this.p.treeReader.parent_id_field,s=this.p.localReader.id;a(this.p.data).each(function(a){b=c.length;for(a=0;a<b;a++)if(c[a][s]==this[n]){c.push(this);break}})}}});return c},getNodeAncestors:function(f){var c=
[];this.each(function(){if(this.grid&&this.p.treeGrid)for(var b=a(this).jqGrid("getNodeParent",f);b;)c.push(b),b=a(this).jqGrid("getNodeParent",b)});return c},isVisibleNode:function(f){var c=!0;this.each(function(){if(this.grid&&this.p.treeGrid){var b=a(this).jqGrid("getNodeAncestors",f),e=this.p.treeReader.expanded_field;a(b).each(function(){c=c&&this[e];if(!c)return!1})}});return c},isNodeLoaded:function(f){var c;this.each(function(){if(this.grid&&this.p.treeGrid){var b=this.p.treeReader.leaf_field;
c=void 0!==f?void 0!==f.loaded?f.loaded:f[b]||0<a(this).jqGrid("getNodeChildren",f).length?!0:!1:!1}});return c},expandNode:function(f){return this.each(function(){if(this.grid&&this.p.treeGrid){var c=this.p.treeReader.expanded_field,b=this.p.treeReader.parent_id_field,e=this.p.treeReader.loaded,k=this.p.treeReader.level_field,j=this.p.treeReader.left_field,m=this.p.treeReader.right_field;if(!f[c]){var d=a.jgrid.getAccessor(f,this.p.localReader.id),l=a("#"+d,this.grid.bDiv)[0],n=this.p._index[d];
a(this).jqGrid("isNodeLoaded",this.p.data[n])?(f[c]=!0,a("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):(f[c]=!0,a("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=l.rowIndex,this.p.datatype=this.p.treedatatype,"nested"==this.p.treeGridModel?a(this).jqGrid("setGridParam",{postData:{nodeid:d,n_left:f[j],n_right:f[m],n_level:f[k]}}):a(this).jqGrid("setGridParam",
{postData:{nodeid:d,parentid:f[b],n_level:f[k]}}),a(this).trigger("reloadGrid"),f[e]=!0,"nested"==this.p.treeGridModel?a(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):a(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(f){return this.each(function(){if(this.grid&&this.p.treeGrid&&f.expanded){f.expanded=!1;var c=a.jgrid.getAccessor(f,this.p.localReader.id),c=a("#"+c,this.grid.bDiv)[0];a("div.treeclick",c).removeClass(this.p.treeIcons.minus+
" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(f,c,b,e){return this.each(function(){if(this.grid&&this.p.treeGrid){var k,j,m,d=[],l=this,n;k=a(this).jqGrid("getRootNodes");k=a.jgrid.from(k);k.orderBy(f,c,b,e);n=k.select();k=0;for(j=n.length;k<j;k++)m=n[k],d.push(m),a(this).jqGrid("collectChildrenSortTree",d,m,f,c,b,e);a.each(d,function(b){var c=a.jgrid.getAccessor(this,l.p.localReader.id);a("#"+l.p.id+" tbody tr:eq("+b+")").after(a("tr#"+c,l.grid.bDiv))});d=n=k=
null}})},collectChildrenSortTree:function(f,c,b,e,k,j){return this.each(function(){if(this.grid&&this.p.treeGrid){var m,d,l,n;m=a(this).jqGrid("getNodeChildren",c);m=a.jgrid.from(m);m.orderBy(b,e,k,j);n=m.select();m=0;for(d=n.length;m<d;m++)l=n[m],f.push(l),a(this).jqGrid("collectChildrenSortTree",f,l,b,e,k,j)}})},setTreeRow:function(f,c){var b=!1;this.each(function(){this.grid&&this.p.treeGrid&&(b=a(this).jqGrid("setRowData",f,c))});return b},delTreeNode:function(f){return this.each(function(){var c=
this.p.localReader.id,b=this.p.treeReader.left_field,e=this.p.treeReader.right_field,k,j,m;if(this.grid&&this.p.treeGrid){var d=this.p._index[f];if(void 0!==d){k=parseInt(this.p.data[d][e],10);j=k-parseInt(this.p.data[d][b],10)+1;d=a(this).jqGrid("getFullTreeNode",this.p.data[d]);if(0<d.length)for(var l=0;l<d.length;l++)a(this).jqGrid("delRowData",d[l][c]);if("nested"===this.p.treeGridModel){c=a.jgrid.from(this.p.data).greater(b,k,{stype:"integer"}).select();if(c.length)for(m in c)c[m][b]=parseInt(c[m][b],
10)-j;c=a.jgrid.from(this.p.data).greater(e,k,{stype:"integer"}).select();if(c.length)for(m in c)c[m][e]=parseInt(c[m][e],10)-j}}}})},addChildNode:function(f,c,b){var e=this[0];if(b){var k=e.p.treeReader.expanded_field,j=e.p.treeReader.leaf_field,m=e.p.treeReader.level_field,d=e.p.treeReader.parent_id_field,l=e.p.treeReader.left_field,n=e.p.treeReader.right_field,s=e.p.treeReader.loaded,o,q,r,u,x;o=0;var t=c,v;if(!f){x=e.p.data.length-1;if(0<=x)for(;0<=x;)o=Math.max(o,parseInt(e.p.data[x][e.p.localReader.id],
10)),x--;f=o+1}var B=a(e).jqGrid("getInd",c);v=!1;if(void 0===c||null===c||""===c)t=c=null,o="last",u=e.p.tree_root_level,x=e.p.data.length+1;else if(o="after",q=e.p._index[c],r=e.p.data[q],c=r[e.p.localReader.id],u=parseInt(r[m],10)+1,x=a(e).jqGrid("getFullTreeNode",r),x.length?(t=x[x.length-1][e.p.localReader.id],x=a(e).jqGrid("getInd",t)+1):x=a(e).jqGrid("getInd",c)+1,r[j])v=!0,r[k]=!0,a(e.rows[B]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.p.treeIcons.leaf+
" tree-leaf").addClass(e.p.treeIcons.minus+" tree-minus"),e.p.data[q][j]=!1,r[s]=!0;q=x+1;b[k]=!1;b[s]=!0;b[m]=u;b[j]=!0;"adjacency"===e.p.treeGridModel&&(b[d]=c);if("nested"===e.p.treeGridModel){var C;if(null!==c){j=parseInt(r[n],10);m=a.jgrid.from(e.p.data);m=m.greaterOrEquals(n,j,{stype:"integer"});m=m.select();if(m.length)for(C in m)m[C][l]=m[C][l]>j?parseInt(m[C][l],10)+2:m[C][l],m[C][n]=m[C][n]>=j?parseInt(m[C][n],10)+2:m[C][n];b[l]=j;b[n]=j+1}else{j=parseInt(a(e).jqGrid("getCol",n,!1,"max"),
10);m=a.jgrid.from(e.p.data).greater(l,j,{stype:"integer"}).select();if(m.length)for(C in m)m[C][l]=parseInt(m[C][l],10)+2;m=a.jgrid.from(e.p.data).greater(n,j,{stype:"integer"}).select();if(m.length)for(C in m)m[C][n]=parseInt(m[C][n],10)+2;b[l]=j+1;b[n]=j+2}}if(null===c||a(e).jqGrid("isNodeLoaded",r)||v)a(e).jqGrid("addRowData",f,b,o,t),a(e).jqGrid("setTreeNode",x,q);r&&!r[k]&&a(e.rows[B]).find("div.treeclick").click()}}})})(l);(function(a){a.jgrid.extend({jqGridImport:function(g){g=a.extend({imptype:"xml",
impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},g||{});return this.each(function(){var c=this,b=function(b,e){var d=a(e.xmlGrid.config,b)[0],g=a(e.xmlGrid.data,b)[0],k;if(f.xml2json&&a.jgrid.parse){var d=f.xml2json(d," "),d=a.jgrid.parse(d),l;for(l in d)d.hasOwnProperty(l)&&(k=d[l]);g?(g=d.grid.datatype,d.grid.datatype="xmlstring",d.grid.datastr=b,a(c).jqGrid(k).jqGrid("setGridParam",{datatype:g})):
a(c).jqGrid(k)}else alert("xml2json or parse are not present")},e=function(b,e){if(b&&"string"==typeof b){var d=a.jgrid.parse(b),f=d[e.jsonGrid.config];if(d=d[e.jsonGrid.data]){var g=f.datatype;f.datatype="jsonstring";f.datastr=d;a(c).jqGrid(f).jqGrid("setGridParam",{datatype:g})}else a(c).jqGrid(f)}};switch(g.imptype){case "xml":a.ajax(a.extend({url:g.impurl,type:g.mtype,data:g.impData,dataType:"xml",complete:function(c,e){"success"==e&&(b(c.responseXML,g),a.isFunction(g.importComplete)&&g.importComplete(c))}},
g.ajaxOptions));break;case "xmlstring":if(g.impstring&&"string"==typeof g.impstring){var k=a.jgrid.stringToDoc(g.impstring);k&&(b(k,g),a.isFunction(g.importComplete)&&g.importComplete(k),g.impstring=null);k=null}break;case "json":a.ajax(a.extend({url:g.impurl,type:g.mtype,data:g.impData,dataType:"json",complete:function(b,c){"success"==c&&(e(b.responseText,g),a.isFunction(g.importComplete)&&g.importComplete(b))}},g.ajaxOptions));break;case "jsonstring":g.impstring&&"string"==typeof g.impstring&&(e(g.impstring,
g),a.isFunction(g.importComplete)&&g.importComplete(g.impstring),g.impstring=null)}})},jqGridExport:function(g){var g=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},g||{}),c=null;this.each(function(){if(this.grid){var b=a.extend({},a(this).jqGrid("getGridParam"));b.rownumbers&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.multiselect&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.subGrid&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.knv=null;if(b.treeGrid)for(var e in b.treeReader)b.treeReader.hasOwnProperty(e)&&
(b.colNames.splice(b.colNames.length-1),b.colModel.splice(b.colModel.length-1));switch(g.exptype){case "xmlstring":c="<"+g.root+">"+f.json2xml(b,g.ident)+"</"+g.root+">";break;case "jsonstring":c="{"+f.toJson(b,g.root,g.ident)+"}",void 0!==b.postData.filters&&(c=c.replace(/filters":"/,'filters":'),c=c.replace(/}]}"/,"}]}"))}}});return c},excelExport:function(f){f=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},f||{});return this.each(function(){if(this.grid){var c;"remote"==
f.exptype&&(c=a.extend({},this.p.postData),c[f.oper]=f.tag,c=l.param(c),c=-1!=f.url.indexOf("?")?f.url+"&"+c:f.url+"?"+c,window.location=c)}})}})})(l);var f={xml2json:function(a,f){9===a.nodeType&&(a=a.documentElement);var c=this.toJson(this.toObj(this.removeWhite(a)),a.nodeName,"\t");return"{\n"+f+(f?c.replace(/\t/g,f):c.replace(/\t|\n/g,""))+"\n}"},json2xml:function(a,f){var c=function(a,b,e){var d="",f,g;if(a instanceof Array)if(0===a.length)d+=e+"<"+b+">__EMPTY_ARRAY_</"+b+">\n";else{f=0;for(g=
a.length;f<g;f+=1)var l=e+c(a[f],b,e+"\t")+"\n",d=d+l}else if("object"===typeof a){f=!1;d+=e+"<"+b;for(g in a)a.hasOwnProperty(g)&&("@"===g.charAt(0)?d+=" "+g.substr(1)+'="'+a[g].toString()+'"':f=!0);d+=f?">":"/>";if(f){for(g in a)a.hasOwnProperty(g)&&("#text"===g?d+=a[g]:"#cdata"===g?d+="<![CDATA["+a[g]+"]]\>":"@"!==g.charAt(0)&&(d+=c(a[g],g,e+"\t")));d+=("\n"===d.charAt(d.length-1)?e:"")+"</"+b+">"}}else d+="function"===typeof a?e+"<"+b+"><![CDATA["+a+"]]\></"+b+">":'""'===a.toString()||0===a.toString().length?
e+"<"+b+">__EMPTY_STRING_</"+b+">":e+"<"+b+">"+a.toString()+"</"+b+">";return d},b="",e;for(e in a)a.hasOwnProperty(e)&&(b+=c(a[e],e,""));return f?b.replace(/\t/g,f):b.replace(/\t|\n/g,"")},toObj:function(a){var f={},c=/function/i;if(1===a.nodeType){if(a.attributes.length){var b;for(b=0;b<a.attributes.length;b+=1)f["@"+a.attributes[b].nodeName]=(a.attributes[b].nodeValue||"").toString()}if(a.firstChild){var e=b=0,k=!1,j;for(j=a.firstChild;j;j=j.nextSibling)1===j.nodeType?k=!0:3===j.nodeType&&j.nodeValue.match(/[^ \f\n\r\t\v]/)?
b+=1:4===j.nodeType&&(e+=1);if(k)if(2>b&&2>e){this.removeWhite(a);for(j=a.firstChild;j;j=j.nextSibling)3===j.nodeType?f["#text"]=this.escape(j.nodeValue):4===j.nodeType?c.test(j.nodeValue)?f[j.nodeName]=[f[j.nodeName],j.nodeValue]:f["#cdata"]=this.escape(j.nodeValue):f[j.nodeName]?f[j.nodeName]instanceof Array?f[j.nodeName][f[j.nodeName].length]=this.toObj(j):f[j.nodeName]=[f[j.nodeName],this.toObj(j)]:f[j.nodeName]=this.toObj(j)}else a.attributes.length?f["#text"]=this.escape(this.innerXml(a)):f=
this.escape(this.innerXml(a));else if(b)a.attributes.length?f["#text"]=this.escape(this.innerXml(a)):(f=this.escape(this.innerXml(a)),"__EMPTY_ARRAY_"===f?f="[]":"__EMPTY_STRING_"===f&&(f=""));else if(e)if(1<e)f=this.escape(this.innerXml(a));else for(j=a.firstChild;j;j=j.nextSibling)if(c.test(a.firstChild.nodeValue)){f=a.firstChild.nodeValue;break}else f["#cdata"]=this.escape(j.nodeValue)}!a.attributes.length&&!a.firstChild&&(f=null)}else 9===a.nodeType?f=this.toObj(a.documentElement):alert("unhandled node type: "+
a.nodeType);return f},toJson:function(a,f,c,b){void 0===b&&(b=!0);var e=f?'"'+f+'"':"",k="\t",j="\n";b||(j=k="");if("[]"===a)e+=f?":[]":"[]";else if(a instanceof Array){var m,d,l=[];d=0;for(m=a.length;d<m;d+=1)l[d]=this.toJson(a[d],"",c+k,b);e+=(f?":[":"[")+(1<l.length?j+c+k+l.join(","+j+c+k)+j+c:l.join(""))+"]"}else if(null===a)e+=(f&&":")+"null";else if("object"===typeof a){m=[];for(d in a)a.hasOwnProperty(d)&&(m[m.length]=this.toJson(a[d],d,c+k,b));e+=(f?":{":"{")+(1<m.length?j+c+k+m.join(","+
j+c+k)+j+c:m.join(""))+"}"}else e+="string"===typeof a?(f&&":")+'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"':(f&&":")+'"'+a.toString()+'"';return e},innerXml:function(a){var f="";if("innerHTML"in a)f=a.innerHTML;else for(var c=function(a){var e="",f;if(1===a.nodeType){e+="<"+a.nodeName;for(f=0;f<a.attributes.length;f+=1)e+=" "+a.attributes[f].nodeName+'="'+(a.attributes[f].nodeValue||"").toString()+'"';if(a.firstChild){e+=">";for(f=a.firstChild;f;f=f.nextSibling)e+=c(f);e+="</"+a.nodeName+
">"}else e+="/>"}else 3===a.nodeType?e+=a.nodeValue:4===a.nodeType&&(e+="<![CDATA["+a.nodeValue+"]]\>");return e},a=a.firstChild;a;a=a.nextSibling)f+=c(a);return f},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();var f;for(f=a.firstChild;f;)if(3===f.nodeType)if(f.nodeValue.match(/[^ \f\n\r\t\v]/))f=f.nextSibling;else{var c=f.nextSibling;a.removeChild(f);f=c}else 1===f.nodeType&&this.removeWhite(f),
f=f.nextSibling;return a}};(function(a){a.browser.msie&&8==a.browser.version&&(a.expr[":"].hidden=function(a){return 0===a.offsetWidth||0===a.offsetHeight||"none"==a.style.display});a.jgrid._multiselect=!1;if(a.ui&&a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var f=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(c,b){var e=f.call(this,c,b);if(b&&this.selectedList){var k=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&
a(this).data("optionLink").remove().appendTo(k)})}return e}}a.ui.multiselect.prototype.destroy&&(a.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();a.Widget===void 0?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)});a.jgrid._multiselect=!0}a.jgrid.extend({sortableColumns:function(c){return this.each(function(){function b(){e.p.disableClick=true}var e=this,f={tolerance:"pointer",axis:"x",scrollSensitivity:"1",
items:">th:not(:has(#jqgh_cb,#jqgh_rn,#jqgh_subgrid),:hidden)",placeholder:{element:function(b){return a(document.createElement(b[0].nodeName)).addClass(b[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(a,b){b.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10));b.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||
0,10))}},update:function(b,c){var f=a(c.item).parent(),f=a(">th",f),g={};a.each(e.p.colModel,function(a){g[this.name]=a});var j=[];f.each(function(){var b=a(">div",this).get(0).id.replace(/^jqgh_/,"");b in g&&j.push(g[b])});a(e).jqGrid("remapColumns",j,true,true);a.isFunction(e.p.sortable.update)&&e.p.sortable.update(j);setTimeout(function(){e.p.disableClick=false},50)}};if(e.p.sortable.options)a.extend(f,e.p.sortable.options);else if(a.isFunction(e.p.sortable))e.p.sortable={update:e.p.sortable};
if(f.start){var g=f.start;f.start=function(a,c){b();g.call(this,a,c)}}else f.start=b;if(e.p.sortable.exclude)f.items=f.items+(":not("+e.p.sortable.exclude+")");c.sortable(f).data("sortable").floating=true})},columnChooser:function(c){function b(b,c){b&&(typeof b=="string"?a.fn[b]&&a.fn[b].apply(c,a.makeArray(arguments).slice(2)):a.isFunction(b)&&b.apply(c,a.makeArray(arguments).slice(2)))}var e=this;if(!a("#colchooser_"+e[0].p.id).length){var f=a('<div id="colchooser_'+e[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),
g=a("select",f),c=a.extend({width:420,height:240,classname:null,done:function(a){a&&e.jqGrid("remapColumns",a,true)},msel:"multiselect",dlog:"dialog",dlog_opts:function(a){var b={};b[a.bSubmit]=function(){a.apply_perm();a.cleanup(false)};b[a.bCancel]=function(){a.cleanup(true)};return{buttons:b,close:function(){a.cleanup(true)},modal:a.modal?a.modal:false,resizable:a.resizable?a.resizable:true,width:a.width+20}},apply_perm:function(){a("option",g).each(function(){this.selected?e.jqGrid("showCol",
m[this.value].name):e.jqGrid("hideCol",m[this.value].name)});var b=[];a("option[selected]",g).each(function(){b.push(parseInt(this.value,10))});a.each(b,function(){delete l[m[parseInt(this,10)].name]});a.each(l,function(){var a=parseInt(this,10),c=b,d=a;if(d>=0){var e=c.slice(),f=e.splice(d,Math.max(c.length-d,d));if(d>c.length)d=c.length;e[d]=a;b=e.concat(f)}else b=void 0});c.done&&c.done.call(e,b)},cleanup:function(a){b(c.dlog,f,"destroy");b(c.msel,g,"destroy");f.remove();a&&c.done&&c.done.call(e)},
msel_opts:{}},a.jgrid.col,c||{});if(a.ui&&a.ui.multiselect&&c.msel=="multiselect"){if(!a.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}c.msel_opts=a.extend(a.ui.multiselect.defaults,c.msel_opts)}c.caption&&f.attr("title",c.caption);if(c.classname){f.addClass(c.classname);g.addClass(c.classname)}if(c.width){a(">div",f).css({width:c.width,margin:"0 auto"});g.css("width",c.width)}if(c.height){a(">div",f).css("height",c.height);g.css("height",
c.height-10)}var m=e.jqGrid("getGridParam","colModel"),d=e.jqGrid("getGridParam","colNames"),l={},n=[];g.empty();a.each(m,function(a){l[this.name]=a;this.hidedlg?this.hidden||n.push(a):g.append("<option value='"+a+"' "+(this.hidden?"":"selected='selected'")+">"+d[a]+"</option>")});var s=a.isFunction(c.dlog_opts)?c.dlog_opts.call(e,c):c.dlog_opts;b(c.dlog,f,s);s=a.isFunction(c.msel_opts)?c.msel_opts.call(e,c):c.msel_opts;b(c.msel,g,s)}},sortableRows:function(c){return this.each(function(){var b=this;
if(b.grid&&!b.p.treeGrid&&a.fn.sortable){c=a.extend({cursor:"move",axis:"y",items:".jqgrow"},c||{});if(c.start&&a.isFunction(c.start)){c._start_=c.start;delete c.start}else c._start_=false;if(c.update&&a.isFunction(c.update)){c._update_=c.update;delete c.update}else c._update_=false;c.start=function(e,f){a(f.item).css("border-width","0px");a("td",f.item).each(function(a){this.style.width=b.grid.cols[a].style.width});if(b.p.subGrid){var g=a(f.item).attr("id");try{a(b).jqGrid("collapseSubGridRow",g)}catch(m){}}c._start_&&
c._start_.apply(this,[e,f])};c.update=function(e,f){a(f.item).css("border-width","");b.p.rownumbers===true&&a("td.jqgrid-rownum",b.rows).each(function(b){a(this).html(b+1)});c._update_&&c._update_.apply(this,[e,f])};a("tbody:first",b).sortable(c);a("tbody:first",b).disableSelection()}})},gridDnD:function(c){return this.each(function(){function b(){var b=a.data(e,"dnd");a("tr.jqgrow:not(.ui-draggable)",e).draggable(a.isFunction(b.drag)?b.drag.call(a(e),b):b.drag)}var e=this;if(e.grid&&!e.p.treeGrid&&
a.fn.draggable&&a.fn.droppable){a("#jqgrid_dnd").html()===null&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");if(typeof c=="string"&&c=="updateDnD"&&e.p.jqgdnd===true)b();else{c=a.extend({drag:function(b){return a.extend({start:function(c,d){if(e.p.subGrid){var f=a(d.helper).attr("id");try{a(e).jqGrid("collapseSubGridRow",f)}catch(g){}}for(f=0;f<a.data(e,"dnd").connectWith.length;f++)a(a.data(e,"dnd").connectWith[f]).jqGrid("getGridParam","reccount")=="0"&&a(a.data(e,"dnd").connectWith[f]).jqGrid("addRowData",
"jqg_empty_row",{});d.helper.addClass("ui-state-highlight");a("td",d.helper).each(function(a){this.style.width=e.grid.headers[a].width+"px"});b.onstart&&a.isFunction(b.onstart)&&b.onstart.call(a(e),c,d)},stop:function(c,d){if(d.helper.dropped){var f=a(d.helper).attr("id");a(e).jqGrid("delRowData",f)}for(f=0;f<a.data(e,"dnd").connectWith.length;f++)a(a.data(e,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row");b.onstop&&a.isFunction(b.onstop)&&b.onstop.call(a(e),c,d)}},b.drag_opts||{})},drop:function(b){return a.extend({accept:function(b){if(!a(b).hasClass("jqgrow"))return b;
var c=a(b).closest("table.ui-jqgrid-btable");if(c.length>0&&a.data(c[0],"dnd")!==void 0){b=a.data(c[0],"dnd").connectWith;return a.inArray("#"+this.id,b)!=-1?true:false}return b},drop:function(c,d){if(a(d.draggable).hasClass("jqgrow")){var f=a(d.draggable).attr("id"),f=d.draggable.parent().parent().jqGrid("getRowData",f);if(!b.dropbyname){var g=0,k={},l,q=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var r in f){if(f.hasOwnProperty(r)&&q[g]){l=q[g].name;k[l]=f[r]}g++}f=k}catch(u){}}d.helper.dropped=
true;if(b.beforedrop&&a.isFunction(b.beforedrop)){l=b.beforedrop.call(this,c,d,f,a("#"+e.id),a(this));typeof l!="undefined"&&(l!==null&&typeof l=="object")&&(f=l)}if(d.helper.dropped){var x;if(b.autoid)if(a.isFunction(b.autoid))x=b.autoid.call(this,f);else{x=Math.ceil(Math.random()*1E3);x=b.autoidprefix+x}a("#"+this.id).jqGrid("addRowData",x,f,b.droppos)}b.ondrop&&a.isFunction(b.ondrop)&&b.ondrop.call(this,c,d,f)}}},b.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",
hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},c||{});if(c.connectWith){c.connectWith=c.connectWith.split(",");c.connectWith=a.map(c.connectWith,function(b){return a.trim(b)});a.data(e,"dnd",c);e.p.reccount!="0"&&!e.p.jqgdnd&&b();e.p.jqgdnd=true;for(var f=0;f<c.connectWith.length;f++)a(c.connectWith[f]).droppable(a.isFunction(c.drop)?c.drop.call(a(e),c):c.drop)}}}})},
gridResize:function(c){return this.each(function(){var b=this;if(b.grid&&a.fn.resizable){c=a.extend({},c||{});if(c.alsoResize){c._alsoResize_=c.alsoResize;delete c.alsoResize}else c._alsoResize_=false;if(c.stop&&a.isFunction(c.stop)){c._stop_=c.stop;delete c.stop}else c._stop_=false;c.stop=function(e,f){a(b).jqGrid("setGridParam",{height:a("#gview_"+b.p.id+" .ui-jqgrid-bdiv").height()});a(b).jqGrid("setGridWidth",f.size.width,c.shrinkToFit);c._stop_&&c._stop_.call(b,e,f)};c.alsoResize=c._alsoResize_?
eval("("+("{'#gview_"+b.p.id+" .ui-jqgrid-bdiv':true,'"+c._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+b.p.id);delete c._alsoResize_;a("#gbox_"+b.p.id).resizable(c)}})}})})(l)});define("jquery-layout",["jquery"],function(l){(function(f){var a=Math.min,g=Math.max,c=Math.floor,b=function(a){return"string"===f.type(a)},e=function(a,c){if(f.isArray(c))for(var e=0,d=c.length;e<d;e++){var g=c[e];try{b(g)&&(g=eval(g)),f.isFunction(g)&&g(a)}catch(l){}}};f.layout={version:"1.3.rc30.7",revision:0.033007,
browser:{mozilla:!!f.browser.mozilla,webkit:!!f.browser.webkit||!!f.browser.safari,msie:!!f.browser.msie,isIE6:f.browser.msie&&6==f.browser.version,boxModel:!1!==f.support.boxModel||!f.browser.msie,version:f.browser.version},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},
blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects panes north south west east center".split(" "),allPanes:["north","south","west","east","center"],borderPanes:["north","south","west","east"],oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,
margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",
overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",
right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(a){a=f(a);if(a=a.data("layout")||a.data("parentLayout")){a=a.container;if(a.data("layoutPane"))return a;a=a.closest("."+f.layout.defaults.panes.paneClass);if(a.data("layoutPane"))return a}return null},getParentPaneInstance:function(a){return(a=f.layout.getParentPaneElem(a))?a.data("layoutPane"):null},getParentLayoutInstance:function(a){return(a=f.layout.getParentPaneElem(a))?a.data("parentLayout"):
null},getEventObject:function(a){return"object"===typeof a&&a.stopPropagation?a:null},parsePaneName:function(a){var b=f.layout.getEventObject(a);return b?(b.stopPropagation(),f(this).data("layoutEdge")):a},plugins:{draggable:!!f.fn.draggable,effects:{core:!!f.effects,slide:f.effects&&(f.effects.slide||f.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||f.layout.getScrollbarSize("width")},
scrollbarHeight:function(){return window.scrollbarHeight||f.layout.getScrollbarSize("height")},getScrollbarSize:function(a){var b=f('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),c={width:b.css("width")-b[0].clientWidth,height:b.height()-b[0].clientHeight};b.remove();window.scrollbarWidth=c.width;window.scrollbarHeight=c.height;return a.match(/^(width|height)$/)?c[a]:c},showInvisibly:function(a,b){if(a&&a.length&&
(b||"none"===a.css("display"))){var c=a[0].style,c={display:c.display||"",visibility:c.visibility||""};a.css({display:"block",visibility:"hidden"});return c}return{}},getElementDimensions:function(a,b){var c={css:{},inset:{}},d=c.css,e={bottom:0},l=f.layout.cssNum,s=a.offset(),o,q,r;c.offsetLeft=s.left;c.offsetTop=s.top;b||(b={});f.each(["Left","Right","Top","Bottom"],function(g,l){o=d["border"+l]=f.layout.borderWidth(a,l);q=d["padding"+l]=f.layout.cssNum(a,"padding"+l);r=l.toLowerCase();c.inset[r]=
0<=b[r]?b[r]:q;e[r]=c.inset[r]+o});d.width=a.css("width");d.height=a.height();d.top=l(a,"top",!0);d.bottom=l(a,"bottom",!0);d.left=l(a,"left",!0);d.right=l(a,"right",!0);c.outerWidth=a.outerWidth();c.outerHeight=a.outerHeight();c.innerWidth=g(0,c.outerWidth-e.left-e.right);c.innerHeight=g(0,c.outerHeight-e.top-e.bottom);c.layoutWidth=a.innerWidth();c.layoutHeight=a.innerHeight();return c},getElementStyles:function(a,b){var c={},d=a[0].style,e=b.split(","),f=["Top","Bottom","Left","Right"],g=["Color",
"Style","Width"],l,q,r,u,x,t;for(u=0;u<e.length;u++)if(l=e[u],l.match(/(border|padding|margin)$/))for(x=0;4>x;x++)if(q=f[x],"border"===l)for(t=0;3>t;t++)r=g[t],c[l+q+r]=d[l+q+r];else c[l+q]=d[l+q];else c[l]=d[l];return c},cssWidth:function(a,b){if(0>=b)return 0;if(!f.layout.browser.boxModel)return b;var c=f.layout.borderWidth,d=f.layout.cssNum,c=b-c(a,"Left")-c(a,"Right")-d(a,"paddingLeft")-d(a,"paddingRight");return g(0,c)},cssHeight:function(a,b){if(0>=b)return 0;if(!f.layout.browser.boxModel)return b;
var c=f.layout.borderWidth,d=f.layout.cssNum,c=b-c(a,"Top")-c(a,"Bottom")-d(a,"paddingTop")-d(a,"paddingBottom");return g(0,c)},cssNum:function(a,b,c){a.jquery||(a=f(a));var d=f.layout.showInvisibly(a),b=f.css(a[0],b,!0),c=c&&"auto"==b?b:Math.round(parseFloat(b)||0);a.css(d);return c},borderWidth:function(a,b){a.jquery&&(a=a[0]);var c="border"+b.substr(0,1).toUpperCase()+b.substr(1);return"none"===f.css(a,c+"Style",!0)?0:Math.round(parseFloat(f.css(a,c+"Width",!0))||0)},isMouseOverElem:function(a,
b){var c=f(b||this),d=c.offset(),e=d.top,d=d.left,g=d+c.outerWidth(),c=e+c.outerHeight(),l=a.pageX,o=a.pageY;return f.layout.browser.msie&&0>l&&0>o||l>=d&&l<=g&&o>=e&&o<=c},msg:function(a,b,c,d){f.isPlainObject(a)&&window.debugData?("string"===typeof b?(d=c,c=b):"object"===typeof c&&(d=c,c=null),c=c||"log( <object> )",d=f.extend({sort:!1,returnHTML:!1,display:!1},d),!0===b||d.display?debugData(a,c,d):window.console&&console.log(debugData(a,c,d))):b?alert(a):window.console?console.log(a):(b=f("#layoutLogger"),
b.length||(b=f('<div id="layoutLogger" style="position: '+(f.support.fixedPosition?"fixed":"absolute")+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body"),
b.css("left",f(window).width()-b.outerWidth()-5),f.ui.draggable&&b.draggable({handle:":first-child"})),b.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+a.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>"))}};f.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,
onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1E3,resizer_drag:1E4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button \n\nInvalid ",containerMissing:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",
noContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\n\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",
togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",
slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:f.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",
fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},
north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}};f.layout.optionsMap={layout:"name instanceKey stateManagement effects inset zIndexes errors zIndex scrollToBookmarkOnLoad showErrorMessages maskPanesEarly outset resizeWithWindow resizeWithWindowDelay resizeWithWindowMaxDelay onresizeall onresizeall_start onresizeall_end onload onunload".split(" "),
center:"paneClass contentSelector contentIgnoreSelector findNestedContent applyDemoStyles triggerEventsOnLoad showOverflowOnHover maskContents maskObjects liveContentResizing containerSelector children initChildren resizeChildren destroyChildren onresize onresize_start onresize_end onsizecontent onsizecontent_start onsizecontent_end".split(" "),noDefault:["paneSelector","resizerCursor","customHotkey"]};f.layout.transformData=function(a,b){var c=b?{panes:{},center:{}}:{},d,e,g,l,o,q,r;if("object"!==
typeof a)return c;for(e in a){d=c;o=a[e];g=e.split("__");r=g.length-1;for(q=0;q<=r;q++)l=g[q],q===r?d[l]=f.isPlainObject(o)?f.layout.transformData(o):o:(d[l]||(d[l]={}),d=d[l])}return c};f.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",
triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",
noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(a){function b(c,d){for(var e=c.split("."),f=e.length-1,g={branch:a,key:e[f]},j=0,l;j<f;j++)l=e[j],g.branch=void 0==g.branch[l]?d?g.branch[l]={}:{}:g.branch[l];return g}var c=f.layout.backwardCompatibility.map,d,e,g,l;for(l in c)d=b(l),g=d.branch[d.key],void 0!==g&&(e=b(c[l],!0),e.branch[e.key]=g,delete d.branch[d.key])},renameAllOptions:function(a){var b=
f.layout.backwardCompatibility.renameOptions;b(a);a.defaults&&("object"!==typeof a.panes&&(a.panes={}),f.extend(!0,a.panes,a.defaults),delete a.defaults);a.panes&&b(a.panes);f.each(f.layout.config.allPanes,function(c,d){a[d]&&b(a[d])});return a}};f.fn.layout=function(k){function j(a){if(!a)return!0;var b=a.keyCode;if(33>b)return!0;var c={38:"north",40:"south",37:"west",39:"east"},d=a.shiftKey,e=a.ctrlKey,g,j,k,l;e&&(37<=b&&40>=b)&&t[c[b]].enableCursorHotkey?l=c[b]:(e||d)&&f.each(n.borderPanes,function(a,
c){g=t[c];j=g.customHotkey;k=g.customHotkeyModifier;if(d&&"SHIFT"==k||e&&"CTRL"==k||e&&d)if(j&&b===(isNaN(j)||9>=j?j.toUpperCase().charCodeAt(0):j))return l=c,!1});if(!l||!R[l]||!t[l].closable||v[l].isHidden)return!0;za(l);a.stopPropagation();return a.returnValue=!1}function l(a){if(H()){this&&this.tagName&&(a=this);var c;b(a)?c=R[a]:f(a).data("layoutRole")?c=f(a):f(a).parents().each(function(){if(f(this).data("layoutRole"))return c=f(this),!1});if(c&&c.length){var e=c.data("layoutEdge"),a=v[e];a.cssSaved&&
d(e);if(a.isSliding||a.isResizing||a.isClosed)a.cssSaved=!1;else{var g={zIndex:t.zIndexes.resizer_normal+1},j={},k=c.css("overflow"),m=c.css("overflowX"),o=c.css("overflowY");"visible"!=k&&(j.overflow=k,g.overflow="visible");m&&!m.match(/(visible|auto)/)&&(j.overflowX=m,g.overflowX="visible");o&&!o.match(/(visible|auto)/)&&(j.overflowY=m,g.overflowY="visible");a.cssSaved=j;c.css(g);f.each(n.allPanes,function(a,b){b!=e&&d(b)})}}}}function d(a){if(H()){this&&this.tagName&&(a=this);var c;b(a)?c=R[a]:
f(a).data("layoutRole")?c=f(a):f(a).parents().each(function(){if(f(this).data("layoutRole"))return c=f(this),!1});if(c&&c.length){var a=c.data("layoutEdge"),a=v[a],d=a.cssSaved||{};!a.isSliding&&!a.isResizing&&c.css("zIndex",t.zIndexes.pane_normal);c.css(d);a.cssSaved=!1}}}var p=f.layout.browser,n=f.layout.config,s=f.layout.cssWidth,o=f.layout.cssHeight,q=f.layout.getElementDimensions,r=f.layout.getElementStyles,u=f.layout.getEventObject,x=f.layout.parsePaneName,t=f.extend(!0,{},f.layout.defaults);
t.effects=f.extend(!0,{},f.layout.effects);var v={id:"layout"+f.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},B={north:null,south:null,east:null,west:null,center:null},C={data:{},set:function(a,b,c){C.clear(a);C.data[a]=setTimeout(b,c)},clear:function(a){var b=C.data;b[a]&&(clearTimeout(b[a]),delete b[a])}},
z=function(a,b,c){var d=t;(d.showErrorMessages&&!c||c&&d.showDebugMessages)&&f.layout.msg(d.name+" / "+a,!1!==b);return!1},A=function(a,c,d){var e=c&&b(c),g=e?v[c]:v,j=e?t[c]:t,k=t.name,l=a+(a.match(/_/)?"":"_end"),m=l.match(/_end$/)?l.substr(0,l.length-4):"",n=j[l]||j[m],o="NC",p=[];!e&&"boolean"===f.type(c)&&(d=c,c="");if(n)try{b(n)&&(n.match(/,/)?(p=n.split(","),n=eval(p[0])):n=eval(n)),f.isFunction(n)&&(o=p.length?n(p[1]):e?n(c,R[c],g,j,k):n(ba,g,j,k))}catch(s){z(t.errors.callbackError.replace(/EVENT/,
f.trim((c||"")+" "+l)),!1)}!d&&!1!==o&&(e?(d=R[c],j=t[c],g=v[c],d.triggerHandler("layoutpane"+l,[c,d,g,j,k]),m&&d.triggerHandler("layoutpane"+m,[c,d,g,j,k])):(T.triggerHandler("layout"+l,[ba,g,j,k]),m&&T.triggerHandler("layout"+m,[ba,g,j,k])));(e&&"onresize_end"===a||"onsizecontent_end"===a)&&ab(c+"",!0);return o},E=function(a){if(!p.mozilla){var b=R[a];"IFRAME"===v[a].tagName?b.css(n.hidden).css(n.visible):b.find("IFRAME").css(n.hidden).css(n.visible)}},K=function(a){var b=R[a],a=n[a].dir,b={minWidth:1001-
s(b,1E3),minHeight:1001-o(b,1E3)};"horz"===a&&(b.minSize=b.minHeight);"vert"===a&&(b.minSize=b.minWidth);return b},U=function(a,c,d){var e=a;b(a)?e=R[a]:a.jquery||(e=f(a));a=o(e,c);e.css({height:a,visibility:"visible"});0<a&&0<e.innerWidth()?d&&e.data("autoHidden")&&(e.show().data("autoHidden",!1),p.mozilla||e.css(n.hidden).css(n.visible)):d&&!e.data("autoHidden")&&e.hide().data("autoHidden",!0)},y=function(a,d,e){e||(e=n[a].dir);b(d)&&d.match(/%/)&&(d="100%"===d?-1:parseInt(d,10)/100);if(0===d)return 0;
if(1<=d)return parseInt(d,10);var g=t,j=0;"horz"==e?j=N.innerHeight-(R.north?g.north.spacing_open:0)-(R.south?g.south.spacing_open:0):"vert"==e&&(j=N.innerWidth-(R.west?g.west.spacing_open:0)-(R.east?g.east.spacing_open:0));if(-1===d)return j;if(0<d)return c(j*d);if("center"==a)return 0;var e="horz"===e?"height":"width",g=R[a],a="height"===e?xa[a]:!1,j=f.layout.showInvisibly(g),k=g.css(e),l=a?a.css(e):0;g.css(e,"auto");a&&a.css(e,"auto");d="height"===e?g.outerHeight():g.outerWidth();g.css(e,k).css(j);
a&&a.css(e,l);return d},S=function(a,b){var c=R[a],d=t[a],e=v[a],f=b?d.spacing_open:0,d=b?d.spacing_closed:0;return!c||e.isHidden?0:e.isClosed||e.isSliding&&b?d:"horz"===n[a].dir?c.outerHeight()+f:c.outerWidth()+f},D=function(b,c){if(H()){var d=t[b],e=v[b],f=n[b],j=f.dir;f.sizeType.toLowerCase();var f=void 0!=c?c:e.isSliding,k=d.spacing_open,l=n.oppositeEdge[b],m=v[l],o=R[l],p=!o||!1===m.isVisible||m.isSliding?0:"horz"==j?o.outerHeight():o.outerWidth(),l=(!o||m.isHidden?0:t[l][!1!==m.isClosed?"spacing_closed":
"spacing_open"])||0,m="horz"==j?N.innerHeight:N.innerWidth,o=K("center"),o="horz"==j?g(t.center.minHeight,o.minHeight):g(t.center.minWidth,o.minWidth),f=m-k-(f?0:y("center",o,j)+p+l),j=e.minSize=g(y(b,d.minSize),K(b).minSize),f=e.maxSize=a(d.maxSize?y(b,d.maxSize):1E5,f),e=e.resizerPosition={},k=N.inset.top,p=N.inset.left,l=N.innerWidth,m=N.innerHeight,d=d.spacing_open;switch(b){case "north":e.min=k+j;e.max=k+f;break;case "west":e.min=p+j;e.max=p+f;break;case "south":e.min=k+m-f-d;e.max=k+m-j-d;break;
case "east":e.min=p+l-f-d,e.max=p+l-j-d}}},Y=function(a,b){var c=f(a),d=c.data("layoutRole"),e=c.data("layoutEdge"),g=t[e][d+"Class"],e="-"+e,j=c.hasClass(g+"-closed")?"-closed":"-open",k="-closed"===j?"-open":"-closed",j=g+"-hover "+(g+e+"-hover ")+(g+j+"-hover ")+(g+e+j+"-hover ");b&&(j+=g+k+"-hover "+(g+e+k+"-hover "));"resizer"==d&&c.hasClass(g+"-sliding")&&(j+=g+"-sliding-hover "+(g+e+"-sliding-hover "));return f.trim(j)},X=function(a,b){var c=f(b||this);a&&"toggler"===c.data("layoutRole")&&
a.stopPropagation();c.addClass(Y(c))},V=function(a,b){var c=f(b||this);c.removeClass(Y(c,!0))},G=function(){var a=f(this).data("layoutEdge"),b=v[a];!b.isClosed&&(!b.isResizing&&!v.paneResizing)&&(f.fn.disableSelection&&f("body").disableSelection(),t.maskPanesEarly&&ma(a))},Q=function(a,b){var c=b||this,d=f(c).data("layoutEdge"),e=d+"ResizerLeave";C.clear(d+"_openSlider");C.clear(e);b?v.paneResizing||(f.fn.enableSelection&&f("body").enableSelection(),t.maskPanesEarly&&Ha()):C.set(e,function(){Q(a,
c)},200)},H=function(){return v.initialized||v.creatingLayout?!0:O()},O=function(a){var b=t;if(!T.is(":visible"))return!a&&(p.webkit&&"BODY"===T[0].tagName)&&setTimeout(function(){O(!0)},50),!1;if(!ja("center").length)return z(b.errors.centerPaneMissing);v.creatingLayout=!0;f.extend(N,q(T,b.inset));Ba();b.scrollToBookmarkOnLoad&&(a=self.location,a.hash&&a.replace(a.hash));ba.hasParentLayout?b.resizeWithWindow=!1:b.resizeWithWindow&&f(window).bind("resize."+ia,ha);delete v.creatingLayout;v.initialized=
!0;e(ba,f.layout.onReady);A("onload_end");return!0},$=function(a,b){var c=x.call(this,a),d=R[c];if(d){var e=xa[c],g=v[c],j=t[c],k=t.stateManagement||{},j=b?j.children=b:j.children;if(f.isPlainObject(j))j=[j];else if(!j||!f.isArray(j))return;f.each(j,function(a,b){f.isPlainObject(b)&&(b.containerSelector?d.find(b.containerSelector):e||d).each(function(){var a=f(this),d=a.data("layout");if(!d){W({container:a,options:b},g);if(k.includeChildren&&v.stateData[c]){var d=(v.stateData[c].children||{})[b.instanceKey],
e=b.stateManagement||(b.stateManagement={autoLoad:!0});!0===e.autoLoad&&d&&(e.autoSave=!1,e.includeChildren=!0,e.autoLoad=f.extend(!0,{},d))}(d=a.layout(b))&&fa(c,d)}})})}},W=function(a,b){var c=a.container,d=a.options,e=d.stateManagement,f=d.instanceKey||c.data("layoutInstanceKey");f||(f=(e&&e.cookie?e.cookie.name:"")||d.name);f=f?f.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++b.childIdx;d.instanceKey=f;c.data("layoutInstanceKey",f);return f},fa=function(a,b){var c=R[a],d=B[a],e=v[a];
f.isPlainObject(d)&&(f.each(d,function(a,b){b.destroyed&&delete d[a]}),f.isEmptyObject(d)&&(d=B[a]=null));!b&&!d&&(b=c.data("layout"));b&&(b.hasParentLayout=!0,c=b.options,W(b,e),d||(d=B[a]={}),d[c.instanceKey]=b.container.data("layout"));ba[a].children=B[a];b||$(a)},ha=function(){var a=t,b=Number(a.resizeWithWindowDelay);10>b&&(b=100);C.clear("winResize");C.set("winResize",function(){C.clear("winResize");C.clear("winResizeRepeater");var b=q(T,a.inset);(b.innerWidth!==N.innerWidth||b.innerHeight!==
N.innerHeight)&&va()},b);C.data.winResizeRepeater||L()},L=function(){var a=Number(t.resizeWithWindowMaxDelay);0<a&&C.set("winResizeRepeater",function(){L();va()},a)},I=function(){A("onunload_start");e(ba,f.layout.onUnload);A("onunload_end")},P=function(a){a=a?a.split(","):n.borderPanes;f.each(a,function(a,b){var c=t[b];if(c.enableCursorHotkey||c.customHotkey)return f(document).bind("keydown."+ia,j),!1})},F=function(){function a(b){var c=t[b],d=t.panes;c.fxSettings||(c.fxSettings={});d.fxSettings||
(d.fxSettings={});f.each(["_open","_close","_size"],function(a,e){var g="fxName"+e,j="fxSpeed"+e,k="fxSettings"+e,l=c[g]=c[g]||d[g]||c.fxName||d.fxName||"none";if(l==="none"||!t.effects[l]||!f.effects||!f.effects[l]&&!f.effects.effect[l])l=c[g]="none";l=t.effects[l]||{};g=l.all||null;l=l[b]||null;c[j]=c[j]||d[j]||c.fxSpeed||d.fxSpeed||null;c[k]=f.extend(true,{},g,l,d.fxSettings,c.fxSettings,d[k],c[k])});delete c.fxName;delete c.fxSpeed;delete c.fxSettings}var b,c,d,e,j,l;k=f.layout.transformData(k,
!0);k=f.layout.backwardCompatibility.renameAllOptions(k);if(!f.isEmptyObject(k.panes)){b=f.layout.optionsMap.noDefault;e=0;for(j=b.length;e<j;e++)d=b[e],delete k.panes[d];b=f.layout.optionsMap.layout;e=0;for(j=b.length;e<j;e++)d=b[e],delete k.panes[d]}b=f.layout.optionsMap.layout;var m=f.layout.config.optionRootKeys;for(d in k)e=k[d],0>f.inArray(d,m)&&0>f.inArray(d,b)&&(k.panes[d]||(k.panes[d]=f.isPlainObject(e)?f.extend(!0,{},e):e),delete k[d]);f.extend(!0,t,k);f.each(n.allPanes,function(e,g){n[g]=
f.extend(!0,{},n.panes,n[g]);c=t.panes;l=t[g];if("center"===g){b=f.layout.optionsMap.center;e=0;for(j=b.length;e<j;e++)if(d=b[e],!k.center[d]&&(k.panes[d]||!l[d]))l[d]=c[d]}else if(l=t[g]=f.extend(!0,{},c,l),a(g),l.resizerClass||(l.resizerClass="ui-layout-resizer"),!l.togglerClass)l.togglerClass="ui-layout-toggler";l.paneClass||(l.paneClass="ui-layout-pane")});e=k.zIndex;m=t.zIndexes;0<e&&(m.pane_normal=e,m.content_mask=g(e+1,m.content_mask),m.resizer_normal=g(e+2,m.resizer_normal));delete t.panes},
ja=function(a){a=t[a].paneSelector;if("#"===a.substr(0,1))return T.find(a).eq(0);var b=T.children(a).eq(0);return b.length?b:T.children("form:first").children(a).eq(0)},Ba=function(a){x(a);f.each(n.allPanes,function(a,b){ca(b,!0)});ka();f.each(n.borderPanes,function(a,b){R[b]&&v[b].isVisible&&(D(b),ua(b))});Ra("center");f.each(n.allPanes,function(a,b){ta(b)})},ca=function(b,c){if(c||H()){var e=t[b],f=v[b],j=n[b],k=j.dir,p="center"===b,q={},u=R[b],x,A;u?Ya(b,!1,!0,!1):xa[b]=!1;u=R[b]=ja(b);if(u.length){u.data("layoutCSS")||
u.data("layoutCSS",r(u,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"));ba[b]={name:b,pane:R[b],content:xa[b],options:t[b],state:v[b],children:B[b]};u.data({parentLayout:ba,layoutPane:ba[b],layoutEdge:b,layoutRole:"pane"}).css(j.cssReq).css("zIndex",t.zIndexes.pane_normal).css(e.applyDemoStyles?j.cssDemo:{}).addClass(e.paneClass+" "+e.paneClass+"-"+b).bind("mouseenter."+ia,X).bind("mouseleave."+ia,V);j={hide:"",show:"",toggle:"",close:"",
open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(A in j)u.bind("layoutpane"+A.toLowerCase()+"."+ia,ba[j[A]||A]);Aa(b,!1);p||(x=f.size=
y(b,e.size),p=y(b,e.minSize)||1,A=y(b,e.maxSize)||1E5,0<x&&(x=g(a(x,A),p)),f.autoResize=e.autoResize,f.isClosed=!1,f.isSliding=!1,f.isResizing=!1,f.isHidden=!1,f.pins||(f.pins=[]));f.tagName=u[0].tagName;f.edge=b;f.noRoom=!1;f.isVisible=!0;Ea(b);"horz"===k?q.height=o(u,x):"vert"===k&&(q.width=s(u,x));u.css(q);"horz"!=k&&Ra(b,!0);e.initClosed&&e.closable&&!e.initHidden?Ma(b,!0,!0):e.initHidden||e.initClosed?qa(b):f.noRoom||u.css("display","block");u.css("visibility","visible");e.showOverflowOnHover&&
u.hover(l,d);v.initialized&&(ka(b),P(b),ta(b))}else R[b]=!1}},ta=function(a){var b=R[a],c=v[a],d=t[a];b&&(b.data("layout")&&fa(a,b.data("layout")),c.isVisible&&(v.initialized?va():Pa(a),d.triggerEventsOnLoad?A("onresize_end",a):ab(a,!0)),d.initChildren&&d.children&&$(a))},Ea=function(a){a=a?a.split(","):n.borderPanes;f.each(a,function(a,b){var c=R[b],d=ga[b],e=v[b],f=n[b].side,g={};if(c){switch(b){case "north":g.top=N.inset.top;g.left=N.inset.left;g.right=N.inset.right;break;case "south":g.bottom=
N.inset.bottom;g.left=N.inset.left;g.right=N.inset.right;break;case "west":g.left=N.inset.left;break;case "east":g.right=N.inset.right}c.css(g);d&&e.isClosed?d.css(f,N.inset[f]):d&&!e.isHidden&&d.css(f,N.inset[f]+S(b))}})},ka=function(a){a=a?a.split(","):n.borderPanes;f.each(a,function(a,b){var c=R[b];ga[b]=!1;sa[b]=!1;if(c){var c=t[b],d=v[b],e="#"===c.paneSelector.substr(0,1)?c.paneSelector.substr(1):"",g=c.resizerClass,j=c.togglerClass,k="-"+b,l=ba[b],m=l.resizer=ga[b]=f("<div></div>"),l=l.toggler=
c.closable?sa[b]=f("<div></div>"):!1;!d.isVisible&&c.slidable&&m.attr("title",c.tips.Slide).css("cursor",c.sliderCursor);m.attr("id",e?e+"-resizer":"").data({parentLayout:ba,layoutPane:ba[b],layoutEdge:b,layoutRole:"resizer"}).css(n.resizers.cssReq).css("zIndex",t.zIndexes.resizer_normal).css(c.applyDemoStyles?n.resizers.cssDemo:{}).addClass(g+" "+g+k).hover(X,V).hover(G,Q).appendTo(T);c.resizerDblClickToggle&&m.bind("dblclick."+ia,za);l&&(l.attr("id",e?e+"-toggler":"").data({parentLayout:ba,layoutPane:ba[b],
layoutEdge:b,layoutRole:"toggler"}).css(n.togglers.cssReq).css(c.applyDemoStyles?n.togglers.cssDemo:{}).addClass(j+" "+j+k).hover(X,V).bind("mouseenter",G).appendTo(m),c.togglerContent_open&&f("<span>"+c.togglerContent_open+"</span>").data({layoutEdge:b,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",b).addClass("content content-open").css("display","none").appendTo(l),c.togglerContent_closed&&f("<span>"+c.togglerContent_closed+"</span>").data({layoutEdge:b,layoutRole:"togglerContent"}).addClass("content content-closed").css("display",
"none").appendTo(l),La(b));Fa(b);d.isVisible?na(b):(jb(b),Na(b,!0))}});bb()},Aa=function(a,b){if(H()){var c=t[a],d=c.contentSelector,e=ba[a],f=R[a],g;d&&(g=e.content=xa[a]=c.findNestedContent?f.find(d).eq(0):f.children(d).eq(0));g&&g.length?(g.data("layoutRole","content"),g.data("layoutCSS")||g.data("layoutCSS",r(g,"height")),g.css(n.content.cssReq),c.applyDemoStyles&&(g.css(n.content.cssDemo),f.css(n.content.cssDemoPane)),f.css("overflowX").match(/(scroll|auto)/)&&f.css("overflow","hidden"),v[a].content=
{},!1!==b&&Pa(a)):e.content=xa[a]=!1}},Fa=function(a){var b=f.layout.plugins.draggable,a=a?a.split(","):n.borderPanes;f.each(a,function(a,d){var e=t[d];if(!b||!R[d]||!e.resizable)return e.resizable=!1,!0;var g=v[d],j=t.zIndexes,k=n[d],l="horz"==k.dir?"top":"left",m=ga[d],o=e.resizerClass,p=0,s,q,r=o+"-drag",u=o+"-"+d+"-drag",x=o+"-dragging",Z=o+"-"+d+"-dragging",y=o+"-dragging-limit",z=o+"-"+d+"-dragging-limit",B=!1;g.isClosed||m.attr("title",e.tips.Resize).css("cursor",e.resizerCursor);m.draggable({containment:T[0],
axis:"horz"==k.dir?"y":"x",delay:0,distance:1,grid:e.resizingGrid,helper:"clone",opacity:e.resizerDragOpacity,addClasses:!1,zIndex:j.resizer_drag,start:function(a,b){e=t[d];g=v[d];q=e.livePaneResizing;if(!1===A("ondrag_start",d))return!1;g.isResizing=!0;v.paneResizing=d;C.clear(d+"_closeSlider");D(d);s=g.resizerPosition;p=b.position[l];m.addClass(r+" "+u);B=!1;f("body").disableSelection();ma(d)},drag:function(a,b){B||(b.helper.addClass(x+" "+Z).css({right:"auto",bottom:"auto"}).children().css("visibility",
"hidden"),B=!0,g.isSliding&&R[d].css("zIndex",j.pane_sliding));var f=0;b.position[l]<s.min?(b.position[l]=s.min,f=-1):b.position[l]>s.max&&(b.position[l]=s.max,f=1);f?(b.helper.addClass(y+" "+z),window.defaultStatus=0<f&&d.match(/(north|west)/)||0>f&&d.match(/(south|east)/)?e.tips.maxSizeWarning:e.tips.minSizeWarning):(b.helper.removeClass(y+" "+z),window.defaultStatus="");q&&Math.abs(b.position[l]-p)>=e.liveResizingTolerance&&(p=b.position[l],c(a,b,d))},stop:function(a,b){f("body").enableSelection();
window.defaultStatus="";m.removeClass(r+" "+u);g.isResizing=!1;v.paneResizing=!1;c(a,b,d,!0)}})});var c=function(a,b,c,d){var e=b.position,f=n[c],a=t[c],b=v[c],g;switch(c){case "north":g=e.top;break;case "west":g=e.left;break;case "south":g=N.layoutHeight-e.top-a.spacing_open;break;case "east":g=N.layoutWidth-e.left-a.spacing_open}g-=N.inset[f.side];d?(!1!==A("ondrag_end",c)&&da(c,g,!1,!0),Ha(!0),b.isSliding&&ma(c)):Math.abs(g-b.size)<a.liveResizingTolerance||(da(c,g,!1,!0),Ia.each(ea))}},ea=function(){var a=
f(this),b=a.data("layoutMask"),b=v[b];"IFRAME"==b.tagName&&b.isVisible&&a.css({top:b.offsetTop,left:b.offsetLeft,width:b.outerWidth,height:b.outerHeight})},ma=function(a,b){var c=n[a],d=["center"],e=t.zIndexes,g=f.extend({objectsOnly:!1,forSliding:v[a].isSliding},b),j,k;g.forSliding&&d.push(n.oppositeEdge[a]);"horz"===c.dir&&(d.push("west"),d.push("east"));f.each(d,function(a,b){k=v[b];j=t[b];k.isVisible&&(j.maskObjects||!g.objectsOnly&&j.maskContents)&&Da(b).each(function(){ea.call(this);this.style.zIndex=
k.isSliding?e.pane_sliding+1:e.pane_normal+1;this.style.display="block"})})},Ha=function(a){if(a||!v.paneResizing)Ia.hide();else if(!a&&!f.isEmptyObject(v.panesSliding))for(var a=Ia.length-1,b,c;0<=a;a--)c=Ia.eq(a),b=c.data("layoutMask"),t[b].maskObjects||c.hide()},Da=function(a){for(var b=f([]),c,d=0,e=Ia.length;d<e;d++)c=Ia.eq(d),c.data("layoutMask")===a&&(b=b.add(c));if(b.length)return b;b=R[a];c=v[a];var d=t[a],e=t.zIndexes,g=f([]),j,k,l,m,n;if(d.maskContents||d.maskObjects)for(n=0;n<(d.maskObjects?
2:1);n++)j=d.maskObjects&&0==n,k=document.createElement(j?"iframe":"div"),l=f(k).data("layoutMask",a),k.className="ui-layout-mask ui-layout-mask-"+a,m=k.style,m.display="block",m.position="absolute",m.background="#FFF",j&&(k.frameborder=0,k.src="about:blank",m.opacity=0,m.filter="Alpha(Opacity='0')",m.border=0),"IFRAME"==c.tagName?(m.zIndex=e.pane_normal+1,T.append(k)):(l.addClass("ui-layout-mask-inside-pane"),m.zIndex=d.maskZindex||e.content_mask,m.top=0,m.left=0,m.width="100%",m.height="100%",b.append(k)),
g=g.add(k),Ia=Ia.add(k);return g},Ya=function(a,b,c,d){if(H()){var a=x.call(this,a),e=R[a],g=xa[a],j=ga[a],k=sa[a];e&&f.isEmptyObject(e.data())&&(e=!1);g&&f.isEmptyObject(g.data())&&(g=!1);j&&f.isEmptyObject(j.data())&&(j=!1);k&&f.isEmptyObject(k.data())&&(k=!1);e&&e.stop(!0,!0);var l=t[a],m=B[a],n=f.isPlainObject(m)&&!f.isEmptyObject(m),d=void 0!==d?d:l.destroyChildren;n&&d&&(f.each(m,function(a,b){b.destroyed||b.destroy(!0);b.destroyed&&delete m[a]}),f.isEmptyObject(m)&&(m=B[a]=null,n=!1));e&&b&&
!n?e.remove():e&&e[0]&&(b=l.paneClass,d=b+"-"+a,b=[b,b+"-open",b+"-closed",b+"-sliding",d,d+"-open",d+"-closed",d+"-sliding"],f.merge(b,Y(e,!0)),e.removeClass(b.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+ia),n&&g?(g.width(g.width()),f.each(m,function(a,b){b.resizeAll()})):g&&g.css(g.data("layoutCSS")).removeData("layoutCSS").removeData("layoutRole"),e.data("layout")||e.css(e.data("layoutCSS")).removeData("layoutCSS"));
k&&k.remove();j&&j.remove();ba[a]=R[a]=xa[a]=ga[a]=sa[a]=!1;c||va()}},Wa=function(a){var b=R[a],c=b[0].style;t[a].useOffscreenClose?(b.data(n.offscreenReset)||b.data(n.offscreenReset,{left:c.left,right:c.right}),b.css(n.offscreenCSS)):b.hide().removeData(n.offscreenReset)},J=function(a){var b=R[a],a=t[a],c=n.offscreenCSS,d=b.data(n.offscreenReset),e=b[0].style;b.show().removeData(n.offscreenReset);if(a.useOffscreenClose&&d&&(e.left==c.left&&(e.left=d.left),e.right==c.right))e.right=d.right},qa=function(a,
b){if(H()){var c=x.call(this,a),d=t[c],e=v[c],f=ga[c];R[c]&&!e.isHidden&&!(v.initialized&&!1===A("onhide_start",c))&&(e.isSliding=!1,delete v.panesSliding[c],f&&f.hide(),!v.initialized||e.isClosed?(e.isClosed=!0,e.isHidden=!0,e.isVisible=!1,v.initialized||Wa(c),Ra("horz"===n[c].dir?"":"center"),(v.initialized||d.triggerEventsOnLoad)&&A("onhide_end",c)):(e.isHiding=!0,Ma(c,!1,b)))}},Sa=function(a,b,c,d){if(H()){var a=x.call(this,a),e=v[a];R[a]&&e.isHidden&&!1!==A("onshow_start",a)&&(e.isShowing=!0,
e.isSliding=!1,delete v.panesSliding[a],!1===b?Ma(a,!0):wa(a,!1,c,d))}},za=function(a,b){if(H()){var c=u(a),d=x.call(this,a),e=v[d];c&&c.stopImmediatePropagation();e.isHidden?Sa(d):e.isClosed?wa(d,!!b):Ma(d)}},ib=function(a){var b=v[a];Wa(a);b.isClosed=!0;b.isVisible=!1},Ma=function(a,b,c,d){function e(){k.isMoving=!1;Na(f,!0);var a=n.oppositeEdge[f];v[a].noRoom&&(D(a),ua(a));if(!d&&(v.initialized||j.triggerEventsOnLoad))m||A("onclose_end",f),m&&A("onshow_end",f),o&&A("onhide_end",f)}var f=x.call(this,
a);if(!v.initialized&&R[f])ib(f);else if(H()){var g=R[f],j=t[f],k=v[f],l,m,o;T.queue(function(a){if(!g||!j.closable&&!k.isShowing&&!k.isHiding||!b&&k.isClosed&&!k.isShowing)return a();var d=!k.isShowing&&!1===A("onclose_start",f);m=k.isShowing;o=k.isHiding;delete k.isShowing;delete k.isHiding;if(d)return a();l=!c&&!k.isClosed&&"none"!=j.fxName_close;k.isMoving=!0;k.isClosed=!0;k.isVisible=!1;o?k.isHidden=!0:m&&(k.isHidden=!1);k.isSliding?Ga(f,!1):Ra("horz"===n[f].dir?"":"center",!1);jb(f);l?(Xa(f,
!0),g.hide(j.fxName_close,j.fxSettings_close,j.fxSpeed_close,function(){Xa(f,false);k.isClosed&&e();a()})):(Wa(f),e(),a())})}},jb=function(a){var b=ga[a],c=sa[a],d=t[a],e=n[a].side,g=d.resizerClass,j=d.togglerClass,k="-"+a;b.css(e,N.inset[e]).removeClass(g+"-open "+g+k+"-open").removeClass(g+"-sliding "+g+k+"-sliding").addClass(g+"-closed "+g+k+"-closed");d.resizable&&f.layout.plugins.draggable&&b.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title","");c&&(c.removeClass(j+
"-open "+j+k+"-open").addClass(j+"-closed "+j+k+"-closed").attr("title",d.tips.Open),c.children(".content-open").hide(),c.children(".content-closed").css("display","block"));oa(a,!1);v.initialized&&bb()},wa=function(a,b,c,d){function e(){k.isMoving=!1;E(f);k.isSliding||Ra("vert"==n[f].dir?"center":"",!1);na(f)}if(H()){var f=x.call(this,a),g=R[f],j=t[f],k=v[f],l,m;T.queue(function(a){if(!g||!j.resizable&&!j.closable&&!k.isShowing||k.isVisible&&!k.isSliding)return a();if(k.isHidden&&!k.isShowing)a(),
Sa(f,!0);else{k.autoResize&&k.size!=j.size?la(f,j.size,!0,!0,!0):D(f,b);var n=A("onopen_start",f);if("abort"===n)return a();"NC"!==n&&D(f,b);if(k.minSize>k.maxSize)return oa(f,!1),!d&&j.tips.noRoomToOpen&&alert(j.tips.noRoomToOpen),a();b?Ga(f,!0):k.isSliding?Ga(f,!1):j.slidable&&Na(f,!1);k.noRoom=!1;ua(f);m=k.isShowing;delete k.isShowing;l=!c&&k.isClosed&&"none"!=j.fxName_open;k.isMoving=!0;k.isVisible=!0;k.isClosed=!1;m&&(k.isHidden=!1);l?(Xa(f,!0),g.show(j.fxName_open,j.fxSettings_open,j.fxSpeed_open,
function(){Xa(f,false);k.isVisible&&e();a()})):(J(f),e(),a())}})}},na=function(a,b){var c=R[a],d=ga[a],e=sa[a],g=t[a],j=v[a],k=n[a].side,l=g.resizerClass,m=g.togglerClass,o="-"+a;d.css(k,N.inset[k]+S(a)).removeClass(l+"-closed "+l+o+"-closed").addClass(l+"-open "+l+o+"-open");j.isSliding?d.addClass(l+"-sliding "+l+o+"-sliding"):d.removeClass(l+"-sliding "+l+o+"-sliding");V(0,d);g.resizable&&f.layout.plugins.draggable?d.draggable("enable").css("cursor",g.resizerCursor).attr("title",g.tips.Resize):
j.isSliding||d.css("cursor","default");e&&(e.removeClass(m+"-closed "+m+o+"-closed").addClass(m+"-open "+m+o+"-open").attr("title",g.tips.Close),V(0,e),e.children(".content-closed").hide(),e.children(".content-open").css("display","block"));oa(a,!j.isSliding);f.extend(j,q(c));v.initialized&&(bb(),Pa(a,!0));if(!b&&(v.initialized||g.triggerEventsOnLoad)&&c.is(":visible"))A("onopen_end",a),j.isShowing&&A("onshow_end",a),v.initialized&&A("onresize_end",a)},Za=function(a){function b(){e.isClosed?e.isMoving||
wa(d,!0):Ga(d,!0)}if(H()){var c=u(a),d=x.call(this,a),e=v[d],a=t[d].slideDelay_open;c&&c.stopImmediatePropagation();e.isClosed&&c&&"mouseenter"===c.type&&0<a?C.set(d+"_openSlider",b,a):b()}},ra=function(a){function b(){e.isClosed?Ga(d,!1):e.isMoving||Ma(d)}if(H()){var c=u(a),d=x.call(this,a),a=t[d],e=v[d],j=e.isMoving?1E3:300;!e.isClosed&&!e.isResizing&&("click"===a.slideTrigger_close?b():a.preventQuickSlideClose&&e.isMoving||a.preventPrematureSlideClose&&c&&f.layout.isMouseOverElem(c,R[d])||(c?C.set(d+
"_closeSlider",b,g(a.slideDelay_close,j)):b()))}},Xa=function(a,b){var c=R[a],d=v[a],e=t[a],f=t.zIndexes;b?(ma(a,{objectsOnly:!0}),c.css({zIndex:f.pane_animate}),"south"==a?c.css({top:N.inset.top+N.innerHeight-c.outerHeight()}):"east"==a&&c.css({left:N.inset.left+N.innerWidth-c.outerWidth()})):(Ha(),c.css({zIndex:d.isSliding?f.pane_sliding:f.pane_normal}),"south"==a?c.css({top:"auto"}):"east"==a&&!c.css("left").match(/\-99999/)&&c.css({left:"auto"}),p.msie&&(e.fxOpacityFix&&"slide"!=e.fxName_open&&
c.css("filter")&&1==c.css("opacity"))&&c[0].style.removeAttribute("filter"))},Na=function(a,b){var c=t[a],d=ga[a],e=c.slideTrigger_open.toLowerCase();if(d&&(!b||c.slidable)){e.match(/mouseover/)?e=c.slideTrigger_open="mouseenter":e.match(/(click|dblclick|mouseenter)/)||(e=c.slideTrigger_open="click");if(c.resizerDblClickToggle&&e.match(/click/))d[b?"unbind":"bind"]("dblclick."+ia,za);d[b?"bind":"unbind"](e+"."+ia,Za).css("cursor",b?c.sliderCursor:"default").attr("title",b?c.tips.Slide:"")}},Ga=function(a,
b){function c(b){C.clear(a+"_closeSlider");b.stopPropagation()}var d=t[a],e=v[a],f=t.zIndexes,g=d.slideTrigger_close.toLowerCase(),j=b?"bind":"unbind",k=R[a],l=ga[a];C.clear(a+"_closeSlider");b?(e.isSliding=!0,v.panesSliding[a]=!0,Na(a,!1)):(e.isSliding=!1,delete v.panesSliding[a]);k.css("zIndex",b?f.pane_sliding:f.pane_normal);l.css("zIndex",b?f.pane_sliding+2:f.resizer_normal);g.match(/(click|mouseleave)/)||(g=d.slideTrigger_close="mouseleave");l[j](g,ra);"mouseleave"===g&&(k[j]("mouseleave."+ia,
ra),l[j]("mouseenter."+ia,c),k[j]("mouseenter."+ia,c));b?"click"===g&&!d.resizable&&(l.css("cursor",b?d.sliderCursor:"default"),l.attr("title",b?d.tips.Close:"")):C.clear(a+"_closeSlider")},ua=function(a,b,c,d){var b=t[a],e=v[a],g=n[a],j=R[a],k=ga[a],l="vert"===g.dir,m=!1;if("center"===a||l&&e.noVerticalRoom)(m=0<=e.maxHeight)&&e.noRoom?(J(a),k&&k.show(),e.isVisible=!0,e.noRoom=!1,l&&(e.noVerticalRoom=!1),E(a)):!m&&!e.noRoom&&(Wa(a),k&&k.hide(),e.isVisible=!1,e.noRoom=!0);if("center"!==a)if(e.minSize<=
e.maxSize){if(e.size>e.maxSize?la(a,e.maxSize,c,!0,d):e.size<e.minSize?la(a,e.minSize,c,!0,d):k&&(e.isVisible&&j.is(":visible"))&&(c=e.size+N.inset[g.side],f.layout.cssNum(k,g.side)!=c&&k.css(g.side,c)),e.noRoom)e.wasOpen&&b.closable?b.autoReopen?wa(a,!1,!0,!0):e.noRoom=!1:Sa(a,e.wasOpen,!0,!0)}else e.noRoom||(e.noRoom=!0,e.wasOpen=!e.isClosed&&!e.isSliding,e.isClosed||(b.closable?Ma(a,!0,!0):qa(a,!0)))},da=function(a,b,c,d,e){if(H()){var a=x.call(this,a),f=t[a],g=v[a],e=e||f.livePaneResizing&&!g.isResizing;
g.autoResize=!1;la(a,b,c,d,e)}},la=function(b,c,d,e,j){function k(){for(var a="width"===C?r.outerWidth():r.outerHeight(),a=[{pane:l,count:1,target:c,actual:a,correct:c===a,attempt:c,cssSize:I}],b=a[0],e={},m="Inaccurate size after resizing the "+l+"-pane.";!b.correct;){e={pane:l,count:b.count+1,target:c};e.attempt=b.actual>c?g(0,b.attempt-(b.actual-c)):g(0,b.attempt+(c-b.actual));e.cssSize=("horz"==n[l].dir?o:s)(R[l],e.attempt);r.css(C,e.cssSize);e.actual="width"==C?r.outerWidth():r.outerHeight();
e.correct=c===e.actual;1===a.length&&(z(m,!1,!0),z(b,!1,!0));z(e,!1,!0);if(3<a.length)break;a.push(e);b=a[a.length-1]}p.size=c;f.extend(p,q(r));p.isVisible&&r.is(":visible")&&(u&&u.css(B,c+N.inset[B]),Pa(l));!d&&(!E&&v.initialized&&p.isVisible)&&A("onresize_end",l);d||(p.isSliding||Ra("horz"==n[l].dir?"":"center",E,j),bb());b=n.oppositeEdge[l];c<G&&v[b].noRoom&&(D(b),ua(b,!1,d));1<a.length&&z(m+"\nSee the Error Console for details.",!0,!0)}if(H()){var l=x.call(this,b),m=t[l],p=v[l],r=R[l],u=ga[l],
B=n[l].side,C=n[l].sizeType.toLowerCase(),E=p.isResizing&&!m.triggerEventsDuringLiveResize,F=!0!==e&&m.animatePaneSizing,G,I;T.queue(function(b){D(l);G=p.size;c=y(l,c);c=g(c,y(l,m.minSize));c=a(c,p.maxSize);if(c<p.minSize)b(),ua(l,!1,d);else{if(!j&&c===G)return b();!d&&(v.initialized&&p.isVisible)&&A("onresize_start",l);I=("horz"==n[l].dir?o:s)(R[l],c);if(F&&r.is(":visible")){var e=f.layout.effects.size[l]||f.layout.effects.size.all,e=m.fxSettings_size.easing||e.easing,u=t.zIndexes,x={};x[C]=I+"px";
p.isMoving=!0;r.css({zIndex:u.pane_animate}).show().animate(x,m.fxSpeed_size,e,function(){r.css({zIndex:p.isSliding?u.pane_sliding:u.pane_normal});p.isMoving=!1;k();b()})}else r.css(C,I),r.is(":visible")?k():(p.size=c,f.extend(p,q(r))),b()}})}},Ra=function(a,b,c){a=(a?a:"east,west,center").split(",");f.each(a,function(a,d){if(R[d]){var e=t[d],j=v[d],k=R[d],l=!0,m={},n=f.layout.showInvisibly(k),r={top:S("north",!0),bottom:S("south",!0),left:S("west",!0),right:S("east",!0),width:0,height:0};r.width=
N.innerWidth-r.left-r.right;r.height=N.innerHeight-r.bottom-r.top;r.top+=N.inset.top;r.bottom+=N.inset.bottom;r.left+=N.inset.left;r.right+=N.inset.right;f.extend(j,q(k));if("center"===d){if(!c&&j.isVisible&&r.width===j.outerWidth&&r.height===j.outerHeight)return k.css(n),!0;f.extend(j,K(d),{maxWidth:r.width,maxHeight:r.height});m=r;m.width=s(k,m.width);m.height=o(k,m.height);l=0<=m.width&&0<=m.height;if(!v.initialized&&e.minWidth>r.width){var e=e.minWidth-j.outerWidth,r=t.east.minSize||0,u=t.west.minSize||
0,x=v.east.size,y=v.west.size,z=x,B=y;0<e&&(v.east.isVisible&&x>r)&&(z=g(x-r,x-e),e-=x-z);0<e&&(v.west.isVisible&&y>u)&&(B=g(y-u,y-e),e-=y-B);if(0===e){x&&x!=r&&la("east",z,!0,!0,c);y&&y!=u&&la("west",B,!0,!0,c);Ra("center",b,c);k.css(n);return}}}else{j.isVisible&&!j.noVerticalRoom&&f.extend(j,q(k),K(d));if(!c&&!j.noVerticalRoom&&r.height===j.outerHeight)return k.css(n),!0;m.top=r.top;m.bottom=r.bottom;m.height=o(k,r.height);j.maxHeight=m.height;l=0<=j.maxHeight;l||(j.noVerticalRoom=!0)}l?(!b&&v.initialized&&
A("onresize_start",d),k.css(m),"center"!==d&&bb(d),j.noRoom&&(!j.isClosed&&!j.isHidden)&&ua(d),j.isVisible&&(f.extend(j,q(k)),v.initialized&&Pa(d))):!j.noRoom&&j.isVisible&&ua(d);k.css(n);if(!j.isVisible)return!0;"center"===d&&(j=p.isIE6||!p.boxModel,R.north&&(j||"IFRAME"==v.north.tagName)&&R.north.css("width",s(R.north,N.innerWidth)),R.south&&(j||"IFRAME"==v.south.tagName)&&R.south.css("width",s(R.south,N.innerWidth)));!b&&v.initialized&&A("onresize_end",d)}})},va=function(a){x(a);if(T.is(":visible"))if(v.initialized){if(f.extend(N,
q(T,t.inset)),N.outerHeight){!0===a&&Ea();if(!1===A("onresizeall_start"))return!1;var b,c,d;f.each(["south","north","east","west"],function(a,b){R[b]&&(c=t[b],d=v[b],d.autoResize&&d.size!=c.size?la(b,c.size,!0,!0,!0):(D(b),ua(b,!1,!0,!0)))});Ra("",!0,!0);bb();f.each(n.allPanes,function(a,c){(b=R[c])&&v[c].isVisible&&A("onresize_end",c)});A("onresizeall_end")}}else O()},ab=function(a,b){var c=x.call(this,a);t[c].resizeChildren&&(b||fa(c),c=B[c],f.isPlainObject(c)&&f.each(c,function(a,b){b.resizeAll()}))},
Pa=function(a,b){if(H()){var c=x.call(this,a),c=c?c.split(","):n.allPanes;f.each(c,function(a,c){function d(a){return g(l.css.paddingBottom,parseInt(a.css("marginBottom"),10)||0)}function e(){var a=t[c].contentIgnoreSelector,a=j.nextAll().not(".ui-layout-mask").not(a||":lt(0)"),b=a.filter(":visible"),f=b.filter(":last");m={top:j[0].offsetTop,height:j.outerHeight(),numFooters:a.length,hiddenFooters:a.length-b.length,spaceBelow:0};m.spaceAbove=m.top;m.bottom=m.top+m.height;m.spaceBelow=f.length?f[0].offsetTop+
f.outerHeight()-m.bottom+d(f):d(j)}var f=R[c],j=xa[c],k=t[c],l=v[c],m=l.content;if(!f||!j||!f.is(":visible"))return!0;if(!j.length&&(Aa(c,!1),!j))return;if(!1!==A("onsizecontent_start",c)){if(!l.isMoving&&!l.isResizing||k.liveContentResizing||b||void 0==m.top)e(),0<m.hiddenFooters&&"hidden"===f.css("overflow")&&(f.css("overflow","visible"),e(),f.css("overflow","hidden"));f=l.innerHeight-(m.spaceAbove-l.css.paddingTop)-(m.spaceBelow-l.css.paddingBottom);if(!j.is(":visible")||m.height!=f)U(j,f,!0),
m.height=f;v.initialized&&A("onsizecontent_end",c)}})}},bb=function(a){a=(a=x.call(this,a))?a.split(","):n.borderPanes;f.each(a,function(a,d){var e=t[d],g=v[d],j=R[d],k=ga[d],l=sa[d],m;if(j&&k){var p=n[d].dir,q=g.isClosed?"_closed":"_open",r=e["spacing"+q],u=e["togglerAlign"+q],q=e["togglerLength"+q],x;if(0===r)k.hide();else{!g.noRoom&&!g.isHidden&&k.show();"horz"===p?(x=N.innerWidth,g.resizerLength=x,j=f.layout.cssNum(j,"left"),k.css({width:s(k,x),height:o(k,r),left:-9999<j?j:N.inset.left})):(x=
j.outerHeight(),g.resizerLength=x,k.css({height:o(k,x),width:s(k,r),top:N.inset.top+S("north",!0)}));V(e,k);if(l){if(0===q||g.isSliding&&e.hideTogglerOnSlide){l.hide();return}l.show();if(!(0<q)||"100%"===q||q>x)q=x,u=0;else if(b(u))switch(u){case "top":case "left":u=0;break;case "bottom":case "right":u=x-q;break;default:u=c((x-q)/2)}else j=parseInt(u,10),u=0<=u?j:x-q+j;if("horz"===p){var A=s(l,q);l.css({width:A,height:o(l,r),left:u,top:0});l.children(".content").each(function(){m=f(this);m.css("marginLeft",
c((A-m.outerWidth())/2))})}else{var y=o(l,q);l.css({height:y,width:s(l,r),top:u,left:0});l.children(".content").each(function(){m=f(this);m.css("marginTop",c((y-m.outerHeight())/2))})}V(0,l)}if(!v.initialized&&(e.initHidden||g.noRoom))k.hide(),l&&l.hide()}}})},La=function(a){if(H()){var b=x.call(this,a),a=sa[b],c=t[b];a&&(c.closable=!0,a.bind("click."+ia,function(a){a.stopPropagation();za(b)}).css("visibility","visible").css("cursor","pointer").attr("title",v[b].isClosed?c.tips.Open:c.tips.Close).show())}},
oa=function(a,b){f.layout.plugins.buttons&&f.each(v[a].pins,function(c,d){f.layout.buttons.setPinState(ba,f(d),a,b)})},T=f(this).eq(0);if(!T.length)return z(t.errors.containerMissing);if(T.data("layoutContainer")&&T.data("layout"))return T.data("layout");var R={},xa={},ga={},sa={},Ia=f([]),N=v.container,ia=v.id,ba={options:t,state:v,container:T,panes:R,contents:xa,resizers:ga,togglers:sa,hide:qa,show:Sa,toggle:za,open:wa,close:Ma,slideOpen:Za,slideClose:ra,slideToggle:function(a){a=x.call(this,a);
za(a,!0)},setSizeLimits:D,_sizePane:la,sizePane:da,sizeContent:Pa,swapPanes:function(a,b){function c(a){var b=R[a],d=xa[a];return!b?!1:{pane:a,P:b?b[0]:!1,C:d?d[0]:!1,state:f.extend(!0,{},v[a]),options:f.extend(!0,{},t[a])}}function d(a,b){if(a){var c=a.P,e=a.C,j=a.pane,k=n[b],m=f.extend(!0,{},v[b]),o=t[b],p={resizerCursor:o.resizerCursor};f.each(["fxName","fxSpeed","fxSettings"],function(a,b){p[b+"_open"]=o[b+"_open"];p[b+"_close"]=o[b+"_close"];p[b+"_size"]=o[b+"_size"]});R[b]=f(c).data({layoutPane:ba[b],
layoutEdge:b}).css(n.hidden).css(k.cssReq);xa[b]=e?f(e):!1;t[b]=f.extend(!0,{},a.options,p);v[b]=f.extend(!0,{},a.state);c.className=c.className.replace(RegExp(o.paneClass+"-"+j,"g"),o.paneClass+"-"+b);ka(b);k.dir!=n[j].dir?(c=l[b]||0,D(b),c=g(c,v[b].minSize),da(b,c,!0,!0)):ga[b].css(k.side,N.inset[k.side]+(v[b].isVisible?S(b):0));a.state.isVisible&&!m.isVisible?na(b,!0):(jb(b),Na(b,!0));a=null}}if(H()){var e=x.call(this,a);v[e].edge=b;v[b].edge=e;if(!1===A("onswap_start",e)||!1===A("onswap_start",
b))v[e].edge=e,v[b].edge=b;else{var j=c(e),k=c(b),l={};l[e]=j?j.state.size:0;l[b]=k?k.state.size:0;R[e]=!1;R[b]=!1;v[e]={};v[b]={};sa[e]&&sa[e].remove();sa[b]&&sa[b].remove();ga[e]&&ga[e].remove();ga[b]&&ga[b].remove();ga[e]=ga[b]=sa[e]=sa[b]=!1;d(j,b);d(k,e);j=k=l=null;R[e]&&R[e].css(n.visible);R[b]&&R[b].css(n.visible);va();A("onswap_end",e);A("onswap_end",b)}}},showMasks:ma,hideMasks:Ha,initContent:Aa,addPane:ca,removePane:Ya,createChildren:$,refreshChildren:fa,enableClosable:La,disableClosable:function(a,
b){if(H()){var c=x.call(this,a),d=sa[c];d&&(t[c].closable=!1,v[c].isClosed&&wa(c,!1,!0),d.unbind("."+ia).css("visibility",b?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable:function(a){if(H()){var a=x.call(this,a),b=ga[a];b&&b.data("draggable")&&(t[a].slidable=!0,v[a].isClosed&&Na(a,!0))}},disableSlidable:function(a){if(H()){var a=x.call(this,a),b=ga[a];b&&(t[a].slidable=!1,v[a].isSliding?Ma(a,!1,!0):(Na(a,!1),b.css("cursor","default").attr("title",""),V(null,b[0])))}},
enableResizable:function(a){if(H()){var a=x.call(this,a),b=ga[a],c=t[a];b&&b.data("draggable")&&(c.resizable=!0,b.draggable("enable"),v[a].isClosed||b.css("cursor",c.resizerCursor).attr("title",c.tips.Resize))}},disableResizable:function(a){if(H()){var a=x.call(this,a),b=ga[a];b&&b.data("draggable")&&(t[a].resizable=!1,b.draggable("disable").css("cursor","default").attr("title",""),V(null,b[0]))}},allowOverflow:l,resetOverflow:d,destroy:function(a,b){f(window).unbind("."+ia);f(document).unbind("."+
ia);"object"===typeof a?x(a):b=a;T.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(t.containerClass).unbind("."+ia);Ia.remove();f.each(n.allPanes,function(a,c){Ya(c,!1,!0,b)});T.data("layoutCSS")&&!T.data("layoutRole")&&T.css(T.data("layoutCSS")).removeData("layoutCSS");"BODY"===N.tagName&&(T=f("html")).data("layoutCSS")&&T.css(T.data("layoutCSS")).removeData("layoutCSS");e(ba,f.layout.onDestroy);I();for(var c in ba)c.match(/^(container|options)$/)||delete ba[c];ba.destroyed=
!0;return ba},initPanes:H,resizeAll:va,runCallbacks:A,hasParentLayout:!1,children:B,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===function(){F();var a=t,b=v;b.creatingLayout=!0;e(ba,f.layout.onCreate);if(!1===A("onload_start"))return"cancel";var c=T[0],d=f("html"),g=N.tagName=c.tagName,j=N.id=c.id,k=N.className=c.className,c=t,l=c.name,m={},n=T.data("parentLayout"),o=T.data("layoutEdge"),s=n&&o,u=f.layout.cssNum,x;N.selector=T.selector.split(".slice")[0];N.ref=(c.name?c.name+" layout / ":
"")+g+(j?"#"+j:k?".["+k+"]":"");N.isBody="BODY"===g;!s&&!N.isBody&&(g=T.closest("."+f.layout.defaults.panes.paneClass),n=g.data("parentLayout"),o=g.data("layoutEdge"),s=n&&o);T.data({layout:ba,layoutContainer:ia}).addClass(c.containerClass);g={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(l in g)T.bind("layout"+l.toLowerCase()+"."+ia,ba[g[l]||l]);s&&(ba.hasParentLayout=!0,n.refreshChildren(o,ba));T.data("layoutCSS")||(N.isBody?(T.data("layoutCSS",f.extend(r(T,"position,margin,padding,border"),
{height:T.css("height"),overflow:T.css("overflow"),overflowX:T.css("overflowX"),overflowY:T.css("overflowY")})),d.data("layoutCSS",f.extend(r(d,"padding"),{height:"auto",overflow:d.css("overflow"),overflowX:d.css("overflowX"),overflowY:d.css("overflowY")}))):T.data("layoutCSS",r(T,"position,margin,padding,border,top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{m={overflow:"hidden",overflowX:"hidden",overflowY:"hidden"};T.css(m);c.inset&&!f.isPlainObject(c.inset)&&(x=parseInt(c.inset,
10)||0,c.inset={top:x,bottom:x,left:x,right:x});if(N.isBody)c.outset?f.isPlainObject(c.outset)||(x=parseInt(c.outset,10)||0,c.outset={top:x,bottom:x,left:x,right:x}):c.outset={top:u(d,"paddingTop"),bottom:u(d,"paddingBottom"),left:u(d,"paddingLeft"),right:u(d,"paddingRight")},d.css(m).css({height:"100%",border:"none",padding:0,margin:0}),p.isIE6?(T.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),c.inset||(c.inset=q(T).inset)):(T.css({width:"auto",height:"auto",
margin:0,position:"absolute"}),T.css(c.outset)),f.extend(N,q(T,c.inset));else{var y=T.css("position");(!y||!y.match(/(fixed|absolute|relative)/))&&T.css("position","relative");T.is(":visible")&&(f.extend(N,q(T,c.inset)),1>N.innerHeight&&z(c.errors.noContainerHeight.replace(/CONTAINER/,N.ref)))}u(T,"minWidth")&&T.parent().css("overflowX","auto");u(T,"minHeight")&&T.parent().css("overflowY","auto")}catch(B){}P();f(window).bind("unload."+ia,I);e(ba,f.layout.onLoad);a.initPanes&&O();delete b.creatingLayout;
return v.initialized}()?null:ba};f(function(){var a=f.layout.browser;a.msie&&(a.boxModel=f.support.boxModel)})})(l);(function(f){f.ui||(f.ui={});f.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(a){for(var g=document.cookie,g=g?g.split(";"):[],c,b=0,e=g.length;b<e;b++){c=f.trim(g[b]).split("=");if(c[0]==a)return decodeURIComponent(c[1])}return null},write:function(a,f,c){var b="",e="",k=false,c=c||{},j=c.expires;if(j&&j.toUTCString)e=j;else if(j===null||typeof j==="number"){e=new Date;
if(j>0)e.setDate(e.getDate()+j);else{e.setFullYear(1970);k=true}}e&&(b=b+(";expires="+e.toUTCString()));c.path&&(b=b+(";path="+c.path));c.domain&&(b=b+(";domain="+c.domain));c.secure&&(b=b+";secure");document.cookie=a+"="+(k?"":encodeURIComponent(f))+b},clear:function(a){f.ui.cookie.write(a,"",{expires:-1})}};f.cookie||(f.cookie=function(a,g,c){var b=f.ui.cookie;if(g===null)b.clear(a);else{if(g===void 0)return b.read(a);b.write(a,g,c)}});f.layout.plugins.stateManagement=!0;f.layout.config.optionRootKeys.push("stateManagement");
f.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}};f.layout.optionsMap.layout.push("stateManagement");f.layout.state={saveCookie:function(a,g,c){var b=a.options,e=b.stateManagement,c=f.extend(true,{},e.cookie,c||null),a=a.state.stateData=
a.readState(g||e.stateKeys);f.ui.cookie.write(c.name||b.name||"Layout",f.layout.state.encodeJSON(a),c);return f.extend(true,{},a)},deleteCookie:function(a){a=a.options;f.ui.cookie.clear(a.stateManagement.cookie.name||a.name||"Layout")},readCookie:function(a){a=a.options;return(a=f.ui.cookie.read(a.stateManagement.cookie.name||a.name||"Layout"))?f.layout.state.decodeJSON(a):{}},loadCookie:function(a){var g=f.layout.state.readCookie(a);if(g){a.state.stateData=f.extend(true,{},g);a.loadState(g)}return g},
loadState:function(a,g){g=f.layout.transformData(g);if(f.isPlainObject(g)&&!f.isEmptyObject(g)){a.state.stateData=g;var c=f.extend(true,{},g);f.each(f.layout.config.allPanes,function(a,e){c[e]&&delete c[e].children});f.extend(true,a.options,c)}},readState:function(a,g){f.type(g)==="string"&&(g={keys:g});g||(g={});var c=a.options.stateManagement,b=g.includeChildren,b=b!==void 0?b:c.includeChildren,c=g.stateKeys||c.stateKeys,e={isClosed:"initClosed",isHidden:"initHidden"},k=a.state,j=f.layout.config.allPanes,
l={},d,p,n,s,o,q;f.isArray(c)&&(c=c.join(","));for(var c=c.replace(/__/g,".").split(","),r=0,u=c.length;r<u;r++){d=c[r].split(".");p=d[0];d=d[1];if(!(f.inArray(p,j)<0)){n=k[p][d];if(n!=void 0){d=="isClosed"&&k[p].isSliding&&(n=true);(l[p]||(l[p]={}))[e[d]?e[d]:d]=n}}}b&&f.each(j,function(b,c){o=a.children[c];s=k.stateData[c];if(f.isPlainObject(o)&&!f.isEmptyObject(o)){q=l[c]||(l[c]={});if(!q.children)q.children={};f.each(o,function(a,b){b.state.initialized?q.children[a]=f.layout.state.readState(b):
s&&(s.children&&s.children[a])&&(q.children[a]=f.extend(true,{},s.children[a]))})}});return l},encodeJSON:function(a){function g(a){var b=[],e=0,k,j,l,d=f.isArray(a);for(k in a){j=a[k];l=typeof j;l=="string"?j='"'+j+'"':l=="object"&&(j=g(j));b[e++]=(!d?'"'+k+'":':"")+j}return(d?"[":"{")+b.join(",")+(d?"]":"}")}return g(a)},decodeJSON:function(a){try{return f.parseJSON?f.parseJSON(a):window.eval("("+a+")")||{}}catch(g){return{}}},_create:function(a){var g=f.layout.state,c=a.options.stateManagement;
f.extend(a,{readCookie:function(){return g.readCookie(a)},deleteCookie:function(){g.deleteCookie(a)},saveCookie:function(b,c){return g.saveCookie(a,b,c)},loadCookie:function(){return g.loadCookie(a)},loadState:function(b,c){g.loadState(a,b,c)},readState:function(b){return g.readState(a,b)},encodeJSON:g.encodeJSON,decodeJSON:g.decodeJSON});a.state.stateData={};if(c.autoLoad)if(f.isPlainObject(c.autoLoad))f.isEmptyObject(c.autoLoad)||a.loadState(c.autoLoad);else if(c.enabled)if(f.isFunction(c.autoLoad)){var b=
{};try{b=c.autoLoad(a,a.state,a.options,a.options.name||"")}catch(e){}b&&(f.isPlainObject(b)&&!f.isEmptyObject(b))&&a.loadState(b)}else a.loadCookie()},_unload:function(a){var g=a.options.stateManagement;if(g.enabled&&g.autoSave)if(f.isFunction(g.autoSave))try{g.autoSave(a,a.state,a.options,a.options.name||"")}catch(c){}else a.saveCookie()}};f.layout.onCreate.push(f.layout.state._create);f.layout.onUnload.push(f.layout.state._unload);f.layout.plugins.buttons=!0;f.layout.defaults.autoBindCustomButtons=
!1;f.layout.optionsMap.layout.push("autoBindCustomButtons");f.layout.buttons={init:function(a){var g=a.options.name||"",c;f.each(["toggle","open","close","pin","toggle-slide","open-slide"],function(b,e){f.each(f.layout.config.borderPanes,function(b,j){f(".ui-layout-button-"+e+"-"+j).each(function(){c=f(this).data("layoutName")||f(this).attr("layoutName");(c==void 0||c===g)&&a.bindButton(this,e,j)})})})},get:function(a,g,c,b){var e=f(g),a=a.options,k=a.errors.addButtonError;if(e.length)if(f.inArray(c,
f.layout.config.borderPanes)<0){f.layout.msg(k+" "+a.errors.pane+": "+c,true);e=f("")}else{g=a[c].buttonClass+"-"+b;e.addClass(g+" "+g+"-"+c).data("layoutName",a.name)}else f.layout.msg(k+" "+a.errors.selector+": "+g,true);return e},bind:function(a,g,c,b){var e=f.layout.buttons;switch(c.toLowerCase()){case "toggle":e.addToggle(a,g,b);break;case "open":e.addOpen(a,g,b);break;case "close":e.addClose(a,g,b);break;case "pin":e.addPin(a,g,b);break;case "toggle-slide":e.addToggle(a,g,b,true);break;case "open-slide":e.addOpen(a,
g,b,true)}return a},addToggle:function(a,g,c,b){f.layout.buttons.get(a,g,c,"toggle").click(function(e){a.toggle(c,!!b);e.stopPropagation()});return a},addOpen:function(a,g,c,b){f.layout.buttons.get(a,g,c,"open").attr("title",a.options[c].tips.Open).click(function(e){a.open(c,!!b);e.stopPropagation()});return a},addClose:function(a,g,c){f.layout.buttons.get(a,g,c,"close").attr("title",a.options[c].tips.Close).click(function(b){a.close(c);b.stopPropagation()});return a},addPin:function(a,g,c){var b=
f.layout.buttons,e=b.get(a,g,c,"pin");if(e.length){var k=a.state[c];e.click(function(e){b.setPinState(a,f(this),c,k.isSliding||k.isClosed);k.isSliding||k.isClosed?a.open(c):a.close(c);e.stopPropagation()});b.setPinState(a,e,c,!k.isClosed&&!k.isSliding);k.pins.push(g)}return a},setPinState:function(a,f,c,b){var e=f.attr("pin");if(!(e&&b===(e=="down"))){var a=a.options[c],e=a.buttonClass+"-pin",k=e+"-"+c,c=e+"-up "+k+"-up",e=e+"-down "+k+"-down";f.attr("pin",b?"down":"up").attr("title",b?a.tips.Unpin:
a.tips.Pin).removeClass(b?c:e).addClass(b?e:c)}},syncPinBtns:function(a,g,c){f.each(a.state[g].pins,function(b,e){f.layout.buttons.setPinState(a,f(e),g,c)})},_load:function(a){var g=f.layout.buttons;f.extend(a,{bindButton:function(b,c,f){return g.bind(a,b,c,f)},addToggleBtn:function(b,c,f){return g.addToggle(a,b,c,f)},addOpenBtn:function(b,c,f){return g.addOpen(a,b,c,f)},addCloseBtn:function(b,c){return g.addClose(a,b,c)},addPinBtn:function(b,c){return g.addPin(a,b,c)}});for(var c=0;c<4;c++)a.state[f.layout.config.borderPanes[c]].pins=
[];a.options.autoBindCustomButtons&&g.init(a)},_unload:function(){}};f.layout.onLoad.push(f.layout.buttons._load);f.layout.plugins.browserZoom=!0;f.layout.defaults.browserZoomCheckInterval=1E3;f.layout.optionsMap.layout.push("browserZoomCheckInterval");f.layout.browserZoom={_init:function(a){f.layout.browserZoom.ratio()!==false&&f.layout.browserZoom._setTimer(a)},_setTimer:function(a){if(!a.destroyed){var g=a.options,c=a.state,b=a.hasParentLayout?5E3:Math.max(g.browserZoomCheckInterval,100);setTimeout(function(){if(!a.destroyed&&
g.resizeWithWindow){var b=f.layout.browserZoom.ratio();if(b!==c.browserZoom){c.browserZoom=b;a.resizeAll()}f.layout.browserZoom._setTimer(a)}},b)}},ratio:function(){function a(a,b){return(parseInt(a,10)/parseInt(b,10)*100).toFixed()}var g=window,c=screen,b=document,e=b.documentElement||b.body,k=f.layout.browser,j=k.version,l,d,p;return k.msie&&j>8||!k.msie?false:c.deviceXDPI&&c.systemXDPI?a(c.deviceXDPI,c.systemXDPI):k.webkit&&(l=b.body.getBoundingClientRect)?a(l.left-l.right,b.body.offsetWidth):
k.webkit&&(d=g.outerWidth)?a(d,g.innerWidth):(d=c.width)&&(p=e.clientWidth)?a(d,p):false}};f.layout.onReady.push(f.layout.browserZoom._init)})(l)});define("RepositoryBrowser",["jquery","Class","PubSub","repository-browser-i18n-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jstree","jqgrid","jquery-layout"],function(l,f,a,g){function c(a){a.each(function(){k(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=
function(){return!1}})})}function b(a,b){a._cachedRepositoryObjects[b.uid]=b}function e(a,c){var f=++d,g=!1===a.hasMoreItems||"folder"!==a.baseType?null:"closed",j=null;if(a.children){var g="open",j=[],k,m;for(k=0;k<a.children.length;k++)m=e(a.children[k],c),j.push(m),b(c,m.resource)}k=l.extend(a,{uid:f,loaded:!1});m={rel:a.type,"data-repo-obj":f};var p=a.name,v;a:switch(a.baseType){case "folder":v="folder";break a;case "document":v="document";break a;default:v=""}return{state:g,resource:k,children:j,
attr:m,data:{title:p,icon:v,attr:{"data-repo-obj":f}}}}var k=l,j=[],m=0,d=(new Date).getTime(),p={repositoryManager:null,repositoryFilter:[],objectTypeFilter:[],renditionFilter:["cmis:none"],filter:["url"],element:null,isFloating:!1,verticalPadding:100,horizontalPadding:50,maxHeight:1E3,minHeight:400,minWidth:400,maxWidth:1200,treeWidth:300,listWidth:"auto",pageSize:8,adaptPageSize:!1,rowHeight:32,rootPath:"",rootFolderId:"aloha",columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",
width:200,sorttype:"text"},url:{title:"URL",width:220,sorttype:"text"},preview:{title:"Preview",width:150,sorttype:"text"}},i18n:{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing"}};return f.extend({_cachedRepositoryObjects:{},_searchQuery:null,_orderBy:null,_prefilledValue:null,$_grid:null,$_tree:null,$_list:null,_isOpened:!0,
_constructor:function(){this.init.apply(this,arguments)},init:function(b){b=k.extend({},p,b,{i18n:g});if(!b.element||0===b.element.length)b.isFloating=!0,b.element=this._createOverlay();b.maxWidth<b.minWidth&&(b.maxWidth=b.minWidth);k.extend(this,b);this._prefilledValue=this._i18n("Input search text...");this._cachedRepositoryObjects={};this._pagingCount=this._orderBy=this._searchQuery=null;this._pagingOffset=0;this._pagingBtns={first:null,end:null,next:null,prev:null};this._initializeUI();j.push(this);
a.pub("repository-browser.initialized",{data:this})},_i18n:function(a){return this.i18n[a]||a},_initializeUI:function(){this.element.attr("data-repository-browser",++d);this.element.width(this.maxWidth);this.$_grid=this._createGrid(this.element).resize();this._setInitialHeight();this.$_tree=this._createTree(this.$_grid.find(".ui-layout-west"));this.$_list=this._createList(this.$_grid.find(".ui-layout-center"));var a=this,b=this.treeWidth/5;this.$_grid.layout({enableCursorHotkey:!1,west__size:this.treeWidth-
1,west__minSize:this.treeWidth-b,west__maxSize:this.treeWidth+b,center__size:"auto",paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",onresize:function(b,c){"center"===b&&a.$_list.setGridWidth(c.width())}}).sizePane("west",this.treeWidth);c(this.$_grid);this._preloadImages();k(function(){k(window).resize(function(){a._onWindowResized()})});this.element.mousedown(function(){k.each(j,function(a){this.element.css("z-index",99999+a)});k(this).css("z-index",99999+
j.length+1)});k(".repository-browser-grid").css("width",this.maxWidth);this.close();this._adaptPageSize()},_setInitialHeight:function(){var a=this.maxHeight-k(window).height()+this.verticalPadding;this.$_grid.height(0<a?Math.max(this.minHeight,this.maxHeight-a):this.maxHeight)},_onWindowResized:function(){var a=this.maxWidth-k(window).width()+this.horizontalPadding,a=0<a?Math.max(this.minWidth,this.maxWidth-a):this.maxWidth;this.element.width(a);this.$_grid.width(a);this._setInitialHeight();a=this.$_grid.find(".repository-browser-tree-header");
this.$_tree.height(this.$_grid.height()-a.outerHeight(!0));a=this.$_grid.find(".ui-layout-center");a.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(a.find(".ui-jqgrid-titlebar").height()+a.find(".ui-jqgrid-hdiv").height()+a.find(".ui-jqgrid-pager").height()));this._adaptPageSize()&&this._currentFolder&&this._fetchItems(this._currentFolder)},_preloadImages:function(){for(var a=this.rootPath+"img/",b="arrow-000-medium.png arrow-180.png arrow-315-medium.png arrow-stop-180.png arrow-stop.png arrow.png control-stop-square-small.png folder-horizontal-open.png folder-open.png magnifier-left.png page.png picture.png sort-alphabet-descending.png sort-alphabet.png".split(" "),
c=b.length;c;)document.createElement("img").src=a+b[--c]},_processRepoResponse:function(a,c,d){"function"===typeof c&&(d=c,c=void 0);var f=this,g=[],j=f._currentFolder&&f._currentFolder.id,k=null,l,m;for(m=0;m<a.length;m++)l=e(a[m],f),g.push(l),b(f,l.resource),j===l.resource.id&&(k=l.resource);d(g,c);k&&window.setTimeout(function(){f.$_tree.jstree("select_node",'li[data-repo-obj="'+k.uid+'"]')},0)},_fetchRepoRoot:function(a){this._currentFolder||(this._currentFolder=this.getSelectedFolder());this.repositoryManager&&
this.getRepoChildren({inFolderId:this.rootFolderId,repositoryFilter:this.repositoryFilter},a)},_getObjectFromCache:function(a){return a&&a.length?this._cachedRepositoryObjects[a.find("a:first").attr("data-repo-obj")]:null},_onTreeNodeSelected:function(a,b){if(!b.args[0].context){var c;if(c=this._cachedRepositoryObjects[b.rslt.obj.find("a:first").attr("data-repo-obj")])this._pagingOffset=0,this._currentFolder=c,this._clearSearch(),this._fetchItems(c),this.folderSelected(c)}},_createTree:function(a){var b=
k('<div class="repository-browser-tree">'),c=k('<div class="repository-browser-tree-header repository-browser-grab-handle">'+this._i18n("Repository Browser")+"</div>");a.append(c,b);b.height(this.$_grid.height()-c.outerHeight(!0));b.bind("loaded.jstree",function(){l(this).find(">ul>li:first").css("padding-top",5);l(this).find('li[rel="repository"]:first').each(function(a,c){b.jstree("open_node",c)})});var d=this;b.bind("select_node.jstree",function(a,b){d._onTreeNodeSelected(a,b)});b.bind("open_node.jstree",
function(a,b){d.folderOpened(b.rslt.obj)});b.bind("close_node.jstree",function(a,b){d.folderClosed(b.rslt.obj)});b.jstree({types:this.types,rootFolderId:this.rootFolderId,plugins:["themes","json_data","ui","types"],core:{animation:250},themes:{url:this.rootPath+"css/jstree.css",dots:!0,icons:!0,theme:"browser"},json_data:{data:function(a,b){d.repositoryManager?(d.jstree_callback=b,d._fetchSubnodes(a,b)):b()},correct_state:!0},ui:{select_limit:1}});return b},_createGrid:function(a){var b=k('<div class="repository-browser-grid\t\t\t\t             repository-browser-shadow\t\t\t\t\t\t\t repository-browser-rounded-top">\t\t\t\t\t<div class="ui-layout-west"></div>\t\t\t\t\t<div class="ui-layout-center"></div>\t\t\t\t</div>');
a.append(b);return b},_createList:function(a){var b=k('<table id="repository-browser-list-'+ ++d+'" class="repository-browser-list"></table>'),c=[{name:"id",sorttype:"int",firstsortorder:"asc",hidden:!0}],e=[""];k.each(this.columns,function(a,b){e.push(b.title||"&nbsp;");c.push({name:a,width:b.width,sortable:b.sortable,sorttype:b.sorttype,resizable:b.resizable,fixed:b.fixed})});var f="repository-browser-list-page-"+ ++d;a.append(b,k('<div id="'+f+'">'));b.jqGrid({datatype:"local",width:a.width(),
shrinkToFit:!0,colNames:e,colModel:c,caption:"&nbsp;",altRows:!0,altclass:"repository-browser-list-altrow",resizeclass:"repository-browser-list-resizable",pager:"#"+f,viewrecords:!0,onPaging:function(){},loadError:function(){},ondblClickRow:function(){},gridComplete:function(){},loadComplete:function(){}});a.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(a.find(".ui-jqgrid-titlebar").height()+a.find(".ui-jqgrid-hdiv").height()+a.find(".ui-jqgrid-pager").height()));var g=this;b.click(function(){g.rowClicked.apply(g,
arguments)});a.find(".ui-pg-button").unbind().find(">span.ui-icon").each(function(){var a=this.className.match(/ui\-icon\-seek\-([a-z]+)/)[1];g._pagingBtns[a]=k(this).parent().addClass("ui-state-disabled").click(function(){k(this).hasClass("ui-state-disabled")||g._doPaging(a)})});a.find(".ui-pg-input").parent().hide();a.find(".ui-separator").parent().css("opacity",0).first().hide();this._createTitlebar(a);var j=b[0].p;a.find(".ui-jqgrid-view tr:first th div").each(function(a){!1!==j.colModel[a].sortable&&
(k(this).css("cursor","pointer"),k(this).unbind().click(function(b){b.stopPropagation();g._sortList(j.colModel[a],this)}))});return b},_clearSearch:function(){this.$_grid.find(".repository-browser-search-field").val(this._prefilledValue).addClass("repository-browser-search-field-empty");this._searchQuery=null},_createTitlebar:function(a){var a=a.find(".ui-jqgrid-titlebar"),b=k('<div class="repository-browser-btns">\t\t\t\t\t<input type="text" class="repository-browser-search-field" />\t\t\t\t\t<span class="repository-browser-btn repository-browser-search-btn">\t\t\t\t\t\t<span class="repository-browser-search-icon"></span>\t\t\t\t\t</span>\t\t\t\t\t<span class="repository-browser-btn repository-browser-close-btn">'+
this._i18n("Close")+'</span>\t\t\t\t\t<div class="repository-browser-clear"></div>\t\t\t\t</div>'),c=this;a.addClass("repository-browser-grab-handle").append(b);a.find(".repository-browser-search-btn").html(this._i18n("Search")).click(function(){c._triggerSearch()});b=a.find(".repository-browser-search-field");this._clearSearch();b.keypress(function(a){13===a.keyCode&&c._triggerSearch()});b.focus(function(){k(this).val()===c._prefilledValue&&k(this).val("").removeClass("repository-browser-search-field-empty")});
b.blur(function(){""===k(this).val()&&c._clearSearch()});a.find(".repository-browser-close-btn").click(function(){c.close()});a.find(".repository-browser-btn").mousedown(function(){k(this).addClass("repository-browser-pressed")}).mouseup(function(){k(this).removeClass("repository-browser-pressed")})},_triggerSearch:function(){var a=this.$_grid.find("input.repository-browser-search-field"),b=a.val();if(k(a).hasClass("aloha-browser-search-field-empty")||""===b)b=null;this._pagingOffset=0;this._searchQuery=
b;this._fetchItems(this._currentFolder)},_sortList:function(a,b){this.$_grid.find("span.ui-grid-ico-sort").addClass("ui-state-disabled");a.sortorder="asc"===a.sortorder?"desc":"asc";k(b).find("span.s-ico").show().find(".ui-icon-"+a.sortorder).removeClass("ui-state-disabled");this._setSortOrder(a.name,a.sortorder);this._fetchItems(this._currentFolder)},_doPaging:function(a){switch(a){case "first":this._pagingOffset=0;break;case "end":this._pagingOffset=0===this._pagingCount%this.pageSize?this._pagingCount-
this.pageSize:this._pagingCount-this._pagingCount%this.pageSize;break;case "next":this._pagingOffset+=this.pageSize;break;case "prev":this._pagingOffset-=this.pageSize,0>this._pagingOffset&&(this._pagingOffset=0)}this._fetchItems(this._currentFolder)},_setSortOrder:function(a,b){var c={},d=!1,e=this._orderBy||[],f,g,j;c[a]=b||"asc";for(j=0;j<e.length;++j){f=e[j];for(g in f)if(f.hasOwnProperty(g)&&g===a){e.splice(j,1);e.unshift(c);d=!0;break}if(d)break}d&&e.unshift(c);this._orderBy=e},_listItems:function(a){var b=
this.$_list.clearGridData(),c,d;for(c=0;c<a.length;c++)d=a[c].resource,b.addRowData(d.uid,k.extend({id:d.id},this.renderRowCols(d)))},handleTimeout:function(){},_processItems:function(a,b){this._pagingCount=b&&k.isNumeric(b.numItems)?b.numItems:null;this.$_grid.find(".loading").hide();this.$_list.show();this._listItems(a);var c=this._pagingBtns;0>=this._pagingOffset?c.first.add(c.prev).addClass("ui-state-disabled"):c.first.add(c.prev).removeClass("ui-state-disabled");k.isNumeric(this._pagingCount)?
this._pagingOffset+this.pageSize>=this._pagingCount?c.end.add(c.next).addClass("ui-state-disabled"):c.end.add(c.next).removeClass("ui-state-disabled"):(c.end.addClass("ui-state-disabled"),a.length<=this.pageSize?c.next.addClass("ui-state-disabled"):c.next.removeClass("ui-state-disabled"));var d;0===a.length&&0===this._pagingOffset?d=c=0:(c=this._pagingOffset+1,d=c+a.length-1);this.$_grid.find(".ui-paging-info").html(this._i18n("Viewing")+" "+c+" - "+d+" "+this._i18n("of")+" "+(k.isNumeric(this._pagingCount)?
this._pagingCount:this._i18n("numerous")));b&&b.timeout&&this.handleTimeout()},_createOverlay:function(){0===k(".repository-browser-modal-overlay").length&&k("body").append('<div class="repository-browser-modal-overlay" style="top: -99999px; z-index: 99999;"></div>');var a=this;k(".repository-browser-modal-overlay").click(function(){a.close()});var b=k('<div class="repository-browser-modal-window" style="top: -99999px; z-index: 99999;">');k("body").append(b);return b},_fetchSubnodes:function(a,b){if(-1===
a)this._fetchRepoRoot(b);else{var c;for(c=0;c<a.length;c++){var d=this._getObjectFromCache(a.eq(c));d&&this.fetchChildren(d,b)}}},getRepoChildren:function(a,b){if(this.repositoryManager){var c=this;this.repositoryManager.getChildren(a,function(a){c._processRepoResponse(a,b)})}},queryRepository:function(a,b){if(this.repositoryManager){var c=this;this.repositoryManager.query(a,function(a){c._processRepoResponse(0<a.results?a.items:[],{numItems:a.numItems,hasMoreItems:a.hasMoreItems,timeout:a.timeout},
b)})}},renderRowCols:function(a){var b={};k.each(this.columns,function(c){switch(c){case "icon":b.icon='<div class="repository-browser-icon repository-browser-icon-'+a.type+'"></div>';break;default:b[c]=a[c]||"--"}});return b},onSelect:function(){},fetchChildren:function(a,b){if((!0===a.hasMoreItems||"folder"===a.baseType)&&!1===a.loaded){var c=this;this.getRepoChildren({inFolderId:a.id,repositoryId:a.repositoryId},function(d){c._cachedRepositoryObjects[a.uid].loaded=!0;"function"===typeof b&&b(d)})}},
rowClicked:function(a){a=k(a.target).parent("tr");return a.length?(a=this._cachedRepositoryObjects[a.attr("id")],this.onSelect(a),a):null},getFieldOfHeader:function(a){return a.find("div.ui-jqgrid-sortable").attr("id").replace("jqgh_","")},_fetchItems:function(a){if(a){var b="string"===typeof this._searchQuery;this.$_list.setCaption("string"===typeof this._searchQuery?this._i18n("Searching for")+' "'+this._searchQuery+'" '+this._i18n("in")+" "+a.name:this._i18n("Browsing")+": "+a.name);this.$_list.hide();
this.$_grid.find(".loading").show();var c=this;this.queryRepository({repositoryId:a.repositoryId,inFolderId:a.id,queryString:this._searchQuery,orderBy:this._orderBy,skipCount:this._pagingOffset,maxItems:this.pageSize,objectTypeFilter:this.objectTypeFilter,renditionFilter:this.renditionFilter,filter:this.filter,recursive:b},function(a,b){c._processItems(a,b)})}},setObjectTypeFilter:function(a){this.objectTypeFilter="string"===typeof a?[a]:a},getObjectTypeFilter:function(){return this.objectTypeFilter},
show:function(){this.open()},open:function(){if(!this._isOpened){this._isOpened=!0;var a=this.element;this.isFloating?(k(".repository-browser-modal-overlay").stop().css({top:0,left:0}).show(),a.stop().show(),this._onWindowResized(),this.$_grid.resize(),k(window),a.css({left:this.horizontalPadding/2,top:this.verticalPadding/2}).draggable({handle:a.find(".repository-browser-grab-handle")}),this.$_grid.css({marginTop:0,opacity:0}).animate({marginTop:0,opacity:1},1500,"easeOutExpo",function(){k.browser.msie&&
k(this).add(a).css("filter","progid:DXImageTransform.Microsoft.gradient(enabled=false)")})):(a.stop().show().css({opacity:1,filter:"progid:DXImageTransform.Microsoft.gradient(enabled=false)"}),this._onWindowResized(),this.$_grid.resize());++m}},close:function(){this._isOpened&&(this._isOpened=!1,this.element.fadeOut(250,function(){k(this).css("top",0).hide();(0===m||0===--m)&&k(".repository-browser-modal-overlay").hide()}))},refresh:function(){this._currentFolder&&this._fetchItems(this._currentFolder)},
folderOpened:function(a){(a=this._cachedRepositoryObjects[a.find("a:first").attr("data-repo-obj")])&&this.repositoryManager.folderOpened(a)},folderClosed:function(a){(a=this._getObjectFromCache(a))&&this.repositoryManager&&this.repositoryManager.folderClosed(a)},folderSelected:function(a){this.repositoryManager&&this.repositoryManager.folderSelected(a)},getSelectedFolder:function(){if(this.repositoryManager&&"function"===typeof this.repositoryManager.getSelectedFolder)return this.repositoryManager.getSelectedFolder()},
_adaptPageSize:function(){var a;if(!this.adaptPageSize||!this.$_list||!this.rowHeight)return!1;if(a=this.$_grid.find(".ui-jqgrid-bdiv").innerHeight()-20)if(a=Math.floor(a/this.rowHeight),0>=a&&(a=1),a!==this.pageSize)return this.pageSize=a,!0;return!1}})});define("repository-browser-i18n-de",[],function(){return{Browsing:"Durchsuchen",Close:"Schließen","in":"in","Input search text...":"Suchtext einfügen...",numerous:"zahlreiche",of:"von","Repository Browser":"Repository Browser",Search:"Suchen","Searching for":"Suche nach",
Viewing:"Anzeige","button.switch-metaview.tooltip":"Zwischen Metaansicht und normaler Ansicht umschalten"}});define("repository-browser-i18n-en",[],function(){return{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing","button.switch-metaview.tooltip":"Switch between meta and normal view"}});define("linkbrowser/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link",
"button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("linkbrowser/linkbrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button link/link-plugin RepositoryBrowser i18n!linkbrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b,e,k,j){var m=k.extend({init:function(a){this._super(a);var e=this;this._linkBrowserButton=c.adopt("linkBrowser",b,{tooltip:j.t("button.addlink.tooltip"),
icon:"aloha-icon-tree",scope:"Aloha.continuoustext",click:function(){e.show()}});this._linkBrowserButton.hide();this.url=l.getAlohaUrl()+"/../plugins/extra/linkbrowser/";l.bind("aloha-link-selected",function(){e._linkBrowserButton.show()});l.bind("aloha-link-unselected",function(){e._linkBrowserButton.hide()})},onSelect:function(a){e.hrefField.setItem(a);var b=l.Selection.getRangeObject(),c=b.startContainer=b.endContainer,f=b.startOffset=b.endOffset;b.select();b.startContainer=b.endContainer=c;b.startOffset=
b.endOffset=f;b.select();l.trigger("aloha-link-selected-in-linkbrowser",a);this.close()},renderRowCols:function(a){var b={},c=this.url;a.id.match(/(\d+)\./);f.each(this.columns,function(e){switch(e){case "icon":b.icon='<div class="aloha-browser-icon\t\t\t\t\t\taloha-browser-icon-__page__"></div>';break;case "translations":if(!a.renditions)break;for(var e=a.renditions,f=e.length,g=[],j;f>0;--f){j=e[f];j.kind=="translation"&&g.push('<img src="'+c+"img/flags/"+j.language+'.png"\t\t\t\t\t\t\t\t\t  alt="'+
j.language+'"\t\t\t\t\t\t\t\t\t  title="'+j.filename+'" />')}b.translations=g.join("");break;case "language":b.language=a.language;break;default:b[e]=a[e]||"--"}});return b}});return a.create("linkbrowser",{dependencies:["link"],browser:null,init:function(){this.browser=new m({repositoryManager:l.RepositoryManager,repositoryFilter:[],objectTypeFilter:["website","file","image","language"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:30,sortable:false,resizable:false},name:{title:"Name",
width:320,sorttype:"text"},language:{title:"",width:30,sorttype:"text"},translations:{title:"",width:350,sorttype:"text"}},rootPath:l.settings.baseUrl+"/vendor/repository-browser/"})}})});define("imagebrowser/nls/i18n",{root:{"button.addimage.tooltip":"Insert Image","button.removeimage.tooltip":"Remove Image","newimage.defaulttext":"New Image","floatingmenu.tab.img":"Image"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("imagebrowser/imagebrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button image/image-plugin RepositoryBrowser i18n!imagebrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),
function(l,f,a,g,c,b,e,k,j){var m=k.extend({init:function(a){this._super(a);var e=this;this._imageBrowserButton=c.adopt("imageBrowser",b,{tooltip:j.t("button.addimage.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext","class":"aloha-imagebrowser-button",click:function(){e.open()}});this._imageBrowserButton.show(false);this.url=l.getAlohaUrl()+"/../plugins/extra/imagebrowser/";l.bind("aloha-image-selected",function(){e._imageBrowserButton.show(true)});l.bind("aloha-image-unselected",function(){e._imageBrowserButton.show(false)})},
onSelect:function(a){if(a.type.match("image")!==null){e.ui.imgSrcField.setItem(a);e.resetSize();this.close()}},listItems:function(a){var b=this,c=this.list.clearGridData();f.each(a,function(){var a=this.resource;a.type.match("image")!==null&&c.addRowData(a.uid,f.extend({id:a.id},b.renderRowCols(a)))})},renderRowCols:function(a){var b={};a.id.match(/(\d+)\./);f.each(this.columns,function(c){switch(c){case "icon":if(!a.renditions)break;if(a.renditions.length===1&&a.renditions[0].kind==="thumbnail")b.icon=
'<img width="'+a.renditions[0].width+'" height="'+a.renditions[0].height+' " src="'+a.renditions[0].url+'"/>';break;default:b[c]=a[c]||"--"}});return b}});return a.create("imagebrowser",{dependencies:["image"],browser:null,init:function(){this.browser=new m({repositoryManager:l.RepositoryManager,repositoryFilter:[],objectTypeFilter:["image"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:75,sortable:false,resizable:false},name:{title:"Name",width:320,sorttype:"text"}},rootPath:l.settings.baseUrl+
"/vendor/repository-browser/"})}})});define("ui/menuButton",["jquery","ui/component","ui/utils","jqueryui"],function(l,f,a){function g(b,e){var f=[];l.each(e,function(d,e){var j=l("<li>");j.append(l("<a>",{href:"javascript:void 0",html:a.makeButtonLabelWithIcon(e)}));e.click&&j.data("aloha-ui-menubutton-select",function(){b();e.click()});if(e.menu){var s=l("<ul>").appendTo(j);s.append(g(c(s,b),e.menu))}f.push(j[0])});return f}function c(a,b){b=b||l.noop;return function(){a.blur().hide();a.parent().removeClass("aloha-ui-menubutton-pressed");
b()}}function b(a,b){var c=b.item.data("aloha-ui-menubutton-select");c&&c(a,b);a.preventDefault()}var e=f.extend({init:function(){this.element=e.makeMenuButton(this)}});e.makeMenuButton=function(e){function f(a){a.hide().parent().removeClass("aloha-ui-menubutton-pressed")}var m=l("<div>",{"class":"aloha-ui-menubutton-container"}),d=a.makeButtonElement({"class":"aloha-ui-menubutton-expand"}),p=l("<ul>",{"class":"aloha-ui-menubutton-menu"}),n=null,s=null;l.browser.msie&&m.addClass("aloha-ui-menubutton-iehack");
e.click?(n=a.makeButton(a.makeButtonElement({"class":"aloha-ui-menubutton-action"}),e).click(e.click),a.makeButton(d,{},!0),s=l("<div>").buttonset().append(n).append(d)):a.makeButton(d,e,!0).addClass("aloha-ui-menubutton-single");if(!e.menu)return m.append(n);d.click(function(){m.addClass("aloha-ui-menubutton-pressed");e.siblingContainer&&e.siblingContainer.find(".aloha-ui-menubutton-menu").each(function(){this!==p[0]&&f(l(this))});if(p.is(":visible"))f(p);else{p.show().position({my:"left top",at:"left bottom",
of:n||d});l(document).bind("click",function(a){l(this).unbind(a);p.hide();m.removeClass("aloha-ui-menubutton-pressed")});return false}});m.append(s||d).append(p);p.append(g(c(p),e.menu));p.hide().menu({select:b});return m};return e});define("ribbon/ribbon-plugin",["jquery","aloha/plugin","ui/menuButton","ui/utils","jqueryui"],function(l,f,a,g){return f.create("ribbon",{init:function(){if(this.settings.enable||"undefined"===typeof this.settings.enable){var a=this;this._visible=!1;this._toolbar=l("<div>",
{"class":"aloha-ribbon-toolbar ui-menubar ui-widget-header ui-helper-clearfix"});var b=g.makeButtonElement({"class":"aloha-ribbon-in"}).button().hide().click(function(){a._toolbar.animate({left:0});l("body").animate({paddingTop:30});b.hide()}).appendTo(this._toolbar);g.makeButtonElement({"class":"aloha-ribbon-out"}).button().click(function(){a._toolbar.animate({left:-a._toolbar.outerWidth()+b.outerWidth()+10});l("body").animate({paddingTop:0});b.show()}).appendTo(this._toolbar);var e=l("<div>",{"class":"aloha aloha-ribbon"}).appendTo("body");
this._icon=l("<div>").prependTo(this._toolbar);this.setIcon("");this._toolbar.appendTo(e);l("body").css({position:"relative",paddingTop:30})}},setIcon:function(a){this._icon&&this._icon.attr("class","aloha-ribbon-icon "+a)},addButton:function(c){this._toolbar&&(c=l.extend({},c,{siblingContainer:this._toolbar}),this._toolbar.append(a.makeMenuButton(c)))},hide:function(){this._toolbar&&(this._toolbar.hide(),this._visible=!1)},show:function(){this._toolbar&&(this._toolbar.show(),this._visible=!0)},isVisible:function(){return this._visible}})});
define("wai-lang/nls/i18n",{root:{"floatingmenu.tab.wai-lang":"Language annotation","button.add-wai-lang-remove.tooltip":"Remove language annotation","button.add-wai-lang.tooltip":"Add language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("wai-lang/languages",["aloha","jquery","flag-icons/flag-icons-plugin","aloha/console","wai-lang/wai-lang-plugin"],function(l,f,a,g){var c=f.Deferred();return new (l.AbstractRepository.extend({languageCodes:[],locale:"de",iso:"iso639-1",
flags:!1,_constructor:function(){this._super("wai-languages")},init:function(){var a=this,e=l.require("wai-lang/wai-lang-plugin"),f=e.iso639;"de"!==l.settings.locale&&(this.locale="en");"iso639-1"!==f&&(this.iso="iso639-2");this.flags=e.flags;this.repositoryName="WaiLanguages";l.require(["wai-lang/"+this.iso+"-"+this.locale],function(e){a.storeLanguageCodes(e);c.resolve()})},markObject:function(){},errorHandler:function(a){g.log("error",this,"Error while loading languages. "+a)},storeLanguageCodes:function(b){var c=
this,g=l.getPluginUrl("wai-lang");f.each(b,function(b,f){f.id=b;f.repositoryId=c.repositoryId;f.type="language";c.flags&&(f.url=f.flag?a.path+"/img/flags/"+f.flag+".png":g+"/img/button.png");c.languageCodes.push(new l.RepositoryDocument(f))})},_searchInLanguageCodes:function(a,c){var g=RegExp("^"+a.queryString,"i"),j,l=[],d,p,n;for(j=0;j<this.languageCodes.length;++j)n=this.languageCodes[j],d=!a.queryString||n.name.match(g),p=!a.objectTypeFilter||!a.objectTypeFilter.length||-1<f.inArray(n.type,a.objectTypeFilter),
d&&p&&l.push(n);c.call(this,l)},query:function(a,e){var f=this;c.done(function(){f._searchInLanguageCodes(a,e)})},getObjectById:function(a,c){var f,g;for(f=0;f<this.languageCodes.length;++f)if(g=this.languageCodes[f],g.id===a){c.call(this,[g]);break}}}))});define("wai-lang/wai-lang-plugin","aloha jquery PubSub aloha/plugin aloha/selection util/dom ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field i18n!wai-lang/nls/i18n wai-lang/languages".split(" "),function(l,f,a,g,c,b,e,k,
j,m,d,p){function n(a){if(a){a.foreground();a.focus()}k.setScope("wai-lang")}function s(){var a=f(this);return a.hasClass(v)||a.is("[lang]")}function o(a){return l.activeEditable?a.findMarkup(s,l.activeEditable.obj):null}function q(a){a.isCollapsed()&&b.extendToWord(a);b.addMarkup(a,f('<span class="'+v+'"></span>'),false);a.select()}function r(a){var c=o(a);if(c){b.removeFromDOM(c,a,true);a.select()}}function u(){if(l.activeEditable){var a=c.getRangeObject();if(o(a))r(a);else{q(a);n(B)}}}function x(a){B=
d({name:"wailangfield",width:320,valueField:"id",minChars:1,scope:"wai-lang"});a._wailangButton=e.adopt("wailang",m,{tooltip:p.t("button.add-wai-lang.tooltip"),icon:"aloha-icon aloha-icon-wai-lang",scope:"Aloha.continuoustext",click:u});e.adopt("removewailang",j,{tooltip:p.t("button.add-wai-lang-remove.tooltip"),icon:"aloha-icon aloha-icon-wai-lang-remove",scope:"wai-lang",click:function(){r(c.getRangeObject())}});k.createScope("wai-lang","Aloha.continuoustext");B.setTemplate(a.flags?'<div class="aloha-wai-lang-img-item"><img class="aloha-wai-lang-img" src="{url}" /><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>':
'<div class="aloha-wai-lang-img-item"><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>');B.setObjectTypeFilter(a.objectTypeFilter)}function t(b){a.sub("aloha.editable.activated",function(a){var a=a.data.editable,c=a.getId()+":"+b._instanceId;z[c]||(z[c]=b.getEditableConfig(a.obj));f.inArray("span",z[c])>-1?b._wailangButton.show():b._wailangButton.hide()});l.bind("aloha-selection-changed",function(a,c){var d=o(c);if(d){b._wailangButton.setState(true);B.setTargetObject(d,"lang");k.setScope("wai-lang")}else{b._wailangButton.setState(false);
B.setTargetObject(null)}});B.addListener("blur",function(){this.getValue()||r(c.getRangeObject())});l.bind("aloha-editable-created",function(a,d){d.obj.bind("keydown",b.hotKey.insertAnnotation,function(){var a=c.getRangeObject();o(a)||q(a);n(B);return false});d.obj.find("span[lang]").each(function(){var a=f(this);a.addClass(v).attr("data-gentics-aloha-repository","wai-languages").attr("data-gentics-aloha-object-id",a.attr("lang"))})})}var v="aloha-wai-lang",B=null,C=function(a){var b=0;return function(){return a+
"-"+ ++b}}(),z={};return g.create("wai-lang",{config:["span"],iso639:"iso639-1",flags:false,objectTypeFilter:["language"],hotKey:{insertAnnotation:p.t("insertAnnotation","ctrl+shift+l")},init:function(){this._instanceId=C("wai-lang");if(this.settings.objectTypeFilter)this.objectTypeFilter=this.settings.objectTypeFilter;this.settings.hotKey&&f.extend(true,this.hotKey,this.settings.hotKey);if(this.settings.iso639)this.iso639=this.settings.iso639;this.flags=true===this.settings.flags||1===this.settings.flags||
"true"===this.settings.flags||"1"===this.settings.flags;x(this);t(this)},formatLanguageSpan:u,makeClean:function(a){a.find("span[lang]").each(function(){var a=f(this);a.removeClass(v).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id").attr("xml:lang",a.attr("lang"))})}})});define("headerids/nls/i18n",{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset","headerids.button.set":"Set",internal_hyperlink:"Internal Hyperlink"},ca:!0,de:!0,mk:!0,"pt-br":!0,
ru:!0,uk:!0,"zh-hans":!0});define("headerids/headerids-plugin","aloha jquery PubSub aloha/plugin util/html i18n!headerids/nls/i18n".split(" "),function(l,f,a,g,c,b){function e(){var a=[],b=m;j.each(arguments,function(){a.push("."+(this==""?b:b+"-"+this))});return f.trim(a.join(" "))}function k(){var a=[],b=m;j.each(arguments,function(){a.push(this==""?b:b+"-"+this)});return f.trim(a.join(" "))}var j=f,m="aloha-headerids";return g.create("headerids",{_constructor:function(){this._super("headerids")},
config:["true"],init:function(){var b=this,c=function(a){b.check(a.data.obj||a.data.editable.obj)};a.sub("aloha.editable.created",c);a.sub("aloha.editable.activated",c);a.sub("aloha.editable.deactivated",c);l.bind("aloha-plugins-loaded",function(){b.initSidebar(l.Sidebar.right)})},check:function(a){var b=this;j.inArray("true",b.getEditableConfig(a))>-1&&a.find("h1,h2,h3,h4,h5,h6").not(".aloha-customized,.aloha-editable,.aloha-block").each(function(a,c){b.processH(c)})},processH:function(a){if(!a.id){for(var a=
j(a),b=this.sanitize(a.text()),c=b,e=1;j("#"+b).length>0;)b=c+"_"+(++e).toString();a.attr("id",b)}},sanitize:function(a){return c.trimWhitespaceCharacters(a).replace(/[^a-z0-9]+/gi,"_")},initSidebar:function(a){var c=this;c.sidebar=a;a.addPanel({id:k("sidebar-panel"),title:b.t("internal_hyperlink"),content:"",expanded:true,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var a=this,d=this.setContent('<label class="'+k("label")+'" for="'+k("input")+'">'+b.t("headerids.label.target")+'</label><input id="'+
k("input")+'" class="'+k("input")+'" type="text" name="value"/> <button class="'+k("reset-button")+'">'+b.t("headerids.button.reset")+'</button><button class="'+k("set-button")+'">'+b.t("headerids.button.set")+"</button>").content;d.find(e("set-button")).click(function(){f(a.effective).attr("id",f(e("input")).val());f(a.effective).addClass("aloha-customized")});d.find(e("reset-button")).click(function(){c.processH(a.effective);f(a.effective).removeClass("aloha-customized");a.content.find(e("input")).val(a.effective.attr("id"))})},
onActivate:function(a){this.effective=a;this.content.find(e("input")).val(a.attr("id"))}});a.show()},makeClean:function(a){this.check(a)}})});define("metaview/nls/i18n",{root:{"button.switch-metaview.tooltip":"Switch between meta and normal view"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0});define("metaview/metaview-plugin","jquery aloha/core aloha/plugin ui/ui ui/toggleButton i18n!metaview/nls/i18n i18n!aloha/nls/i18n".split(" "),function(l,f,a,g,c,b){function e(a,b){a.addClass("aloha-metaview");
b.setState(true);j[a[0].id]=true}function k(a,b){a.removeClass("aloha-metaview");b.setState(false);j[a[0].id]=false}var j={},m=g.adopt("toggleMetaView",c,{tooltip:b.t("button.switch-metaview.tooltip"),icon:"aloha-icon aloha-icon-metaview",scope:"Aloha.continuoustext",click:function(){var a=f.activeEditable.obj;j[a[0].id]?k(a,this):e(a,this)}});return a.create("metaview",{config:["metaview"],init:function(){var a=this;f.bind("aloha-editable-activated",function(){var b=a.getEditableConfig(f.activeEditable.obj);
if(l.type(b)==="array"&&l.inArray("enabled",b)!==-1){m.show(true);e(f.activeEditable.obj,m)}else if(l.type(b)==="array"&&l.inArray("metaview",b)!==-1){m.show(true);j[f.activeEditable.obj[0].id]?e(f.activeEditable.obj,m):k(f.activeEditable.obj,m)}else m.show(false)});f.bind("aloha-editable-deactivated",function(){f.activeEditable.obj.removeClass("aloha-metaview")})}})});define("listenforcer/listenforcer-plugin",["aloha","jquery","aloha/plugin","aloha/console"],function(l,f,a,g){function c(a,c){if(-1!==
f.inArray(a[0],b)){a.find(".aloha-end-br").remove();var g=!1;a.find("li").each(function(){if(""!==f.trim(f(this).text()))return g=!0,!1});g||a.html(c);var l=a.find(">ul,>ol"),d=l.length,p;if(1<d){var n=f(l[0]);for(p=1;p<d;++p)n.append(f(l[p]).find(">li")),f(l[p]).remove()}a.find(">*:not(ul,ol)").remove()}}var b=[];return a.create("listenforcer",{_constructor:function(){this._super("listenforcer")},init:function(){var a=this,b=this.settings.editables||[],j,m,d=b.length;for(m=0;m<d;m++)j=b[m],"string"===
typeof j||j.nodeName||j instanceof f?f(j).each(function(){a.addEditableToEnforcementList(this)}):g.warn("Aloha List Enforcer Plugin",'Object "'+j.toString()+'" can not be used as a jQuery selector with which to register an editable to be list enforced.');l.bind("aloha-editable-activated",function(a,b){c(b.editable.obj,"<ul><li><br /></li></ul>")});l.bind("aloha-editable-deactivated",function(a,b){c(b.editable.obj,"")});l.bind("aloha-smart-content-changed",function(a,b){l.activeEditable&&!0===l.activeEditable.isActive&&
c(b.editable.obj,"<ul><li><br /></li></ul>")})},addEditableToEnforcementList:function(a){a&&b.push(a)}})});Aloha._load&&Aloha._load()})();
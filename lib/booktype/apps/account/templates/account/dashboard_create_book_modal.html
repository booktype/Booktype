{% load i18n booktype_tags %}

<div class="modal fade" id="createBookModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog new_book">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h2 class="modal-title" id="myModalLabel">{% trans "Create New Book" %}</h2>
      </div>
      <div class="modal-body">
        <section id="basic">
          <form method="post" action="{% url 'accounts:create_book' current_user.username %}" target="hidden_frame" enctype="multipart/form-data">
            {% csrf_token %}
            {% with book_creation_form as form %}
            <div id="wizard-1">

              <h3>{% trans "Book Information" %}</h3>
              <section>
                <p class="wizard_desc">{% trans "Please fill in the details of your book" %}</p>
                <div class="form-group mb10">
                  {{ form.title.label_tag }}
                  {{ form.title }}
                  <div class="bookexists alert alert-danger" style="display: none;">
                    {% trans "There is already a book with this name." %}
                  </div>
                </div>

                <div class="form-group mb10">
                  {{ form.author.label_tag }}
                  {{ form.author }}
                </div>

                <div class="form-group mb10">
                  {{ form.language.label_tag }}
                  {{ form.language }}
                </div>

                <div class="form-group mb10">
                  {{ form.license.label_tag }}
                  {{ form.license }}
                </div>

                <div class="form-group mb10">
                  <label for="visible_to_everyone">
                    {{ form.visible_to_everyone.label }} <i class="fa fa-info-circle" data-toggle="tooltip" title="{{ form.visible_to_everyone.help_text }}"></i>:
                  </label>
                  {{ form.visible_to_everyone }}
                </div>

                <div class="form-group mb0">
                  {{ form.description.label_tag }}
                  {{ form.description }}
                </div>
              </section>

              <h3>{% trans "Metadata" %}</h3>
              <section>
                <p class="wizard_desc">{% trans "Enter some metadata of your book" %}</p>
                {% for mfield in form.get_metadata_fields %}
                  <div class="form-group {% if forloop.last %}mb0{% else %}mb10{% endif %}">
                    {{ mfield.label_tag }}
                    {{ mfield }}
                  </div>
                {% endfor %}
              </section>

              <h3>{% trans "Creation mode" %}</h3>
              <section>
                <p class="wizard_desc">{% trans "Choose the way you want to create your book" %}</p>
                <div class="form-group mb20 row">
                  <label class="col-xs-3" for="creation_mode">
                    {% trans "Creation mode" %}:
                  </label>
                  <div class="col-xs-9">
                    <input id="creation_mode_scratch" type="radio" name="creation_mode" value="scratch" class="mr5" checked>
                    <label for="creation_mode_scratch" class="f-normal">
                      {% trans "From scratch" %}
                      <i class="fa fa-info-circle" data-toggle="tooltip" title="{% trans 'Will create an empty book with no sections or chapters' %}"></i>
                    </label>
                    <br>

                    <input id="creation_mode_based_on_book" type="radio" name="creation_mode" value="based_on_book" class="mr5">
                    <label for="creation_mode_based_on_book" class="f-normal">
                      {% trans "Based on another book" %}
                      <i class="fa fa-info-circle" data-toggle="tooltip" title="{% trans 'Pick this option if you want to create your book based on another book existent on the system' %}"></i>
                    </label>
                    <br>

                    <input id="creation_mode_based_on_skeleton" type="radio" name="creation_mode" value="based_on_skeleton" class="mr5">
                    <label for="creation_mode_based_on_skeleton" class="f-normal">
                      {% trans "Based on skeleton" %}
                      <i class="fa fa-info-circle" data-toggle="tooltip" title="{% trans 'You will have the option to select a predefined skeleton to base your new book on' %}"></i>
                    </label>
                  </div>
                </div>

                <div id="base_on_book_row" class="form-group mb10 row" style="display: none;">
                  <div class="col-xs-3">
                    {{ form.base_book.label_tag }}
                  </div>
                  <div class="col-xs-7 pl0">
                    {{ form.base_book }}
                  </div>
                </div>

                <div id="base_on_skeleton_row" class="form-group mb10 row" style="display: none;">
                  <div class="col-xs-3">
                    {{ form.base_skeleton.label_tag }}
                  </div>
                  <div class="col-xs-7 pl0">
                    {{ form.base_skeleton }}
                  </div>

                  {% if form.base_skeleton.field.queryset.count == 0 %}
                  <div class="col-xs-7 col-xs-offset-3 pl0 mt5">
                    <p>
                      {% trans "No book skeletons yet." %}
                      {% check_perm 'account.can_manage_book_skeletons' %}
                      {% blocktrans %}You can manage book skeletons from the <a href="{% url 'control_center:settings' %}#list-of-skeletons">Control Center</a>.{% endblocktrans %}
                      {% endcheck_perm %}
                    </p>
                  </div>
                  {% endif %}
                </div>
              </section>

              <h3>{% trans "Image" %}</h3>
              <section>
                <p class="wizard_desc">{% trans "If you have an image for the book then add it now (this can be added or changed later)" %}</p>
                <label for="cover">{% trans "Book Image" %}</label>
                <input type="file" name="cover" size="40">
              </section>

            </div>
            {% endwith %}
          </form>

          <iframe name="hidden_frame" style="display:none;"></iframe>
        </section>
      </div>
    </div>
  </div>
</div>
